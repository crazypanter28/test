function showAdvisersInfo(e,t,n){"use strict";var o=angular.element($("#goals-report")[0]).scope();o.$apply(function(){o.reports.showAdvisersInfo(e,t,n),$("html, body").animate({scrollTop:$(".details-wrapper").offset().top-100},500)})}!function(){"use strict";angular.module("actinver.providers",[]),angular.module("actinver.controllers",[]),angular.module("actinver.services",[]),angular.module("actinver.directives",[]),angular.module("actinver.constants",[]),angular.module("actinver.filters",[]),angular.module("actinver.templates",[]),angular.module("actinver",["actinver.filters","actinver.providers","actinver.controllers","actinver.services","actinver.directives","actinver.constants","actinver.filters","actinver.templates","ui.bootstrap","sun.scrollable","ui.router","ncy-angular-breadcrumb","ngStorage","ngResource","oc.lazyLoad","chart.js","ngTable","ngStomp","ngSanitize","daterangepicker","angularFileUpload","ngFileSaver","angularMoment","textAngular","rzModule","ng-currency","ng-percent","chart.js","ngMask","angularUtils.directives.dirPagination","angular-loading-bar","htmlToPdfSave"]),angular.module("actinver").config(["$httpProvider","$locationProvider",function(e,t){e.interceptors.push("interceptor404"),e.interceptors.push("interceptorToken"),t.hashPrefix("")}]),angular.module("actinver").run(["$rootScope","$state","$sessionStorage","Auth",function(e,t,n,o){o.init(),e.$state=t,e.Object=Object,e.getTodayDate=new Date,e.$on("$stateChangeStart",function(a,r,i){$("html, body").animate({scrollTop:0},"1500"),o.checkPermissionForView(r)||(a.preventDefault(),n.user?window.location.href="/#!/dashboard":location.assign("/asesoria/login")),"app.dashboard"!==r.name&&"app.dashboard"===a.currentScope.$state.$current.self.name&&(e.$broadcast("close-socket-ipc-status"),e.$broadcast("close-socket-last-news")),r.data&&r.data.needContract&&!n.sclient&&(a.preventDefault(),t.go("operations",i,{location:"replace"})),void 0===r.data&&"operations"!==r.name&&"account"!==r.name&&delete n.sclient,r.redirectTo&&(a.preventDefault(),t.go(r.redirectTo,i,{location:"replace"})),"investment.capitals"===a.currentScope.$state.$current.self.name&&e.$broadcast("disconnectCapitals"),"investment.capitalsLumina"===a.currentScope.$state.$current.self.name&&e.$broadcast("disconnectCapitals")})}])}(),function(){"use strict";function e(e,t){e.modelForView={},e.$watch(function(){return angular.toJson(t)},function(e,t){void 0!==t&&e!==t&&(R.isEmpty(JSON.parse(e))||!JSON.parse(t).sclient&&!JSON.parse(e).sclient)&&(window.location.href="/login.html")})}e.$inject=["$scope","$sessionStorage"],angular.module("actinver.controllers").controller("mainCtrl",e)}(),function(){"use strict";function e(){return{numeric:"\\d+",alphanumeric:"[a-z0-9A-ÑñZáéíóúÁÉÍÓÚ ]+",letter:"[a-zA-ZáéíóúÁÉÍÓÚ ]+",date:"[(d{1,2})/(d{1,2})/(d{4})]+"}}angular.module("actinver.constants").constant("REGEX",new e)}(),function(){"use strict";function e(){return{userInfo:"/asesoria-restful/api/asesoria/user",csrfRest:"/asesoria-restful/api/asesoria/validate",validateUserTokens:"/asesoria-restful/api/asr/orchestrate/validateUserTokens",saveAdviserNumber:"/asesoria-restful/api/asr/orchestrate/saveAdviserNumber",login:"/asesoria/login",logout:"/asesoria/logout",getPermiso:"/asesoria-restful/api/all/Asesores/UserRole/getRoleAllow",getBalance:"/asesoria-restful/api/asr/investmentSociety/v1_1/cashByDate/",getTransfers:"/asesoria-restful/api/asr/movements/v1_0/contractMovementsQuery/",getBankContractSPEIMovementsQuery:"/asesoria-restful/api/asr/movements/v1_0/bankContractSPEIMovementsQuery/",getOtherAccounts:"/asesoria-restful/api/asr/orchestrate/destinationAccountQuery/",getMedia:"/asesoria-restful/api/asr/catalogs/v1_0/contactMeansCatalog?language=SPA",webSocketUrl:"http://vsdlapafro01.actinver.com.mx/Asesores/ws/stock/",makeTransfer:"/asesoria-restful/api/asr/financialOps/v1_0/transferExecution?language=SPA",makeTransferOtherAccount:"/asesoria-restful/api/asr/financialOps/v1_0/brokerSPEITransfer?language=SPA",getIPC:"/asesoria-restful/api/asr/Asesores/GraphicsInfo/getIPC",dashboardWebSocket:"/asesoria-restful/api/asr/ws",getIssuers2:"/issuers2",dashboardNews:"/asesoria-restful/api/asr/orchestrate/getLastNews",dashboardMonthGoal:"",dashboardIncomes:"",dashboardSchedule:"/asesoria-restful/api/asr/Asesores/ActivityLog/getUncontactedCustomers/",dashboardSocial:"",getAppointments:"/asesoria-restful/api/asr/Asesores/Mail/getAppointments/",getCurrentMessages:"/asesoria-restful/api/asr/Asesores/Message/getCurrentMessages/",addNewActivity:"/asesoria-restful/api/asr/Asesores/ActivityDay/addActivityDay/",getGoalsPositions:"/asesoria-restful/api/asr/Asesores/Meta/metaPosiciones/",getSumGoalsPositions:"/asesoria-restful/api/asr/Asesores/Meta/sumMetaPosiciones/",getGoalsContracts:"/asesoria-restful/api/asr/Asesores/Meta/metaContratos/",getSupervisorInfo:"/asesoria-restful/api/asr/Asesores/Meta/reporteSupervisor/",getCenterInfo:"/asesoria-restful/api/asr/Asesores/Meta/metaPosicionesCFSuper/",getCenterProducts:"/asesoria-restful/api/asr/Asesores/Meta/metaContratosCFSuper/",getGroupsByEmployee:"/asesoria-restful/api/asr/Asesores/Meta/getGroupsByEmployee/",getInfoByGroup:"/asesoria-restful/api/asr/Asesores/Meta/reporteSupervisorPorGrupo/",getCustomCenterInfo:"/asesoria-restful/api/asr/Asesores/Meta/metaPosicionesCF/",getCustomCenterProducts:"/asesoria-restful/api/asr/Asesores/Meta/metaContratosCF/",getSharedReport:"/asesoria-restful/api/asr/Asesores/SharedReport/getSharedReport/",getGroupsByEmployeeRpt:"/asesoria-restful/api/rpt/Asesores/Meta/getGroupsByEmployee/",getInfoByGroupRpt:"/asesoria-restful/api/rpt/Asesores/Meta/reporteSupervisorPorGrupo/",getGoalsPositionsRpt:"/asesoria-restful/api/rpt/Asesores/Meta/metaPosiciones/",getSumGoalsPositionsRpt:"/asesoria-restful/api/rpt/Asesores/Meta/sumMetaPosiciones/",getGoalsContractsRpt:"/asesoria-restful/api/rpt/Asesores/Meta/metaContratos/",getCustomCenterInfoRpt:"/asesoria-restful/api/rpt/Asesores/Meta/metaPosicionesCF/",getCustomCenterProductsRpt:"/asesoria-restful/api/rpt/Asesores/Meta/metaContratosCF/",getBinnacleClients:"/asesoria-restful/api/asr/Asesores/Contract/getSponsorList/",getBirthDays:"/asesoria-restful/api/asr/Asesores/ActivityLog/getBirthDays/",getClientDetails:"/asesoria-restful/api/asr/Asesores/Contract/getDetailsOfContract/",getCommentsDetailsByContract:"/asesoria-restful/api/asr/Asesores/Contract/getDetailsOfContract/",sendMessangeBirthday:"/asesoria-restful/api/asr/Asesores/ActivityLog/sendCongratulations",getDetailGraph:"/asesoria-restful/api/asr/Asesores/ActivityLog/getReportMetas",getAdvisersDetails:"/asesoria-restful/api/asr/Asesores/ActivityLog/getReportMetasDetail/",getClientType:"/asesoria-restful/api/asr/Asesores/Contract/validateUser/",getClientProfile:"/asesoria-restful/api/asr/Asesores/Contract/getProfile/",getBinnacleAdvGoal:"/asesoria-restful/api/asr/Asesores/ActivityLog/getReport/",getBinnacleCatalog:"/asesoria-restful/api/asr/Asesores/ActivityLog/getActivityCatalogRoot/TPC/",getBinnacleCatalogChild:"/asesoria-restful/api/asr/Asesores/ActivityLog/getActivityCatalogChild/",doBinnacleComment:"/asesoria-restful/api/asr/Asesores/ActivityLog/saveComment/",getOutlineInfo:"/asesoria-restful/api/asr/Asesores/PracticasVenta/",getSellsPracticeUrl:"/asesoria-restful/api/asr/Asesores/PracticasVenta/getUrlVentas",getIssuersInfo:"/asesoria-restful/api/asr/Asesores/Fund/getFunds/",getProducts:"/asesoria-restful/api/asr/Asesores/Product/getClassifications/",getSubProducts:"/asesoria-restful/api/asr/Asesores/Product/getProductsByClassification/",getProfiles:"/asesoria-restful/api/asr/Asesores/Catalogs/getClientProfileCatalog/",getStrategies:"/asesoria-restful/api/asr/Asesores/Portfolio/getModelPortfolioByCriterionQuery/",getStrategyDetail:"/asesoria-restful/api/asr/Asesores/Portfolio/getModelPortfolioDetailQuery/",getInvIssuersCatalog:"/asesoria-restful/api/asr/Asesores/InvestmentSociety/getIssuersCatalog/",getBandsCatalog:"/asesoria-restful/api/asr/Asesores/BondMarket/getBandsCatalog/",getIssuersCatalog:"/asesoria-restful/api/asr/Asesores/BondMarket/getIssuersCatalog/",getAllIssuers:"/asesoria-restful/api/asr/Asesores/MarketInfo/getIssuersCatalog/",doProposal:"/asesoria-restful/api/asr/Asesores/ActivityLog/saveComment/",getContractInfo:"/asesoria-restful/api/asr/orchestrate/validateContractUserOrchestrate/",doTracing:"/Asesores/ActivityLog/saveComment/",getCustomerTrackingAndProposal:"/asesoria-restful/api/asr/Asesores/Report/getCustomerTrackingAndProposal",getCustomerTracking:"/asesoria-restful/api/asr/Asesores/Report/getCustomerTracking/",getAdviserContract:"/asesoria-restful/api/asr/Asesores/Contract/validateUser/",getContractIdClient:"/eActinver_Admin/jaxrs/AdministrativeManagerEnrollmentRest/getIdClient/",getContractSummary:"/asesoria-restful/api/asr/Asesores/Portfolio/getSummary/",getinsuranceAccumulatedRisksValidation:"/asesoria-restful/api/asr/insurance/v1_0/insuranceAccumulatedRisksValidation",getDetailedSummary:"/asesoria-restful/api/asr/Asesores/Portfolio/getDetailedSummary",getDetailedSummaryGral:"/asesoria-restful/api/asr/Asesores/Portfolio/getDetailedSummary",getBrokerHousePositionList:"/api/asr/Asesores/Contract/getBrokerHousePositionList/",getBankPositionList:"/asesoria-restful/api/asr/Asesores/Contract/getBankPositionList/",getBankWarrantyPositionList:"/asesoria-restful/api/asr/Asesores/Contract/getBankWarrantyPositionList/",getInsuranceInsuredSumQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceInsuredSumQuery",getCurrentPortfolio:"/Asesores/Portfolio/getCurrentPortfolio/",getCustomerProposal:"/asesoria-restful/api/asr/Asesores/Report/getCustomerProposal",getFavoritesAsr:"/asesoria-restful/api/asr/Asesores/Issuer/getFavorites/",getClientInfo:"/asesoria-restful/api/asr/client/v1_0/clientOrContractClientInfoQuery/",getContractByAdviser:"/asesoria-restful/api/asr/orchestrate/contractByClientID/",getContracts:"/asesoria-restful/api/asr/balance/v1_0/contractsBalancesByPortfolioQuery",getContractHistorical:"/asesoria-restful/api/asr/balance/v1_0/brokerMonthlyBalanceQuery",getClientName:"/asesoria-restful/api/asr/clientInfo/v1_0/clientInfoQuery",getBrokerHistoricalBalanceQuery:"/asesoria-restful/api/asr/balance/v1_0/brokerHistoricalBalanceQuery",getPortfolioResume:"/asesoria-restful/api/asr/orchestrate/summaryPortfolio/",getCreditsList:"/asesoria-restful/api/asr/orchestrate/loans/",getInsurancesList:"/portfolio-insurances/",getContractDetail:"/asesoria-restful/api/asr/portfolio/v1_0/portfolioDetailQuery/",getContractDetailBank:"/asesoria-restful/api/asr/portfolio/v1_0/fIXISSecuritiesPortfolioQuery/",getInitDoll:"/asesoria-restful/api/asr/balance/v1_0/a2KContractBalance/",getInitDoll2:"/asesoria-restful/api/asr/investmentSociety/v1_0/fundQuery/",confirmDoll:"/asesoria-restful/api/asr/investmentSociety/v1_2/fundOrderQuotation?language=SPA",capture:"/asesoria-restful/api/asr/investmentSociety/v1_2/fundOrderRegistration?language=SPA",getDetailStations:"/asesoria-restful/api/asr/investmentSociety/v1_2/fundOperationDataQuery/",getDollAccounts:"/asesoria-restful/api/asr/orchestrate/destinationAccountQuery/",getOrderDetail:"/asesoria-restful/api/asr/movements/v1_0/contractMovementsQuery",getOrders:"/asesoria-restful/api/asr/orders/v1_2/ordersByDateQuery/",getPortfolio:"/asesoria-restful/api/asr/portfolio/v1_0/portfolioDetailQuery/",getInvestmentSocietyRest:"/asesoria-restful/api/asr/investmentSociety/v1_2/investmentIssuersQuery/",getMoreInfo:"/asesoria-restful/api/asr/orders/v1_0/fundsOrderDetailQuey/",getMoreInfoCapital:"/asesoria-restful/api/asr/orders/v1_0/capitalMarketOrderDetailQuery/",cancellation:"/asesoria-restful/api/asr/investmentSociety/v1_2/fundOrderCancelation",cancellationMarket:"/asesoria-restful/api/asr/capitalMarket/v1_1/stockMarketOrderCancelation",cancellationStopLoss:"/asesoria-restful/api/asr/capitalMarket/v1_1/stopLossTrailingStopCancelation/",getReporto:"/asesoria-restful/api/asr/bondMarket/v1_1/bondMarketBands/",getCurrentCash:"/asesoria-restful/api/asr/balance/v1_0/a2KContractBalance/",confirmMoneyDoll:"/asesoria-restful/api/asr/bondMarket/v1_1/bondMarketOrderQuotation?language=SPA",doMoneyTransaction:"/asesoria-restful/api/asr/bondMarket/v1_1/bondMarketOrderRegistration?language=SPA",getCapitalsStation:"/asesoria-restful/api/asr/marketinfo/v1_1/clientIssuersMarketInfoQuery/",getNewCapitalsStation:"/asesoria-restful/api/asr/marketinfo/v1_1/contractIssuersMarketInfoQuery/",CapitalsWebSocket:"/asesoria-restful/api/asr/ws",getLastIPC:"/asesoria-restful/api/asr/marketinfo/v1_0/stockMarketIndexQuery",getCommission:"/asesoria-restful/api/asr/contractInfo/v1_0/contractCommissionAndValuationQuery/",getCommission34:"/asesoria-restful/api/asr/catalogs/v1_0/capitalBandCatalog/",getCapitalStop:"/asesoria-restful/api/asr/capitalMarket/v1_0/securitiesForStopLossQuery/",getAcciones:"/asesoria-restful/api/asr/portfolio/v1_1/securitiesPortfolioQuery/",confirmStopLoss:"/asesoria-restful/api/asr/capitalMarket/v1_1/stopLossTrailingStopRegistration?language=SPA",getOrderValidity:"/asesoria-restful/api/asr/orders/v1_0/orderValidityQuery/",getOptionsTypeOperation:"/asesoria-restful/api/asr/catalogs/v1_1/getOptionsTypeOperation",getAccionesLumina:"/asesoria-restful/api/asr/capitalMarket/v1_0/capitalMarketPositionQuery",getOrdersLumina:"/asesoria-restful/api/asr/capitalMarket/v1_0/capitalMarketOrderQuery",cancellationLumina:"/asesoria-restful/api/asr/capitalMarket/v1_0/cMEquityOrderCancelation",confirmCapitalDollLumina:"/asesoria-restful/api/asr/capitalMarket/v1_0/cMEquityOrderRegistration",getOrdertypeCatalog:"/asesoria-restful/api/asr/orchestrate/orderTypeCatalog/",getClientElegible:"/asesoria-restful/api/asr/contractInfo/v1_0/bankContractQuery/",geturlpracticasventa:"/asesoria-restful/api/asr/orchestrate/generateUrlSelling/",LuminaWebSocket:"/asesoria-restful/api/asr/ws",updateStatusLumina:"/asesoria-restful/api/asr/adviser/v1_0/adviserNotificationStsModification",getNotificationLumina:"/asesoria-restful/api/asr/orchestrate/notificationQuery",getOrderCatalog:"/asesoria-restful/api/asr/orders/v1_0/ordersTypeQuery",confirmCapitalDoll:"/asesoria-restful/api/asr/capitalMarket/v1_0/cMOrderManagement?language=SPA",getBinnacleOperativeBank:"/asesoria-restful/api/asr/Asesores/OperativeLogBook/getBankLog",getBinnacleOperativeStockExchange:"/asesoria-restful/api/asr/Asesores/OperativeLogBook/getCBLog",getInvestmentIssuersQuery:"/asesoria-restful/api/asr/Asesores/InvestmentSociety/getInvestmentIssuersQuery/",clientIssuersMarketInfoQuery:"/asesoria-restful/api/asr/Asesores/MarketInfo/clientIssuersMarketInfoQuery/",SimulatorRest:"/ficha-valor-restful/SimulatorRest/",getCreditDetail:"/getCreditDetail/",getSimPayment:"/getSimPayment/",clientIssuersMarketInfoQueryV1:"/asesoria-restful/api/asr/marketinfo/v1_0/clientIssuersMarketInfoQuery/",getTableProspects:"/tableAdmin/",getProsGraphics:"/asesoria-restful/api/asr/Asesores/getProsGraphics/",getProsReports:"/getProsReports/",getCatalogSearch:"/asesoria-restful/api/asr/Asesores/Prospect/catalogSearch/",getListByEmployee:"/asesoria-restful/api/asr/Asesores/Prospect/getListByEmployee/",getStages:"/asesoria-restful/api/asr/Asesores/Prospect/getStagesCatalog",prospecsPT:"/asesoria-restful/api/asr/Asesores/Prospect/prospect/PT/",getDetailProspect:"/asesoria-restful/api/asr/Asesores/Prospect/getDetail/",getProspectTPC:"/asesoria-restful/api/asr/Asesores/Prospect/TPC/",getProspectProfile:"/asesoria-restful/api/asr/Asesores/Prospect/Prospect/profile/",saveProspect:"/asesoria-restful/api/asr/Asesores/Prospect/save/",updateProspect:"/asesoria-restful/api/asr/Asesores/Prospect/update/",saveActivity:"/asesoria-restful/api/asr/Asesores/Prospect/saveActivity/",deleteActivity:"/asesoria-restful/api/asr/Asesores/Prospect/deleteActivity/",closeActivity:"/asesoria-restful/api/asr/Asesores/Prospect/closeActivity/",updateActivity:"/asesoria-restful/api/asr/Asesores/Prospect/updateActivity/",getActivityRecord:"/asesoria-restful/api/asr/Asesores/ActivityRecord",getActivityRecordAdm:"/asesoria-restful/api/adm/Asesores/ActivityRecord",getActivityOffices:"/asesoria-restful/api/asr/Asesores/Meta/getFinancialCenters/?language=SPA",getTracingClient:"/asesoria-restful/api/asr/Asesores",getDetailedCustomerTrackingReport:"/asesoria-restful/api/asr/Asesores/Report/getDetailedCustomerTrackingReport",getCustomerTrackingReport:"/asesoria-restful/api/asr/Asesores/Report/getCustomerTrackingReport",getPresentations:"/asesoria-restful/api/asr/Asesores/Presentation/getPresentationsByType/",getIssuersProposal:"/asesoria-restful/api/adm/Asesores/Fund/getFunds/",getClassifications:"/asesoria-restful/api/adm/Asesores/Product/getClassifications/",getProductsByClassification:"/asesoria-restful/api/adm/Asesores/Product/getProductsByClassification/",deleteProduct:"/asesoria-restful/api/adm/Asesores/Product/delete/",saveProduct:"/asesoria-restful/api/adm/Asesores/Product/save/",updateProduct:"/asesoria-restful/api/adm/Asesores/Product/updateName/",doFactsheet:"/asesoria-restful/api/adm/Asesores/Product/save/",updateFactsheetImg:"/asesoria-restful/api/asr/Asesores/Product/updateProduct/",getProductFactsheetImg:"/asesoria-restful/api/adm/Asesores/Product/getImage/",updateFactsheetProduct:"/asesoria-restful/api/adm/Asesores/Product/updateName/",deleteFactsheetProduct:"/asesoria-restful/api/adm/Asesores/Product/delete/",getGroups:"/asesoria-restful/api/adm/Asesores/Meta/getGroups/",saveGroup:"/asesoria-restful/api/adm/Asesores/Meta/saveGroup/",updateNameGroup:"/asesoria-restful/api/adm/Asesores/Meta/updateNameGroup/",deleteGroup:"/asesoria-restful/api/adm/Asesores/Meta/deleteGroup/",ServiceGroups:"/asesoria-restful/api/adm/Asesores/Meta/",getTypesAsr:"/asesoria-restful/api/asr/Asesores/Presentation/getTypes/",getTypes:"/asesoria-restful/api/adm/Asesores/Presentation/getTypes/",getPresentationsByType:"/asesoria-restful/api/adm/Asesores/Presentation/getPresentationsByType/",getPresentationSubTypes:"/asesoria-restful/api/asr/Asesores/PresentationSubType/getPresentationSubTypes/",getPresentationSubTypesByClassification:"/asesoria-restful/api/adm/Asesores/PresentationSubType/getPresentationSubTypesByClassification/",savePresentation:"/asesoria-restful/api/adm/Asesores/Presentation/save/",updatePresentationImg:"/asesoria-restful/api/asr/Asesores/Presentation/update/",getPresentationFile:"/asesoria-restful/api/asr/Asesores/Presentation/getFile/",getPresentationFileAdm:"/asesoria-restful/api/adm/Asesores/Presentation/getFile/",deletePresentation:"/asesoria-restful/api/adm/Asesores/Presentation/delete/",updateNamePresentation:"/asesoria-restful/api/adm/Asesores/Presentation/updateName/",saveClasification:"/asesoria-restful/api/adm/Asesores/PresentationType/saveClassification/",saveSubClasification:"/asesoria-restful/api/asr/Asesores/PresentationSubType/save/",getGlobalForecasts:"/asesoria-restful/api/adm/Asesores/Parameters/getGlobalForecasts/",updateGlobalForecasts:"/asesoria-restful/api/adm/Asesores/Parameters/updateGlobalForecasts/",getLocalForecasts:"/asesoria-restful/api/adm/Asesores/Parameters/getLocalForecasts/",updateLocalForecasts:"/asesoria-restful/api/adm/Asesores/Parameters/updateLocalForecasts/",getEconomicEnvironment:"/asesoria-restful/api/adm/Asesores/Parameters/getEconomicEnvironment/",updateEconomicEnvironment:"/asesoria-restful/api/adm/Asesores/Parameters/updateEconomicEnvironment/",getAnnoucement:"/asesoria-restful/api/adm/Asesores/Parameters/getAnnoucement/",updateAnnouncement:"/asesoria-restful/api/adm/Asesores/Parameters/updateAnnouncement/",getDerivatives:"/asesoria-restful/api/adm/Asesores/Parameters/getDerivatives/",updateDerivatives:"/asesoria-restful/api/adm/Asesores/Parameters/updateDerivatives/",getDerivativesAsr:"/asesoria-restful/api/asr/Asesores/Parameters/getDerivatives/",getFundTypes:"/asesoria-restful/api/adm/Asesores/Fund/getFundTypes/",saveFund:"/asesoria-restful/api/adm/Asesores/Fund/saveFund/",deleteFund:"/asesoria-restful/api/adm/Asesores/Fund/deleteFund/",updateFund:"/asesoria-restful/api/adm/Asesores/Fund/updateFund/",saveFavorite:"/asesoria-restful/api/adm/Asesores/Issuer/saveFavorite/",deleteFavorite:"/asesoria-restful/api/adm/Asesores/Issuer/deleteFavorite/",updateFavorite:"/asesoria-restful/api/adm/Asesores/Issuer/updateFavorite/",getFavorites:"/asesoria-restful/api/adm/Asesores/Issuer/getFavorites/",getClassificationFav:"/asesoria-restful/api/asr/Asesores/ClassificationFav/getClassificationFav/",getClassificationFavAdm:"/asesoria-restful/api/adm/Asesores/ClassificationFav/getClassificationFav/",saveClassificationFav:"/asesoria-restful/api/adm/Asesores/ClassificationFav/saveClassificationFav/",deleteClassificationFav:"/asesoria-restful/api/adm/Asesores/ClassificationFav/deleteClassificationFav/",getEmployeeMap:"/asesoria-restful/api/adm/Asesores/employeeMap/getEmployeeMap/",deleteEmployeMap:"/asesoria-restful/api/adm/Asesores/employeeMap/deleteEmployeMap/",saveEmployeeMap:"/asesoria-restful/api/adm/Asesores/employeeMap/saveEmployeeMap/",getRoles:"/asesoria-restful/api/adm/Asesores/UserRole/getRoles/",getUserRoles:"/asesoria-restful/api/adm/Asesores/UserRole/getUserRoles/",saveUserRole:"/asesoria-restful/api/adm/Asesores/UserRole/saveUserRole/",deleteUserRole:"/asesoria-restful/api/adm/Asesores/UserRole/deleteUserRole/",getMessages:"/asesoria-restful/api/adm/Asesores/Message/getAllMessages/",messageRegistration:"/asesoria-restful/api/adm/Asesores/Message/messageRegistration/",getMessageDetail:"/asesoria-restful/api/asr/Asesores/Message/getMessageDetail/",getAllMessagesByRange:"/asesoria-restful/api/adm/Asesores/Message/getAllMessagesByRangeDate/",getAdvisersBinnacleMessage:"/asesoria-restful/api/adm/Asesores/Message/getMessage/",getAdvisersBinnacleBinnacle:"/asesoria-restful/api/adm/Asesores/ActivityLog/getReportCommentsXls/",getMediaBank:"/asesoria-restful/api/asr/orchestrate/contactMeansCatalog",getOrdersBank:"/asesoria-restful/api/asr/funds/v1_0/bankFundsAndMoneyMarketMvmntsQuery",getOrdersMoneyMarketBank:"/asesoria-restful/api/asr/movements/v1_0/bankContractInvstMovementsQuery",deleteReportoBuy:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketReportoBuyCancellation",deleteDirectBuy:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketDirectBuyCancellation/",deleteDirectSell:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketDirectSellCancellation",getReportoBands:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketBandsReportoQuery",getDirectBands:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketBandsDirectQuery/",getAuctionBands:"/asesoria-restful/api/asr/moneyMarket/v1_0/mMAuctionsQuery",getMoneyMarketCalculation:"/asesoria-restful/api/asr/moneyMarket/v1_0/mMBondPriceCalculationQuery/",getMoneyMarketRate:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketCalculationByRateQuery/",getMoneyMarketPrice:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketCalculationByDPriceQuery",getPortfolioBank:"/asesoria-restful/api/asr/portfolio/v1_0/bankInvstFundsAndMMPositionsQuery/",getPortfolioReporto:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketIntradayPositionQuery/",getAuctionsPrice:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketAuctionsPriceQuery/",getMaturityDateQuery:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketMaturityDateQuery/",getReportoConfirmLtr:"/asesoria-restful/api/asr/orchestrate/getReportoConfirmLetterQuery/",sendEmailReportoLtr:"/asesoria-restful/api/asr/orchestrate/sendEmailReportoConfirmLetter",getFundBank:"/asesoria-restful/api/asr/funds/v1_0/bankInvstFundsByContractQuery/",getCalendarBank:"/asesoria-restful/api/asr/funds/v1_0/bankInvstCalendarByFundsQuery/",bankFundBuyRequest:"/asesoria-restful/api/asr/investment/v1_0/bankFundBuyRequest",captureDirectBank:"/asesoria-restful/api/asr/moneyMarket/v1_0/mMDirectBondOrdersRegistration/",captureReportoBank:"/asesoria-restful/api/asr/moneyMarket/v1_0/mMReportoBondOrdersRegistration/",bankContractBalance:"/asesoria-restful/api/asr/balance/v1_0/bankContractBalance/",bankReportoBuyingPowerQuery:"/asesoria-restful/api/asr/portfolio/v1_0/bankReportoBuyingPowerQuery/",bankPortfolioQuery:"/asesoria-restful/api/asr/portfolio/v1_1/bankPortfolioQuery/",getPortfolioGlobalDetailQuery:"/asesoria-restful/api/asr/portfolio/v1_0/portfolioGlobalDetailQuery/",bankInvstUserInfoQuery:"/asesoria-restful/api/asr/funds/v1_0/bankInvstUserInfoQuery/",bankFundSellRequest:"/asesoria-restful/api/asr/investment/v1_0/bankFundSellRequest",bankFundBuyCancelationRequest:"/asesoria-restful/api/asr/investment/v1_0/bankFundBuyCancelation",bankFundSellCancelationRequest:"/asesoria-restful/api/asr/investment/v1_0/bankInvstFundOperationCancelation",getMoneyMarketIssuersSeriesQuery:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketIssuersSeriesQuery",getMoneyMarketAdviserContractsQuery:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketAdviserContractsQuery",getMoneyMarketContactMeansCatalogs:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketContactMeansCatalogs/",getMoneyMarketOrderQuotation:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketOrderQuotation",getMoneyMarketOrderRegistration:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketOrderRegistration",getQuestions:"/getQuestions",getVideos:"/getVideos",getPendingOperations:"/asesoria-restful/api/asr/contractManagemen/v1_0/eBPendingOpQuery/",PendingOperationsApprove:"/asesoria-restful/api/asr/contractManagemen/v1_0/eBPendingOpExecution/",PendingOperationsReject:"/asesoria-restful/api/asr/contractManagemen/v1_0/eBPendingOpModification/",PendingOperationsApproveNotification:"/asesoria-restful/api/asr/contractManagemen/v1_0/adviserPendingOpsExecution/",PendingOperationsRejectNotification:"/asesoria-restful/api/asr/contractManagemen/v1_0/adviserPendingOpsModification/",getPendingOperationsCat:"/asesoria-restful/api/cat/contractManagemen/v1_0/eBPendingOpQuery/",PendingOperationsApproveCat:"/asesoria-restful/api/cat/contractManagemen/v1_0/eBPendingOpExecution/",PendingOperationsRejectCat:"/asesoria-restful/api/cat/contractManagemen/v1_0/eBPendingOpModification/",PendingOperationsApproveCatNotification:"/asesoria-restful/api/cat/contractManagemen/v1_0/adviserPendingOpsExecution/",PendingOperationsRejectCatNotification:"/asesoria-restful/api/cat/contractManagemen/v1_0/adviserPendingOpsModification/",PendingOperationsHistoric:"/asesoria-restful/api/asr/contractManagemen/v1_0/eBHistoricalPendingOpQuery/",PendingOperationsHistoricCat:"/asesoria-restful/api/cat/contractManagemen/v1_0/eBHistoricalPendingOpQuery/",getPendingOperationsSent:"/asesoria-restful/api/asr/contractManagemen/v1_0/eBSentPendingOpQuery",getBankContractsByClientQuery:"/asesoria-restful/api/asr/contractInfo/v1_0/bankContractsByClientQuery/",rejectAdviser:"/api/operations/rejectAuth",approveAdviser:"/api/operations/requestAuth",orderTypeA2K:"/asesoria-restful/api/asr/orchestrate/orderTypeA2K/",getTemporal:"/asesoria/img/temp.json",getShortAndLargeReport:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketCashByAdviserQuery",getEmpleadoReport:"/asesoria-restful/api/asr/moneyMarket/v1_0/moneyMarketCashByAdviserQuery",getContractInfoDetail:"/asesoria-restful/api/asr/contractInfo/v1_0/simplifiedBankContractQuery/",getContractSelection:"/asesoria-restful/api/asr/orchestrate/contractSelection/",getMarketValidation:"/asesoria-restful/api/asr/clientConfigurations/v1_0/contractMarketValidation/",getDCInvestmentProspectQueryById:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCInvestmentProspectQueryById/",getDCInvestmentProspectQuery:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCInvestmentProspectQuery/",getDCScheduleQueryByDate:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCScheduleQueryByDate/",getDCScheduleQueryByDateDetails:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCScheduleQueryByDateDetails/",getDCDocumentQuery:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCDocumentQuery/",getDCDocumentQueryByClient:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCDocumentQueryByClient/",getDCScheduleQuery:"/asesoria-restful/api/dinnAsesoria/digitalChannelsManagment/v1_0/dCScheduleQuery/",getStrategy:"/asesoria-restful/api/asr/Asesores/Opportunity/getStrategy/",getSegment:"/asesoria-restful/api/asr/Asesores/Opportunity/getSegment/",saveOpportunity:"/asesoria-restful/api/asr/Asesores/Opportunity/saveOpportunity/",getListOpportunity:"/asesoria-restful/api/asr/Asesores/Opportunity/getOpportunity/",getOpportunityById:"/asesoria-restful/api/asr/Asesores/Opportunity/getOpportunityById/",updateContacted:"/asesoria-restful/api/asr/Asesores/Opportunity/updateContacted/",nextStage:"/asesoria-restful/api/asr/Asesores/Opportunity/nextStage/",updateOpportunity:"/asesoria-restful/api/asr/Asesores/Opportunity/updateOpportunity/",getOpportunityReport:"/asesoria-restful/api/asr/Asesores/Opportunity/getOpportunityReport/",getReportOpportunityDetail:"/asesoria-restful/api/asr/Asesores/Opportunity/getReportOpportunityDetail/",getReportOpportunityDetailFC:"/asesoria-restful/api/asr/Asesores/Opportunity/getReportOpportunityDetailFC/",outOfProfileContractQuery:"/asesoria-restful/api/asr/contractInfo/v1_0/outOfProfileContractQuery/",getCatalogEntityFederal:"/asesoria-restful/api/asr/insurance/v1_0/federalEntityQuery/",getCatalogMarksCars:"/asesoria-restful/api/asr/insurance/v1_1/carBrandQuery/",getCatalogModelsCars:"/asesoria-restful/api/asr/insurance/v1_1/carModelQuery/",getCatalogMunicipalityCars:"/asesoria-restful/api/asr/insurance/v1_0/municipalityQuery/",getCatalogBanksCars:"/asesoria-restful/api/asr/insurance/v1_0/insuranceBanksQuery/",getCatalogBanks:"/asesoria-restful/api/asr/insurance/v1_0/insuranceBanksQuery/",getServiceEmision:"/asesoria-restful/api/asr/insurance/v1_1/carInsurancePolicyRegistration/",getServiceCotizacion:"/asesoria-restful/api/asr/insurance/v1_1/carInsuranceQuotation/",getBankType:"/asesoria-restful/api/asr/insurance/v1_1/bankType/",sendCustomizedEmailNotificationSending:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingLifeInsurance/",sendEmailNotificationCotization:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCotizar/",sendEmailNotificationCompraSeguro:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCompraSeguro/",getStatementFiscal:"/asesoria-restful/api/asr/statement/v1_0/accountStatementAvailabilityQuery/",getStatementFiscalPormenorizadas:"/asesoria-restful/api/asr/statement/v1_0/fiscalCertificateAvailableQuery/",sendEmailNotificationStatementFiscalQuery:"/asesoria-restful/api/asr/orchestrate/sendEmailNotificationStatementFiscalQuery/",getAccountState:"/asesoria-restful/api/asr/orchestrate/getAccountState/",getAccountStateRh:"/asesoria-restful/api/rh/orchestrate/getAccountState/",getCatalogPostalCodeQuery:"/asesoria-restful/api/asr/insurance/v1_0/postalCodeQuery/",getCatalogInsuranceRiskTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceRiskTypeQuery/",getCatalogWallTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/wallTypeQuery/",getCatalogRoofTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/roofTypeQuery/",getCatalogStreetTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/streetTypeQuery/",getCatalogCardTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceCardTypeQuery/",getCatalogPaymentTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/PaymentTypeQuery/",getCatalogInsuranceCardTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/streetTypeQuery/",getServiceCotizacionHome:"/asesoria-restful/api/asr/insurance/v1_0/homeInsuranceQuotation/",getServiceEmisionHomegetServiceEmisionHome:"/asesoria-restful/api/asr/insurance/v1_0/homeInsurancePolicyRegistration/",getServiceEmisionPyme:"/asesoria-restful/api/asr/insurance/v1_0/homeInsurancePolicyRegistration/",getCatalogEntityFederalPyme:"/asesoria-restful/api/asr/insurance/v1_0/federalEntityQuery/",
getCatalogMunicipalityPyme:"/asesoria-restful/api/asr/insurance/v1_0/municipalityQuery/",getCatalogBanksPyme:"/asesoria-restful/api/asr/insurance/v1_0/insuranceBanksQuery/",getServiceCotizacionPyme:"/asesoria-restful/api/asr/insurance/v1_0/homeInsuranceQuotation/",getCatalogClasificationQuery:"/asesoria-restful/api/asr/insurance/v1_0/streetTypeQuery/",getCoverage:"/asesoria-restful/api/asr/insuranceCoverageService/v1_0/insuranceCoverageQuery/",getCotizationAdd:"/asesoria-restful/api/asr/insuranceQuotationService/v1_0/insuranceQuotationAdd/",getCotizationSearch:"/asesoria-restful/api/asr/insuranceQuotationService/v1_0/insuranceQuotationQuery/",getCotizationUpdate:"/asesoria-restful/api/asr/insuranceQuotationService/v1_0/insuranceQuotationUpdateJson/",getCotizationProcedure:"/asesoria-restful/api/asr/insuranceQuotationService/v1_0/insuranceQuotationProcedureJson/",getCotizationCancel:"/asesoria-restful/api/asr/insuranceQuotationService/v1_0/insuranceQuotationCancelJson/",getAgentQuery:"/asesoria-restful/api/asr/insuranceJpaService/v1_0/insuranceAgentQuery/",getAgent:"/asesoria-restful/api/asr/insuranceJpaService/v1_0/insuranceAgent/",getAgentAddQuery:"/asesoria-restful/api/asr/insuranceJpaService/v1_0/insuranceAgentAdd/",getAgentUpdateQuery:"/asesoria-restful/api/asr/insuranceJpaService/v1_0/insuranceAgentUpdate/",getAgentDeleteQuery:"/asesoria-restful/api/asr/insuranceJpaService/v1_0/insuranceAgentDelete/",sendEmailNotificationCotizationHome:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCotizarHogar",sendEmailNotificationEmisionHome:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCompraSeguroHogar",sendEmailNotificationCotizationPyme:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCotizarHogar",sendEmailNotificationEmisionPyme:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCompraSeguroHogar",getMedicalExpenseInsuranceQuotation:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseInsuranceQuotation",getMedExpInsuranceDetailQuotationQuery:"/asesoria-restful//api/asr/insurance/v1_0/medExpInsuranceDetailQuotationQuery",getMedicalExpenseJobQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseJobQuery",getMedicalExpensePolicyHolderNumQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpensePolicyHolderNumQuery",getMedicalExpenseStateQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseStateQuery",getMedicalExpenseLocationQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseLocationQuery",getMedicalExpenseRelationshipQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseRelationshipQuery",sendEmailNotificationCotizationPMM:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceCotizarPMM",sendEmailNotificationEmisionPMM:"/asesoria-restful/api/asr/notificationsAndAlertsWS/1_2/customizedEmailNotificationSendingInsuranceEmisionPMM",getMedicalExpenseSportsQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseSportsQuery",getMedicalExpenseProfessionsQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseProfessionsQuery",getMedicalInsuranceFiscalIDNumberQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceFiscalIDNumberQuery",getMedicalExpenseDeductibleQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseDeductibleQuery",getMedicalExpenseCoinsuranceQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseCoinsuranceQuery",getMedicalExpenseDeductibleRedQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseDeductibleRedQuery",getMedicalExpenseMaxCoinsuranceQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseMaxCoinsuranceQuery",getMedicalExpenseInsuranceRequotationQuery:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseInsuranceRequotation",setMedicalExpenseDocsRegistration:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseDocsRegistration",getMedExpInsurancePolicyRegistration:"/asesoria-restful/api/asr/insurance/v1_0/medExpInsurancePolicyRegistration",getInsuranceCountryQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceCountryQuery",getInsuranceBusinessActivityQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceBusinessActivityQuery",getInsuranceIdentificationTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceIdentificationTypeQuery",getMedExpInsuranceQuestRegistration:"/asesoria-restful/api/asr/insurance/v1_0/medExpInsuranceQuestRegistration",getMedExpInsuranceQuestionnaireQuery:"/asesoria-restful/api/asr/insurance/v1_0/medExpInsuranceQuestionnaireQuery",getMedicalExpenseQuestValidation:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseQuestValidation",getInsuranceMaritalStatusQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceMaritalStatusQuery",getInsuranceSumQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceInsuredSumQuery",getCatalogCardTypeQueryLife:"{https://negociosuat.mapfre.com.mx/Zonaliados.Negocio/Api/_AYESalud/Identificacion?ramo=100",getLifeinsuranceNationalityQuery:"https://negociosuat.mapfre.com.mx/Zonaliados.Negocio/Api/_AYESalud/Pais?ramo=100",getLifeInsuranceQuotation:"/asesoria-restful/api/asr/insurance/v1_0/lifeInsuranceQuotation",getLifeInsuranceQuestionnaireQuery:"/asesoria-restful/api/asr/insurance/v1_0/lifeInsuranceQuestionnaireQuery",getinsuranceLifeHighRiskJobValidation:"/asesoria-restful/api/asr/insurance/v1_0/insuranceLifeHighRiskJobValidation",getLifeInsurancePolicyRegistration:"/asesoria-restful/api/asr/insurance/v1_0/lifeInsurancePolicyRegistration",getPoliza:"https://10.184.62.77/impresionSeGA/TWImpPolizaMarco.aspx",getSolicitud:"https://10.184.62.77/impresionSeGA/TWImpSolicitudMarco.aspx",getCondiciones:"https://zonaliados.mapfre.com.mx/zonaaliadosextra/vida/pdf/Plan%20de%20Vida%20Individual.pdf",getInsuranceBeneficiaryTypeQuery:"/asesoria-restful/api/asr/insurance/v1_0/insuranceBeneficiaryTypeQuery",getPolizasVida:"/asesoria-restful/api/asr/polizaVidaServiceController/v1_0/polizaVidaQueryOp",PolizaVidaUp:"/asesoria-restful/api/asr/polizaVidaServiceController/v1_0/polizaVidaUpOp",PolizaVidaAdd:"/asesoria-restful/api/asr/polizaVidaServiceController/v1_0/polizaVidaAddOp",PolizaVidaFindId:"/asesoria-restful/api/asr/polizaVidaServiceController/v1_0/polizaVidaFindIdOp",setMedicalExpenseProcessingRequest:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseProcessingRequest",getMedicalExpenseSignRegistration:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpenseSignRegistration",getMedicalExpensePackageRegistration:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpensePackageRegistration",getMedicalExpensePackageUpdate:"/asesoria-restful/api/asr/insurance/v1_0/medicalExpensePackageUpdate",getLifeInsuranceExpenseJobQuery:"/asesoria-restful/api/asr/insurance/v1_0/lifeInsuranceJobQuery",getLifeInsuranceRelationshipQuery:"/asesoria-restful/api/asr/insurance/v1_0/lifeInsuranceRelationshipQuery"}}angular.module("actinver.constants").constant("URLS",new e)}(),function(){"use strict";function e(){var e={};return e.user={},e.user_permissions={},e}angular.module("actinver.services").service("userConfig",e)}(),function(){"use strict";function e(e,t,n,o){var a={login:function(e){return o.makeRequestLogin(e)},permisos:function(e){return o.makeRequestPermissions(e)},csrf:function(){return o.makeCsrfToken()},logout:function(){return o.makeRequestLogout()}},r={},i=function(e){return!!r.isLoggedIn()&&(!e.permissions||!e.permissions.length||r.userHasPermission(e.permissions))};return r.currentUser=function(){return{user:JSON.parse(e.user),user_permissions:JSON.parse(e.user_permissions)}},r.init=function(){r.isLoggedIn()&&(n.user=r.currentUser().user,n.user_permissions=r.currentUser().user_permissions)},r.csrf=function(){return t(function(e,t){function n(){e(!0)}function o(e){t(e)}a.csrf().then(n).catch(o)})},r.login=function(o,i){return t(function(t,s){function c(){a.login({username:o,password:i}).then(function(o){e.user=JSON.stringify(o.data),n.user=o.data,t(r.permission(o.data.employeeID))}).catch(function(e){s(e)})}r.csrf().then(c).catch()})},r.permission=function(o){return t(function(t,r){a.permisos(o).then(function(o){e.user_permissions=JSON.stringify(o.data),n.user_permissions=o.data,t(o)}).catch(function(e){r(e)})})},r.logout=function(){function e(e){function t(){sessionStorage.clear(),location.assign("/asesoria/login")}function n(e){console.error(e)}a.logout(e).then(t).catch(n)}o.makeCsrfToken().then(e).catch()},r.checkPermissionForView=function(e){return!e.requiresAuthentication||i(e)},r.userHasPermission=function(e){return!!r.isLoggedIn()&&R.find(function(e){return n.user_permissions.componentDTO.indexOf(e)>=0},e)},r.isLoggedIn=function(){return null!==e.user&&void 0!==e.user},r}e.$inject=["$sessionStorage","$q","userConfig","loginSrvc"],angular.module("actinver.services").factory("Auth",e)}(),function(){"use strict";function e(e,t,n,o){return{getInfo:function(a){var r=o().subtract(1,"months"),i=r.format("MM"),s=r.format("YYYY");return n(function(n,o){t({method:"GET",url:e.getBinnacleAdvGoal+a+"/"+i+"/"+s,params:{language:"SPA"}}).then(function(e){if(void 0!==e&&1===e.data.status){var t=e.data.result;t.data=[t.clientsContacted,t.clientsToReach-t.clientsContacted],t.percentage=parseInt(t.totalPercentage)+"%",t.colors=["#7ed321","#517cbd"],n({success:!0,data:t,finish:!0})}else o({success:!1,finish:!0})},function(){o({success:!1,finish:!0})})})},showInfo:function(e,t){return{chart:t?e.result:e.data,finish:!0,success:e.success}}}}e.$inject=["URLS","$http","$q","moment"],angular.module("actinver.services").factory("binnacleInfo",e)}(),function(){"use strict";function e(){var e={};return e.infoStrategyCommercial=null,e.saveState=function(t){e.infoStrategyCommercial=t},e}angular.module("actinver.services").factory("binnacleStrategyCommercialFtr",e)}(),function(){"use strict";function e(){function e(e){var t="";return angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),t}return{createError:e}}angular.module("actinver.services").factory("ErrorMessage",e)}(),function(){"use strict";function e(e,t,n){var o,a=!1,r=function(){window.location="/asesoria/login"};return{request:function(e){return o=e.exclude,e},responseError:function(i){if(o)return e.reject(i);var s=t.get("CommonModalsSrv");return n.complete(),401===i.status?s.info("Su sesión ha terminado.").result.then(function(){a=!1,r()}):200===i.status&&404===i.status&&401===i.status||a||(a=!0,s.systemError().result.then(function(){},function(){a=!1})),e.reject(i)}}}e.$inject=["$q","$injector","cfpLoadingBar"],angular.module("actinver.services").factory("interceptor404",e)}(),function(){"use strict";function e(e,t,n){function o(e){return n.complete(),"POST"!==e.method&&"PUT"!==e.method&&"DELETE"!==e.method||e.url.indexOf("authentication/token")>0||e.url.indexOf("logout")>0?(e.headers.Authorization="bearer "+sessionStorage.getItem("__token")||"",e.headers["X-CSRF-TOKEN"]=sessionStorage.getItem("__csrf")||"",e):a().then(function(t){return e.headers["X-CSRF-TOKEN"]=t.csrf,e.headers.Authorization="bearer "+sessionStorage.getItem("__token")||"",e.headers["Content-Type"]=e.headers&&angular.isDefined(e.headers.ocupateMyHeader)&&e.headers.ocupateMyHeader?e.headers["Content-Type"]:"application/x-www-form-urlencoded; charset=UTF-8",e})}function a(){return n.complete(),t.get("$http")({method:"GET",url:r+i+"/api/asesoria/validate"}).then(function(e){return{csrf:e.headers("X-CSRF-TOKEN")}}).catch(function(e){console.log("Error",e)})}var r=window.location.port?window.location.protocol+"//"+window.location.hostname+":"+window.location.port:window.location.protocol+"//"+window.location.hostname,i="/asesoria-restful";return{request:o}}e.$inject=["$q","$injector","cfpLoadingBar"],angular.module("actinver.services").factory("interceptorToken",e)}(),function(){"use strict";function e(e){var t=function(t){return e.btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))},n=function(e,t){return e.replace(/{(\w+)}/g,function(e,n){return t[n]})};return{tableToExcel:function(e,o){var a=$(e),r={worksheet:o,table:a.html()};return"data:application/vnd.ms-excel;base64,"+t(n('<html  xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">  <head> <META http-equiv="Content-Type" content="text/html; charset=utf-8"> \x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',r))}}}e.$inject=["$window"],angular.module("actinver.services").factory("exportTableToExcel",e)}(),function(){"use strict";function e(e,t,n){var o={},a=this;return o={getResource:function(t){return e(t,{},{query:{exclude:a.exclude,method:"GET",ignoreLoadingBar:!0}})},tableSet:function(e,r,i){var s,c,u={count:7},l={counts:[]};return e.url||e.dataset?(e.url.includes("consultarContratosPerfilVencer")?a.exclude=!0:e.url.includes("consultarContratosPerfilVencido")?a.exclude=!0:a.exclude=!1,e.url?l.getData=function(a){return o.getResource(e.url).query({language:"SPA"}).$promise.then(function(e){if(e.result||e.contratosVencimientoTO){var t,o=e.result||e.contratosVencimientoTO,r=n("limitTo")(o,20);e.data=r,t=a.sorting()?n("orderBy")(e.data,a.orderBy()):e.data,a.total(t.length),e.data=t.slice((a.page()-1)*a.count(),a.page()*a.count())}else a.total(e.total);return e.data.constructor!==Array&&(e.data=[e.data]),0===a.total()?{loading:!1,validate:"no-results"}:e.data}).catch(function(e){return t.warn("Resource was not found",e),{loading:!1,validate:"error"}})}:l.dataset=e.dataset,s=angular.merge({},u,r),c=angular.merge({},l,i),{loading:!0,initialParams:s,initialSettings:c}):(t.warn("You need to set a valid data resource"),!1)}}}e.$inject=["$resource","$log","$filter"],angular.module("actinver.services").factory("tableList",e)}(),function(){"use strict";function e(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}}angular.module("actinver.filters").filter("capitalize",e)}(),function(){"use strict";function e(){return function(e,t){if(null!==e&&!isNaN(e)){var n=e.toString(),o=n.indexOf(".");return-1===o?n:0===t?n.substr(0,o):n.substr(0,o+(t||2)+1)}return null}}angular.module("actinver.filters").filter("currencyCustom",e)}(),function(){"use strict";function e(){return function(e,t){return e?e.reduce(function(e,n){return(e[n[t]]=e[n[t]]||[]).push(n),e},{}):[]}}angular.module("actinver.filters").filter("groupJSON",e)}(),function(){"use strict";function e(e){return function(t,n,o){return n=angular.isNumber(n)?n:3,o=o||"%",e.isNaN(t)?"":Math.round(t*Math.pow(10,n+2))/Math.pow(10,n)+o}}e.$inject=["$window"],angular.module("percentage",[]).filter("percentage",e)}(),function(){"use strict";function e(){return function(e,t){t=parseInt(t);for(var n=0;n<t;n++)e.push(n);return e}}angular.module("actinver.filters").filter("range",e)}(),function(){"use strict";function e(){return function(e){return function(e){var t=parseInt(e/60),n=e-60*t;return(t<10?"0"+t:t)+":"+(n<10?"0"+n:n)}(e)}}angular.module("actinver.filters").filter("remainingTime",e)}(),function(){"use strict";function e(e){return function(t,n){var o=angular.isString(t)?t:t&&null!==t?t.toString():"";return n&&(o=o.replace(new RegExp("("+n+")","gi"),'<span class="search-find">$1</span>')),e.trustAsHtml(o)}}e.$inject=["$sce"],angular.module("actinver.filters").filter("remarkText",e)}(),function(){"use strict";function e(){return function(e){return e?e.substring(6,8)+"/"+e.substring(4,6)+"/"+e.substring(0,4):""}}angular.module("actinver.filters").filter("showAsDate",e)}(),function(){"use strict";function e(){return function(e,t,n){return e?e.split(t)[n]:""}}angular.module("actinver.filters").filter("split",e)}(),function(){"use strict";function e(){return function(e,t){var n=0;return e.forEach(function(e){n+=parseFloat(e[t])}),n}}angular.module("actinver.filters").filter("sumByColumn",e)}(),function(){"use strict";function e(){return function(e,t){var n=0;return e.forEach(function(e){n+=parseFloat(e[t].valuation)}),n}}angular.module("actinver.filters").filter("sumByColumnProp",e)}(),function(){"use strict";function e(e){var t={};return t.detail=function(t){return e.open({templateUrl:"/scripts/modals/views/investment/account-contract.html",controller:"accountContractCtrl",controllerAs:"accountContract",resolve:{info:function(){return t}}})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("accountContractModalSrv",e)}(),function(){"use strict";function e(e){var t={};return t.detail=function(t){return e.open({templateUrl:"/scripts/modals/views/investment/account-name.html",controller:"accountNameCtrl",controllerAs:"accountName",resolve:{info:function(){return t}}})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("accountModalSrv",e)}(),function(){"use strict";function e(e){var t={};return t.addActivity=function(t,n){return e.open({templateUrl:"/scripts/modals/views/activity/add.html",controller:"addActivityCtrl",controllerAs:"activity",resolve:{title:function(){return t||"Actividad"},item:function(){return n}}})},t.notice=function(t){return e.open({templateUrl:"/scripts/modals/views/activity/notice.html",controller:"noticeActivityCtrl",controllerAs:"activity",resolve:{item:function(){return t}}})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("modalActivity",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(a,i){return n(function(n,i){function s(){var o,s,c,u="";2===a.strategy.idStrategy?(o=8,u="Se inicia como prospecto",s=a.clientNumber,c=""):(o=7,u="Se inicia como posibilidad",s=0,c=a.segment?a.segment.segment:"");var d={nameOpportunity:a.clientName,idStrategy:a.strategy.idStrategy,phone:a.phone,mail:a.email,idStage:o,segment:c,comment:u,idEmployee:l.employeeID,clientNumber:s,language:"SPA"};t({method:"POST",url:e.saveOpportunity,data:$.param(d)}).then(function(e){n(1===e.data.status?{success:!0,data:e.data.messages[0].description}:{success:!1,data:e.data.messages[0].description})}).catch(function(e){r("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),i({error:e.data})})}function c(e){i(e)}o.csrfValidate().then(s).catch(c)})}function c(){return n(function(n,o){t({method:"GET",url:e.getStrategy,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?n({success:!0,data:e.data.result}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})}function u(){return n(function(n,o){t({method:"GET",url:e.getSegment,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?n({success:!0,data:e.data.result}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})}var l=JSON.parse(i.user);return{setOpportunity:s,getStrategy:c,getSegment:u}}e.$inject=["URLS","$http","$q","csrfSrv","$filter","ErrorMessagesSrv","$sessionStorage"],angular.module("actinver.services").service("addProspectSrv",e)}(),function(){"use strict";function e(e,t){var n={};return n.admonFactsheet=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-factsheet.html",size:"md",windowClass:"administrator",controller:"admonFactsheetModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},factsheet:function(){return n}}}).result},n.admonGroup=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-group.html",size:"sm",windowClass:"administrator",controller:"admonGroupModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},group:function(){return n}}}).result},n.admonPresentations=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-presentations.html",size:"lg",windowClass:"administrator",controller:"admonPresentationsModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},presentations:function(){return n}}}).result},n.admonInvestment=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-investment.html",windowClass:"administrator investment",controller:"admonInvestmentModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},investment:function(){return n}}}).result},n.admonFavorites=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-favorites.html",windowClass:"administrator",controller:"admonFavoriteModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},favorite:function(){return n}}}).result},n.admonEmployee=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-employee.html",windowClass:"administrator",controller:"admonEmployeeModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},employee:function(){return n}}}).result},n.admonProfiles=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-profiles.html",windowClass:"administrator",controller:"admonProfilesModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},profile:function(){return n}}}).result},n.admonMessages=function(e,n){return t.open({templateUrl:"/scripts/modals/views/administrator/admon-messages.html",windowClass:"administrator",controller:"admonProfilesModalCtrl",controllerAs:"ctrl",resolve:{title:function(){return e},profile:function(){return n}}}).result},n}e.$inject=["$q","$uibModal"],angular.module("actinver.services").service("administratorModalsSrv",e)}(),function(){"use strict";function e(e){var t={};return t.showClientInfo=function(t){return e.open({templateUrl:"/scripts/modals/views/binnacle/client-info.html",controller:"clientInfoModalCtrl",controllerAs:"client",backdrop:"static",resolve:{clientInfo:function(){return{info:t}}}}).result.finally(angular.noop).then(angular.noop,angular.noop)},t.outlineClient=function(t,n,o,a,r,i,s){return e.open({templateUrl:"/scripts/modals/views/binnacle/outline-client.html",controller:"outlineClientModalCtrl",controllerAs:"outline",windowClass:"outline-client-lb",resolve:{outlineItemDetails:function(){return{employee:t,contrato:n,tipoOrigen:o,typeServicio:a,tipoPersona:r,typeoperation:i,investmentProfile:s}}}}).result.finally(angular.noop).then(angular.noop,angular.noop)},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("binnacleModalSrv",e)}(),function(){"use strict";function e(e){var t={};return t.warning=function(t){return e.open({templateUrl:"/scripts/modals/views/commons/warning.html",size:"sm",windowClass:"commons warning",controller:"warningModalCtrl",controllerAs:"warning",resolve:{message:function(){return t}}})},t.confirm=function(t){return e.open({templateUrl:"/scripts/modals/views/commons/confirm.html",size:"sm",windowClass:"commons confirm",controller:"warningModalCtrl",controllerAs:"warning",resolve:{message:function(){return t}}})},t.done=function(t){return e.open({templateUrl:"/scripts/modals/views/commons/done.html",size:"sm",windowClass:"commons done",controller:"doneModalCtrl",backdrop:"static",keyboard:!1,controllerAs:"done",resolve:{message:function(){return t}}})},t.info=function(t){return e.open({templateUrl:"/scripts/modals/views/commons/info.html",size:"sm",windowClass:"commons info",controller:"doneModalCtrl",backdrop:"static",keyboard:!1,controllerAs:"done",resolve:{message:function(){return t}}})},t.error=function(t){return e.open({templateUrl:"/scripts/modals/views/commons/error.html",size:"sm",windowClass:"commons error",controller:"errorModalCtrl",controllerAs:"error",resolve:{message:function(){return t}}}).result.catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},t.systemError=function(t){return e.open({templateUrl:"/scripts/modals/views/commons/system-error.html",size:"sm",windowClass:"commons errorSystem",controller:"errorSystemModalCtrl",controllerAs:"error",resolve:{message:function(){return t}}}).result.catch(function(e){if("cancel"!==e&&"escape key press"!==e)throw e})},t.user={},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("CommonModalsSrv",e)}(),function(){"use strict";function e(e){var t={};return t.information=function(){return e.open({templateUrl:"/scripts/modals/views/contract-out-profile/contract-out-profile.html",windowClass:"center-modal modal-center-contract-out-profile error",controller:"outProfile",controllerAs:"outProfile"}).result.catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("outProfileSrv",e)}(),function(){"use strict";function e(e){var t={};return t.information=function(t,n){return e.open({templateUrl:"/scripts/modals/views/money-market/directs-bands.html",windowClass:"center-modal-bands-direct modal-center-contract-out-profile info",controller:"directsBandsMdlCtrl",controllerAs:"directsBandsMdlCtrl",backdrop:"static",keyboard:!1,resolve:{data:function(){return t},fn:function(){return n}}})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("directsBandsSrv",e)}(),function(){"use strict";function e(e){var t={};return t.showCenterDetail=function(t,n,o,a){return e.open({templateUrl:"/scripts/modals/views/goals/center-detail.html",controller:"centerDetailModalCtrl",controllerAs:"center",resolve:{centerInfo:function(){return{type:t,employee:n,center:o,date:a}}}}).result.finally(angular.noop).then(angular.noop,angular.noop)},t.showAdviserDetail=function(t,n,o){return e.open({templateUrl:"/scripts/modals/views/goals/adviser-detail.html",controller:"adviserDetailModalCtrl",controllerAs:"adviser",resolve:{adviserInfo:function(){return{adviserID:t,name:n,date:o}}}}).result.finally(angular.noop).then(angular.noop,angular.noop)},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("goalsModalSrv",e)}(),function(){"use strict";function e(e,t){var n={};return n.moreInfo=function(t){return e.open({templateUrl:"/scripts/modals/views/investment/detail.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"transfer-detail",resolve:{info:function(){return t}}})},n.moreInfoMarketOrder=function(t,n){return e.open({templateUrl:"/scripts/modals/views/investment/detailMarket.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"transfer-detail",resolve:{info:function(){return t.order=n,t}}})},n.moreInfoStations=function(t,n){return e.open({templateUrl:"/scripts/modals/views/investment/detail-stations.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"table-detail",resolve:{info:function(){return t.station=n,t}}})},n.moreInfoStationsBank=function(t){return e.open({templateUrl:"/scripts/modals/views/investment/detail-stations.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"table-detail",resolve:{info:function(){return t}}})},n.moreInfoMarket=function(n){return n.url=t.trustAsResourceUrl("https://bursanet.actinver.com/static/ficha-valor/#/index?emisora="+n.issuer.issuerName+"&serie="+n.issuer.serie),e.open({templateUrl:"/scripts/directives/table-stations-sockets/fichaValor.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"table-detail",resolve:{info:function(){return n}}})},n.moreInfoTitles=function(t){return e.open({templateUrl:"/scripts/directives/table-portfolio-investment/info-titles.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"table-detail",resolve:{info:function(){return t}}})},n.moreInfoFundsBank=function(t){return e.open({templateUrl:"/scripts/modals/views/investment/detail-funds-bank.html",controller:"invModalCtrl",controllerAs:"inv",windowClass:"table-detail",resolve:{info:function(){return t}}})},n.reportoConfirmLetter=function(t,n,o){return e.open({templateUrl:"/scripts/modals/views/money-market/reporto-letter.html",size:"sm",windowClass:"commons confirm",controller:"reportoLetterModalCtrl",controllerAs:"reportoLtr",resolve:{operation:function(){return t},operDate:function(){return n},holder:function(){return o},mailConfirm:function(){return!1}}})},n}e.$inject=["$uibModal","$sce"],angular.module("actinver.services").service("investmentModalSrv",e)}(),function(){"use strict";function e(e){var t={};return t.information=function(t){return e.open({templateUrl:"/scripts/modals/views/notification/lumina.html",windowClass:"lumina modal-center-lumina done",controller:"luminaModalCtrl",controllerAs:"lumina",resolve:{data:function(){return t}}}).result.catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("LuminaModalsSrv",e)}(),function(){"use strict";function e(e){var t={};return t.showNews=function(t){return e.open({templateUrl:"/scripts/modals/views/news/news.html",windowClass:"modal-center-news info",controller:"newsModalCtrl",controllerAs:"news",resolve:{data:function(){return t}}}).result.catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("newsModalSrv",e)}(),function(){"use strict";function e(){var e={};return $.notify.addStyle("error",{html:"<div> <span data-notify-text/> </div>",classes:{base:{"background-color":"white",padding:"5px",border:"2px solid #FA596D","border-radius":"5px","max-width":"300px"},superblue:{color:"white","background-color":"blue"}}}),$.notify.addStyle("warning",{html:"<div> <span data-notify-text/> </div>",classes:{base:{"background-color":"white",padding:"5px",border:"2px solid #ffba3a","border-radius":"5px","max-width":"300px"},superblue:{color:"white","background-color":"blue"}}}),$.notify.addStyle("done",{html:"<div> <span data-notify-text/> </div>",classes:{base:{"background-color":"white",padding:"5px",border:"2px solid #00be66","border-radius":"5px","max-width":"300px"},superblue:{color:"white","background-color":"blue"}}}),$.notify.addStyle("info",{html:"<div> <span data-notify-text/> </div>",classes:{base:{"background-color":"white",padding:"5px",border:"2px solid #337ab7","border-radius":"5px","max-width":"300px"},superblue:{color:"white","background-color":"blue"}}}),e.warning=function(e,t){t=t||{},t.style="warning",$.notify(e,t)},e.done=function(e,t){t=t||{},t.style="done",$.notify(e,t)},e.info=function(e,t){t=t||{},t.style="info",$.notify(e,t)},e.error=function(e,t){t=t||{},t.style="error",$.notify(e,t)},e}angular.module("actinver.services").service("popupsSrv",e)}(),function(){"use strict";function e(e){var t={};return t.addOpportunity=function(t,n){return e.open({templateUrl:"/scripts/modals/views/prospects/add.html",controller:"prospectsModalCtrl",controllerAs:"add",size:"lg",resolve:{msg:function(){return t},IDOpportunity:function(){return n}}})},t.addActivity=function(t,n){return e.open({templateUrl:"/scripts/modals/views/prospects/activity.html",size:"lg",controller:"addActivityProsModalCtrl",controllerAs:"activity",resolve:{activity:function(){return n},title:function(){return t}}})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("prospectModalsSrv",e)}(),function(){"use strict";function e(e,t,n){var o={};return o.accept=function(t){return e.open({templateUrl:"/scripts/modals/views/transfers/confirm.html",controller:"transferModalCtrl",controllerAs:"transfer",backdrop:"static",keyboard:!1,windowClass:"confirm-transfer",resolve:{info:function(){return t}}})},o.detail=function(o,a){return e.open({templateUrl:"/scripts/modals/views/transfers/detail.html",controller:"detailModalCtrl",controllerAs:"detail",windowClass:"transfer-detail",resolve:{info:function(){return t({method:"GET",url:n.getOrderDetail+"/"+o+"/"+a+"?language=SPA"})}}})},o.detailTransfer=function(t){var n=[];return n.push(t),e.open({templateUrl:"/scripts/modals/views/transfers/detail.html",controller:"detailModalCtrl",controllerAs:"detail",
windowClass:"transfer-detail",resolve:{info:function(){return n}}})},o.detailTransferSPEI=function(t){return e.open({templateUrl:"/scripts/modals/views/transfers/detailSPEI.html",controller:"detailModalCtrl",controllerAs:"detail",windowClass:"transfer-detail-SPEI",resolve:{info:function(){return t}}})},o}e.$inject=["$uibModal","$http","URLS"],angular.module("actinver.services").service("transferModalSrv",e)}(),function(){"use strict";function e(e,t){e.state("app",{abstract:!0,templateUrl:"/app/app.html",controller:"mainCtrl",resolve:{autenticacion:["Auth",function(e){var t=e.currentUser(),n=t.user.employeeID;return e.permission(n).then(function(){e.init()})}]}}),t.otherwise("/dashboard")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n){var o={};return o.getAdvisersBinnacleMessage=function(o){var a=t.defer(),r=a.promise;return e.get(n.getAdvisersBinnacleMessage+o+"?language=SPA").then(function(e){1===e.data.status&&a.resolve(e.data.result),a.reject(e.data.messages)},function(e){a.reject(e)}),r},o.getAdvisersBinnacleBinnacle=function(o,a,r){return t(function(){function t(e,t){if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(e,t);else{var n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.click(),window.URL.revokeObjectURL(n.href)}}e({method:"GET",url:n.getAdvisersBinnacleBinnacle+o+"/"+a+"/"+r,responseType:"arraybuffer",params:{language:"SPA"}}).then(function(e){t(new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"Bitacora"+a+"-"+r+".xlsx")})})},o}e.$inject=["$http","$q","URLS"],angular.module("actinver.services").service("administratorSrv",e)}(),function(){"use strict";function e(e){function t(e,t,n){if(e||n)return!0}function n(t,n,o){return t?(n.instructionDate=e(new Date).format("DDMMYYYY"),n.instructionTime="00:00:01",n.extensionNumber="0001",n.tracingKey="2",n.comments="Sin comentarios",n.instructionTimeNumber="0001",n.requestType="2",n.requestHour_RD="00:00:01",n.requestType_RD="2",n.extensionNumber_RD="0001",n.userName="NO APLICA",n.instructionTimeNumber="0001"):(n.instructionDate=e(o.binnacle.date).format("DDMMYYYY"),n.instructionTime="TELEFONO"===o.media.type.text?o.binnacle.time+":00":"00:00:01",n.extensionNumber="TELEFONO"===o.media.type.text?o.binnacle.phone:"0001",n.tracingKey=o.media.type.id,n.comments=o.binnacle.comments?o.binnacle.comments:"Sin comentarios",n.instructionTimeNumber="TELEFONO"===o.media.type.text?o.binnacle.time+":00":"00:00:01",n.requestType=o.media.type.id,n.requestHour_RD=o.binnacle.time?o.binnacle.time+":00":"00:00:01",n.requestType_RD=o.media.type.identifier,n.extensionNumber_RD=o.binnacle.phoneNumber?o.binnacle.phoneNumber:"0001",n.userName=o.binnacle.usserName?o.binnacle.usserName:"NO APLICA",n.instructionTimeNumber="0001"),n}return{contractType:t,sendBinnacle:n}}e.$inject=["moment"],angular.module("actinver.services").service("contractTypeSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){return t(function(t,n){function o(e){sessionStorage.setItem("__csrf",e.headers("X-CSRF-TOKEN")),t({success:!0})}function a(e){n({success:!1,data:{},error:e,message:"Ha ocurrido un error de seguridad"})}e.head(location.href).then(o).catch(a)})}function a(){return t(function(t,o){function a(e){sessionStorage.setItem("__csrf",e.headers("X-CSRF-TOKEN")),t({success:!0})}function r(e){o({success:!1,data:{},error:e,message:"Ha ocurrido un error de seguridad"})}e.get(n.csrfRest).then(a).catch(r)})}return{csrfHead:o,csrfValidate:a}}e.$inject=["$http","$q","URLS"],angular.module("actinver.services").service("csrfSrv",e)}(),function(){"use strict";function e(e){function t(t){var n=R.find(function(e){if("N"===e.responseType)return"FATAL"===e.responseCategory||"ERROR"===e.responseCategory})(t),o=n?n.responseMessage:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk";e.error(o)}return t}e.$inject=["CommonModalsSrv"],angular.module("actinver.services").service("ErrorMessagesSrv",e)}(),function(){"use strict";function e(e,t,n,o){var a=this;a.makeCsrfToken=function(){return t(function(t,n){function o(e){var n=e.headers("X-CSRF-TOKEN");sessionStorage.setItem("__csrf",e.headers("X-CSRF-TOKEN")),t({success:!0,data:n,message:"Operación realizada con éxito"})}function a(){n({success:!1,data:{},message:"Ha ocurrido un error de seguridad"})}var r=location.href;e.head(r).then(o).catch(a)})},a.makeRequestLogout=function(){return t(function(t,o){e({method:"POST",url:n.logout,headers:{"X-HTTP-Method-Override":"POST","Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){void 0!==e.data?t({success:!0,data:{},message:"Operación realizada con éxito"}):o({success:!1,data:{},message:"El usuario o contraseña que ingresaste es incorrecto, te pedimos volver a intentar."})},function(e){o({success:!1,data:e,message:"Falla en el servidor."})})})},a.makeDataUser=function(){return t(function(t,o){function a(e){t({success:!0,user:e.data})}function r(e){o({success:!1,error:e,messagge:"Ha ocurrido un error"})}e({method:"GET",url:n.userInfo,headers:{Authorization:"bearer "+sessionStorage.getItem("__token")},ignoreLoadingBar:!0}).then(a).catch(r)})},a.makeRequestLogin=function(o){return t(function(t,r){e({method:"POST",url:n.login,data:$.param(o),headers:{"X-CSRF-TOKEN":sessionStorage.getItem("__csrf"),"X-HTTP-Method-Override":"POST","Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){void 0!==e.data&&""!==e.data.access_token?(sessionStorage.setItem("__token",e.data.access_token),a.makeDataUser().then(function(e){angular.forEach(e.user.scope,function(n){if("INCOMPLETE"===n)r({success:!1,data:{},error:"error",message:"El usuario no está registrado en LDAP. Favor de comunicarse al CAT"});else{var a={name:e.user.firstName+" "+e.user.lastName,mail:e.user.clientId+"@actinver.com.mx",employeeID:"-2147483648",userName:o.username,roles:e.user.scope,enviroment:e.user.systemTO.profile};t({success:!0,data:a,message:"Operación realizada con éxito"})}})}).catch(function(e){r({success:!1,data:{},error:e,message:"Ha ocurrido un error al obtener los datos de usuario"})})):r({success:!1,data:{},message:"El usuario o contraseña que ingresaste es incorrecto, te pedimos volver a intentar."})},function(e){r({success:!1,data:e,message:e.data.error_description})})})},a.makeRequestPermissions=function(a){return t(function(t,r){e({method:"GET",url:n.getPermiso+"/"+parseInt(a)+"?language=SPA",headers:{"X-CSRF-TOKEN":sessionStorage.getItem("__csrf"),Authorization:"bearer "+sessionStorage.getItem("__token")},ignoreLoadingBar:!0}).then(function(e){void 0!==e.data&&1===e.data.status?t({success:!0,data:JSON.parse(e.data.result.restrictionsString),message:"Operación realizada con éxito"}):r({success:!1,data:{},message:"No se pudo obetener información del usuario consultado, intente más tarde"})},function(e){window.location.href="/asesoria/login.html",o.systemError(),r({success:!1,data:e,message:"Falla en el servidor."})})})},a.validateUserTokens=function(){return t(function(t,o){e({method:"GET",url:n.validateUserTokens+"?language=SPA",headers:{Authorization:"bearer "+sessionStorage.getItem("__token")}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,msg:e.data.outCommonHeader.result.messages[0].responseMessage}):o({success:!1,msg:e.data.outCommonHeader.result.messages[0].responseMessage})}).catch(function(){o({success:!1,msg:"Ha ocurrido un error"})})})},a.saveAdviserNumber=function(o,a){return t(function(t,r){e({method:"POST",url:n.saveAdviserNumber,data:$.param({adviserNumber:a,adviserType:o,language:"SPA"}),headers:{"X-HTTP-Method-Override":"POST","Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){void 0!==e.data&&1===e.data.outCommonHeader.result.result?t({success:!0,data:{},message:e.data.outCommonHeader.result.messages[0].responseMessage}):r({success:!1,data:{},message:e.data.outCommonHeader.result.messages[0].responseMessage})},function(e){r({success:!1,data:e,message:"Ha ocurrido un error !!"})})})}}e.$inject=["$http","$q","URLS","CommonModalsSrv"],angular.module("actinver.services").service("loginSrvc",e)}(),function(){"use strict";function e(e,t,n,o,a,r){var i={};return i.getActivityOffice=function(a){var i,s=t.defer(),c=s.promise,u=n("date")(a,"MM/yyyy");return r.makeDataUser().then(function(t){for(var n=0;n<t.user.scope.length;n++){var a=t.user.scope[n];"ASESOR"===a?i=o.getActivityRecord:"ADMINISTRADOR"===a&&(i=o.getActivityRecordAdm)}e.get(i+"/getReport/"+u+"/6?language=SPA").then(function(e){1===e.data.status&&s.resolve(e.data.result),s.reject(e.data.messages)},function(e){s.reject(e)})}),c},i.validateAdviserContract=function(t,n){return e.get(o.getAdviserContract+t+"/"+n+"?language=SPA").then(function(e){return void 0!==e&&1===e.data.response.status?e&&e.data:null})},i.getContractIdClient=function(t){var n=null;return"contract"===t.type?"Casa"===t.optionTypeContract.text?n="?bankingArea=998&clientNumber=&contractNumber="+t.field+"&descripcion="+t.field+"&language=SPA&titularFlag=true&typeQuery=2":"Banco"===t.optionTypeContract.text&&(n="?bankingArea=999&clientNumber=&contractNumber="+t.field+"&descripcion="+t.field+"&language=SPA&titularFlag=true&typeQuery=2"):n="?bankingArea=&clientNumber="+t.field+"&contractNumber=&descripcion="+t.field+"&language=SPA&titularFlag=true&typeQuery=1",e.get(o.getClientInfo+n).then(function(e){return void 0!==e&&1===e.data.outCommonHeader.result.result?e&&e.data:e.data})},i.getTracingClientByClient=function(t){return e.get(o.getContracts+"?bankingArea=&clientID="+t+"&language=SPA").then(function(e){return void 0!==e&&1===e.data.outCommonHeader.result.result?e&&e.data.outContractsBalancesByPortfolioQuery.contractInformation:null})},i.getContractSummary=function(t,n){return e.get(o.getContractSummary+n+"/"+t+"?language=SPA").then(function(e){return void 0!==e&&1===e.data.status?e&&e.data.result:null})},i.getDetailedSummaryContract=function(n,r){return t(function(t,i){function s(){e({method:"POST",url:o.getDetailedSummary,params:{language:"SPA",contracts:window.btoa(JSON.stringify([{contract:n,source:r}])),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}}).then(function(e){t(1===e.data.status?{contractNumber:n,result:e.data.result}:null)})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},i.getPositionTypeBankAndHouse=function(e,n){var o=t.defer(),a=o.promise,r=i.getPosition(e),s=i.getPositionTypeBank(n);return Promise.all([r,s]).then(function(e){o.resolve(e[0].concat(e[1]))}).catch(function(){o.resolve([])}),a},i.getPosition=function(n){var a=t.defer(),r=a.promise;return e.get(o.getTracingClient+"/Contract/getBrokerHousePositionList/"+n.join(",")+"?language=SPA").then(function(e){a.resolve(e.data.result)},function(){a.resolve([])}),r},i.getPositionTypeBank=function(e){var n=t.defer(),o=n.promise,a=i.getBankPosition(e),r=i.getBankWarrantyPositionList(e);return Promise.all([a,r]).then(function(e){var t=e[0].concat(e[1]);t.forEach(function(e){e.lastPrice=e.price}),n.resolve(t)}).catch(function(){n.resolve([])}),o},i.getBankPosition=function(n){var a=t.defer(),r=a.promise;return e.get(o.getBankPositionList+n.join(",")+"?language=SPA").then(function(e){1===e.data.status?a.resolve(e.data.result):a.resolve([])}).catch(function(){a.resolve([])}),r},i.getBankWarrantyPositionList=function(n){var a=t.defer(),r=a.promise;return e.get(o.getBankWarrantyPositionList+n.join(",")+"?language=SPA").then(function(e){1===e.data.status?a.resolve(e.data.result):a.resolve([])}).catch(function(){a.resolve([])}),r},i.getDetailedCustomerTrackingReport=function(n){return t(function(t,r){function i(){e({method:"POST",url:o.getDetailedCustomerTrackingReport,data:$.param(n),responseType:"arraybuffer"}).then(function(e){t(e)}).catch(function(e){r(e)})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},i.getCustomerTrackingReport=function(n){return t(function(t,r){function i(){e({method:"POST",url:o.getCustomerTrackingReport,data:$.param(n),responseType:"arraybuffer"}).then(function(e){t(e)}).catch(function(e){r(e)})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},i}e.$inject=["$http","$q","$filter","URLS","csrfSrv","loginSrvc"],angular.module("actinver.services").service("proposalSrv",e)}(),function(){"use strict";function e(){function e(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<5;n++){for(var o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*t.length));e+=4===n?"":"-"}return e}this.getNameFile=function(){var t=[],n="";try{t=new Uint16Array(5);var o=window.crypto.getRandomValues(t);n=o.join("-")}catch(t){n=e()}return n}}angular.module("actinver.services").service("randomNamesSrv",e)}(),function(){"use strict";function e(){this.principal=function(){function e(e){importScripts(e),function(){t()}()}function t(){i++;var e=new SockJS(s.url);c.client=Stomp.over(e),c.client.debug=null,c.client.connect({},o,n)}function n(){s.throwSocket&&i<4&&setTimeout(work.wsConnect,3e3)}function o(){a(s.emisoras).forEach(function(e){c.client.subscribe("/topic/capitales/bmvAll/"+e,function(e){r(JSON.parse(e.body))})})}function a(e){var t=[];return e&&e.forEach(function(e){t.indexOf(e.issuer.issuerSerie)<0&&t.push(e.issuer.issuerSerie)}),t}function r(e){var t=s.emisoras.findIndex(function(t){return t.issuer.issuerSerie===e.issuer.issuerSerie&&t.feed===e.feed});if(t>=0){var n=JSON.parse(JSON.stringify(s.emisoras[t]));s.emisoras[t].averagePrice=e.averagePrice,s.emisoras[t].minPrice=e.minPrice,s.emisoras[t].maxPrice=e.maxPrice,s.emisoras[t].tradeDateTime=e.tradeDateTime,s.emisoras[t].tradeSell=e.tradeSell,s.emisoras[t].tradeSellPrice=e.tradeSellPrice,s.emisoras[t].tradeBuyPrice=e.tradeBuyPrice,s.emisoras[t].tradeBuy=e.tradeBuy,s.emisoras[t].lastPrice=e.lastPrice,s.emisoras[t].priceVar=e.priceVar,(n.lastPrice>e.lastPrice||n.lastPrice<e.lastPrice)&&postMessage({last:n.lastPrice,nuevo:e.lastPrice,id:s.emisoras[t].idIssuerSerie+"lastPrice",lastRecord:n,newRecord:e,indice:t}),(n.tradeBuyPrice>e.tradeBuyPrice||n.tradeBuyPrice<e.tradeBuyPrice)&&postMessage({last:n.tradeBuyPrice,nuevo:e.tradeBuyPrice,id:s.emisoras[t].idIssuerSerie+"tradeBuyPrice",lastRecord:n,newRecord:e,indice:t}),(n.tradeSellPrice>e.tradeSellPrice||n.tradeSellPrice<e.tradeSellPrice)&&postMessage({last:n.tradeSellPrice,nuevo:e.tradeSellPrice,id:s.emisoras[t].idIssuerSerie+"tradeSellPrice",lastRecord:n,newRecord:e,indice:t})}}var i=0,s=null,c={client:null};onmessage=function(t){switch(t.data.step){case 1:s=t.data.config,e(s.urlResource+"/bower/worker.js");break;case 2:null!==c.client&&c.client.disconnect(),console.log("disconnect socket CAPITALS")}}}}angular.module("actinver.services").service("workerConfigSrv",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.sclient=t.sclient?t.sclient:{},o.showSystemError=n.systemError,o.getSelectedClient=function(t,n){localStorage.setItem("contractSelected",JSON.stringify(n)),void 0!==o.sclient.data&&(o.show_instructions=!1,e.go(t))}}e.$inject=["$state","$sessionStorage","CommonModalsSrv"],angular.module("actinver.controllers").controller("operationCtrl",e)}(),function(){"use strict";function e(e){e.state("operations",{templateUrl:"/app/operations/operation.html",parent:"app",controller:"operationCtrl",controllerAs:"operations",redirectTo:"account",url:"/operations",ncyBreadcrumb:{label:"Operaciones",parent:"app.dashboard"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(e,t){return o("limitTo")(e,t)}var u=this;u.title=t,u.temporaryDate="",u.temporaryTime="",u.temporaryAssistants="",u.multipleEmailRegex=/^[\W]*([\w+\-.%]+@[\w\-.]+\.[A-Za-z]{2,4}[\W]*;{1}[\W]*)*([\w+\-.%]+@[\w\-.]+\.[A-Za-z]{2,4})[\W]*$/,u.newActivity={},u.close=function(){e.dismiss()},u.done=function(){e.close()},u.submitActivity=function(){""!==u.temporaryDate?u.newActivity.date=o("date")(u.temporaryDate._d,"yyyy-MM-dd"):u.newActivity.date=o("date")(new Date,"yyyy-MM-dd");var e=u.temporaryTime.split(" - ");if(u.newActivity.startTime=e[0],u.newActivity.endTime=e[1],""!==u.temporaryAssistants){var t=u.temporaryAssistants.split(";"),n=[];angular.forEach(t,function(e){e.length>0&&n.push({email:e})}),u.newActivity.assistants=JSON.stringify(n)}else u.newActivity.assistants=u.temporaryAssistants;i(function(e,t){a({method:"POST",url:r.addNewActivity,ignoreLoadingBar:!0,params:{language:"SPA"},data:$.param(u.newActivity)}).then(function(e){1===e.data.status?(u.done(),s.done("Actividad agregada correctamente")):(u.close(),s.error("Ocurrio un error al intentar agregar la actividad"))}).catch(function(){t({error:"Ha ocurrido un error"})})})},function(){n&&(u.timeActivity=c(n.start,5)+" - "+c(n.end,5),u.text=n.subject)}()}e.$inject=["$uibModalInstance","title","item","$filter","$http","URLS","$q","CommonModalsSrv"],angular.module("actinver.controllers").controller("addActivityCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.item=t,function(){if(t.fileContent){for(var e=atob(t.fileContent),n=[],a=new Array(e.length),r=0;r<e.length;r++)a[r]=e.charCodeAt(r);var i=new Uint8Array(a);n.push(i),o.messageFile=new Blob(n,{type:t.contentType}),-1!==o.item.contentType.search("image")&&(o.messageImage="data:"+o.item.contentType+";base64,"+t.fileContent)}}(),o.close=function(){e.dismiss()},o.downloadFile=function(){n.saveAs(o.messageFile,"adjuntoMensaje"+t.idMessage)}}e.$inject=["$uibModalInstance","item","FileSaver"],angular.module("actinver.controllers").controller("noticeActivityCtrl",e)}(),function(){"use strict";function e(){}angular.module("actinver.controllers").controller("administratorCtrl",e)}(),function(){"use strict";function e(e){e.state("administrator",{templateUrl:"/app/advisers/administrator/administrator.html",url:"/administrator",controller:"administratorCtrl",controllerAs:"ctrl",parent:"app",ncyBreadcrumb:{label:"Administrador",parent:"app.dashboard"},redirectTo:"administrator.factsheets"}).state("administrator.factsheets",{templateUrl:"/app/advisers/administrator/factsheets/factsheets.html",url:"/factsheets",controller:"factsheetsCtrl",controllerAs:"fact",parent:"administrator",ncyBreadcrumb:{label:"Factsheets",parent:"administrator"}}).state("administrator.group",{templateUrl:"/app/advisers/administrator/group/group.html",url:"/grupos",controller:"groupCtrl",controllerAs:"group",parent:"administrator",ncyBreadcrumb:{label:"Grupos",parent:"administrator"}}).state("administrator.presentations",{templateUrl:"/app/advisers/administrator/presentations/presentations.html",url:"/presentations",controller:"presentationsAdminCtrl",controllerAs:"pres",parent:"administrator",ncyBreadcrumb:{label:"Presentaciones",parent:"administrator"}}).state("administrator.eeuu",{templateUrl:"/app/advisers/administrator/eeuu/eeuu.html",url:"/EEUU",controller:"eeuuCtrl",controllerAs:"eeuu",parent:"administrator",ncyBreadcrumb:{label:"EEUU",parent:"administrator"}}).state("administrator.mexico",{templateUrl:"/app/advisers/administrator/mexico/mexico.html",url:"/mexico",controller:"mexicoCtrl",controllerAs:"mx",parent:"administrator",ncyBreadcrumb:{label:"México",parent:"administrator"}}).state("administrator.economic",{templateUrl:"/app/advisers/administrator/economic/economic.html",url:"/entorno-economico",controller:"economicCtrl",controllerAs:"economic",parent:"administrator",ncyBreadcrumb:{label:"Entorno económico",parent:"administrator"}}).state("administrator.legal",{templateUrl:"/app/advisers/administrator/legal/legal.html",url:"/aviso-legal",controller:"legalCtrl",controllerAs:"legal",parent:"administrator",ncyBreadcrumb:{label:"Aviso legal",parent:"administrator"}}).state("administrator.investment",{templateUrl:"/app/advisers/administrator/investment/investment.html",url:"/fondos-de-inversion",controller:"adminInvestmentCtrl",controllerAs:"invest",parent:"administrator",ncyBreadcrumb:{label:"Fondos de inversión",parent:"administrator"}}).state("administrator.favorites",{templateUrl:"/app/advisers/administrator/favorites/favorites.html",url:"/favoritos",controller:"favoritesCtrl",controllerAs:"fav",parent:"administrator",ncyBreadcrumb:{label:"Favoritos",parent:"administrator"}}).state("administrator.profiles",{templateUrl:"/app/advisers/administrator/profiles/profiles.html",url:"/asignacion-de-perfiles",controller:"profilesCtrl",controllerAs:"profiles",parent:"administrator",ncyBreadcrumb:{label:"Asignación de perfiles",parent:"administrator"}}).state("administrator.advisers_binnable",{templateUrl:"/app/advisers/administrator/advisers-binnacle/advisers-binnacle.html",url:"/bitacora-de-asesores",controller:"advisersBinnacleCtrl",controllerAs:"ctrl",parent:"administrator",ncyBreadcrumb:{label:"Bitacora de asesores",parent:"administrator"}}).state("administrator.messages",{templateUrl:"/app/advisers/administrator/messages/messages.html",url:"/mensajes",controller:"messagesCtrl",controllerAs:"msgs",parent:"administrator",ncyBreadcrumb:{label:"Mensajes",parent:"administrator"}}).state("administrator.derivatives",{templateUrl:"/app/advisers/administrator/derivatives/derivatives.html",url:"/derivatives",controller:"derivativesCtrl",controllerAs:"dvts",parent:"administrator",ncyBreadcrumb:{label:"Derivados",parent:"administrator"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o){function a(o){return t(function(t,a){n({method:"POST",url:e.getAgentQuery,params:{language:"SPA",operation:"PARAMS",idEmpleado:void 0===o?"":o.idEmpleado,claveMapfre:void 0===o?"":o.claveMapfre,idNegocio:void 0===o?"":o.idNegocio,asesor:void 0===o?"":o.asesor,puesto:void 0===o?"":o.puesto}}).then(function(e){1===e.data.return.status?(u.responseAgente=e.data.return.data.insuranceAgentBeanList,u.totalPages=parseInt(u.responseAgente.length/5),0===u.totalPages&&(u.totalPages=1),t({success:!0,info:u.responseAgente})):a({success:!1,info:e.data.return.message})},function(){a({success:!1,type:"not-found"})})})}function r(r,i,s,c,l){return t(function(t,d){n({method:"POST",url:e.getAgentAddQuery,params:{language:"SPA",operation:"PARAMS",idEmpleado:r,claveMapfre:i,idNegocio:s,asesor:c,puesto:l}}).then(function(e){1===e.data.return.status?(u.responseAgenteAdd=e.data.return.data.insuranceAgentBeanList,a(),o.done("Se agrego agente con exito"),t({success:!0,info:u.responseAgenteAdd})):d({success:!1,info:e.data.return.message})},function(){d({success:!1,type:"not-found"})})})}function i(r,i){return t(function(t,s){n({method:"POST",url:e.getAgentDeleteQuery,params:{language:"SPA",idEmpleado:r,idNegocio:i}}).then(function(e){1===e.data.return.status?(u.responseAgenteDelete=e.data.return.data.insuranceAgentBeanList,a(),o.done("Borrado exitoso"),t({success:!0,info:u.responseAgenteDelete})):s({success:!1,info:e.data.return.message})},function(){s({success:!1,type:"not-found"})})})}function s(r,i,s,c,l){return t(function(t,d){n({method:"POST",url:e.getAgentUpdateQuery,params:{language:"SPA",idEmpleado:r,claveMapfre:i,idNegocio:s,asesor:c,puesto:l}}).then(function(e){console.log(e),1===e.data.return.status?(u.responseAgenteUpdate=e.data.return.data.insuranceAgentBeanList,a(),o.done("Actualización exitosa"),t({success:!0,info:u.responseAgenteUpdate})):d({success:!1,info:e.data.return.message})},function(){d({success:!1,type:"not-found"})})})}function c(e){var t=new RegExp("^[0-9]+$"),n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==e.charCode)return e.preventDefault(),!1}var u=this;u.pageSize=25,u.currentPage=1,u.totalPages,u.selectAll=!1,u.openSearch=!0,u.agentes=[],u.buttonTextToggle="AGREGAR",u.editToggle=!1,u.posicionPaginado=10,a(),u.indexEdit,u.listBussines=[{id:1,text:"ARRENDAMIENTO"},{id:2,text:"CB Y BANCO"},{id:3,text:"CREDITO"}],u.columns=[{name:"asesor",value:"Nombre Asesor"},{name:"claveMapfre",value:"ID Mapfre"},{name:"idEmpleado",value:"ID Asesor"},{name:"puesto",value:"Puesto"},{name:"idNegocio",value:"Negocio"}],u.checkAll=function(){u.selectAll?(u.agentsArray=[],angular.forEach(u.agents,function(e,t){console.log("key: ",t),console.log("value: ",e)})):u.agentsArray=[]},u.getAgent=a,u.getAgentAdd=r,u.getAgentDelete=i,u.getAgentUpdate=s,u.selectAgent=function(e,t){console.log("Empleado Seleccionado: "+e+", Negocio: "+t)},u.submitSearch=function(){},u.editRow=function(){},u.deleteRow=function(){},u.nextPage=function(){u.responseAgente.length>u.posicionPaginado&&(u.posicionPaginado+=5,u.currentPage++)},u.soloNumero=c,u.prevPage=function(){u.posicionPaginado>10&&(u.posicionPaginado-=5,u.currentPage--)},u.addAgents=function(){u.editToggle?(s(u.idEmpleado,u.claveMapfre,u.negocio.text,u.asesor,u.puesto),u.editToggle=!1,u.buttonTextToggle="AGREGAR"):r(u.idEmpleado,u.claveMapfre,u.negocio.text,u.asesor,u.puesto),u.limpiarAgentes()},u.deleteAgents=function(e,t){u.editToggle=!1,u.buttonTextToggle="AGREGAR",i(e,t),u.limpiarAgentes()},u.modifyAgents=function(e,t,n,o,a){u.editToggle=!0,u.idEmpleado=e,u.claveMapfre=t,u.asesor=o,u.puesto=a,u.negocio={text:n},u.buttonTextToggle="EDITAR"},u.limpiarAgentes=function(){u.idEmpleado="",u.claveMapfre="",u.asesor="",u.puesto="",u.negocio=""},u.buscarAgente=function(){a({idEmpleado:u.idEmpleado,claveMapfre:u.claveMapfre,idNegocio:void 0===u.negocio?"":u.negocio.text,asesor:void 0===u.asesor?"":u.asesor.toUpperCase(),puesto:void 0===u.puesto?"":u.puesto.toUpperCase()})}}e.$inject=["URLS","$q","$http","CommonModalsSrv"],angular.module("actinver.controllers").controller("agentCtrl",e)}(),function(){"use strict";function e(e){e.state("agent",{url:"/agent",parent:"app",templateUrl:"/app/advisers/agent/agent.html",controller:"agentCtrl",controllerAs:"agent",ncyBreadcrumb:{label:"Agentes",parent:"app.dashboard"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e){var t="/app/advisers/binnacle";e.state("binnacle",{templateUrl:t+"/binnacle.html",url:"/bitacora",parent:"app",ncyBreadcrumb:{label:"Bitácora",parent:"app.dashboard"},controller:"binnacleCtrl",controllerAs:"binnacle"}).state("binnacle.commercial",{templateUrl:t+"/views/commercial/commercial.html",url:"/comercial",ncyBreadcrumb:{label:"Comercial"}}).state("binnacle.commercial.strategy",{templateUrl:t+"/views/commercial/strategy/strategy.html",url:"/estrategia",controller:"binnacleStrategyCtrl",controllerAs:"strategy",ncyBreadcrumb:{label:"Estrategia"}}).state("binnacle.commercial.strategy.id",{templateUrl:t+"/views/commercial/strategy/id.html",url:"/{sponsor}/{id:[0-9]+}/{clasificacion}",controller:["$scope","$stateParams",function(e,t){e.client_id=t.id}],ncyBreadcrumb:{label:"Cliente: {{client_id}}"}}).state("binnacle.commercial.reports",{templateUrl:t+"/views/commercial/reports/reports.html",controller:"binnacleReportsCtrl",controllerAs:"reports",url:"/reportes",ncyBreadcrumb:{label:"Reporte de Metas"}}).state("binnacle.commercial.reports.id",{templateUrl:t+"/views/commercial/reports/id.html",url:"/{id:[0-9]+}/{estado:[0-9]+}/{action:[0-9]+}/{employee}",controller:"binnacleReportsCtrl",controllerAs:"reports",requiresAuthentication:!0,permissions:["asesores.AdministradorMenu."],ncyBreadcrumb:{label:"Asesor: {{adviser.id}}"}}).state("binnacle.commercial.outline",{templateUrl:t+"/views/commercial/outline/outline.html",controller:"binnacleOutlineCtrl",controllerAs:"outline",url:"/reperfilamiento",ncyBreadcrumb:{label:"Reperfilamiento"}}).state("binnacle.operative",{templateUrl:t+"/views/operative/main.html",url:"/operativa",ncyBreadcrumb:{label:"Operativa"}}).state("binnacle.operative.bank",{templateUrl:t+"/views/operative/bank.html",url:"/banco",ncyBreadcrumb:{label:"Banco"},controller:"binnacleBankCtrl",controllerAs:"ctrl"}).state("binnacle.operative.stock_exchange",{templateUrl:t+"/views/operative/stock-exchange.html",url:"/casa-de-bolsa",ncyBreadcrumb:{label:"Casa de Bolsa"},controller:"binnacleStockExchangeCtrl",controllerAs:"ctrl"})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o){var a={};return a.getOperativeBank=function(o,a,r){var i=t.defer(),s=i.promise,c=n.getBinnacleOperativeBank+"/"+o+"/"+a+"/"+r+"?language=SPA";return e.get(c).then(function(e){e&&e.data&&1===e.data.status?i.resolve(e.data.result):i.reject({})},function(e){i.reject(e)}),s},a.getOperativeStockExchange=function(o,a,r){var i=t.defer(),s=i.promise,c=n.getBinnacleOperativeStockExchange+"/"+o+"/"+a+"/"+r+"?language=SPA";return e.get(c).then(function(e){i.resolve(e.data.result)},function(e){i.reject(e)}),s},a.downloadPDF=function(a,r){return t(function(t,i){e.post(n.getAdvisersBinnacleBinnacle,{start:a,end:r},{responseType:"arraybuffer"}).then(function(e){var n=e.headers("Content-Type"),i=new Blob([e.data],{type:n});o.saveAs(i,"bitacora_"+a+"_"+r),t()},function(e){i(e)})})},a}e.$inject=["$http","$q","URLS","FileSaver"],angular.module("actinver.services").service("binnacleSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){var e={today:[],nextWeek:[],lastWeek:[]};e.today.push({fecha:a().valueOf(),records:[{isHeader:!0,fecha:a().valueOf()}]});for(var t=1;t<8;t++)e.nextWeek.push({fecha:a().add(t,"days").valueOf(),records:[{isHeader:!0,fecha:a().add(t,"days").valueOf()}]}),e.lastWeek.push({fecha:a().subtract(t,"days").valueOf(),records:[{isHeader:!0,fecha:a().subtract(t,"days").valueOf()}]});return e}var c={getInfo:function(o){return t(function(t,a){n({method:"GET",url:e.getBirthDays+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:c.setBirthday(s(),e.data.result),finish:!0}):a({success:!1,data:c.setBirthday(s(),[]),finish:!0})},function(){a({success:!1,data:c.setBirthday(s(),[]),finish:!0})})})},setBirthday:function(e,t){var n=0,o=0,r={hasBirhtdayToday:!1,hasBirthdayLastweek:!1,hasBirthdayNextweek:!1};for(n=0;angular.isArray(t.currentWeek)&&n<t.currentWeek.length;n++)for(o=0;o<e.today.length;o++)a(t.currentWeek[n].birthDate).format("DD/MM")===a(e.today[o].fecha).format("DD/MM")&&(e.today[o].records.push(Object.assign(t.currentWeek[n],{isHeader:!1})),r.hasBirhtdayToday=!0);for(n=0;angular.isArray(t.lastWeek)&&n<t.lastWeek.length;n++)for(o=0;o<e.lastWeek.length;o++)a(t.lastWeek[n].birthDate).format("DD/MM")===a(e.lastWeek[o].fecha).format("DD/MM")&&(e.lastWeek[o].records.push(Object.assign(t.lastWeek[n],{isHeader:!1})),o=e.lastWeek.length,r.hasBirthdayLastweek=!0);for(n=0;angular.isArray(t.nextWeek)&&n<t.nextWeek.length;n++)for(o=0;o<e.nextWeek.length;o++)a(t.nextWeek[n].birthDate).format("DD/MM")===a(e.nextWeek[o].fecha).format("DD/MM")&&(e.nextWeek[o].records.push(Object.assign(t.nextWeek[n],{isHeader:!1})),o=e.nextWeek.length,r.hasBirthdayNextweek=!0);return{lista:e,flag:r}},sendMessage:function(o){return t(function(t,a){function r(){n({method:"POST",url:e.sendMessangeBirthday,data:$.param(o)}).then(function(e){t(e.data)})}function s(e){a(e)}console.info("MODEL:",o),i.csrfValidate().then(r).catch(s)})}};return c}e.$inject=["URLS","$q","$http","$filter","moment","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("binnacleBirthdaysSrv",e)}(),function(){"use strict";function e(e,t,n){return{getClientsInfo:function(o,a){return t(function(t,r){var i="soon"===a?"consultarContratosPerfilVencer":"consultarContratosPerfilVencido";n({method:"GET",url:e.getOutlineInfo+i+"/"+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.resultadoOperacionServicioTO.status?t({success:!0,data:e.data.contratosVencimientoTO}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})},getSellsPracticeUrl:function(o){return t(function(t,a){n({method:"GET",url:e.getSellsPracticeUrl,params:o}).then(function(e){t(e)},function(){a({success:!1,data:[]})})})}}}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("binnacleOutlineSrv",e)}(),function(){"use strict";function e(e,t,n){function o(e,t,n){var o="",a="",r=e.fecha.split("/")
;return"single"!==n[0]?(o="<p><a href='javascript:void(0);' onclick='showAdvisersInfo( "+t+" , "+function(e){return e=e.trim(),["ENERO","FEBRERO","MARZO","ABRIL","MAYO","JUNIO","JULIO","AGOSTO","SEPTIEMBRE","OCTUBRE","NOVIEMBRE","DICIEMBRE"].indexOf(e.toUpperCase())+1}(r[0])+","+r[1]+" )'>VER DETALLE</a></p>",a="<li><strong>Total de asesores:</strong> "+e.asesores+"</li><li><strong>Total de clientes a contactar:</strong> "+e.clientes+"</li>"):a="<li><strong>Clientes a contactar:</strong> "+e.clientes+"</li>","<div class='dashboard-tooltip report-tooltip top'><div class='tooltip-arrow'></div><div class='tooltip-inner'><ul>"+a+"<li><strong>Meta por día:</strong>"+e.meta+"</li><li><strong>Clientes contactados:</strong>"+e.numContactos+"</li><li><strong>Alcance:</strong> "+e.alcance+"%</li></ul>"+o+"</div></div>"}var a={search_types:[{id:1,text:"Número de cliente único",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"11"}},{id:2,text:"Número de contrato",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"11"}},{id:3,text:"Nombre de cliente único",typeahead:!0,validation:{pattern:"",maxlength:"60"}}],getInfo:function(r){return t(function(t,i){var s=null,c={language:"SPA"};"profile"===r.type?s=e.getDetailGraph+"/true":"advisers"===r.type&&(s=e.getDetailGraph+"/false"),r&&r.show_info&&""!==r.show_info&&(c.employeeID=r.show_info),n({method:"GET",url:s,params:c,ignoreLoadingBar:!0}).then(function(e){var n,s=[];if("profile"===r.type?n=e.data.result.myProfile:"advisers"===r.type&&(n=e.data.result.advisors),angular.forEach(n,function(e){var t={asesores:e.totalAdvisors,clientes:e.clientsToReach,meta:e.targetPerDay,alcance:e.totalPercentage,numContactos:e.clientsContacted,fecha:e.month},n=[e.month,e.totalPercentage,o(t,r.show_info,r.filter)];s.push(n)}),void 0!==e){var c=e.data.result.myProfile;"profile"===r.type&&(c=c[c.length-1],c.data=[c.clientsContacted,c.clientsToReach-c.clientsContacted],c.percentage=parseInt(c.totalPercentage)+"%",c.colors=["#7ed321","#517cbd"]),t({success:!0,data:a.displayChart(s),finish:!0,result:c})}else i({success:!1,data:[],finish:!0})},function(){i({success:!1,data:[],finish:!0})})})},displayChart:function(e){var t=[],n=[],o=[],a=[];return e.forEach(function(r,i){t.push(i),n.push(r[1]),o.push(r[0]),i!==e.length-1?a.push("#00bebe"):a.push("#0f3f88")}),{section:"binnnacle-reports",labels:o,data:n,datasetOverride:{pointBackgroundColor:a,pointHoverBackgroundColor:a,pointBorderColor:a,pointHoverBorderColor:a},options:{maintainAspectRatio:!1,animation:!1,events:["click"],chartArea:{backgroundColor:"rgba(0, 190, 190, .1)"},scales:{yAxes:[{display:!0,ticks:{beginAtZero:!0,padding:10,fontSize:13,fontFamily:"Proxima Regular",fontColor:"#1a5dc4",stepSize:10,suggestedMax:105,callback:function(e){return 0!==e&&110!==e?e+"%":""}},gridLines:{drawBorder:!1,color:"#a2e6e6",borderDash:[2,0,2],zeroLineColor:"rgba(0, 0, 0, 0)"}}],xAxes:[{ticks:{fontFamily:"Proxima Semibold",fontColor:"#00bebe",fontSize:15},gridLines:{display:!1}}]},elements:{line:{fill:!1,tension:0,borderWidth:2,borderColor:"#00bebe"},point:{radius:8,hitRadius:8,hoverRadius:8}},tooltips:{enabled:!1,custom:!0,idxs:t,data:e}}}},getAdvisersInfo:function(o,a){return t(function(t,r){n({method:"GET",url:e.getAdvisersDetails+o,params:{date:a,language:"SPA"}}).then(function(e){e.data.result?t({success:!0,data:e.data.result,finish:!0}):r({success:!1,data:[],finish:!0})},function(){r({success:!1,data:[],finish:!0})})})}};return a}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("binnacleReportsSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){return{search_types:[{id:1,text:"Nombre del cliente",field:"nombreCliente",validation:{maxlength:"60"}},{id:2,text:"Número de contrato",field:"numContrato",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"11"}},{id:3,text:"Clasificación",field:"clasification",validation:{maxlength:"60"}},{id:4,text:"Tipo de contrato",field:"typeOrigin",validation:{maxlength:"60"}},{id:5,text:"Estatus",field:"contactNameStatus",validation:{maxlength:"60"}},{id:6,text:"Todos"}],getBinnacleClients:function(a){var r=o().format("M"),i=o().format("YYYY");return t(function(t,o){n({method:"GET",url:e.getBinnacleClients+a+"/"+r+"/"+i+"/TODOS/",params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.response.status&&e.data.response.result?t({success:!0,data:e.data.response.result.sponsorList}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getClientDetails:function(a,r,i){var s=o().format("M"),c=o().format("YYYY");return t(function(t,o){n({method:"GET",url:e.getClientDetails+a+"/"+r+"/"+i+"/"+s+"/"+c,params:{language:"SPA"}}).then(function(e){void 0===e||1!==e.data.response.status||R.isEmpty(e.data.response.result)?o({success:!1,data:[]}):t({success:!0,data:e.data.response.result,type:"details"})},function(){o({success:!1,data:[]})})})},getClientType:function(o,a){return t(function(t,r){n({method:"GET",url:e.getClientType+o+"/"+a,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.response.status?t({success:!0,data:e.data.response.result,type:"type"}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})},getClientProfile:function(o){return t(function(t,a){n({method:"GET",url:e.getClientProfile+o+"/2/2",params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outProfileByContractQuery.contractResult,type:"profile"}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getBinnacleCatalog:function(){return t(function(t,o){n({method:"GET",url:e.getBinnacleCatalog,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getBinnacleCatalogChild:function(o){return t(function(t,a){n({method:"GET",url:e.getBinnacleCatalogChild+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getCommentsDetailsByContract:function(o,a,r,i,s){return t(function(t,c){n({method:"GET",url:e.getCommentsDetailsByContract+o+"/"+a+"/"+r+"/"+i+"/"+s+"/",params:{language:"SPA"}}).then(function(e){void 0!==e&&e.data&&null!==e.data.response&&1===e.data.response.status?t(e.data.response.result):c({success:!1})},function(){c({success:!1})})})},doBinnacleComment:function(o){return t(function(t,r){function i(){n({method:"POST",url:e.doBinnacleComment,data:$.param(o)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,msg:"El mensaje se ha enviado exitosamente."}):r({success:!1,msg:e.data.messages[0].description})},function(){r({success:!1,msg:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"})})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})}}}e.$inject=["URLS","$q","$http","moment","csrfSrv"],angular.module("actinver.controllers").service("binnacleStrategySrv",e)}(),function(){"use strict";function e(e,t,n){var o=this,a=t.user.employeeID;o.scheduleInfo=n.tableSet({url:e.dashboardSchedule+a}),o.outlineSoonInfo=n.tableSet({url:e.getOutlineInfo+"consultarContratosPerfilVencer/"+a},{count:2}),o.outlineExpiredInfo=n.tableSet({url:e.getOutlineInfo+"consultarContratosPerfilVencido/"+a},{count:2})}e.$inject=["URLS","userConfig","tableList"],angular.module("actinver.controllers").controller("genericCtrl",e)}(),function(){"use strict";function e(e){e.state("app.generic",{controller:"genericCtrl",controllerAs:"generic",templateUrl:"/app/advisers/generic/generic.html",url:"/generic",requiresAuthentication:!0,ncyBreadcrumb:{label:" "},parent:"app"})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n){var o=this,a=t.user.employeeID;o.fdc=/access/i.test(navigator.userAgent),o.scheduleInfo=n.tableSet({url:e.dashboardSchedule+a}),o.outlineSoonInfo=n.tableSet({url:e.getOutlineInfo+"consultarContratosPerfilVencer/"+a},{count:2}),o.outlineExpiredInfo=n.tableSet({url:e.getOutlineInfo+"consultarContratosPerfilVencido/"+a},{count:2})}e.$inject=["URLS","userConfig","tableList"],angular.module("actinver.controllers").controller("dashboardCtrl",e)}(),function(){"use strict";function e(e){e.state("app.dashboard",{controller:"dashboardCtrl",controllerAs:"dashboard",templateUrl:"/app/advisers/dashboard/dashboard.html",url:"/dashboard",requiresAuthentication:!0,ncyBreadcrumb:{label:"Módulo de Asesoría"},parent:"app"})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.getAccountState=function(a,r,i,s,c,u){return t(function(t,l){function d(){var o={month:a,year:r,employeeId:i,userName:s,password:c,language:"SPA",isReport:u};n({method:"POST",url:e.getAccountState,data:$.param(o)}).then(function(e){t(e)})}function m(e){l(e)}o.csrfValidate().then(d).catch(m)})},a.prototype.getAccountStateRh=function(a,r,i,s,c,u){return t(function(t,l){function d(){var o={month:a,year:r,employeeId:i,userName:s,password:c,language:"SPA",isReport:u};n({method:"POST",url:e.getAccountStateRh,data:$.param(o)}).then(function(e){t(e)})}function m(e){l(e)}o.csrfValidate().then(d).catch(m)})},new a}e.$inject=["URLS","$q","$http","csrfSrv"],angular.module("actinver.services").service("accountStateSrv",e)}(),function(){"use strict";function e(e,t,n){return{getGroupsByEmployeeRpt:function(o,a){return t(function(t,r){n({method:"GET",url:decodeURIComponent(e.getGroupsByEmployeeRpt+"?idEmployee="+o+"&language=SPA&fechaTransaccion="+a)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})},getInfoByGroupRpt:function(o,a){return t(function(t,r){n({method:"GET",url:decodeURIComponent(e.getInfoByGroupRpt+o+"?language=SPA&fechaTransaccion="+a)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})},getCustomCenterInfoRpt:function(o,a){return t(function(t,r){n({method:"GET",url:decodeURIComponent(e.getCustomCenterInfoRpt+o+"?language=SPA&fechaTransaccion="+a)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"goals-positions"}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})},getCustomCenterProductsRpt:function(o,a){return t(function(t,r){n({method:"GET",url:decodeURIComponent(e.getCustomCenterProductsRpt+o+"?language=SPA&fechaTransaccion="+a)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"goals-contracts"}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})}}}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("goalsCustomSrv",e)}(),function(){"use strict";function e(e,t,n){function o(e){var t=JSON.parse(JSON.parse(sessionStorage["ngStorage-user"])),n=-1;return angular.isDefined(t.roles)&&angular.isArray(t.roles)&&(n=t.roles.findIndex(function(t){return t.toUpperCase()===e})),n>-1}return{getGoalsPositionsRpt:function(a,r){var i=o("ASESOR")?e.getGoalsPositions:e.getGoalsPositionsRpt;return t(function(e,t){n({method:"GET",url:decodeURIComponent(i+a+"?language=SPA&fechaTransaccion="+r)}).then(function(n){void 0!==n&&1===n.data.status?e({success:!0,data:n.data.result,topic:"goals-positions"}):t({success:!1,data:[]})},function(){t({success:!1,data:[]})})})},getSumGoalsPositionsRpt:function(a,r){var i=o("ASESOR")?e.getSumGoalsPositions:e.getSumGoalsPositionsRpt;return t(function(e,t){n({method:"GET",url:decodeURIComponent(i+a+"?language=SPA&fechaTransaccion="+r)}).then(function(n){void 0!==n&&1===n.data.status?e({success:!0,data:n.data.result,topic:"sum-goals-positions"}):t({success:!1,data:[]})},function(){t({success:!1,data:[]})})})},getGoalsContractsRpt:function(a,r){var i=o("ASESOR")?e.getGoalsContracts:e.getGoalsContractsRpt;return t(function(e,t){n({method:"GET",url:decodeURIComponent(i+a+"?language=SPA&fechaTransaccion="+r)}).then(function(n){void 0!==n&&1===n.data.status?e({success:!0,data:n.data.result,topic:"goals-contracts"}):t({success:!1,data:[]})},function(){t({success:!1,data:[]})})})}}}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("goalsReportsSrv",e)}(),function(){"use strict";function e(e){var t="/app/advisers/goals";e.state("goals",{templateUrl:t+"/goals.html",url:"/reporte-metas",parent:"app",ncyBreadcrumb:{label:"Reporte de metas",parent:"app.dashboard"},controller:"goalsCtrl",controllerAs:"goals"}).state("goals.report",{templateUrl:t+"/views/report/report.html",url:"/reporte",ncyBreadcrumb:{label:"Reporte"},controller:"reportCtrl",controllerAs:"report"}).state("goals.supervisor",{templateUrl:t+"/views/supervisor/supervisor.html",url:"/reporte-supervisor",ncyBreadcrumb:{label:"Reporte de Supervisor"},controller:"supervisorCtrl",controllerAs:"supervisor"}).state("goals.custom",{templateUrl:t+"/views/custom/custom.html",url:"/reporte-personalizado",ncyBreadcrumb:{label:"Reporte Personalizado"},controller:"customCtrl",controllerAs:"custom"}).state("goals.manager",{templateUrl:t+"/views/report/manager.html",url:"/reporte-manager",ncyBreadcrumb:{label:"Reporte de Gestión"},controller:"managerCtrl",controllerAs:"manager"}).state("goals.reportLargeAndShort",{templateUrl:t+"/views/report/reportLargeAndShort.html",url:"/reporte-reportLargeAndShort",ncyBreadcrumb:{label:"Reporte de largos y cortos"},controller:"reportLargeAndShortCtrl",controllerAs:"reportLargeAndShort"}).state("goals.accountStatus",{templateUrl:t+"/views/accountState/accountState.html",url:"/account-state",ncyBreadcrumb:{label:"Estados de cuenta"},controller:"accountStateCtrl",controllerAs:"accountState"})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n){return{search_filter_types:[{id:1,text:"Todos"},{id:2,text:"Top 10+ Asesores"},{id:3,text:"Top 10- Asesores"},{id:4,text:"Top 10+ Centros Financieros"},{id:5,text:"Top 10- Centros Financieros"}],getSupervisorInfo:function(o,a){return t(function(t,r){n({method:"GET",url:decodeURIComponent(e.getSupervisorInfo+o+"?language=SPA&fechaTransaccion="+a)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):r({success:!1,data:[]})},function(){r({success:!1,data:[]})})})},getCenterInfo:function(o,a,r){return t(function(t,i){n({method:"GET",url:decodeURIComponent(e.getCenterInfo+a+"/"+o+"?language=SPA&fechaTransaccion="+r)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"goals-positions"}):i({success:!1,data:[]})},function(){i({success:!1,data:[]})})})},getCenterProducts:function(o,a,r){return t(function(t,i){n({method:"GET",url:decodeURIComponent(e.getCenterProducts+a+"/"+o+"?language=SPA&fechaTransaccion="+r)}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"goals-contracts"}):i({success:!1,data:[]})},function(){i({success:!1,data:[]})})})}}}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("goalsSupervisorSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getListaLargeAndShort=function(){return t(function(t,o){n({method:"Get",url:e.getShortAndLargeReport,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,lista:e.data.outMoneyMarketCashByAdviserQuery.contractList.contract,msg:""}):void 0!==e&&2===e.data.outCommonHeader.result.result&&o({success:!1,lista:[],msg:e.data.outCommonHeader.result.messages[0]})}).catch(function(){o({success:!1,lista:[],msg:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("reportLargeAndShortSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){a.getVideos().then(function(e){s.videos=e})}function i(){s.loadingQuestions=!0,a.getQuestions().then(function(e){s.questions=e,s.loadingQuestions=!1}).finally(function(){s.loadingQuestions=!1})}var s=this;s.showVideo=function(e){n.show(e)},s.sendComment=function(){a.sendComment().then(function(){o.done("Tu pregunta se ha enviado de manera correcta. Agradecemos tu participación en esta sección.").result.then(function(){s.comments=""})})},function(){r(),i()}()}e.$inject=["PresentationSrv","$state","HelpModals","CommonModalsSrv","HelpSrv"],angular.module("actinver.controllers").controller("helpCtrl",e)}(),function(){"use strict";function e(e){e.state("help",{templateUrl:"/app/advisers/help/help.html",parent:"app",controller:"helpCtrl",controllerAs:"help",url:"/help",ncyBreadcrumb:{label:"Ayuda",parent:"app.dashboard"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getVideos=function(){return t(function(t,o){n({method:"GET",url:e.getVideos}).then(function(e){1===e.data.status?t(e.data.result):o()}).catch(o)})},o.prototype.getQuestions=function(){return t(function(t,o){n({method:"GET",url:e.getQuestions}).then(function(e){1===e.data.status?t(e.data.result):o()}).catch(o)})},o.prototype.sendComment=function(){return t(function(t,o){n({method:"POST",url:e.genericPost}).then(function(e){1===e.data.status?t(e.data.result):o()}).catch(o)})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("HelpSrv",e)}(),function(){"use strict";function e(e,t,n){var o=this,a=JSON.parse(n.user);o.role=a.roles.includes("SEGUROS"),o.agentList=[],t.agentDisabled=!1,void 0===t.agentLength&&e.getAgent().then(function(e){e.success?(t.agentLength=0,angular.forEach(e.info,function(e){o.agentList.push({id:e.claveMapfre,text:e.claveMapfre+" | "+e.idNegocio}),e.idNegocio.toString().toUpperCase().startsWith("CB")&&(t.agentSelected=o.agentList[t.agentLength]),++t.agentLength}),0===t.agentLength&&o.agentList.push({id:5988,text:"5988 | Actinver"}),void 0===t.agentSelected&&(t.agentSelected=o.agentList[0])):(o.agentList=[],t.agentSelected=[])})}e.$inject=["insuranceSrv","$scope","$sessionStorage"],angular.module("actinver.controllers").controller("insuranceCtrl",e)}(),function(){"use strict";function e(e){e.state("insurance",{templateUrl:"/app/advisers/insurance/insurance.html",url:"/insurance",ncyBreadcrumb:{label:"Seguros",parent:"app.dashboard"},controller:"insuranceCtrl",controllerAs:"insCtrl",parent:"app",redirectTo:"insurance.main"}).state("insurance.main",{templateUrl:"/app/advisers/insurance/main/insurance-main.html",url:"/main",params:{model:null},controller:"insuranceMainCtrl",controllerAs:"insMainCtrl",parent:"insurance",ncyBreadcrumb:{label:"Cuenta",parent:"insurance"}}).state("insurance.cars",{templateUrl:"/app/advisers/insurance/cars/insurance-cars.html",url:"/cars",params:{model:null},controller:"insuranceCarsCtrl",controllerAs:"carsCtrl",parent:"insurance",ncyBreadcrumb:{label:"Automóviles",parent:"insurance"}}).state("insurance.houses",{templateUrl:"/app/advisers/insurance/houses/insurance-houses.html",url:"/houses",params:{model:null},controller:"insuranceHousesCtrl",controllerAs:"housesCtrl",parent:"insurance",ncyBreadcrumb:{label:"Hogar",parent:"insurance"}}).state("insurance.medical",{templateUrl:"/app/advisers/insurance/medical/insurance-medical.html",url:"/medical",params:{model:null},controller:"insuranceMedicalCtrl",controllerAs:"medicalCtrl",parent:"insurance",ncyBreadcrumb:{label:"PMM",parent:"insurance"}}).state("insurance.life",{templateUrl:"/app/advisers/insurance/life/insurance-life.html",url:"/life",params:{model:null},controller:"insuranceLifeCtrl",controllerAs:"lifeCtrl",parent:"insurance",ncyBreadcrumb:{label:"Vida",parent:"insurance"}}).state("insurance.repor",{templateUrl:"/app/advisers/insurance/main/views/reporte/misreportes.html",url:"/reporte",controller:"misreportesCtrl",controllerAs:"misreportes",ncyBreadcrumb:{label:"Reportes"}}).state("insurance.pyme",{templateUrl:"/app/advisers/insurance/pyme/insurance-pyme.html",url:"/pyme",params:{model:null},controller:"insurancePymeCtrl",controllerAs:"pymeCtrl",parent:"insurance",ncyBreadcrumb:{label:"PYMES",parent:"insurance"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n){return{getAgent:function(){return t(function(t,o){n({method:"POST",url:e.getAgent,params:{language:"SPA",operation:"AGENT"}}).then(function(e){void 0===e.data.outCommonHeader?1===e.data.return.status?t({success:!0,info:e.data.return.data.insuranceAgentBeanList}):o({success:!1,info:e.data.return.messages[0].description}):o({success:!1,info:e.data})},function(){o({success:!1,info:response.data})}).catch(function(){o({success:!1,info:"***ERROR*** Catch getAgentSvc"})})})}}}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("insuranceSrv",e)}(),function(){"use strict";function e(e){e.state("notification",{templateUrl:"/app/advisers/notification/notification.html",url:"/notification",ncyBreadcrumb:{label:"Notificaciones",parent:"app.dashboard"},parent:"app",redirectTo:"notification.lumina"}).state("notification.lumina",{templateUrl:"/app/advisers/notification/lumina/lumina-notification.html",url:"/Lumina",controller:"luminaNotificationCtrl",controllerAs:"lumina",parent:"notification",ncyBreadcrumb:{label:"Lumina",parent:"notification"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e){e.state("presentations",{templateUrl:"/app/advisers/presentations/presentations.html",url:"/presentations",parent:"app",controller:"presentationsCtrl",controllerAs:"presentations",ncyBreadcrumb:{label:"Presentaciones",parent:"app.dashboard"}}).state("presentations.id",{templateUrl:"/app/advisers/presentations/list.html",url:"/{id:int}",controller:"presentationsCtrl",controllerAs:"presentations",ncyBreadcrumb:{label:" "}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n){function o(){i.selectedTab=1,i.groupSelectedTab=0}function a(e){var t={};e.map(function(e){var n=e.idPresentationSubType||"generica",o=e.presentations[0].descriptionSubType||"generica";t[n]||(t[n]={name:o,list:[]}),t[n].list=e.presentations}),i.presentationsList=t}function r(){i.loadingProducts=!0,e.getTypesAsr().then(function(e){i.products=e},function(){i.errorLoadingProducts=!0}).finally(function(){i.loadingProducts=!1})}var i=this;i.nextTab=function(){i.groupSelectedTab++},i.beforeTab=function(){i.groupSelectedTab--},i.getPresentationsByType=function(t){i.loadingSubProducts=!0,i.loadingPres=!0,i.subProducts=[],e.getPresentations(t).then(function(e){angular.forEach(e,function(e){i.subProducts.push(e)}),i.loadingSubProducts=!1,i.loadingPres=!1,a(i.subProducts)}).catch(function(){i.loadingSubProducts=!1,i.loadingPres=!1})},i.done=function(t){e.getPresentationsFile(t).then(function(){})},function(){var e=n.id?n.id:1;t.go("presentations.id",{id:e}),r(),i.getPresentationsByType(e),o()}()}e.$inject=["PresentationSrv","$state","$stateParams"],angular.module("actinver.controllers").controller("presentationsCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getTypesAsr=function(){var r;return t(function(t,i){a.makeDataUser().then(function(a){for(var s=0;s<a.user.scope.length;s++){var c=a.user.scope[s];if("ADMINISTRADOR"===c){r=e.getTypes;break}if("ASESOR"===c){r=e.getTypesAsr;break}}n({method:"GET",url:r,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),i())}).catch(i)})})},r.prototype.getPresentations=function(o){return t(function(t,r){var i;a.makeDataUser().then(function(a){for(var s=0;s<a.user.scope.length;s++){var c=a.user.scope[s];if("ADMINISTRADOR"===c){i=e.getPresentationsByType;break}if("ASESOR"===c){i=e.getPresentations;break}}n({method:"GET",url:i+o,params:{language:"SPA"}}).then(function(e){1===e.data.status?t(e.data.result):r()})})})},r.prototype.getPresentationsFile=function(o){return t(function(t,r){var i;a.makeDataUser().then(function(a){for(var s=0;s<a.user.scope.length;s++){var c=a.user.scope[s];if("ADMINISTRADOR"===c){i=e.getPresentationFileAdm;break}if("ASESOR"===c){i=e.getPresentationFile;break}}n({method:"GET",url:i+o,responseType:"arraybuffer",params:{language:"SPA"}}).then(function(e){var n=new Blob([e.data],{type:"application/pdf"}),o=URL.createObjectURL(n);window.open(o,"_blank","Presentación"),t({response:e.data})}).catch(function(e){r({error:e.data})})})})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","loginSrvc"],angular.module("actinver.services").service("PresentationSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){return{client_types:[{key:1,description:"Física"},{key:2,description:"Moral"}],getIssuersInfo:function(){return t(function(t,o){var r;a.makeDataUser().then(function(a){for(var i=0;i<a.user.scope.length;i++){var s=a.user.scope[i];if("ADMINISTRADOR"===s){r=e.getIssuersProposal;break}if("ASESOR"===s){r=e.getIssuersInfo;break}}n({method:"GET",url:r,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})})},getProducts:function(){return t(function(t,o){n({method:"GET",url:e.getProducts,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getSubProducts:function(o){return t(function(t,a){n({method:"GET",url:e.getSubProducts+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getProfiles:function(){return t(function(t,o){n({method:"GET",url:e.getProfiles,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result.outClientProfileCatalog.profileList}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getStrategies:function(o){for(var a=[],r=o;r>0;r--)a.push(function(o){return t(function(t,a){n({method:"GET",url:e.getStrategies+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outModelPortfolioByCriterionQuery.modelPortfolios}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})}(r));return t.all(a)},getStrategyDetail:function(o){return t(function(t,a){n({method:"GET",url:e.getStrategyDetail+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outModelPortfolioDetailQuery.modelPortfolios}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getInvIssuersCatalog:function(o){return t(function(t,a){n({method:"GET",url:e.getInvIssuersCatalog+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outInvestmentIssuersProspectQuery.issuer,topic:"invIssuersCatalog"}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getBandsCatalog:function(o){return t(function(t,a){n({method:"GET",url:e.getBandsCatalog+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outBondMarketBandsProspectQuery.band,topic:"bandsCatalog"}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getIssuersCatalog:function(o){return t(function(t,a){n({method:"GET",url:e.getIssuersCatalog+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outBondMarketIssuerProspectQuery.issuer,topic:"issuersCatalog"}):a({success:!1,data:[]})},function(){a({success:!1,data:[]})})})},getDerivativesCatalog:function(o){return t(function(t,o){n({method:"GET",url:e.getDerivativesAsr,params:{language:"SPA"}}).then(function(e){if(void 0!==e){var n=e.data;t({success:!0,data:n,topic:"derivatives"})}else o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getAllIssuers:function(){return t(function(t,o){n({method:"GET",url:e.getAllIssuers,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outClientIssuersMarketInfoQuery.marketDataTuple,topic:"issuers"}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getFavorites:function(){return t(function(t,o){n({method:"GET",url:e.getFavoritesAsr,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"favorites"}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},getClassificationFav:function(){return t(function(t,o){n({method:"GET",url:e.getClassificationFav,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"classificationFav"}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},doProposal:function(a){return t(function(t,r){function i(){n({method:"POST",url:e.doProposal,data:a}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0}):r({success:!1})})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},generaReportePropuesta:function(a){return t(function(t,r){function i(){n({method:"POST",url:e.getCustomerProposal,data:$.param(a),responseType:"arraybuffer"}).then(function(e){t(e)}).catch(function(e){console.error(e),r(e)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})}}}e.$inject=["URLS","$q","$http","csrfSrv","loginSrvc"],angular.module("actinver.controllers").service("proposalsProposalSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(e){for(var t=0;t<u.length;t++)if(u[t].name.trim()===e.trim())return u[t].description;return""}function s(e,t){var n=[],o={},a={};return angular.forEach(e,function(e,r){"Fondo de Fondos"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:i(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Renta Variable"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:unescape(encodeURIComponent(e.subGroup.name)),instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:i(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Fibras"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:i(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Riesgo Cambiario"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:i(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Deuda"===r&&angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:i(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})})}),n}function c(e){var t=[];return angular.forEach(e,function(e,n){angular.forEach(e,function(e){"invest"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,descripcion:e.description,instrumento:"SOCIEDADES DE INVERSION"
}):"actions"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,instrumento:"ACCIONES"}):"money"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,instrumento:"MERCADO DE DINERO"}):"reportos"===n&&t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,instrumento:"REPORTOS"})})}),t}var u;return{doProposalTracing:function(i){return u=i.issuers,n(function(n,u){function l(){var a={language:"SPA",data:0===f.length?0:window.btoa(unescape(encodeURIComponent(JSON.stringify(f)))),contract:i.tracing.form.scontract.numContrato?i.tracing.form.scontract.numContrato:"",confidential:i.tracing.form.confidential&&!0===i.tracing.form.confidential?1:0,startDate:"CB"===i.tracing.form.scontract.origen?e("date")(i.tracing.form.tir.startDate._d,"ddMMyyyy"):"",endDate:"CB"===i.tracing.form.scontract.origen?e("date")(i.tracing.form.tir.endDate._d,"ddMMyyyy"):"",valorPortafolio:i.brief.form.portfolio[0]?i.brief.form.portfolio[0].value:"0",name:m.name?m.name:"",mail:m.mail?m.mail:"",ext:i.adviser.form.adviser_ext?i.adviser.form.adviser_ext:"0",mobile:i.adviser.form.adviser_mobile?i.adviser.form.adviser_mobile:"0",phone:i.adviser.form.adviser_phone?i.adviser.form.adviser_phone:"0",clientType:i.tracing.form.person_type&&!0===i.tracing.form.person_type?1:0,serviceType:i.tracing.form.service_type&&!0===i.tracing.form.service_type?1:0,comments:i.tracing.form.comment_tracing?i.tracing.form.comment_tracing:"",commentsProposal:i.brief.form.portfolio[0].comment?i.brief.form.portfolio[0].comment:"",source:i.tracing.form.scontract.origen?i.tracing.form.scontract.origen:"",clientName:i.tracing.form.scontract.nombreCliente?i.tracing.form.scontract.nombreCliente:"",products:0===p.length?0:window.btoa(unescape(encodeURIComponent(JSON.stringify(p)))),plusvalia:i.tracing.form.capital_gain&&!0===i.tracing.form.capital_gain?"1":"0",portfolio:g&&0===g.length?0:window.btoa(unescape(encodeURIComponent(JSON.stringify(g)))),valorPortafolio2:i.brief.form.portfolio[1]?i.brief.form.portfolio[1].value:"0",comments2:i.brief.form.portfolio[1]?i.brief.form.portfolio[1].comment:"",idEmployee:m.employeeID?m.employeeID:0,portfolioType1:i.brief.form.portfolio[0]&&"manual"===i.brief.form.portfolio[0].type?1:2,portfolioType2:i.brief.form.portfolio[1]&&i.brief.form.portfolio[1].type&&"manual"===i.brief.form.portfolio[1].type?1:2,createEnvironment:!0,createForecast:!0};o({method:"POST",url:t.getCustomerTrackingAndProposal,data:$.param(a),responseType:"arraybuffer"}).then(function(e){n(e)}).catch(function(e){u(e)})}function d(e){u(e)}var m=JSON.parse(r.user),p=[];i.products&&angular.forEach(i.products,function(e){e&&angular.forEach(e.subproducts,function(e,t){p.push({product:t,value:1})})});var f,g=[];"model"===i.brief.form.portfolio[0].type?f=s(i.brief.form.portfolio[0]?i.brief.form.portfolio[0].strategyItems:[],i.brief.form.portfolio[0].value):"manual"===i.brief.form.portfolio[0].type&&(f=c(i.brief.form.portfolio[0]?i.brief.form.portfolio[0].invest:[])),i.brief.form.portfolio[1]&&"model"===i.brief.form.portfolio[1].type?g=s(i.brief.form.portfolio[1]?i.brief.form.portfolio[1].strategyItems:[],i.brief.form.portfolio[1].value):i.brief.form.portfolio[1]&&"manual"===i.brief.form.portfolio[1].type&&(g=c(i.brief.form.portfolio[1]?i.brief.form.portfolio[1].invest:[])),a.csrfValidate().then(l).catch(d)})},getCurrentPortfolio:function(e,a,r){return n(function(n,i){o({method:"GET",url:t.getCurrentPortfolio+e+"/"+a+"/"+r,params:{language:"SPA"}}).then(function(e){e.data.status?n(e.data.result):i({success:!1})},function(){i({success:!1})})})}}}e.$inject=["$filter","URLS","$q","$http","csrfSrv","$sessionStorage"],angular.module("actinver.controllers").service("proposalsPropTracingSrv",e)}(),function(){"use strict";function e(e){var t="/app/advisers/proposals";e.state("proposals",{templateUrl:t+"/proposals.html",url:"/propuestas",parent:"app",ncyBreadcrumb:{label:"Propuestas",parent:"app.dashboard"}}).state("proposals.proposal",{templateUrl:t+"/views/proposal/proposal.html",url:"/propuesta",ncyBreadcrumb:{label:"Propuesta"},controller:"proposalCtrl",controllerAs:"proposal"}).state("proposals.tracing",{templateUrl:t+"/views/tracing/tracing.html",url:"/seguimiento",ncyBreadcrumb:{label:"Seguimiento"},controller:"tracingCtrl",controllerAs:"tracing"}).state("proposals.proposal-tracing",{templateUrl:t+"/views/proposal-tracing/proposal-tracing.html",url:"/propuesta-seguimiento",ncyBreadcrumb:{label:"Propuesta Seguimiento"},controller:"propTracingCtrl",controllerAs:"propTracing"}).state("proposals.tracing-client",{templateUrl:t+"/views/tracing-client.html",url:"/seguimiento-cliente-unico",ncyBreadcrumb:{label:"Seguimiento por cliente único"},controller:"tracingClientCtrl",controllerAs:"ctrl"}).state("proposals.activity",{templateUrl:t+"/views/activity.html",url:"/registro-actividades",ncyBreadcrumb:{label:"Registro de actividades"},controller:"activityCtrl",controllerAs:"ctrl"})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){return{getContractInfo:function(o,a){return t(function(t,r){n({method:"GET",url:e.getContractInfo+o+"/"+a,params:{language:"SPA"}}).then(function(e){t(void 0!==e&&1===e.data.outCommonHeader.result.result?{success:!0,data:e.data.result,message:e.data.outCommonHeader.result.messages[0].responseMessage}:{success:!1,data:[],message:e.data.outCommonHeader.result.messages[0].responseMessage})},function(){r({success:!1,data:[],message:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})})})},doTracing:function(o){var s=[],c={};for(var u in o.products)for(c in o.products[u].subproducts){var l={product:c,value:1};s.push(l)}var d=JSON.parse(r.user),m={language:"SPA",contract:o.scontract.numContrato.toString(),name:d.name,mail:d.mail,ext:o.adviser_ext,confidential:o.confidential&&!0===o.confidential?1:0,startDate:"CB"===o.scontract.origen?a("date")(o.tir.startDate._d,"ddMMyyyy"):"",endDate:"CB"===o.scontract.origen?a("date")(o.tir.endDate._d,"ddMMyyyy"):"",mobile:o.adviser_mobile?o.adviser_mobile:0,phone:o.adviser_phone?o.adviser_phone:0,clientType:o.person_type&&!0===o.person_type?1:0,serviceType:o.service_type&&!0===o.service_type?1:0,comments:o.comment_tracing,source:o.scontract.origen?o.scontract.origen:"",clientName:o.scontract.nombreCliente,startDate2:o.tir2?a("date")(o.tir2.startDate._d,"ddMMyyyy"):"00000000",endDate2:o.tir2?a("date")(o.tir2.endDate._d,"ddMMyyyy"):"00000000",products:0===s.length?0:window.btoa(JSON.stringify(s)),plusvalia:o.capital_gain&&!0===o.capital_gain?1:0,idEmployee:d.employeeID,createEnvironment:!0,createForecast:!0};return t(function(t,o){function a(){n({method:"POST",url:e.getCustomerTracking,data:$.param(m),responseType:"arraybuffer"}).then(function(e){t(e)},function(e){o(e)})}function r(e){o(e)}i.csrfValidate().then(a).catch(r)})}}}e.$inject=["URLS","$q","$http","userConfig","$filter","$sessionStorage","csrfSrv"],angular.module("actinver.controllers").service("proposalsTracingSrv",e)}(),function(){"use strict";function e(){}angular.module("actinver.controllers").controller("prospectsCtrl",e)}(),function(){"use strict";function e(e){e.state("prospects",{templateUrl:"/app/advisers/prospects/prospects.html",url:"/prospects",controller:"prospectsCtrl",controllerAs:"prospect",redirectTo:"prospects.myProfile",ncyBreadcrumb:{label:"Prospectos",parent:"app.dashboard"},parent:"app"}).state("prospects.myProfile",{templateUrl:"/app/advisers/prospects/my-profile/my-profile.html",url:"/myProfile",controller:"prospectsProfileCtrl",controllerAs:"myProfile",ncyBreadcrumb:{label:"Mi perfil"}}).state("prospects.id",{templateUrl:"/app/advisers/prospects/detail/detail-prospect.html",url:"/myProfile/{id:int}",controller:"prospectsDetailCtrl",controllerAs:"detail",ncyBreadcrumb:{label:"Datos del prospecto"}}).state("prospects.reactivate",{templateUrl:"/app/advisers/prospects/reactivate/reactivate.html",url:"/myProfile/reactivate",controller:"prospectsReactivateCtrl",controllerAs:"reactivate",ncyBreadcrumb:{label:"Reactivar"},params:{model:null}}).state("prospects.team",{templateUrl:"/app/advisers/prospects/team/team.html",url:"/team",controller:"prospectsTeamCtrl",controllerAs:"admin",ncyBreadcrumb:{label:"Mi equipo"}}).state("prospects.report",{templateUrl:"/app/advisers/prospects/report/report.html",url:"/report",controller:"reportOppCtrl",controllerAs:"rep",ncyBreadcrumb:{label:"Reportes"}}).state("prospects.team.idTeam",{templateUrl:"/app/advisers/prospects/my-profile/my-profile.html",url:"/adviser/:id",controller:"prospectsProfileCtrl",controllerAs:"myProfile",ncyBreadcrumb:{label:"Perfil"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(){}function u(e,t){var n=[],o=0,a=0;return R.mapObjIndexed(function(e,r){t?(n.push(e),o+=e,"clients"===r&&(a+=e)):"value"===r&&n.push(e)},e),{options:n,percentage:t?o:e.value+e.quantity,remaining:a}}s.user.employeeID;return c.prototype.nextStage=function(o){return t(function(t){n({method:"POST",url:e.nextStage,data:$.param(o),params:{language:"SPA"}}).then(function(e){e.data.status&&t()})})},c.prototype.downloadPDF=function(){return t(function(t,o){n.post(e.downloadPDF,{},{responseType:"arraybuffer"}).then(function(e){var n=e.headers("Content-Type"),o=new Blob([e.data],{type:n});a.saveAs(o,"bitacora_"),t()},function(e){o(e)})})},c.prototype.getDetailProspect=function(o,a){var r=a?o+"/"+a:o;return t(function(t){n({method:"GET",url:e.getDetailProspect+r,params:{language:"SPA"}}).then(function(e){e.data.status&&(e.data.result.stage={},e.data.result.stage.idStage=a,t(e.data.result))})})},c.prototype.getInfoClient=function(o){return t(function(t,a){n({method:"GET",url:e.getClientInfo,params:{typeQuery:o.type,language:"SPA",titularFlag:!0,bankingArea:o.bankingArea,contractNumber:o.contractNumber,clientNumber:o.clientNumber}}).then(function(e){var n,o="";void 0!==e&&1===e.data.outCommonHeader.result.result?(n=e.data.outClientOrContractClientInfoQuery.client,o=e.data.outCommonHeader.result.messages[0].responseMessage,t({success:angular.isArray(n)&&n.length>0,data:n,msg:o})):(o=e.data.outCommonHeader.result.messages[0].responseMessage,t({success:!1,data:[],msg:o}))},function(){a({success:!1,data:[],msg:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})})})},c.prototype.getStages=function(){return t(function(t){n({method:"GET",url:e.getStages,params:{language:"SPA"}}).then(function(e){t(e.data.result)})})},c.prototype.getListByEmployee=function(o){return t(function(t){n({method:"GET",url:e.getListOpportunity+o,params:{language:"SPA"}}).then(function(e){t(e.data.result)})})},c.prototype.getStageProspect=function(o,a){return t(function(t){n({method:"GET",url:e.getListByEmployee+o,params:{language:"SPA"}}).then(function(e){var n=e.data.result.prospects,o={};n.forEach(function(e){e.idProspect===a&&(o=e)},this),t(o)})})},c.prototype.getOpportunityById=function(o){return t(function(t){n({method:"GET",url:e.getOpportunityById+o,params:{language:"SPA"}}).then(function(e){t(e.data.result)})})},c.prototype.updateContacted=function(o){return t(function(t,a){n({method:"POST",url:e.updateContacted,params:{idOpportunity:o,language:"SPA"}}).then(function(e){1===e.data.status?t(e.data):a(!1)})})},c.prototype.getCatalogSearch=function(){return t(function(t){n({method:"GET",url:e.getCatalogSearch,params:{language:"SPA"}}).then(function(e){t(e.data)})})},c.prototype.getTableProspects=function(o){return t(function(t){n({method:"GET",url:e.getTableProspects+o}).then(function(e){t(e.data.results)})})},c.prototype.prospecsPT=function(){return t(function(t,o){n({method:"GET",url:e.prospecsPT}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outTelephoneTypeCatalog):o(!0)})})},c.prototype.getProspectTPC=function(){return t(function(t,o){n({method:"GET",url:e.getProspectTPC}).then(function(e){1===e.data.status?t(e.data.result):o(null)})})},c.prototype.getProspectProfile=function(){return t(function(t,o){n({method:"GET",url:e.getProspectProfile}).then(function(e){e.data.length>0?t(e.data):o(null)})})},c.prototype.getPrincipalgraphics=function(o,a,r){return t(function(t,i){n({method:"GET",url:e.getProsGraphics+o+"/"+a+"/"+r,params:{language:"SPA"}}).then(function(e){1===e.data.status?t(e.data.payload):i(!1)})})},c.prototype.getProsReports=function(a,r,i){var s=o("date")(a,"MM-yyyy"),c="mes"===r?0:1;return t(function(t,o){n({method:"GET",url:e.getProsReports+s+"/"+c+"/"+i}).then(function(e){1===e.data.status?t(e.data.payload):o(!1)})})},c.prototype.getReportOpportunity=function(a,r){var i=o("date")(r,"MM/yyyy");return t(function(t,o){n({method:"GET",url:e.getOpportunityReport+a+"/"+i,params:{language:"SPA"}}).then(function(e){1===e.data.status?t(e.data):o(!1)})})},c.prototype.getReportOpportunityDetail=function(a,r){var i=o("date")(r,"MM/yyyy");return t(function(t,o){n({method:"GET",url:e.getReportOpportunityDetail+a+"/"+i,params:{language:"SPA"}}).then(function(e){1===e.data.status?t(e.data):o(!1)})})},c.prototype.getReportOpportunityDetailFC=function(a,r){var i=o("date")(r,"MM/yyyy");return t(function(t,o){n({method:"GET",url:e.getReportOpportunityDetailFC+a+"/"+i,params:{language:"SPA"}}).then(function(e){1===e.data.status?t(e.data):o(!1)})})},c.prototype.saveActivity=function(o){return t(function(t,a){function s(){n({method:"POST",url:e.saveActivity,data:$.param(o)}).then(function(e){1===e.data.status?t(e.data.payload):a(!1)}).catch(function(e){r("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),a({error:e.data})})}function c(e){a(e)}i.csrfValidate().then(s).catch(c)})},c.prototype.updateOpportunity=function(o,a){return t(function(t,s){function c(){n({method:"POST",url:e.updateOpportunity,data:$.param(d)}).then(function(e){t(1===e.data.status?{success:!0,data:e.data.messages[0].description}:{success:!1,data:e.data.messages[0].description})}).catch(function(e){r("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),s({error:e.data})})}function u(e){s(e)}i.csrfValidate().then(c).catch(u);var l="";8===o.stage.idStage?l="Cambio a Prospecto":9===o.stage.idStage?l="Cambio a Apertura":10===o.stage.idStage&&(l=o.lowMotive.text);var d={language:"SPA",idOpportunity:a,nameOpportunity:o.clientName,phone:o.phone,mail:o.email,idStage:o.stage.idStage,segment:o.segment.text,comment:l}})},c.prototype.removeActivity=function(o){return t(function(t,a){function r(){n({method:"POST",url:e.deleteActivity,data:$.param(o)}).then(function(e){1===e.data.status?t(e.data.payload):a(!1)})}function s(e){a(e)}i.csrfValidate().then(r).catch(s)})},c.prototype.updateActivity=function(o){return t(function(t,a){function s(){n({method:"POST",url:e.updateActivity,data:$.param(o)}).then(function(e){1===e.data.status?t(e.data.payload):a(!1)}).catch(function(e){r("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),a({error:e.data})})}function c(e){a(e)}i.csrfValidate().then(s).catch(c)})},c.prototype.completeActivity=function(o){return t(function(t,a){n({method:"POST",url:e.closeActivity,params:{idActivityStage:o,language:"SPA"}}).then(function(e){1===e.data.status?t(e.data.payload):a(!1)})})},c.prototype.generateDataChart=function(e,t){var n=u(e,t),o={chart:{data:n.options,percentage:n.percentage,cutoutPercentage:70,colors:["#00bebe","#f5f047"]},remaining:n.remaining};return t&&(o.chart.pieceLabel={fontFamily:"Proxima Semibold",mode:"value",fontSize:10,fontStyle:"bold",fontColor:"#0f3f88",arc:!0}),o},new c}e.$inject=["URLS","$q","$http","$filter","FileSaver","ErrorMessagesSrv","csrfSrv","userConfig"],angular.module("actinver.services").service("prospectSrv",e)}(),function(){"use strict";function e(e){e.state("simulators",{templateUrl:"/app/advisers/simulators/simulators.html",url:"/simulators",parent:"app",ncyBreadcrumb:{label:"Simuladores",parent:"app.dashboard"},redirectTo:"simulators.performance"}).state("simulators.performance",{templateUrl:"/app/advisers/simulators/performance/performance.html",url:"/performance",controller:"performanceCtrl",controllerAs:"per",ncyBreadcrumb:{label:"Rendimiento histórico"}}).state("simulators.details",{templateUrl:"/app/advisers/simulators/performance/details.html",url:"/details",params:{model:null},controller:"detailPerformCtrl",controllerAs:"detail",ncyBreadcrumb:{label:"Rendimiento"}}).state("simulators.credit",{templateUrl:"/app/advisers/simulators/credit/credit.html",controller:"creditCtrl",controllerAs:"credit",url:"/credit",ncyBreadcrumb:{label:"Crédito"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l,d){function m(e){2===e.length?d.detail({list:e,contract:h.contract}).result.then(function(){p(u.selectedContact.clientNumber)}):1===e.length&&p(e[0].clientNumber)}function p(e){s.getContractByAdviser(e).then(function(e){e.success?(o.operations.sclient.contracts_adviser=e.data.contract,g(e.data.client[0].clientNumber,e.data.client[0],e.data.contract)):i.error(e.msg)},function(e){var t;"not-found"===e.type?o.operations.showSystemError():(t=e.info.error.responseMessage?e.info.error.responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",i.error(t)),f()})}function f(){h.contracts_search={finish:!1,sent:!1},o.operations.sclient={},delete r.sclient}function g(e,t,c){n.getContractResume(e).then(function(u){h.exchange_rates=[],h.portfolio_totals=0,h.portfolio_totals=u.data.result.totalValue;var d=u.data.result.positionHousePercentage;angular.forEach(h.portfolioTable,function(e,t){h.portfolioTable[t].percent=d[e.topic]}),h.chart_info={chart:n.setChartInfo(h.portfolioTable)},localStorage.setItem("__chart",JSON.stringify(h.chart_info));var m=[];return angular.forEach(u.data.result.contract,function(t){var n=t.bankingArea;t="nosaldo"===e?"nosaldo":"nosaldo2"===e?"nosaldo"+t.contractNumber:t.contractNumber,"998"===n?m.push(s.getContractHistorical(t)):m.push(s.getBrokerHistoricalBalanceQuery(t,12))}),a.all(m).then(function(e){h.porfolio=u.data.result.contract;var n=[];angular.forEach(u.data.result.contract,function(e){R.forEach(function(t){t.contractNumber===e.contractNumber&&null!==e.portfolio&&(t.portfolio=e.portfolio,t.totalBalance=e.portfolio.totalFinal)},c)}),angular.forEach(e,function(e){e.historical&&n.push(e)});var a,i=[];h.contracts_search.finish=!0,o.operations.sclient.contracts_list=c,o.operations.sclient.balance=!0,h.colors_chart=[],R.forEach(function(e){var t=0;R.forEach(function(n){n.contractNumber===e.historical.contractNumber&&(n.totalBalance?(e.empty=!1,h.colors_chart.push(h.chart_line_colors[t])):e.empty=!0),t++},c),e.empty||i.push(e)},n),a=0===i.length||R.find(function(e){return e.empty},i),a&&(o.operations.sclient.checked_all_contracts=!0,o.operations.sclient.balance=!1),angular.forEach(i,function(e){if(e.historical&&e.historical.historicalInfo&&e.historical.historicalInfo.length>=1&&e.historical.historicalInfo.length<=11){for(var t=e.historical.historicalInfo.length,n=e.historical.historicalInfo[t-1],o=n.paymentPeriod.substring(0,4),a=n.paymentPeriod.substring(4,6),r=new Date(parseInt(o),parseInt(a-1),parseInt("01"));t<12;){r.setMonth(r.getMonth()-1),t++;var i=moment(r).format("YYYYMM");e.historical.historicalInfo.push({paymentPeriod:i,amount:null})}e.historical.historicalInfo.reverse()}}),"1"===t.personType?o.operations.sclient.data=t:(t.name=t.companyName,o.operations.sclient.data=t);for(var s=0;s<o.operations.sclient.contracts_list.length;s++)"998"===o.operations.sclient.contracts_list[s].bankingArea?o.operations.sclient.contracts_list[s].companyName="Casa":o.operations.sclient.contracts_list[s].companyName="Banco";o.operations.sclient.chart=i,r.sclient=o.operations.sclient}).catch(function(e){i.error(l.createError(e.data.messages))})},function(e){var t;"not-found"===e.type?o.operations.showSystemError():(h.portfolio_totals=0,t=e.result?e.result:"Se Encontró Un Error Favor De Intentarlo Más Tarde",i.error(t))})}var h=this;h.type_contract={id:0},o.operations.show_instructions=!0,h.search_types=s.search_types,h.contract_type=s.type_contract,h.person_type=s.type_person,h.contracts_search={finish:!1,sent:!1},h.portfolioTable=[{topic:"totalSD",name:"Fondos de Deuda",nom:"SD",abbr:"FD",totalDebtInstruments:0,percent:0,color:"#00bebe"},{topic:"totalSI",name:"Fondos de Renta Variable",nom:"SI",abbr:"RV",totalPledgedValues:0,percent:0,color:"#fa596d"},{topic:"totalSC",name:"Fondos de Cobertura",nom:"SC",abbr:"FC",notDefined2:0,percent:0,color:"#f9be00"},{topic:"totalMD",name:"Mercado de Dinero",nom:"MD",abbr:"MD",notDefined:0,percent:0,color:"#7ed321"},{topic:"totalMC",name:"Mercado de Capitales",nom:"MC",abbr:"MC",totalCapitalInstruments:0,percent:0,color:"#e21599"},{topic:"totalSettlementOperations",name:"Pendientes por Liquidar",nom:"OL",abbr:"OL",totalSettlementOperations:0,percent:0,color:"#ccc"},{topic:"totalBlockedBalance",name:"Efectivo en Tránsito",nom:"ET",abbr:"ET",totalBlockedBalance:0,percent:0,color:"#B39DDB"},{topic:"totalIP",name:"CEDES y Pagarés",nom:"IP",abbr:"IP",totalIP:0,percent:0,color:"#fa596d"},{topic:"totalVG",name:"Valores en Garantía",nom:"VG",abbr:"VG",totalVG:0,percent:0,color:"#00bebe"},{topic:"totalCash",name:"Efectivo",nom:"EF",abbr:"EF",totalCash:0,percent:0,color:"#3c86f6"}],function(){""!==localStorage.getItem("__chart")&&(h.chart_info=JSON.parse(localStorage.getItem("__chart")),r.sclient&&g(r.sclient.data.clientNumber,r.sclient.data,r.sclient.contracts_list))}(),h.clean=function(){h.client="",h.person={}},h.showDetail=function(t){var n={contractNumber:t.contractNumber,clientNumber:o.operations.sclient.data.clientNumber,bankingArea:t.bankingArea};s.getContractInfoDetail(n).then(function(t){e.open({templateUrl:"/app/operations/account/detail/detail-contract.html",controller:"detailContractCtrl",controllerAs:"detailContract",windowClass:"table-detail",resolve:{data:function(){return t}}})}).catch(function(){i.error("No se pudo consultar el detalle del contrato")})},h.chart_line_colors=s.displayChart(null).options.colors,h.cleanForm=function(){h.contract=null,h.client=null,h.person=null},h.submitSearch=function(){f(),h.contracts_search.sent=!0;h.type_contract.id;if(h.client)s.getContractByAdviser(h.client).then(function(e){e.success?(o.operations.sclient.contracts_adviser=e.data.contract,g(h.client,e.data.client[0],e.data.contract)):i.error(e.msg)},function(e){"not-found"===e.type?o.operations.showSystemError():i.error(l.createError(e.messages)),f()});else if(h.contract){var e=[];s.getClientInfo(h.contract,h.contract,999).then(function(t){t.info[0].areaType="Banco",e.push(t.info[0]),s.getClientInfo(h.contract,h.contract,998).then(function(t){t.info[0].areaType="Casa",e.push(t.info[0]),m(e)},function(){m(e)})},function(t){s.getClientInfo(h.contract,h.contract,998).then(function(t){t.info[0].areaType="Casa",e.push(t.info[0]),m(e)},function(e){i.error(t.info.error.responseMessage),f()})})}else if(h.person){var t;if(h.person.name){var n=h.person.name?h.person.name.toUpperCase():"";c.detail({list:[],wordToSearch:n,personType:"1"}).result.then(function(){s.getContractByAdviser(u.selectedClient.uniqueClientNumber).then(function(e){e.success?(o.operations.sclient.contracts_adviser=e.data.contract,g(e.data.client[0].clientNumber,e.data.client[0],e.data.contract)):i.error(e.msg)},function(e){var t;"not-found"===e.type?o.operations.showSystemError():(t=e.info.error.responseMessage?e.info.error.responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",i.error(t)),f()})})}else s.getClientName(h.person).then(function(e){e.info[0]?c.detail({list:e.info,wordToSearch:"",personType:"2"}).result.then(function(){s.getContractByAdviser(u.selectedClient.clientNumber).then(function(e){e.success?(o.operations.sclient.contracts_adviser=e.data.contract,g(e.data.client[0].clientNumber,e.data.client[0],e.data.contract)):i.error(e.msg)},function(e){var t;"not-found"===e.type?o.operations.showSystemError():(t=e.info.error.responseMessage?e.info.error.responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",i.error(t)),f()})}):(t="No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",i.error(t),f())},function(e){"not-found"===e.type?o.operations.showSystemError():(t=e.info.messages?e.info.messages[0].responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",i.error(t)),f()})}},h.contractSelection=function(e,n){var a={bankingArea:e.bankingArea,contractNumber:e.contractNumber,clientNumber:o.operations.sclient.data.clientNumber},r=n;e.isDinn=!1,"999"===e.bankingArea&&"MC"===n&&(r="CM"),s.getContractInfoDetail(a).then(function(t){"14"==t.contractType.contractID&&"02"==t.contractSubType.subtype&&(e.isDinn=!0)}).catch(function(){i.error("No se pudo obtener el detalle del contrato")}),localStorage.setItem("_marketType",JSON.stringify(r)),localStorage.setItem("contractSelected",JSON.stringify(e)),t.go("investment.funds")}}e.$inject=["$uibModal","$state","pResumeSrv","$scope","$q","$sessionStorage","CommonModalsSrv","accountSrv","accountModalSrv","$rootScope","ErrorMessage","accountContractModalSrv"],angular.module("actinver.controllers").controller("accountCtrl",e)}(),function(){"use strict";function e(e){e.state("account",{templateUrl:"/app/operations/account/account.html",url:"/account",controller:"accountCtrl",controllerAs:"account",parent:"operations",ncyBreadcrumb:{label:"Cuenta"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o){function a(e){return"<div class='operations-account-tp'><span>"+e.month+"</span><div>"+e.id+": "+o("currency")(e.amount)+"</div></div>"}function r(){for(var e=[],t=new Date,n=t.getMonth()+1,o=t.getFullYear()-1,a=1;a<=13;a++)e.push({paymentPeriod:n<10?o+"0"+n:o+""+n,amount:null}),n<12?n++:(n=1,o+=1);return e}var i=["#517cbd","#f5f047","#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac","#b77322","#16d620","#b91383","#f4359e","#9c5935","#a9c413","#2a778d","#668d1c","#bea413","#0c5922","#743411"],s={type:"string",role:"tooltip",p:{html:!0}},c={type_contract:[{id:999,text:"Banco"},{id:998,text:"Casa"}],type_person:[{text:"Física"},{text:"Moral"}],search_types:[{id:1,text:"Número de cliente único",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"10"}},{id:2,text:"Número de contrato",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"10"}},{id:3,text:"Nombre de cliente único",typeahead:!0,validation:{pattern:"",maxlength:"60"}}],displayChart:function(e){return{data:e,options:{colors:i,vAxis:{gridlines:{color:"#7fdade"},textStyle:{color:"#333333",fontSize:10,fontName:"Proxima Regular"}},hAxis:{textStyle:{color:"#333333",fontSize:10,fontName:"Proxima Regular"}},chartArea:{left:70,right:20,backgroundColor:{fill:"#f4f8ff"}}}}},getClientName:function(o){return t(function(t,a){n({method:"GET",url:e.getClientName,params:{language:"SPA",lastName:o.lastName?o.lastName.toUpperCase():" ",surname:(o.surname,""),name:o.name?o.name.toUpperCase():" ",companyName:o.companyName,personType:o.name?1:2,tIN:o.fiscalIDNumber}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outClientInfoQuery.clientList.client,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getContractByAdviser:function(o){return t(function(t,a){n({method:"GET",url:e.getContractByAdviser+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,data:e.data.result,msg:e.data.outCommonHeader.result.messages[0].responseMessage}:{success:!1,data:[],msg:e.data.outCommonHeader.result.messages[0].responseMessage})},function(){a({success:!1,type:"not-found",data:[],msg:"Ha ocurrido un error Interno"})})})},getClientInfo:function(o,a,r){return t(function(t,i){n({method:"GET",url:e.getClientInfo,params:{descripcion:a,typeQuery:o,language:"SPA",titularFlag:!0,bankingArea:r,contractNumber:1===o?"":a,clientNumber:1===o?a:""}}).then(function(e){var n,o;void 0!==e&&"ERROR"!==e.data.outCommonHeader.result.messages[0].responseCategory?(n=e.data.outClientOrContractClientInfoQuery.client,o=e.data.outClientOrContractClientInfoQuery.client[0].clientNumber,t({success:!0,info:n,clientId:o})):(e.data={error:{responseMessage:e.data.outCommonHeader.result.messages[0].responseMessage}},i({success:!1,info:e.data,type:"empty"}))},function(){i({success:!1,type:"not-found"})})})},getContracts:function(o,a){return t(function(t,r){n({method:"GET",url:e.getContracts,params:{language:"SPA",bankingArea:a||999,clientID:o}}).then(function(e){void 0!==e&&e.data.outContractsBalancesByPortfolioQuery?t({success:!0,contracts:e.data.outContractsBalancesByPortfolioQuery.contractInformation}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})},getContractHistorical:function(o){return t(function(t,a){n({method:"GET",url:e.getContractHistorical,params:{language:"SPA",contractNumber:'[{"idContrato":"'+o+'"}]'}}).then(function(e){if(1===e.data.outCommonHeader.result.result){var n=e.data.outBrokerMonthlyBalanceQuery.clients.client[0],o=!0,a=[];a=r(),angular.forEach(n.historicalInfo,function(e){o&&0!==e.amount&&(o=!1);for(var t=0;t<a.length;t++)a[t].paymentPeriod===e.paymentPeriod&&(a[t].amount=parseFloat(e.amount),t=a.length)}),n.historicalInfo=a,t({success:!0,historical:n,empty:o})}else t({success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getBrokerHistoricalBalanceQuery:function(o,a){return t(function(t,i){n({method:"GET",url:e.getBrokerHistoricalBalanceQuery+"/"+o+"/"+a,params:{language:"SPA"}}).then(function(e){if(1===e.data.outCommonHeader.result.result){var n,o=e.data.outBrokerHistoricalBalanceQuery.balanceFound,a=!0,i=[],s={};i=r(),angular.forEach(o,function(e){a&&0!==e.contractBalance&&(a=!1);for(var t=0;t<i.length;t++)i[t].paymentPeriod===e.period&&(i[t].amount=parseFloat(e.contractBalance),t=i.length);n=e.contractNumber}),s={contractNumber:n,historicalInfo:i},t({success:!0,historical:s,empty:a})}else t({success:!1,data:e.data.outCommonHeader.result})},function(){i({success:!1})})})},getBankContractBalance:function(o){return t(function(t,a){n({method:"GET",url:e.bankPortfolioQuery+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result&&null!==e.data.outBankPortfolioQuery.bankPortfolio?{success:!0,contractNumber:o,totalBalance:e.data.outBankPortfolioQuery.bankPortfolio.bankPortfolioElement[10].actualValue}:{success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getPortfolioGlobalDetailQuery:function(o){return t(function(t,a){n({method:"GET",url:e.getPortfolioGlobalDetailQuery+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,contractNumber:o,totalBalance:e.data.outPortfolioGlobalDetailQuery.totalValuation}:{success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},setInfo:function(e){for(var t=[],n=e[0].historicalInfo,r=0;r<=n.length;r++)if(0===r)t[r]=["Mes"];else{var i=n[r-1].paymentPeriod,u=parseInt(i.substr(0,4)),l=parseInt(i.substr(4,2)),d=new Date(u,l-1);t[r]=[o("date")(d,"MMM").toUpperCase()+"."+o("date")(d,"yy")]}for(var m=0;m<e.length;m++){t[0].push(e[m].contractNumber),t[0].push(s);for(var p=0;p<e[m].historicalInfo.length;p++){var f={id:e[m].contractNumber,month:t[p+1][0],amount:e[m].historicalInfo[p].amount};t[p+1].push(f.amount),t[p+1].push(a(f))}}return c.displayChart(t)},getContractInfoDetail:function(o){return t(function(t,a){n({method:"GET",
url:e.getContractInfoDetail+o.contractNumber+"/"+o.bankingArea,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t(e.data.outSimplifiedBankContractQuery.contract):a(e.data.outCommonHeader.result)},function(e){a(e)})})},getBankContractsByClientQuery:function(o,a,r){return t(function(t,i){n({method:"GET",url:e.getBankContractsByClientQuery+o+"/1/Modulo Asesor/"+a+"/"+r,params:{language:"SPA"}}).then(function(e){var n={success:!0,data:null,msg:e.data.outCommonHeader.result.messages[0].responseMessage};void 0!==e&&1===e.data.outCommonHeader.result.result?(n.data=e.data.outBankContractsByClientQuery,t(n)):(n.success=!1,t(n))},function(){i({success:!1,data:null,msg:"Error Interno"})})})}};return c}e.$inject=["URLS","$q","$http","$filter"],angular.module("actinver.controllers").service("accountSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){var e=JSON.parse(localStorage.getItem("contractSelected")),t=JSON.parse(localStorage.getItem("_marketType"));""!==e&&null!==t&&(l.contractS=e,"999"===l.contractS.bankingArea&&"MC"===t?t="CM":"998"===l.contractS.bankingArea&&"CM"===t&&(t="MC"),u(t))}function c(){var e=JSON.parse(sessionStorage["ngStorage-sclient"]),t="1"===e.data.personType?e.data.name+" "+e.data.lastName+" "+e.data.lastName:e.data.companyName,o={bankingArea:l.contract.bankingArea,clientNumber:l.contract.clientNumber,clientName:t,contractNumber:l.contract.contractNumber};n.outOfProfileContractQuery(o).then(function(e){e.data.outOutOfProfileContractQuery.outOfProfileContractFlag&&i.information()})}function u(e){l.contract=l.contractS,localStorage.setItem("contractSelected",JSON.stringify(l.contract)),l.iscuentapropia=l.contractS.isPropia,l.tabSelect=3,l.navInvestment=[];var a={contractNumber:l.contract.contractNumber,bankingArea:l.contract.bankingArea},i={businessType:"999"===l.contract.bankingArea?"01":"02",contractNumber:l.contract.contractNumber,marketType:"TD"};n.getContractSelection(a).then(function(a){1===a.data.outCommonHeader.result.result?n.getMarketValidation(i).then(function(n){if(c(),null!==n.data.outContractMarketValidation&&n.data.outContractMarketValidation.market&&1===n.data.outCommonHeader.result.result&&n.data.outContractMarketValidation.market.length){l.markets=n.data.outContractMarketValidation.market;var a=[];if(angular.forEach(l.markets,function(e){"SI"===e.marketType?a[0]=e.operativeFlag:"MD"===e.marketType?a[1]=e.operativeFlag:"CM"===e.marketType&&(a[2]=e.operativeFlag)}),r.viewMarketsByVisible=a,l.contract)switch(l.contract.bankingArea){case"998":switch(l.navInvestment=[{name:"Fondos de inversión",state:"investment.funds",shortname:"SI"},{name:"Mercado de dinero",state:"investment.money",shortname:"MD"},{name:"Mercado de capitales",state:"investment.capitals",shortname:"MC"}],e){case"SI":t.go("investment.funds");break;case"MD":t.go("investment.money");break;case"MC":t.go("investment.capitals");break;default:t.go("investment.funds")}break;case"999":switch(l.navInvestment=[{name:"Fondos de inversión",state:"investment.fundsBank",shortname:"SI"},{name:"Mercado de dinero",state:"investment.moneyBank",shortname:"MD"},{name:"Mercado de capitales",state:"investment.capitalsLumina",shortname:"CM"}],e){case"SI":t.go("investment.fundsBank");break;case"MD":t.go("investment.moneyBank");break;case"CM":t.go("investment.capitalsLumina");break;default:t.go("investment.fundsBank")}}l.getUrlPracticasV()}else o.error(n.data.outCommonHeader.result.messages[0].responseMessage),l.markets=null},function(){}):2===a.data.outCommonHeader.result.result?(o.error(a.data.outCommonHeader.result.messages[0].responseMessage),l.markets=null):(o.error(a.data.result),l.markets=null)}).catch(function(){})}var l=this;l.contract=null,l.tabSelect=null,l.markets=null,l.url=!1,l.loadContract=u,l.changeContract=function(e){localStorage.setItem("contractSelected",JSON.stringify(e)),s()},s(),angular.forEach(e.operations.sclient.contracts_adviser,function(t,n){e.operations.sclient.contracts_adviser[n].contractNumber=t.contractNumber}),l.contracts=R.map(function(e){return e.text=e.contractNumber,e},e.operations.sclient.contracts_adviser),l.selectedTab=function(e){localStorage.setItem("_marketType",JSON.stringify(e.shortname))},e.mostrarcapitales=!1,a.makeDataUser().then(function(t){console.log("_response.user.systemTO.profile",t.user.systemTO.profile),"local"!==t.user.systemTO.profile&&"qa"!==t.user.systemTO.profile||(e.mostrarcapitales=!0)}),e.filterfn=function(t){var n=!1;return"MC"===t.shortname&&"999"===l.contract.bankingArea?e.mostrarcapitales:(l.markets.forEach(function(e){e.marketType===t.shortname&&!0===e.operativeFlag&&(n=!0)}),n)},l.getUrlPracticasV=function(){l.url=!0,n.getUrlPracticasVenta(l.contract.contractNumber,l.contract.bankingArea).then(function(e){e&&(l.urlPracticaVenta=e.data.result.url,l.paramsPracticaVneta=e.data.result.params)},function(){})},e.goPV=function(){document.LANSA.action=l.urlPracticaVenta,document.LANSA.submit()},l.getMarkets=function(e){n.getMarketValidation(e).then(function(e){1===e.data.outCommonHeader.result.result&&null!==e.data.outContractMarketValidation&&e.data.outContractMarketValidation.market&&(l.markets=e.data.outContractMarketValidation.market)},function(){})}}e.$inject=["$scope","$state","investmentSrv","CommonModalsSrv","loginSrvc","$rootScope","outProfileSrv"],angular.module("actinver.controllers").controller("investmentCtrl",e)}(),function(){"use strict";function e(e){e.state("investment",{templateUrl:"/app/operations/investment/investment.html",url:"/investment",controller:"investmentCtrl",controllerAs:"investment",parent:"operations",data:{needClient:!0},ncyBreadcrumb:{label:"Inversiones"}}).state("investment.funds",{templateUrl:"/app/operations/investment/investment-society/funds.html",url:"/funds",controller:"fundsCtrl",controllerAs:"funds",data:{needClient:!0},ncyBreadcrumb:{label:"Fondos de inversión"}}).state("investment.capitals",{templateUrl:"/app/operations/investment/capitals/capitals.html",url:"/capitals",controller:"capitalsCtrl",controllerAs:"capitals",data:{needClient:!0},ncyBreadcrumb:{label:"Mercado de Capitales"}}).state("investment.money",{templateUrl:"/app/operations/investment/money/money.html",url:"/money",controller:"moneyCtrl",controllerAs:"money",data:{needClient:!0},ncyBreadcrumb:{label:"Mercado de Dinero"}}).state("investment.moneyBank",{templateUrl:"/app/operations/investment/money-bank/moneyBank.html",url:"/moneyBank",controller:"moneyBankCtrl",controllerAs:"moneyBank",data:{needClient:!0},ncyBreadcrumb:{label:"Mercado de Dinero"}}).state("investment.fundsBank",{templateUrl:"/app/operations/investment/investment-society-bank/fundsBank.html",url:"/fundsBank",controller:"fundsBankCtrl",controllerAs:"fundsBank",data:{needClient:!0},ncyBreadcrumb:{label:"Fondos de inversión"}}).state("investment.capitalsLumina",{templateUrl:"/app/operations/investment/capitals-lumina/capitals-lumina.html",url:"/capitalsLumina",controller:"capitalsLuminaCtrl",controllerAs:"capitalsLumina",data:{needClient:!0},ncyBreadcrumb:{label:"Mercado de Capitales"}}).state("investment.statementFiscal",{templateUrl:"/app/operations/investment/investment-statementFiscal/statement-fiscal.html",url:"/statementFiscal",controller:"statementFiscalCtrl",controllerAs:"statementFiscal",data:{needClient:!0},ncyBreadcrumb:{label:"Constancias Fiscales"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getDetailStations=function(n,o){return e({method:"get",url:t.getDetailStations+n+"/"+o+"?language=SPA"})},r.prototype.getUrlPracticasVenta=function(n,o){return e({method:"get",url:t.geturlpracticasventa+n+"/"+o+"?language=SPA"})},r.prototype.getStations=function(n,o){return e({method:"GET",url:t.getInvestmentSocietyRest+n+"/"+o+"/0/0/0/0?language=SPA"})},r.prototype.getStationsBank=function(n){return e({method:"GET",url:t.getFundBank+n+"/1/0?language=SPA"})},r.prototype.getPortfolioInvestment=function(n,o){return o=o||"SI",e("MC"===o?{method:"GET",url:t.getPortfolio+n+"/"+o+"?language=SPA"}:{method:"GET",url:t.getPortfolio+n+"/"+o+"?language=SPA"})},r.prototype.getPortfolioInvestmentLumina=function(o,a){a=a||"MC";var r=new Date,i=n("date")(r,"ddMMyyyy");if("MC"===a)return e({method:"POST",url:t.getAccionesLumina+"?language=SPA&contractNumber="+o+"&date="+i})},r.prototype.getOrders=function(o,a,r,i){var s,c,u,l=new Date;return a=void 0===a?"SI":a,r&&i?u=o+"/"+r+"/"+a+"/"+i+"?language=SPA&r="+Math.random():(s=n("date")(l,"ddMMyyyy"),c=n("date")(l,"ddMMyyyy"),u=o+"/"+s+"/"+a+"/"+c+"?language=SPA&r="+Math.random()),e({method:"GET",url:t.getOrders+u})},r.prototype.getOrdersLumina=function(o,a,r){r=void 0===r?new Date:new Date(r);var i=new Date(r),s=n("date")(i,"ddMMyyyy");return a=void 0===a?"SI":a,e({method:"POST",url:t.getOrdersLumina+"?language=SPA&contractNumber="+o+"&startDate="+s+"&endDate="+s})},r.prototype.getOrdersBank=function(n,o,a,r){var i=void 0===o?"1":o;return e({method:"GET",url:t.getOrdersBank+"/"+n+"/"+a+"/"+r+"/"+i+"/99",params:{language:"SPA"}})},r.prototype.getOrdersMoneyMarketBank=function(n,o,a){return e({method:"GET",url:t.getOrdersMoneyMarketBank,params:{language:"SPA",contractNumber:n,startDate:o,endDate:a,marketType:"MD"}})},r.prototype.getPortfolioInvestmentBank=function(n,o){return e({method:"GET",url:t.getPortfolioBank+n+"/"+o+"/0",params:{language:"SPA"}})},r.prototype.getPortfolioReportoBank=function(n,o){return e({method:"GET",url:t.getPortfolioReporto+n+"/"+o,params:{language:"SPA"}})},r.prototype.moreInfo=function(n,o){return e({method:"GET",url:t.getMoreInfo+n+"/"+o+"?language=SPA"})},r.prototype.moreInfoCapital=function(n,o){return e({method:"GET",url:t.getMoreInfoCapital+o+"/"+n+"?language=SPA"})},r.prototype.delete=function(n,r){var i={contractNumber:n,settlementType:"C",operationReference:r.order.orderReference};return a(function(n,a){function r(){e({method:"POST",url:t.cancellation,data:$.param(i),params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?n({success:!0,data:e.data}):a({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){a({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function s(e){a({success:!1,data:e.data})}o.csrfValidate().then(r).catch(s)})},r.prototype.deleteMarket=function(n){return a(function(a,r){function i(){e({method:"POST",url:t.cancellationMarket,params:{orderSubReference:"0",orderReference:n.order.orderReference,language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?a({success:!0,data:e.data}):r({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){r({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function s(e){r({success:!1,data:e.data})}o.csrfValidate().then(i).catch(s)})},r.prototype.deleteOrderLumina=function(n){var r;return r="DIRECTOS"===n.movementConcept?"FIXED_INCOME_ORDER":"REPORTO"===n.movementConcept?"REPO_ORDER":"EQUITY_ORDER",a(function(a,i){function s(){var o={language:"SPA",orderTypeDesc:r,orderID:n.orderReference||n.operationID};e({method:"POST",url:t.cancellationLumina,data:$.param(o)}).then(function(e){1===e.data.outCommonHeader.result.result?a({success:!0,data:e.data}):i({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){i({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function c(e){i({success:!1,data:e.data})}o.csrfValidate().then(s).catch(c)})},r.prototype.deleteStopLoss=function(n,r){var i={contractNumber:n,operationReference:r.share.operationReference,multiAccountManager:0};return a(function(n,a){function r(){e({method:"POST",url:t.cancellationStopLoss,data:$.param(i),params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?n({success:!0,data:e.data}):a({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){a({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function s(e){a({success:!1,data:e.data})}o.csrfValidate().then(r).catch(s)})},r.prototype.deleteDirectBuy=function(n){return a(function(a,r){function i(){e({method:"POST",url:t.deleteDirectBuy,params:{language:"SPA",operationReference:n.orderReference,transactionType:n.transactionType,consecutive:1,orderCancellationReason:""}}).then(function(e){1===e.data.outCommonHeader.result.result?a({success:!0,data:e.data}):r({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){r({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function s(e){r({success:!1,data:e.data})}o.csrfValidate().then(i).catch(s)})},r.prototype.deleteDirectSell=function(n,r){return a(function(a,i){function s(){e({method:"POST",url:t.deleteDirectSell,params:{language:"SPA",amount:n.amount,consecutive:1,operationReference:n.orderReference,orderCancellationReason:"",transactionType:n.transactionType,bankingArea:"001",contractNumber:r}}).then(function(e){1===e.data.outCommonHeader.result.result?a({success:!0,data:e.data}):i({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){i({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function c(e){i({success:!1,data:e.data})}o.csrfValidate().then(s).catch(c)})},r.prototype.deleteReportoBuy=function(n,r){return a(function(a,i){function s(){e({method:"POST",url:t.deleteReportoBuy,params:{language:"SPA",consecutive:1,operationReference:n.orderReference,orderCancellationReason:"",transactionType:n.transactionType,bankingArea:"001",contractNumber:r}}).then(function(e){1===e.data.outCommonHeader.result.result?a({success:!0,data:e.data}):i({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})}).catch(function(e){i({success:!1,data:e.data,message:e.data.outCommonHeader.result.messages})})}function c(e){i({success:!1,data:e.data})}o.csrfValidate().then(s).catch(c)})},r.prototype.getContractSelection=function(n){return e({method:"GET",url:t.getContractSelection+n.contractNumber+"/"+n.bankingArea+"?language=SPA"})},r.prototype.getMarketValidation=function(n){return e({method:"GET",url:t.getMarketValidation+n.businessType+"/"+n.contractNumber+"/"+n.marketType+"?language=SPA"})},r.prototype.outOfProfileContractQuery=function(n){return e({method:"GET",url:t.outOfProfileContractQuery+n.bankingArea+"/"+n.clientNumber+"/"+n.clientName+"/"+n.contractNumber+"?language=SPA"})},new r}e.$inject=["$http","URLS","$filter","csrfSrv","$q"],angular.module("actinver.services").service("investmentSrv",e)}(),function(){"use strict";function e(e,t,n,o){var a=this,r=["common","asset"],i=[];a.contracts={common:!1,asset:!1},angular.forEach(a.contracts,function(t,n){i.push(o.getAllContractsDetails(n,e.operations.sclient.contracts_list))}),t.all(i).then(function(e){var t=0;angular.forEach(e,function(e){var n=r[t];a.contracts[n]=e,t++})},function(t){var o;if(a.contracts={common:[],asset:[]},"not-found"===t.type)e.operations.showSystemError();else{var r=R.find(function(e){if("N"===e.responseType)return"ERROR"===e.responseCategory||"FATAL"===e.responseCategory})(t.data.outCommonHeader.result.messages);o=r?r.responseMessage:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk",n.error(o)}})}e.$inject=["$scope","$q","CommonModalsSrv","pDetailSrv"],angular.module("actinver.controllers").controller("pDetailCtrl",e)}(),function(){"use strict";function e(e,t,n){var o={getAllContractsDetails:function(e,n){var a=[];return angular.forEach(n,function(t){"Casa"===t.companyName?a.push(o.getContractDetail(e,t.contractNumber)):a.push(o.getContractDetailBank(t.contractNumber))}),t.all(a)},getContractDetailBank:function(o){return t(function(t,a){n({method:"GET",url:e.getContractDetailBank+o,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outFIXISSecuritiesPortfolioQuery.fundsList[0].fundPortfolioList}):a({success:!1,data:e.data,type:"empty"})},function(){a({success:!1,type:"not-found"})})})},getContractDetail:function(o,a){return t(function(t,r){n({method:"GET",url:e.getContractDetail+a.toString()+"/TM",params:{type:o,language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outPortfolioDetailQuery.details}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})},setTotals:function(e,t){return angular.forEach(e,function(e){for(var n=0;n<t.length;n++){var o=e.data.portfolioValue.portfolioValueByCurrency[n];t[n][1][0].totalDebtInstruments+=o.totalDebtInstruments,t[n][1][1].totalPledgedValues+=o.totalPledgedValues,t[n][1][2].totalCapitalInstruments+=o.totalCapitalInstruments,t[n][1][3].notDefined+=0,t[n][1][4].totalSettlementOperations+=o.totalSettlementOperations,t[n][1][5].totalCash+=o.totalCash,t[n][1][6].notDefined2+=0,t[n][1][7].totalPortfolioValue+=o.totalPortfolioValue}}),t},getPercentage:function(e,t){return(100*t/e).toFixed(2)}};return o}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("pDetailSrv",e)}(),function(){"use strict";function e(e,t){var n=this,o=e.sclient.data.clientNumber;n.topics=[{topic:"totalSD",name:"Fondos de Deuda",nom:"SD",abbr:"FD",totalDebtInstruments:0,percent:0},{topic:"totalSI",name:"Fondos de Renta Variable",nom:"SI",abbr:"RV",totalPledgedValues:0,percent:0},{topic:"totalMC",name:"Mercado de Capitales",nom:"MC",abbr:"MC",totalCapitalInstruments:0,percent:0},{topic:"totalMD",name:"Mercado de Dinero",nom:"MD",abbr:"MD",notDefined:0,percent:0},{topic:"totalSettlementOperations",name:"Órdenes por Liquidar",nom:"OL",abbr:"OL",totalSettlementOperations:0,percent:0},{topic:"totalCash",name:"Efectivo",nom:"EF",abbr:"EF",totalCash:0,percent:0},{topic:"totalDerivative",name:"Derivados",nom:"DV",abbr:"DV",notDefined2:0,percent:0},{topic:"totalPortfolioValue",totalPortfolioValue:0}],n.resume_credits=!1,t.getCreditsList(o).then(function(e){n.resume_credits=e.data.result.outBankClientLoansQuery.currentLoans.bankLoan},function(){n.resume_credits="no-data"}),n.resume_insurances=!1}e.$inject=["$sessionStorage","pResumeSrv"],angular.module("actinver.controllers").controller("portfolioCtrl",e)}(),function(){"use strict";function e(e){e.state("portfolio",{templateUrl:"/app/operations/portfolio/portfolio.html",url:"/portfolio",controller:"portfolioCtrl",controllerAs:"portfolio",parent:"operations",data:{needClient:!0},ncyBreadcrumb:{label:"Portafolio"},redirectTo:"portfolio.resume"}).state("portfolio.resume",{templateUrl:"/app/operations/portfolio/presume.html",url:"/resume",controller:"pResumeCtrl",controllerAs:"presume",data:{needClient:!0},ncyBreadcrumb:{label:"Resumen"}}).state("portfolio.detail",{templateUrl:"/app/operations/portfolio-detail/portfolio-detail.html",url:"/detail",controller:"portfoli-detail.controller",controllerAs:"pdetailCtrl",data:{needClient:!0},ncyBreadcrumb:{label:"Detalle"}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a){var r=this,i=e.portfolio.topics;r.clientNumber=a.sclient.data.clientNumber,r.topics=i,o.getContractResume(r.clientNumber).then(function(e){r.exchange_rates=[],r.portfolio_totals=0,r.portfolio_totals=e.data.result.totalValue;var t=e.data.result.positionHouseMN,n=e.data.result.positionHouseEUR,a=e.data.result.positionHouseDLLS,i=e.data.result.positionHousePercentage;r.totlaMXN=t.totalFinal,r.totalDLL=a.totalFinal,r.totalEUR=n.totalFinal,r.exchangeRateDLL=a.exchangeRate,r.exchangeRateEUR=n.exchangeRate;var s=[{topic:"totalSD",name:"Fondos de Deuda",nom:"SD",abbr:"FD",totalDebtInstruments:0,percent:0},{topic:"totalSI",name:"Fondos de Renta Variable",nom:"SI",abbr:"RV",totalPledgedValues:0,percent:0},{topic:"totalSC",name:"Fondos de Cobertura",nom:"SC",abbr:"FC",notDefined2:0,percent:0},{topic:"totalMD",name:"Mercado de Dinero",nom:"MD",abbr:"MD",notDefined:0,percent:0},{topic:"totalMC",name:"Mercado de Capitales",nom:"MC",abbr:"MC",totalCapitalInstruments:0,percent:0},{topic:"totalSettlementOperations",name:"Pendientes por Liquidar",nom:"OL",abbr:"OL",totalSettlementOperations:0,percent:0},{topic:"totalBlockedBalance",name:"Efectivo en Tránsito",nom:"ET",abbr:"ET",totalBlockedBalance:0,percent:0},{topic:"totalCash",name:"Efectivo",nom:"EF",abbr:"EF",totalCash:0,percent:0},{topic:"totalPortfolioValue",totalPortfolioValue:0}];angular.forEach(s,function(e,o){s[o].mn=t[e.topic],s[o].eur=n[e.topic],s[o].dlls=a[e.topic],s[o].percent=i[e.topic]}),r.portfolioTable=s,r.chart_info={chart:o.setChartInfo(r.portfolioTable)}},function(t){var o;"not-found"===t.type?e.operations.showSystemError():(r.portfolio_totals=0,o=t.result?t.result:"Se Encontró Un Error Favor De Intentarlo Más Tarde",n.error(o))})}e.$inject=["$scope","$q","CommonModalsSrv","pResumeSrv","$sessionStorage"],angular.module("actinver.controllers").controller("pResumeCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(e){return"<div class='operations-portfolio-tp "+o("lowercase")(e.abbr)+"'><span>"+e.name+"</span><br />"+e.percent+"%</div>"}var r=["#00bebe","#fa596d","#f9be00","#7ed321","#e21599","#ccc","#B39DDB","#3c86f6","#f5f047","#ff6f00"],i={type:"string",role:"tooltip",p:{html:!0}},s={displayChart:function(e){var t=[],n=[],o=[],a=[];return e.forEach(function(e,i){i>0&&e[1]>0&&(t.push(i),n.push(e[1]),o.push(r[i-1]),a.push(e[0]))}),{data:n,colors:o,cutoutPercentage:60,labels:a,pieceLabel:{mode:"label",fontFamily:"Proxima Semibold"},tooltips:{custom:!0,idxs:t,data:e}}},getContractResume:function(o){return t(function(t,a){n({method:"GET",url:e.getPortfolioResume+o,params:{language:"SPA"}}).then(function(e){1===e.data.status?t({success:!0,data:e.data}):a(e.data)},function(){a({success:!1,type:"not-found"})})})},setChartInfo:function(e){var t=[];return angular.forEach(e,function(e,n){var o=Number(e.percent)>0?Number(e.percent):0;0===n&&t.push(["Tarea","Porcentaje",i]),e.abbr&&t.push([e.abbr,o,a(e)])}),s.displayChart(t)},getCreditsList:function(o){return t(function(t,a){n({method:"GET",url:e.getCreditsList+o+"?language=SPA"}).then(function(e){1===e.data.status?t({success:!0,data:e.data}):a({success:!1,data:e.data,type:"empty"})},function(){a({success:!1,type:"not-found"})})})}};return s}e.$inject=["URLS","$q","$http","$filter"],angular.module("actinver.controllers").service("pResumeSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(e){e.show=!e.show}var i=this;i.showDetail=r,i.typeFundsFilter=["DEUDA","VARIABLE","COBERTURA"],function(){var n=e.operations.sclient.contracts_list,r=[],s=[];angular.forEach(n,function(e){if("Casa"===e.companyName){var n=[];t.detail(e.contractNumber).then(function(t){var o=[];angular.forEach(_.groupBy(t.data,"marketTypeDesc"),function(e){"1"===e[0].marketType&&angular.forEach(e,function(e){var t=""!==e.fundTypeDesc?e.fundTypeDesc:"SIN CLASIFICAR";o.push({title:t,emisora:e,show:!1})}),n.push({title:e[0].marketTypeDesc,marketType:e[0].marketType,ordersValue:e,fundsTypeDesk:o,show:!1})}),r.push({detail:n,contractNumber:e.contractNumber})}).catch(function(){})}else{var i=[];t.detailsBanks(e.contractNumber,"2").then(function(e){angular.forEach(_.groupBy(e.data,"valueTypeDesc"),function(e){i.push({title:"FONDOS DE INVERSIÓN",typeOp:"2",ordersValue:e})})}).catch(function(){});var c=a(new Date).format("YYYYMMDD");t.detailsBanksMoney(e.contractNumber,c).then(function(e){angular.forEach(_.groupBy(e.data,"valueTypeDesc"),function(e){i.push({title:"MERCADO DE DINERO",typeOp:"1",ordersValue:e})})}).catch(function(){});var c=o("date")(new Date,"ddMMyyyy");t.detailsBanksLumina(e.contractNumber,c).then(function(e){angular.forEach(_.groupBy(e.data,"valueTypeDesc"),function(e){i.push({title:"MERCADO DE CAPITALES",typeOp:"3",ordersValue:e})})}).catch(function(){}),s.push({detail:i,contractNumber:e.contractNumber})}}),i.detailBank=s,i.detail=r}(),i.resume_credits=!1,n.getCreditsList(e.operations.sclient.data.clientNumber).then(function(e){i.resume_credits=e.data.result.outBankClientLoansQuery.currentLoans.bankLoan},function(){i.resume_credits="no-data"})}e.$inject=["$scope","portfolioDetailService","pResumeSrv","$filter","moment"],angular.module("actinver.controllers").controller("portfoli-detail.controller",e)}(),function(){"use strict";function e(e,t,n){function o(o,a){return t(function(t,r){e({method:"GET",url:n.getPortfolioBank+o+"/"+a+"/0",params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outBankInvstFundsAndMMPositionsQuery.positions.positionInformation,contract:o}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})}function a(o,a){return t(function(t,r){return e({method:"GET",url:n.getPortfolioReporto+o+"/"+a,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outMoneyMarketIntradayPositionQuery.positionData,contract:o}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})}function r(o,a){return t(function(t,r){return e({method:"POST",url:n.getAccionesLumina+"?contractNumber="+o+"&date="+a,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outCapitalMarketPositionQuery.positionData,contract:o}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})}function i(o){return t(function(t,a){e({method:"GET",url:n.getContractDetail+o.toString()+"/TM",params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t({success:!0,data:e.data.outPortfolioDetailQuery.portfolios.portfolioDetail,contract:o}):a({success:!1,data:e.data,type:"empty"})}).catch(function(){a({success:!1,type:"not-found"})})})}return{detailsBanks:o,detailsBanksLumina:r,detailsBanksMoney:a,detail:i}}e.$inject=["$http","$q","URLS"],angular.module("actinver.controllers").service("portfolioDetailService",e)}(),function(){"use strict";function e(){function e(e){e.resetChilds=function(t,n){e.model.form[t]||delete e.model.form[n]}}return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/adviser-form/adviser-form.html",scope:{model:"="},link:e}}angular.module("actinver.directives").directive("adviserForm",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){"Casa"===m.cmd.contract.companyName?t.getBalance(m.cmd.contract.contractNumber).then(function(t){1===t.data.outCommonHeader.result.result?(e.transferLoading=!0,e.loadAccountsTransferNull=!1,m.dataContract=t.data.outCashByDate.cashSettlement[0].cashAmount,m.base=angular.copy(m.cmd.contract.contractNumber),l(m.cmd.contract.contractNumber)):(e.transferLoading=!1,e.loadAccountsTransferNull=!0,n.error(r.createError(t.data.outCommonHeader.result.messages)))}):i.bankContractBalance(m.cmd.contract.contractNumber,"001").then(function(t){1===t.data.outCommonHeader.result.result?(e.transferLoading=!0,e.loadAccountsTransferNull=!1,m.dataContract=t.data.outBankContractBalance.balanceData.availableBalance,m.base=angular.copy(m.cmd.contract.contractNumber),l(m.cmd.contract.contractNumber)):(e.transferLoading=!1,e.loadAccountsTransferNull=!0,n.error(r.createError(t.data.outCommonHeader.result.messages)))})}function c(){e.$ctrl.contract=m.cmd.contract.contractNumber,e.transferLoading=!0,m.cmd.transfer={bank:"01"},s()}function u(){e.spinnerTransfers=!0,t.getTransfers(m.cmd.contract.contractNumber,m.cmd.contract.companyName).then(function(t){1===t.data.outCommonHeader.result.result&&t.data.outContractMovementsQuery.movementsList.length>0?m.transfers=t.data.outContractMovementsQuery.movementsList:m.transfers=[],e.spinnerTransfers=!1},function(){m.transfers=[],e.$ctrl.showSystemError(),e.spinnerTransfers=!1})}function l(t){m.accounts=[],m.accounts=d(e.operations.sclient.contracts_list,t.contractNumber),e.transferLoading=!1,u()}function d(e,t){return e=e||[],R.map(function(e){if(e.contractNumber!==t)return e.text=e.contractNumber,e},e)}var m=this;m.title="Traspasos",m.pattern=a,m.viewTransactions=!0,m.cmd={transfer:{bank:"01"}},m.contracts=R.map(function(e){return e.text=e.contractNumber,e},e.operations.sclient.contracts_list),m.viewMoreDetail=o.detailTransfer,m.loadContract=c,function(){var e=JSON.parse(localStorage.getItem("contractSelected"));""!==e&&(m.cmd.contract=e,c())}(),m.makeTransfer=function(){m.cmd.typeTrans="1",o.accept(m.cmd).result.then(function(e){if(1===e.outCommonHeader.result.result){var t;e.outTransferExecution?t="La transferencia se realizó de manera correcta. <br> Con el folio de la operación <b>"+e.outTransferExecution.transferResult.operationReference+"</b>":e.outAdviserPendingOpRegistration&&(t="La transferencia se realizó de manera correcta. <br> Con el ID Solicitud <b>"+e.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),n.done(t).result.then(function(){m.cmd.transfer={bank:"01"},u(),s()})}else n.error(r.createError(e.outCommonHeader.result.messages))})}}e.$inject=["$scope","transfersSrv","CommonModalsSrv","transferModalSrv","REGEX","ErrorMessage","fundBankDollSrv"],angular.module("actinver.controllers").controller("myAccountsCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(t){var n=i.sclient.data.clientNumber;a.loadAccountsTransferNull=!1,e.getOtherAccounts(t,n).then(function(e){d.accounts=[],1===e.data.status?(d.accounts=l(e.data.result.bankAccountsListFilter),a.transferLoading=!1,u()):(a.transferLoading=!1,a.loadAccountsTransferNull=!0)},function(){a.$ctrl.showSystemError(),a.transferLoading=!1}).catch(function(e){var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),r.error(t)})}function u(){a.spinnerTransfers=!0,e.getTransfers(d.cmd.contract.text,d.cmd.contract.companyName).then(function(e){1===e.data.outCommonHeader.result.result&&e.data.outContractMovementsQuery.movementsList.length>0?d.transfers=e.data.outContractMovementsQuery.movementsList:d.transfers=[],a.spinnerTransfers=!1},function(){d.transfers=[],a.$ctrl.showSystemError(),a.spinnerTransfers=!1})}function l(e){e=e||[];var t=R.map(function(e){return e.text=(null!==e.alias&&""!==e.alias?e.alias+"-":"")+e.accountNumber,e.contractNumber=d.cmd.contract.contractNumber,e},e);return"Casa"===d.cmd.contract.companyName?"":t}var d=this;d.title="Transferencias",d.pattern=o,d.viewSPEI=!1,d.viewTransactions=!0,d.viewSPEITag=!0,d.cmd={transfer:{bank:"02"}},d.viewMoreDetail=n.detailTransfer,d.viewMoreDetailSPEI=n.detailTransferSPEI,a.contractso=R.map(function(e){if(e.text=e.contractNumber,"999"===e.bankingArea)return e},a.operations.sclient.contracts_list),d.makeTransfer=function(){d.cmd.typeTrans="2",n.accept(d.cmd).result.then(function(n){var o;1===n.outCommonHeader.result.result?(n.outTransferRequest?o="La transferencia se realizó de manera correcta. <br> Con el folio de la operación <b>"+n.outTransferRequest.transferResult.operationReference+"</b>":n.outBrokerSPEITransfer?o="La transferencia se realizó de manera correcta. <br> Con el folio de la operación <b>"+n.outBrokerSPEITransfer.transferResult.operationReference+"</b>":n.outTransferExecution?o="La transferencia se realizó de manera correcta. <br> Con el folio de la operación <b>"+n.outTransferExecution.transferResult.operationReference+"</b>":n.outAdviserPendingOpRegistration&&(o="La transferencia se realizó de manera correcta. <br> Con el ID Solicitud <b>"+n.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),r.done(o).result.then(function(){d.cmd.transfer={bank:"02"},u(),"Casa"===d.cmd.contract.companyName?e.getBalance(d.cmd.contract.text).then(function(e){d.dataContract=e.data.outCashByDate.cashSettlement[0].cashAmount,d.base=angular.copy(d.cmd.contract),c(d.cmd.contract)},function(){a.$ctrl.showSystemError(),a.transferLoading=!1}):t.bankContractBalance(d.cmd.contract.text,"001").then(function(e){
1===e.data.outCommonHeader.result.result&&(d.dataContract=e.data.outBankContractBalance.balanceData.availableBalance,d.base=angular.copy(d.cmd.contract),c(d.cmd.contract))},function(){a.$ctrl.showSystemError(),a.transferLoading=!1})})):r.error(s.createError(n.outCommonHeader.result.messages))})},d.loadContract=function(){a.$ctrl.contract=d.cmd.contract.contractNumber,a.transferLoading=!0,d.cmd.transfer={bank:"01"},"Casa"===d.cmd.contract.companyName?e.getBalance(d.cmd.contract.text).then(function(e){1===e.data.outCommonHeader.result.result?(a.transferLoading=!0,a.loadAccountsTransferNull=!1,d.dataContract=e.data.outCashByDate.cashSettlement[0].cashAmount,d.base=angular.copy(d.cmd.contract.contractNumber),c(d.cmd.contract.contractNumber)):(a.transferLoading=!1,a.loadAccountsTransferNull=!0,r.error(s.createError(e.data.outCommonHeader.result.messages)))}):t.bankContractBalance(d.cmd.contract.text,"001").then(function(e){1===e.data.outCommonHeader.result.result?(a.transferLoading=!0,a.loadAccountsTransferNull=!1,d.dataContract=e.data.outBankContractBalance.balanceData.availableBalance,d.base=angular.copy(d.cmd.contract),c(d.cmd.contract)):(a.transferLoading=!1,a.loadAccountsTransferNull=!0,r.error(s.createError(e.data.outCommonHeader.result.messages)))})},d.loadSPEI=function(){d.transfersSPEI=[],d.viewSPEI=!0,d.viewTransactions=!1,a.loadAccountsTransferNull=!1;var t={contractNumber:d.cmd.contract.text,bankingArea:"Banco"===d.cmd.contract.companyName?999:998,requirementFlag:0,language:"SPA"};e.getBankContractSPEIMovementsQuery(t).then(function(e){1===e.data.outCommonHeader.result.result&&(e.data.outBankContractSPEIMovementsQuery.speitransactionsList.length>0?d.transfersSPEI=e.data.outBankContractSPEIMovementsQuery.speitransactionsList:d.transfersSPEI=[])}).catch(function(e){var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),r.error(t)})},d.loadTransactions=function(){d.viewSPEI=!1,d.viewTransactions=!0}}e.$inject=["transfersSrv","fundBankDollSrv","transferModalSrv","REGEX","$scope","CommonModalsSrv","$sessionStorage","ErrorMessage"],angular.module("actinver.controllers").controller("otherAccountsCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;e.getMedia().then(function(e){var t=e.data.outContactMeansCatalog.contactMeansCatalogData.contactMeans,n=[];angular.forEach(t,function(e){"4"!==e.key&&"5"!==e.key&&n.push({id:e.key,text:e.description})}),o.Media=n}),o.showSystemError=t.systemError,n.contractso=R.map(function(e){return e.text=e.contractNumber,e},n.operations.sclient.contracts_list)}e.$inject=["transfersSrv","CommonModalsSrv","$scope"],angular.module("actinver.controllers").controller("transfersCtrl",e)}(),function(){"use strict";function e(e){e.state("transfers",{templateUrl:"/app/operations/transfers/transfers.html",url:"/transfers",controller:"transfersCtrl",controllerAs:"$ctrl",parent:"operations",redirectTo:"transfers.myAccounts",data:{needClient:!0},ncyBreadcrumb:{label:"Transferencias"}}).state("transfers.myAccounts",{controller:"myAccountsCtrl",controllerAs:"accounts",templateUrl:"/app/operations/transfers/accounts.html",url:"/myAccounts",data:{needClient:!0},ncyBreadcrumb:{label:"A cuentas actinver"}}).state("transfers.otherAccounts",{controller:"otherAccountsCtrl",controllerAs:"accounts",templateUrl:"/app/operations/transfers/accounts.html",url:"/otherAccounts",data:{needClient:!0},ncyBreadcrumb:{label:"A otras cuentas"}}).state("transfers.reports",{template:"<h2>h2</h2>",url:"/reports",data:{needClient:!0}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getBalance=function(t){return e({method:"GET",url:n.getBalance+t+"/0/1?language=SPA"})},r.prototype.getAccounts=function(t){return e({method:"GET",url:n.getAccounts+t+"/0/1/"})},r.prototype.makeTransfer=function(r,i,s,c){var u,l=a("date")(i,"yyyy/dd/MM"),d=a("date")(i,"HH:mm:ss"),m=r.contract.companyName,p=r.transfer.account.companyName,f=r.transfer.account.contractNumber;"Casa"===m&&"Casa"===p||"Banco"===m&&"Banco"===p?u="01":"Casa"===m&&"Banco"===p||"Banco"===m&&"Casa"===p?u="04":1===r.transfer.account.destinationAccountType?(u="02",f=r.transfer.account.accountNumber):(u="03",f=r.transfer.account.accountNumber);var g={Contrato:r.contract.contractNumber,Movimiento:"Retiro",Importe:r.transfer.import,Concepto:r.transfer.concepto};g=JSON.stringify(g);var h={businessType:"Casa"===r.contract.companyName?"02":"01",destinationAccountTypeID:u,clientID:s,contractNumber:r.contract.contractNumber,name:c,beneficiaryName:r.transfer.account.alias&&""!==r.transfer.account.alias?r.transfer.account.alias:r.transfer.account.beneficiaryName,destinationAccount:f,amount:r.transfer.import,currency:1,transferDetails:r.transfer.concepto,notificationFlag:0,comments:r.transfer.binnacle.observation,instructionDate:d,instructionTime:l,sPEIReference:"1",bankID:r.transfer.account.bankID,extensionNumber:"TELEFONO"===r.transfer.media.text?r.transfer.media.phone:null,tracingKey:r.transfer.media.id,jsonDetails:g};return t(function(t,a){function r(){e({method:"POST",url:n.makeTransfer,data:$.param(h)}).then(function(e){t(e.data)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},r.prototype.makeTransferOtherAccount=function(r,i,s,c){var u=a("date")(i,"ddMMyyyy"),l=a("date")(i,"HH:mm:ss"),d={Contrato:r.contract.contractNumber,Movimiento:"Retiro",Importe:r.transfer.import,Concepto:r.transfer.concepto};d=JSON.stringify(d);var m={contractNumber:r.contract.contractNumber,amount:r.transfer.import,CLABE:r.transfer.account.bankAccounts.clabe?r.transfer.account.bankAccounts.clabe:r.transfer.account.bankAccounts.accountNumber,observations:r.transfer.concepto,name:c,transactionDate:u,transactionTime:l,extensionNumber:"TELEFONO"===r.transfer.media.text?r.transfer.media.phone:null,key:r.transfer.media.id,comments:r.transfer.binnacle.observation,tracingKey:r.transfer.media.id,jsonDetails:d};return t(function(t,a){function r(){e({method:"POST",url:n.makeTransferOtherAccount,data:$.param(m)}).then(function(e){t(e.data)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},r.prototype.getOtherAccounts=function(t,o){var a="Casa"===t.companyName?"02":"01";return e({method:"GET",url:n.getOtherAccounts+a+"/"+o+"/"+t.contractNumber+"?language=SPA&accountStatus=1"})},r.prototype.getTransfers=function(t,o){var a="Casa"===o?"02":"01",r=new Date,i=r.getDate()<10?"0"+r.getDate():r.getDate(),s=r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,c=i+""+s+r.getFullYear();return e({method:"GET",url:n.getTransfers+t+"/"+c+"/"+c+"/"+a+"?language=SPA"})},r.prototype.getMedia=function(){return e({method:"GET",url:n.getMedia})},r.prototype.getMediaBnak=function(){return e({method:"GET",url:n.getMediaBank+"?language=SPA"})},r.prototype.getBankContractSPEIMovementsQuery=function(t){return e({method:"GET",url:n.getBankContractSPEIMovementsQuery,params:{contractNumber:t.contractNumber,bankingArea:t.bankingArea,requirementFlag:t.requirementFlag,language:"SPA"}})},new r}e.$inject=["$http","$q","URLS","csrfSrv","$filter"],angular.module("actinver.services").service("transfersSrv",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.details={finish:!1};var a={type:"profile",show_info:"",filter:""};n.getInfo(a).then(function(e){o.details=t.showInfo(e,1)},function(e){o.details=e})}e.$inject=["userConfig","binnacleInfo","binnacleReportsSrv"],angular.module("actinver.controllers").controller("binnacleWidgetCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/binnacle/binnacle.html",controller:"binnacleWidgetCtrl",controllerAs:"binnacleWidget"}}angular.module("actinver.directives").directive("binnacle",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}var r={BirthDays:t.getBirthDays,messages:t.getCurrentMessages};return a.prototype.getMessages=function(t,o){return n(function(n,a){e({method:"GET",url:r[t]+o,params:{language:"SPA"},ignoreLoadingBar:!0}).then(function(e){1===e.data.status?n(e.data.result):a()})})},a.prototype.getAppointments=function(o){return n(function(n,a){e({method:"POST",url:t.getAppointments,ignoreLoadingBar:!0,params:{language:"SPA"},data:$.param(o)}).then(function(e){1===e.data.status?n(e.data.result):a()}).catch(function(){a({error:"Ha ocurrido un error"})})})},a.prototype.getMessageDetail=function(a,r){return n(function(n,i){e({method:"POST",url:t.getMessageDetail,params:{language:"SPA"},data:$.param({idEmployee:a,idMessage:r})}).then(function(e){1===e.data.status?n(e.data.result[0]):(o(e.data.messages),i())}).catch(i)})},a.prototype.getClientDetail=function(n,o){var a=null;return"CB"===o?a="?bankingArea=998&clientNumber=&contractNumber="+n+"&descripcion=&language=SPA&titularFlag=true&typeQuery=2":"BANCO"===o&&(a="?bankingArea=999&clientNumber=&contractNumber="+n+"&descripcion=&language=SPA&titularFlag=true&typeQuery=2"),e.get(t.getClientInfo+a).then(function(e){return void 0!==e&&1===e.data.outCommonHeader.result.result?e&&e.data:e.data},function(){reject({success:!1,data:[],msg:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})})},new a}e.$inject=["$http","URLS","$q","ErrorMessagesSrv"],angular.module("actinver.services").service("CalendarSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/calendar/calendar.html",scope:!0,link:function(s){function c(e){s.appointmentFilterIsToday=!0;var t=a("date")(e,"yyyy-MM-dd"),r={languaje:"SPA",mail:o.user.mail,date:t,temp:""};n.getAppointments(r).then(function(e){s.appointments=e}).catch(function(){s.appointments=[]})}function u(e){return R.concat(R.concat(e.lastWeek,e.currentWeek),e.nextWeek)}function l(){n.getMessages("BirthDays",o.user.employeeID).then(function(e){s.birthdaysCurrentWeek=e.currentWeek,s.BirthDays=u(e)})}function d(){n.getMessages("messages",o.user.employeeID).then(function(e){s.messages=e})}s.appointmentFilterIsToday=!0,s.toggleAppointmentFilter=function(){s.appointmentFilterIsToday?(s.updateCalendar(),s.appointmentFilterIsToday=!s.appointmentFilterIsToday):s.updateCalendar()},s.isInAppointmentFilter=function(e){return"Today"===e.group&&s.appointmentFilterIsToday?e:"Today"!==e.group&&!1===s.appointmentFilterIsToday?e:void 0},s.updateCalendar=function(){c(s.dateCalendar)},s.addActivity=function(){i.open({templateUrl:"/scripts/modals/views/activity/add.html",controller:"addActivityCtrl",controllerAs:"activity",resolve:{title:function(){return"Agregar Actividades del día"},item:function(){}}}).closed.then(function(){s.updateCalendar()})},s.editActivity=R.curry(e.addActivity)("Editar Actividades del día"),s.notice=e.notice,s.deleteActivity=t.warning,s.showNotice=function(t){n.getMessageDetail(o.user.employeeID,t.idMessage).then(function(t){e.notice(t).closed.then(function(){d()})})},s.more=function(){s.mores=!0},s.close=function(){s.mores=!1},s.showClientInfo=function(e){var o="",a="";n.getClientDetail(e.contract,e.origen.trim()).then(function(n){if(2===n.outCommonHeader.result.result)return a=n.outCommonHeader.result.messages,angular.forEach(a,function(e){e.responseMessage&&(o+=e.responseMessage+"<br>")}),void t.error(o);n.outClientOrContractClientInfoQuery&&n.outClientOrContractClientInfoQuery.client&&0!=n.outClientOrContractClientInfoQuery.client.length&&0!=n.outClientOrContractClientInfoQuery.client[0].email.length?(e.email=n.outClientOrContractClientInfoQuery.client[0].email[0].email,e.phoneNumber=0!=n.outClientOrContractClientInfoQuery.client[0].telephoneData.length?Number(n.outClientOrContractClientInfoQuery.client[0].telephoneData[0].phoneNumber):"",r.showClientInfo(e)):t.error("No se encontró información del cliente.")},function(e){t.error(e.msg)}).finally(function(){})},function(){l(),d(),c(new Date),s.tooltip={data:!1}}()}}}e.$inject=["modalActivity","CommonModalsSrv","CalendarSrv","userConfig","$filter","binnacleModalSrv","$uibModal"],angular.module("actinver.directives").directive("actCalendar",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l,d,m,p){function f(e,t){x.tipoMedio.msg=e?"":t,x.tipoMedio.showMsg=!e}function g(e){var t,n=angular.copy(e);return"object"!=typeof n.issuer&&(t=n.issuer,n.issuer={issuerName:t,serie:n.serie}),n}function h(){e.$broadcast("select-emisora-toTable-cb",x.cmd.station)}function v(e){var t,n=e;return n.toUpperCase(),/MK/i.test(n)?(t=n.replace(/\D+/g,""),t=1e6*parseInt(t)):/K/i.test(n)?(t=n.replace(/\D+/g,""),t=parseInt(t),t*=1e3):t=x.cmd.order.model.titles,t}function y(){x.loading=!0,n.confirmStopLoss(w).then(function(e){x.captureModel=e,t.$emit("updateCapitalsTab");var n="La venta se realizó de manera correcta.";n+="<br>Con el folio de la operación <b>"+x.captureModel.stopLoss[0].shares.operationReference+"</b>",c.done(n)}).catch(function(e){x.loading=!1;var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),c.error(t)}).finally(function(){x.loading=!1})}function b(){u.getPortfolioInvestment(t.contract,"MC").then(function(e){1===e.data.outCommonHeader.result.result&&(k=e.data.outPortfolioDetailQuery.portfolios.portfolioDetail)})}function C(){void 0!==k&&(x.titlesForSell=R.find(function(e){return e.issuerName===x.cmd.station.issuer.issuerName&&x.cmd.station.issuer.serie===e.serie},k))}function S(){x.statusOrders={close:[],advance:[],basic:[],stops:[]},x.confirmationModel=!1,x.captureModel=!1,x.cmd={order:{options:{type:"any"},model:{term:1,maxPrice:"0"}}}}function D(){r.getMedia().then(function(e){var t=e.data.outContactMeansCatalog.contactMeansCatalogData.contactMeans,n=[];angular.forEach(t,function(e){"5"!==e.key&&n.push({id:e.key,text:e.description})}),x.Media=n}),P()}function M(){a.getCurrentCash(t.contract).then(function(t){1===t.data.outCommonHeader.result.result&&(x.currentCash=t.data.outA2KContractBalance.balance.buyingPowerData.cash48,e.currentCash=x.currentCash)}).finally(function(){x.loading=!1})}function A(){n.getOrderCatalog().then(function(e){E(e)}).catch(function(e){c.error(d.createError(e.result.messages)),x.statusOrders=null})}function P(){x.cmd.station=t.station,A()}function E(e){x.statusOrders=e.orderType,x.statusOrdersSell=[],x.statusRouting=e.stockMarketType,R.forEach(function(e){e.shortKey=e.orderType,e.description=e.orderDescription},e.orderType),R.forEach(function(e){x.statusOrdersSell.push(e)},x.statusOrders),x.statusOrdersSell.push({areaKey:1,key:"-1",shortKey:"TS",description:"TRAILING STOP"},{areaKey:1,key:"-1",shortKey:"SL",description:"STOP LOSS"})}function I(e){x.cmd.orderValidity=void 0,x.orderValidity=void 0,x.cmd.station&&C(),e&&(x.tab=null,x.cmd.media={}),x.newState=e,M(),x.cmd.order={options:{type:"any"},model:{term:1,maxPrice:x.cmd.order.model.maxPrice}}}function T(){i.getStations(t.contract,1,5).then(function(t){e.statiosnTable=t}).catch(function(){s.info("get stations error"),t.stations=[]}).finally(function(){})}var k,x=this,N=l.sclient.data.name+" "+l.sclient.data.lastName+" "+l.sclient.data.secondLastName;x.regex="\\d+MK|\\d+mk|\\d+mK|\\d+Mk|\\d+K|\\d+k|\\d";var w,O=JSON.parse(localStorage.getItem("contractSelected"));x.contractType=o.contractType(O.isPropia,O.isEligible,O.isDiscretionary),x.isPropia=O.isPropia,x.isEligible=O.isEligible,x.validateTitles=function(e,t){x.LPmessage=!1,x.VOmessage=!1,void 0!==e&&(("LP"===e.shortKey.trim()||"DC"===e.shortKey.trim())&&t<100?(x.LPmessage=!0,x.VOmessage=!1):("VO"===e.shortKey.trim()||"MA"===e.shortKey.trim())&&t<2e3&&(x.VOmessage=!0,x.LPmessage=!1))},x.tipoMedio={msg:"",showMsg:!1},x.onChangeTypeMedio=function(e,t){"4"===t.id?p.validateUserTokens().then(function(e){f(e.success,e.msg)}).catch(function(e){f(e.success,e.msg)}):f(!0,"")},x.cleanModels=function(){I(!1),x.cmd.station=null,x.cmd.priceStation=null,x.cmd.binnacle.comments=null},t.$watch("stations",function(){t.stations&&(x.stations=t.stations)}),e.$watch("actionStation",function(){e.actionStation&&"Casa"===e.actionStation.operationType&&(x.confirmationModel=null,x.loading=!0,x.AddStation(e.actionStation.station),x.changeTab(e.actionStation.type))}),x.getOrderValidity=function(e){x.cmd.orderValidity=void 0,x.orderValidity=void 0,"BMV"===e?e="1":"BIVA"===e?e="2":"0"==x.cmd.order.value.stockMarketValueType.trim()&&(e="0"),n.getOrderValidity(e,x.cmd.order.value.shortKey).then(function(e){var t=e.data.outOrderValidityQuery.orderType,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.businessKey})}),x.orderValidity=n})},x.changeOperationType=function(t){void 0!==e.actionStation?x.cmd.typeStock=e.actionStation.station.feed:x.cmd.typeStock="0","99"===t.stockMarketValueType&&"BMV"===x.cmd.typeStock?x.cmd.typeStock="1":"99"===t.stockMarketValueType&&"BIVA"===x.cmd.typeStock?x.cmd.typeStock="2":"99"===t.stockMarketValueType&&"SOR"===x.cmd.typeStock?x.cmd.typeStock="0":"2"===t.stockMarketValueType?x.cmd.typeStock="2":"1"===t.stockMarketValueType||"99"===t.stockMarketValueType?x.cmd.typeStock="1":"0"===t.stockMarketValueType&&(x.cmd.typeStock="0"),"SL"!==x.cmd.order.value.shortKey.trim()&&"TS"!==x.cmd.order.value.shortKey.trim()&&x.getOrderValidity(x.cmd.typeStock),x.showPrice=!1,x.showLimitPrice=!1,x.showVolume=!1,x.showVolMin=!1,x.cmd.operatorTypeRL=!1,x.cmd.operatorTypeRO=!1,"LP"!==x.cmd.order.value.shortKey.trim()&&"VO"!==x.cmd.order.value.shortKey.trim()&&"BQ"!==x.cmd.order.value.shortKey.trim()&&"ET"!==x.cmd.order.value.shortKey.trim()&&"EV"!==x.cmd.order.value.shortKey.trim()&&"PA"!==x.cmd.order.value.shortKey.trim()||(x.showPrice=!0),"PR"!==x.cmd.order.value.shortKey.trim()&&"MA"!==x.cmd.order.value.shortKey.trim()&&"MP"!==x.cmd.order.value.shortKey.trim()&&"LO"!==x.cmd.order.value.shortKey.trim()&&"MO"!==x.cmd.order.value.shortKey.trim()&&"PA"!==x.cmd.order.value.shortKey.trim()&&"XM"!==x.cmd.order.value.shortKey.trim()||(x.showLimitPrice=!0),"VO"!==x.cmd.order.value.shortKey.trim()&&"LO"!==x.cmd.order.value.shortKey.trim()||(x.showVolume=!0),"XM"===x.cmd.order.value.shortKey.trim()&&(x.showVolMin=!0),"BQ"!==x.cmd.order.value.shortKey.trim()&&"ET"!==x.cmd.order.value.shortKey.trim()&&"EV"!==x.cmd.order.value.shortKey.trim()&&"LO"!==x.cmd.order.value.shortKey.trim()&&"LP"!==x.cmd.order.value.shortKey.trim()&&"MC"!==x.cmd.order.value.shortKey.trim()&&"PA"!==x.cmd.order.value.shortKey.trim()&&"XM"!==x.cmd.order.value.shortKey.trim()&&"ML"!==x.cmd.order.value.shortKey.trim()||(x.cmd.operatorTypeRO=!0),"HC"!==x.cmd.order.value.shortKey.trim()&&"LO"!==x.cmd.order.value.shortKey.trim()&&"LP"!==x.cmd.order.value.shortKey.trim()&&"MA"!==x.cmd.order.value.shortKey.trim()&&"MC"!==x.cmd.order.value.shortKey.trim()&&"MP"!==x.cmd.order.value.shortKey.trim()&&"PA"!==x.cmd.order.value.shortKey.trim()&&"VO"!==x.cmd.order.value.shortKey.trim()&&"XM"!==x.cmd.order.value.shortKey.trim()&&"ML"!==x.cmd.order.value.shortKey.trim()||(x.cmd.operatorTypeRL=!0),!0===x.cmd.operatorTypeRO&&!0===x.cmd.operatorTypeRL?x.cmd.operatorType="RL":!0===x.cmd.operatorTypeRO?x.cmd.operatorType="RO":!0===x.cmd.operatorTypeRL&&(x.cmd.operatorType="RL")},x.AddStation=function(e){var t="0";e&&(x.cmd.station=g(e),e.issuer&&e.issuer.issuerName?(x.cmd.priceStation=e.lastPrice,x.cmd.order.model.maxPrice=e.tradeBuyPrice):(x.cmd.priceStation=e.weightedLastPrice,x.cmd.order.model.maxPrice=e.weightedLastPrice),C(),h(),"BMV"===e.feed?t="1":"BIVA"===e.feed&&(t="2"),x.cmd.typeStock=t)},x.modify=function(){x.confirmationModel=null},x.changeTab=function(e){x.tab=e,I(!1),x.cmd.evtentType=e,t.columnsExpand=!1,t.focusElement(),x.cmd.order.type="basic",x.dataListTipoOrdenesFilter=x.statusOrders,x.dataListTipoOrdenesFilterSell=x.statusOrdersSell;var n;if(n="sell"===x.tab?x.statusOrdersSell:x.statusOrders,n.length>0){var o=R.find(function(e){return"LP"===e.orderType},n);x.cmd.order.value=o,x.cmd.typeStock="1",x.getOrderValidity("1"),x.changeOperationType(o)}},x.confirm=function(){x.cmd.titlesMK=v(x.cmd.order.model.titles),x.loading=!0,"SL"===x.cmd.order.value.shortKey||"TS"===x.cmd.order.value.shortKey?(w={contractNumber:t.contract,coupon:0,issuerName:x.cmd.station.issuer.issuerName,serie:x.cmd.station.issuer.serie,movement:x.cmd.order.value.shortKey.trim(),lowerPercentage:"TS"===x.cmd.order.value.shortKey.trim()?x.cmd.order.model.floorPricePercentage:0,higherPercentage:"TS"===x.cmd.order.value.shortKey.trim()?x.cmd.order.model.ceilingPricePercentage:0,lowerPrice:"SL"===x.cmd.order.value.shortKey.trim()?x.cmd.order.model.floorPrice:0,higherPrice:"SL"===x.cmd.order.value.shortKey.trim()?x.cmd.order.model.ceilingPrice:0,stopType:"MA",sellingTitles:x.cmd.titlesMK,name:l.sclient.data.name+" "+l.sclient.data.lastName+" "+l.sclient.data.secondLastName},w=o.sendBinnacle(x.contractType,w,x.cmd),x.confirmationModel=w,x.loading=!1):n.confirmDoll(x.cmd,t.contract,N,x.contractType).then(function(e){x.confirmationModel=e.outCMOrderManagement.capitalMarketOrder}).catch(function(e){var t=R.find(function(e){if("N"===e.responseType)return"FATAL"===e.responseCategory||"ERROR"===e.responseCategory||"INFO"===e.responseCategory})(e),n=t?t.responseMessage:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk";c.error(n)}).finally(function(){x.loading=!1})},x.capture=function(){x.loading=!0,"SL"===x.cmd.order.value.shortKey||"TS"===x.cmd.order.value.shortKey?y():n.captureDoll(x.cmd,t.contract,N,x.confirmationModel,x.contractType).then(function(e){x.titlesMK=v(x.cmd.order.model.titles);var n,o=(x.cmd.priceStation*x.cmd.titlesMK).toFixed(2);"CMOrderManagement"===e.outCommonHeader.operationName?(x.captureModel={res:e.outCMOrderManagement.capitalMarketOrder,outCMOrderManagement:{capitalMarketOrder:{netAmount:o}}},n="La "+("buy"===x.tab?"compra":"venta")+" se envió  de manera correcta.",n+="<br>Con el folio de la operación <b>"+x.captureModel.res.operationReference+"</b>"):(x.captureModel=x.confirmationModel,n=e.outAdviserPendingOpRegistration.operationsDetails[0].message,n+="<br>Con el ID Registro <b>"+e.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),t.$emit("updateCapitalsTab"),c.done(n),x.confirmationModel=null,x.captureModel=null,I(!1),x.cmd.binnacle&&(x.cmd.binnacle={date:x.cmd.binnacle.date})}).catch(function(e){x.loading=!1;var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),c.error(t)}).finally(function(){x.loading=!1})},e.$on("select-emisora-toTable-changeTab-cb",function(){h()}),x.finish=function(){x.confirmationModel=null,x.captureModel=null,I(!1),x.cmd.binnacle={date:x.cmd.binnacle.date}},function(){S(),T(),D(),b()}()}e.$inject=["$rootScope","$scope","capitalsDollSrv","contractTypeSrv","moneyDollSrv","transfersSrv","TableStationsSrv","$log","CommonModalsSrv","investmentSrv","$sessionStorage","ErrorMessage","moment","loginSrvc"],angular.module("actinver.controllers").controller("capitalsDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){}function s(e,t){"LP"===e||"BQ"===e||"ET"===e||"EV"===e||"PA"===e?u=t.priceStation?t.priceStation:t.station.tradeSellPrice:"ML"===e||"PD"===e||"XM"===e||"MP"===e||"MC"===e||"MO"===e||"PR"===e||"MA"===e||"HC"===e||"LO"===e||"HC"===e||"DC"===e?u=0:"VO"===e&&(u=t.priceStation),c="VO"===e||"LO"===e?t.order.model.volOculto:0,d="XM"===e||"MINFI"===t.orderValidity.text?t.order.model.volMin:0,l="XM"===e||"PR"===e||"MA"===e||"MP"===e||"LO"===e||"PA"===e||"MO"===e||"MP"===e?t.order.model.maxPrice:0}var c,u,l,d;r("date")(new Date,"yyyy-MM-dd");return i.prototype.getOrderCatalog=function(){return n(function(n,o){e({method:"GET",url:t.getOrderCatalog+"?language=SPA"}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.outOrdersTypeQuery.orderTypeCatalogData):o(e.data.outCommonHeader)})})},i.prototype.confirmStopLoss=function(a){return n(function(n,r){function i(){e({method:"POST",url:t.confirmStopLoss,data:$.param(a)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.outStopLossTrailingStopRegistration):r(e.data.outCommonHeader.result.messages)}).catch(function(e){r(e)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},i.prototype.getOrderValidity=function(n,o){return e({method:"GET",url:t.getOrderValidity+o+"/"+n+"?language=SPA"})},i.prototype.confirmDoll=function(r,i,m,p){s(r.order.value.shortKey,r);var f={contractNumber:i,issuerName:r.station.issuer.issuerName,serie:r.station.issuer.serie,iMovement:"buy"===r.evtentType?1:2,orderType:r.order.value.shortKey,term:r.order.model.term,securities:r.titlesMK,price:u,priceLimit:l,percentage:c,hiddenVolume:c,minimumVolume:d,fillOrKill:"N",actionType:"1",agreementType:r.order.value.agreementType,brokerageID:r.typeStock,routing:r.operatorType,name:m,validityOrderTime:void 0!==r.order.options.time?r.order.options.time+":00":"00:00:00",validityType:r.orderValidity.id,jsonDetails:""};return f=a.sendBinnacle(p,f,r),n(function(n,a){function r(){e({method:"POST",url:t.confirmCapitalDoll,data:$.param(f)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data):a(e.data.outCommonHeader.result.messages)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},i.prototype.captureDoll=function(r,i,m,p){var f="";"buy"===r.evtentType?f="Compra":"sell"===r.evtentType&&(f="Venta");var g={Contrato:i,"Tipo de orden":f,Emisora:p.issuerName,Precio:p.price,"Títulos":p.titlesQty};g=JSON.stringify(g),s(r.order.value.shortKey,r);var h={contractNumber:i,issuerName:r.station.issuer.issuerName,serie:r.station.issuer.serie,iMovement:"buy"===r.evtentType?1:2,orderType:r.order.value.shortKey,term:r.order.model.term,securities:r.titlesMK,price:u,priceLimit:l,percentage:c,hiddenVolume:c,minimumVolume:d,fillOrKill:"N",actionType:"2",agreementType:r.order.value.agreementType,brokerageID:r.typeStock?r.typeStock:"0",routing:r.operatorType,name:m,validityOrderTime:void 0!==r.order.options.time?r.order.options.time+":00":"00:00:00",validityType:r.orderValidity.id,jsonDetails:g},v=JSON.parse(localStorage.getItem("contractSelected"));return p=a.contractType(v.isPropia,v.isEligible,v.isDiscretionary),h=a.sendBinnacle(p,h,r),n(function(n,a){function r(){e({method:"POST",url:t.confirmCapitalDoll,data:$.param(h)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data):a(e.data.outCommonHeader.result.messages)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},new i}e.$inject=["$http","URLS","$q","csrfSrv","contractTypeSrv","$filter"],angular.module("actinver.services").service("capitalsDollSrv",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#station").focus()},200)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/capitals-doll/capitals-doll.html",scope:{contract:"@",station:"=",ids:"="},controller:"capitalsDollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actCapitalsDoll",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/chart-tooltip/chart-tooltip.html",scope:{tooltipData:"="},link:function(e){function t(t){var o=document.getElementById(e.tooltipData.id),a=this._chart.canvas.offsetTop,r=this._chart.canvas.offsetLeft;return 0===t.opacity?void(o.style.opacity=0):(t.dataPoints&&(o.style.opacity=1,o.style.left=r+t.caretX+"px",o.style.top=a+t.caretY+"px",o.innerHTML=n.idxs?n.data[n.idxs[t.dataPoints[0].index]][2]:""),o)}var n=e.tooltipData;e.tooltipData.id=n.id||"chartjs-tooltip",n.custom=t}}}angular.module("actinver.directives").directive("chartTooltip",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){var e=JSON.parse(t.contract);r.getCommission(e.contractNumber).then(function(e){g.amount1=e.commissionPercentage+"0"})}function c(){r.getLastIPC().then(function(e){if(angular.isArray(e)&&e.length>0){var t=JSON.parse(JSON.stringify(e[0]));e.forEach(function(e){new Date(t.operationDate)<new Date(e.operationDate)&&(t=JSON.parse(JSON.stringify(e)))}),g.ipcFact.percentage=t.percentage,g.ipcFact.index=t.index}})}function u(){e.setDebug(function(e){o.debug(e)}),l()}function l(){var t=n.CapitalsWebSocket+"?access_token="+sessionStorage.getItem("__token");e.connect(t,{}).then(m,p)}function d(e){var t="B"===e.tendency?-1*e.percentage:e.percentage;return{index:e.index,percentage:t}}function m(){a(function(){e.subscribe("/topic/capitales/bmvIpcFacts",function(e){t.$apply(function(){var t=d(e);g.ipcFact.index=t.index,g.ipcFact.percentage=t.percentage})})},1e3)}function p(){a.cancel(f),i.is("investment.capitals")&&(f=a(l,3e3),o.info("STOMP: Reconecting in 3 seconds"))}var f,g=this;g.ipcFact={},t.$on("disconnectCapitals",function(){e.disconnect().then(function(){})}),function(){s(),c(),u()}()}e.$inject=["$stomp","$scope","URLS","$log","$timeout","capitalsIpcSrv","$state"],angular.module("actinver.controllers").controller("capitalsIpcCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getLastIPC=function(){return n(function(n,o){e({method:"POST",url:t.getLastIPC+"?language=SPA"}).then(function(e){try{1===e.data.outCommonHeader.result.result?n(e.data.outStockMarketIndexQuery.stockMarketIndexTuple):o(e.data.outCommonHeader.messages)}catch(e){console.log("reference error: "+e)}})})},o.prototype.getCommission=function(o){return n(function(n,a){e({method:"GET",url:t.getCommission+o+"?language=SPA"}).then(function(e){try{1===e.data.outCommonHeader.result.result?n(e.data.outContractCommissionAndValuationQuery):a(e.data.outCommonHeader.messages)}catch(e){console.log("reference error: "+e)}})})},o.prototype.getCommission34=function(o){return n(function(n,a){e({method:"GET",url:t.getCommission34+o+"?language=SPA"}).then(function(e){e.data&&e.data.outCapitalBandCatalog.capitalBand?n(e.data.outCapitalBandCatalog.capitalBand):a(e.data.outCommonHeader.messages)})})},new o}e.$inject=["$http","URLS","$q"],angular.module("actinver.services").service("capitalsIpcSrv",e)}(),function(){"use strict";function e(){return{restrict:"A",replace:!0,scope:{contract:"@"},templateUrl:"/scripts/directives/capitals-ipc/ipc.html",controller:"capitalsIpcCtrl",controllerAs:"ipc"}}angular.module("actinver.directives").directive("capitalsIpc",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c){function u(e,t){M.tipoMedio.msg=e?"":t,M.tipoMedio.showMsg=!e}function l(){t.$broadcast("select-emisora-toTable",M.cmd.station)}function d(e){var t,n=angular.copy(e);return"object"!=typeof n.issuer&&(t=n.issuer,n.issuer={issuerName:t,serie:n.serie}),n}function m(){void 0!==t.capitalsPortfolioBank&&(M.titlesForSell=R.find(function(e){if(void 0!==M.cmd.station)return M.cmd.station.weightedLastPrice?e.instrumentDesc.operationType===M.cmd.station.issuer.issuerName:e.instrumentDesc.operationType===M.cmd.station.instrumentDesc},t.capitalsPortfolioBank))}function p(){M.loading=!0;var t=s.sclient.data.name+" "+s.sclient.data.lastName+" "+s.sclient.data.secondLastName;n.confirmStopLoss(M.cmd,e.contract,t).then(function(t){M.captureModel=t,e.$emit("updateCapitalsTab");i.done("La venta se envió de manera correcta.")}).catch(function(e){M.loading=!1;var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),i.error(t)}).finally(function(){M.loading=!1})}function f(){M.statusOrders={close:[],advance:[],basic:[],stops:[]},M.confirmationModel=!1,M.captureModel=!1,M.cmd={order:{type:"basic",options:{type:"any"}}},M.dataListTipoOrdenesFilter=M.statusOrders[M.cmd.order.type],M.cmd.libroomesa="Book",M.elegible=P.isEligible}function g(){n.getMediaBank().then(function(e){var t=e.data.result,n=[];angular.forEach(t,function(e){"5"!==e.key&&n.push({id:e.identifier,text:e.instructionTypeDescription})}),M.Media=n}),e.iscuentapropia&&(M.cmd.media={type:{id:"7",text:"E-MAIL"}})}function h(){var t=null;n.bankContractBalance(e.contract,M.bankingArea).then(function(e){1===e.data.outCommonHeader.result.result?(t=e.data.outBankContractBalance.balanceData,M.balance=t):(i.error(o.createError(e.data.outCommonHeader.result.messages)),M.newStateInit=!0,M.confirmationModel=!1,M.loading=!1)}).catch(function(e){i.error(o.createError(e.data.outCommonHeader.result.messages)),M.newStateInit=!0,
M.confirmationModel=!1,M.loading=!1})}function v(){var t=[];M.cmd.station&&n.getOrderCatalog(M.cmd.station,e.contract,M.bankingArea).then(function(e){t=e,b(t)}).catch(function(e){var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),i.error(t)})}function y(){a.getStationsLumina(e.contract,e.ids.val1,"EQUITY","B").then(function(e){t.statiosnTableBank=e}).catch(function(){r.info("get stations error"),e.stations=[]})}function b(e){M.statusOrders.basic=[],R.forEach(function(e){var t=R.find(R.propEq("value",e.shortKey.trim()))(A);t&&M.statusOrders[t.type].push(e)},e),M.dataListTipoOrdenesFilter=M.statusOrders[M.cmd.order.type],S()}function C(e){M.stepA=!1,e&&(M.cmd.media={}),m(),v(),M.newState=e,h(),M.montoaprox=null,M.cmd.order={type:"basic",model:{term:1,titles:null},options:{type:"any"}},M.dataListTipoOrdenesFilter=M.statusOrders[M.cmd.order.type],S()}function S(){"SIC"===e.ids.text&&(M.cmd.order.value=M.dataListTipoOrdenesFilter[0])}function D(){a.getOptionsTypeOperation().then(function(e){M.listTypeOperation=e}).catch(function(){M.listTypeOperation=[]})}var M=this,A=[{value:"LP",type:"basic"},{value:"MC",type:"basic"}];M.stepA=!0,M.bankingArea="999";var P=JSON.parse(localStorage.getItem("contractSelected"));e.iscuentapropia=P.isPropia,M.listTypeOperation=[],M.tipoMedio={msg:"",showMsg:!1},function(){M.stepA=!0,f(),g(),h(),m(),y(),D()}(),t.$on("select-emisora-toTable-changeTab",function(){l()}),M.changeSelect=function(){M.dataListTipoOrdenesFilter=M.statusOrders.basic,M.cmd.order.model={term:1}},M.cleanModels=function(){f(),C(!1),u(!0,"")},M.recalcularMontoAprox=function(){M.montoaprox=M.cmd.order.model.titles*M.cmd.priceStation},M.changeOrdeType=function(){M.cmd&&M.cmd.order&&M.cmd.order.value&&3!==M.cmd.order.value.key&&"Desk"===M.cmd.libroomesa&&(M.cmd.order.orderTypeOperation=null),M.recalcularMontoAprox()},t.$watch("actionStation",function(){t.actionStation&&"Banco"===t.actionStation.operationType&&(M.confirmationModel=null,M.loading=!1,M.AddStation(t.actionStation.station),e.contract=t.actionStation.contract,M.changeTab(t.actionStation.type))}),M.changeTime=function(){e.time=!0,parseInt(M.cmd.order.model.term)>1&&(e.time=!1)},M.AddStation=function(e){e&&(M.cmd.typeStock="0",M.cmd.station=d(e),M.cmd.priceStation=void 0!==e.tradeBuyPrice?e.lastPrice:e.weightedLastPrice,M.cmd.ultimoecho=e.lastPrice,M.cmd.evtentType=M.tab,M.cmd.modify=e.modify,M.cmd.orderReference=e.orderReference,m())},M.AddStationfromdoll=function(e){M.AddStation(e),l(),v()},M.modify=function(){M.confirmationModel=null},M.changeTab=function(t){M.tab=t,C(!1),M.cmd.evtentType=t,e.columnsExpand=!1,e.focusElement()},M.cambioBolsaOperar=function(e){if(M.typeStock=e.feed,M.montoaprox="SOR"===e?M.montoaprox:null,t.statiosnTableBank&&M.cmd.station){var n=t.statiosnTableBank.filter(function(t){return t.issuer.issuerSerie===M.cmd.station.issuer.issuerSerie&&t.feed===e});n&&n.length>0&&M.AddStationfromdoll(n[0])}},M.confirm=function(){M.loading=!0,"stops"===M.cmd.order.type?p():n.confirmDoll(M.cmd,e.contract).then(function(e){M.confirmationModel=e}).catch(function(e){var t=null;t=e.length>=2?e[1]:R.find(function(e){if("N"===e.responseType||"T"===e.responseType)return"FATAL"===e.responseCategory||"ERROR"===e.responseCategory||"INFO"===e.responseCategory})(e);var n=null!==t?t.responseMessage:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk";i.error(n)}).finally(function(){M.loading=!1})},M.capture=function(){M.loading=!0,n.captureDoll(M.cmd,e.contract).then(function(t){var n,o=(M.cmd.priceStation*M.cmd.order.model.titles).toFixed(2);"CMEquityOrderRegistration"===t.outCommonHeader.operationName?(M.captureModel={res:t.outCMEquityOrderRegistration.orderDetail,CMEquityOrderRegistration:{orderDetail:{netAmount:o}}},n="Orden enviada con folio: "+t.outCMEquityOrderRegistration.orderDetail.orderID,h()):(M.captureModel=M.confirmationModel,n=t.outAdviserPendingOpRegistration.operationsDetails[0].message,n+="<br>Con el ID Registro <b>"+t.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),e.$emit("updateCapitalsTab"),i.done(n),M.confirmationModel=null,M.captureModel=null,C(!1),M.cmd.binnacle={date:M.cmd.binnacle.date}}).catch(function(e){M.loading=!1;var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),i.error(t)}).finally(function(){M.loading=!1})},M.finish=function(){M.confirmationModel=null,M.captureModel=null,C(!1),M.cmd.binnacle={date:M.cmd.binnacle.date}},M.onChangeTypeMedio=function(e,t){"10"===t.id?c.validateUserTokens().then(function(e){u(e.success,e.msg)}).catch(function(e){u(e.success,e.msg)}):u(!0,"")}}e.$inject=["$scope","$rootScope","capitalsLuminaDollSrv","ErrorMessage","TableStationsSrv","$log","CommonModalsSrv","$sessionStorage","loginSrvc"],angular.module("actinver.controllers").controller("capitalsLuminaDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}function i(e,t){"LP"===e?c=t.priceStation?t.priceStation:t.station.tradeSellPrice:"MC"===e||"PR"===e||"MA"===e||"MP"===e||"LO"===e||"HC"===e||"DC"===e?c=0:"MO"===e?c=t.order.model.maxPrice:"VO"===e&&(c=t.priceStation),s="VO"===e||"LO"===e?t.order.model.volOculto:0,u="PR"===e||"MA"===e||"MP"===e||"LO"===e?t.order.model.maxPrice:0}var s,c,u;return r.prototype.getOrderCatalog=function(o,a,r){var i,s;return o.issuer.issuerSerie?(s=o.issuer.issuerName,i=o.issuer.serie):(s=o.issuerName,i=o.serie),n(function(n,o){e({method:"GET",url:t.getOrdertypeCatalog+s+"/"+i+"/"+a+"/"+r+"?language=SPA"}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.result):o(e.data.outCommonHeader)})})},r.prototype.bankContractBalance=function(n,o){return e({method:"GET",url:t.bankContractBalance+n+"/"+o,params:{language:"SPA"}})},r.prototype.getClientElegible=function(n,o){return e({method:"GET",url:t.getClientElegible+n+"/"+o,params:{language:"SPA"}})},r.prototype.confirmStopLoss=function(r,i,s){var c={contractNumber:i,coupon:0,issuerName:r.station.issuer.issuerName,serie:r.station.issuer.serie,movement:r.order.value.shortKey.trim(),lowerPercentage:"TS"===r.order.value.shortKey.trim()?r.order.model.floorPricePercentage:0,higherPercentage:"TS"===r.order.value.shortKey.trim()?r.order.model.ceilingPricePercentage:0,lowerPrice:"SL"===r.order.value.shortKey.trim()?r.order.model.floorPrice:0,higherPrice:"SL"===r.order.value.shortKey.trim()?r.order.model.ceilingPrice:0,stopType:"MA",sellingTitles:r.order.model.titles,name:s,instructionDate:a(r.date).format("DDMMYYYY"),instructionTime:"TELEFONO"===r.media.type.text?r.binnacle.time+":00":null,extensionNumber:"TELEFONO"===r.media.type.text?r.binnacle.phone:null,tracingKey:r.media.type.id,comments:r.binnacle.comments};return n(function(n,a){function r(){e({method:"POST",url:t.confirmStopLoss,data:$.param(c)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.outStopLossTrailingStopRegistration):a(e.data.outCommonHeader.result.messages)}).catch(function(e){a(e)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},r.prototype.confirmDoll=function(r,i){var s={requestType:r.media.type.id,language:"SPA",clientID:i,clientTypeID:"CLIENT_ID",eventID:"ADD",action:"VALIDATE",legalEntity:"BCO ACTINVER",operationType:"buy"===r.evtentType?"B":"S",orderType:"Single",destination:r.libroomesa,motive:"",market:"SOR",equityOrderType:"Lot",instrumentID:r.station.instrumentDesc?r.station.instrumentDesc:r.station.issuer.issuerName,instrumentType:"SHORT_NAME",titlesQty:r.order.model.titles,comments:a(r.binnacle.date).format("YYYY-MM-DD")+" | "+r.media.type.text+" "+("10"===r.media.type.id?r.binnacle.phone+" "+r.binnacle.time:" ")+" | "+r.binnacle.comments,clientIDD:"CLIENT_01",quantity:0,fillOrKillFlag:!(!r.order.orderTypeOperation||1!==r.order.orderTypeOperation.id),executionFlag:!(!r.order.orderTypeOperation||2!==r.order.orderTypeOperation.id),jsonDetails:""};return"MC"!==r.order.value.shortKey&&(s.titlePrice=r.priceStation),n(function(n,a){function r(){e({method:"POST",url:t.confirmCapitalDollLumina,data:$.param(s)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data):a(e.data.outCommonHeader.result.messages)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},r.prototype.captureDoll=function(r,s){var c="";"buy"===r.evtentType?c="Compra":"sell"===r.evtentType&&(c="Venta");var u={Contrato:s,Movimiento:c,"Tipo de orden":r.order.value.description,Emisora:r.station.instrumentDesc?r.station.instrumentDesc:r.station.issuer.issuerName,Precio:"MC"!==r.order.value.shortKey?r.priceStation:"0.0","Títulos":r.order.model.titles,Plazo:1};i(r.order.value.shortKey.trim(),r);var l={requestType:r.media.type.id,language:"SPA",clientID:s,clientTypeID:"CLIENT_ID",eventID:"ADD",action:"SAVE",legalEntity:"BCO ACTINVER",operationType:"buy"===r.evtentType?"B":"S",orderType:"Single",destination:r.libroomesa,motive:"",market:"SOR",equityOrderType:"Lot",instrumentID:r.station.instrumentDesc?r.station.instrumentDesc:r.station.issuer.issuerName,instrumentType:"SHORT_NAME",titlesQty:r.order.model.titles,comments:a(r.binnacle.date).format("YYYY-MM-DD")+" | "+r.media.type.text+" "+("1"===r.media.type.id?r.binnacle.phone+" "+r.binnacle.time:" ")+" | "+r.binnacle.comments,clientIDD:"CLIENT_01",quantity:1500,fillOrKillFlag:!(!r.order.orderTypeOperation||1!==r.order.orderTypeOperation.id),executionFlag:!(!r.order.orderTypeOperation||2!==r.order.orderTypeOperation.id),jsonDetails:JSON.stringify(u)};return"MC"!==r.order.value.shortKey&&(l.titlePrice=r.priceStation),n(function(n,a){function r(){e({method:"POST",url:t.confirmCapitalDollLumina,data:$.param(l)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data):a(e.data.outCommonHeader.result.messages)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},r.prototype.getMediaBank=function(){return e({method:"GET",url:t.getMediaBank+"?language=SPA"})},new r}e.$inject=["$http","URLS","$q","csrfSrv","moment"],angular.module("actinver.services").service("capitalsLuminaDollSrv",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#station").focus()},200)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/capitals-lumina-doll/capitals-lumina-doll.html",scope:{contract:"@",station:"=",ids:"=",iscuentapropia:"="},controller:"capitalsLuminaDollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actCapitalsLuminaDoll",e)}(),function(){"use strict";function e(){function e(e){var t={layout:{padding:{top:20}},animation:{duration:0,onComplete:function(){var e=this.chart,t=e.ctx;t.font=Chart.helpers.fontString(12,"normal","Proxima Semibold"),t.fillStyle="#0e539a",t.textAlign="center",t.textBaseline="bottom",this.data.datasets.forEach(function(n,o){e.controller.getDatasetMeta(o).data.forEach(function(e,o){var a=n.data[o]+"%";t.fillText(a,e._model.x,e._model.y-2)})})}},hover:!1,tooltips:{enabled:!1},scales:{xAxes:[{categoryPercentage:1,barPercentage:.75,gridLines:{display:!1,zeroLineColor:"#9b9b9b"},ticks:{fontSize:9,fontFamily:"'Proxima Regular'",fontColor:"#0f3f88"}}],yAxes:[{display:!1,ticks:{beginAtZero:!0}}]},elements:{rectangle:{borderWidth:0}}};return angular.merge({},t,e)}function t(t){t.chartSettings=e(t.model.chart)}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/charts/column-bar.html",link:t,scope:{model:"="}}}angular.module("actinver.directives").directive("columnBarChart",e)}(),function(){"use strict";function e(){function e(e){var t={animation:{animateRotate:!1},cutoutPercentage:92,hover:!1,tooltips:{enabled:!1},elements:{arc:{borderWidth:0}}};return angular.merge({},t,e)}function t(t){t.setChart=function(){t.chartInfo=t.model.chart,t.chartSettings=e(t.chartInfo),t.tooltipSettings=t.tooltip,t.ready()},t.ready=function(){t.showGraphic=!0}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/charts/donut.html",link:t,scope:{model:"=",tooltip:"=",ready:"=?",custom:"@"}}}angular.module("actinver.directives").directive("donutChart",e)}(),function(){"use strict";function e(e){function t(t){function n(e,t){var n="y-axis-"+e;l.push({label:e,yAxisID:n,fill:!1,pointRadius:5}),d.push({id:n,type:"linear",display:t<1,position:"left",ticks:{fontFamily:"Proxima Semibold",min:parseInt(m),max:5e4*(parseInt(parseInt(p)/5e4)+1)}})}function o(e){var t=e.substring(4),n=e.substring(2,4);t=i[t-1].substring(0,3).toUpperCase()+". "+n,-1===c.indexOf(t)&&c.push(t)}function a(e,t){u[t]||(u[t]=[]),u[t].push(e)}function r(e,t){e.map(function(e){o(e.paymentPeriod),a(e.amount,t)})}var i=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],s=[],c=[],u=[],l=[],d=[],m=0,p=0;!function(o){void 0===o.chart.section?(o.chart.map(function(e){e&&e.historical&&e.historical.historicalInfo&&e.historical.historicalInfo.forEach(function(e){p=e.amount>p&&null!==e.amount?e.amount:p,m=e.amount<m&&null!==e.amount?e.amount:m})}),o.chart.map(function(e,t){if(!e.empty){var o=e.historical;s.push(o.contractNumber),n(o.contractNumber,t),r(o.historicalInfo,t)}}),t.colors=t.color,t.labels=c,t.data=u,t.series=s,t.datasetOverride=l,t.options={scales:{yAxes:d,xAxes:[{ticks:{fontSize:10,fontFamily:"Proxima Bold"}}]},tooltips:{caretSize:0,custom:function(e){e.backgroundColor="rgba(41, 215, 135, 0.4)",e.yPadding=10,e.height=55,e.titleFontSize=14,e.width=194,e.xPadding=10,e.bodyFontColor="#0f3f88",e.titleFontColor="#0f3f88",e.displayColors=!1},callbacks:{label:function(t,n){return n.datasets[t.datasetIndex].label+" : "+e("currency")(t.yLabel,"$")}},mode:"single"}}):(t.labels=o.chart.labels,t.data=o.chart.data,t.options=o.chart.options,t.datasetOverride=o.chart.datasetOverride)}(t.model)}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/charts/line.html",link:t,scope:{model:"=",color:"=",custom:"@?"}}}e.$inject=["$filter"],angular.module("actinver.directives").directive("lineChart",e)}(),function(){"use strict";function e(e){function t(t){function n(e,t){var n="y-axis-"+e;l.push({label:e,yAxisID:n,fill:!1,pointRadius:5}),d.push({id:n,type:"linear",display:t<1,position:"left",ticks:{fontFamily:"Proxima Semibold"}})}function o(e){var t=e.substring(4,6),n=e.substring(2,4);t=e.substring(6,8)+". "+i[t-1].substring(0,3).toUpperCase()+". "+n,c.push(t)}function a(e,t){u[t]||(u[t]=[]),u[t].push(e)}function r(e,t){e.map(function(e){o(e.paymentPeriod),a(e.amount,t)})}var i=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],s=[],c=[],u=[],l=[],d=[];!function(o){void 0===o.chart.section?(o.chart.map(function(e,t){if(!e.empty){var o=e.historical;s.push(o.contractNumber),n(o.contractNumber,t),r(o.historicalInfo,t)}}),t.colors=t.color,t.labels=c,t.data=u,t.series=s,t.datasetOverride=l,t.options={scales:{yAxes:d,xAxes:[{ticks:{fontSize:10,fontFamily:"Proxima Bold"}}]},tooltips:{caretSize:0,custom:function(e){e.backgroundColor="rgba(41, 215, 135, 0.4)",e.yPadding=10,e.height=55,e.titleFontSize=14,e.width=194,e.xPadding=10,e.bodyFontColor="#0f3f88",e.titleFontColor="#0f3f88",e.displayColors=!1},callbacks:{label:function(t,n){return n.datasets[t.datasetIndex].label+" : "+e("currency")(t.yLabel,"$")}},mode:"single"}}):(t.labels=o.chart.labels,t.data=o.chart.data,t.options=o.chart.options,t.datasetOverride=o.chart.datasetOverride)}(t.model)}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/charts/lineSimulator.html",link:t,scope:{model:"=",color:"=",custom:"@?"}}}e.$inject=["$filter"],angular.module("actinver.directives").directive("lineChartSimulator",e)}(),function(){"use strict";function e(){return{restrict:"A",scope:{classFocus:"@"},link:function(e,t){e.$watch(function(){return t.attr("class")},function(){t.hasClass(e.classFocus)&&t.focus()})}}}angular.module("actinver.directives").directive("classFocus",e)}(),function(){"use strict";function e(){function e(e){function t(){var t={autoApply:!0,showDropdowns:!0,locale:{format:"DD/MM/YYYY",daysOfWeek:["DO","LU","MA","MI","JU","VI","SA"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:0}};e.isSingle&&(t.singleDatePicker=!0),e.options2=e.options?angular.merge({},t,e.options):t}function n(){e.date?e.auxDate={newDate:e.date}:e.auxDate={newDate:{startDate:null,endDate:null}}}function o(){e.$watch("auxDate.newDate",function(t,n){n!==t&&(angular.isFunction(e.onChange)&&e.onChange(e.auxDate.newDate),e.date=e.auxDate.newDate)})}e.$watch("options.maxDate",function(){e.options&&e.options.maxDate&&(e.options2.maxDate=e.options.maxDate)}),e.$watch("options.minDate",function(){e.options&&e.options.minDate&&(e.options2.minDate=e.options.minDate)}),e.$watch("date",function(t,n){t!==n&&e.auxDate&&(e.auxDate.newDate=e.date)}),function(){n(),t(),o()}()}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/dates-range-picker/dates-range-picker.html",scope:{label:"@",placeholder:"@",date:"=?",options:"=?",onChange:"=?",ngRequired:"=?",isSingle:"=?"},link:e}}angular.module("actinver.directives").directive("datesRangePicker",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/datetime/datetime.html",link:function(e){e.models={modl1:null,modl2:null},e.modelInput={value:e.ngModel};var t=[];e.timeForSelect2=[];var n,o;"HH"===e.type?(!function(){for(n=0;n<24;n++)o=n<10?"0"+n:n,t.push({text:n<10?"0"+n:n});for(n=0;n<60;n++)e.timeForSelect2.push({text:n<10?"0"+n:n})}(),e.maskInput="29:69"):(!function(){for(n=6;n<=20;n++)o=n<10?"0"+n:n,t.push({text:o+":00"}),20!==o&&t.push({text:o+":30"})}(),e.maskInput="29:69 - 29:69"),e.loadEndTime=function(){var n=t.indexOf(e.models.modl1)+1,o=[];n>t.length?o.push({text:"20:30"}):(o=t.slice(n),o.push({text:"20:30"})),e.timeForSelect2=o.slice()},e.timeForSelect=t,e.$watchCollection("modelInput.value",function(){e.ngModel=e.modelInput.value}),e.$watchCollection("models",function(t,n){angular.equals(t,n)||t.modl1&&t.modl2&&("HH"===e.type?e.modelInput.value=t.modl1.text+":"+t.modl2.text:e.modelInput.value=t.modl1.text+" - "+t.modl2.text,e.ngModel=e.modelInput.value)})},scope:{ngModel:"=",title:"@",type:"@",required:"@?"}}}angular.module("actinver.directives").directive("actDatetime",e)}(),function(){"use strict";function e(){function e(e){e.css="",e.placeholder="---",e.status={isopen:!1},e.type="default",e.select=function(t,n){e.selected=t,e.onChange&&angular.isFunction(e.onChange)&&e.onChange(t,e.idx),e.change&&angular.isFunction(e.change)&&e.change({lastValue:n,newValue:t})},function(){e.typeCss=angular.isDefined(e.nameCss)&&angular.isString(e.nameCss)&&""!==e.nameCss?2:1,e.css=angular.isDefined(e.nameCss)&&angular.isString(e.nameCss)&&""!==e.nameCss?e.nameCss:"act-dropdown"}()}return{restrict:"A",replace:!0,templateUrl:"/scripts/directives/dropdown/dropdown.html",scope:{ngModel:"=",ngDisabled:"=",onChange:"=?",selected:"=?",name:"@",idx:"@?",change:"&?",nameCss:"@?"},link:e}}angular.module("actinver.directives").directive("actDropdown",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(e,t){D.tipoMedio.msg=e?"":t,D.tipoMedio.showMsg=!e}function m(){D.cmd={type:"titles",media:{}},d(!0,"")}function p(){D.cmd.typeBank="efectivo"}function f(e){var t,n=e.mode,o=e.date;if("day"===n){var a=R.find(function(e){var t=new Date(e.operationDate);return o.getDate()===t.getDate()&&o.getMonth()===t.getMonth()&&o.getFullYear()===t.getFullYear()},D.dollDescription.fund.operationDatesData.operationDateItem);if(a){var r=a?new Date(a.operationDate):null;t=R.find(function(e){var t=new Date(e);return r.getDate()===t.getDate()&&r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear()},D.dollDescription.fund.holidayDatesData.holidayDate)}return!!t||!a}return!1}function g(){n.getDoll2(t.contract,D.cmd.station,D.tab,D.anticipedSell).then(function(e){1===e.data.outCommonHeader.result.result&&(D.dollDescription=e.data.outFundQuery,D.cmd.dates=D.dollDescription.fund.operationDatesData.operationDateItem[0],D.orderDate=D.cmd.dates.operationDate)})}function h(e){return R.find(function(t){return t.operationDate===e},D.dollDescription.fund.operationDatesData.operationDateItem)}function v(e){s.getStations(t.contract,e).then(function(e){D.stations=e.data.outInvestmentIssuersQuery.issuer}),m()}function y(){g(),n.getDollFund(t.contract,D.typeFund).then(function(t){1===t.data.outCommonHeader.result.result&&(D.currentCash=t.data.outA2KContractBalance,e.currentCash=D.currentCash)}),s.getDetailStations(D.cmd.station.issuerName||D.cmd.station.issuer,D.cmd.station.serie).then(function(e){if(1===e.data.outCommonHeader.result.result){var t=e.data.outFundOperationDataQuery.fundOperationData;D.rulesBuy=R.find(function(e){return"COMPRA"===e.movementType.trim()},t),D.rulesSell=R.find(function(e){return"VENTA"===e.movementType.trim()},t)}})}function b(e,t){D.newState=!1,S=e,D.cmd.station=S,C(),y()}function C(){D.cmd={type:"titles",media:{},station:S},D.tipoMedio.showMsg=!1,D.captureModel=null,D.confirmationModel=null,D.cmd.dates=D.dollDescription?D.dollDescription.fund.operationDatesData.operationDateItem[0]:null,d(!0,"")}var S,D=this,M=JSON.parse(localStorage.getItem("contractSelected"));D.contractType=r.contractType(M.isPropia,M.isEligible,M.isDiscretionary),D.tipoMedio={msg:"",showMsg:!1},D.stations=[],D.currentDate=o("date")(new Date,"dd/MM/yyyy"),D.changeAnticipedSell=function(){g()},t.datepickerOptions={showWeeks:!1,formatMonth:"MMM",yearColumns:3,dateDisabled:f},a.getMedia().then(function(e){var t=e.data.outContactMeansCatalog.contactMeansCatalogData.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description})}),D.Media=n}),D.findDate=function(){D.cmd.dates=h(new Date(D.orderDate).getTime())},D.AddStation=function(e){D.priceSelected=e.lastPrice,b(e,"input")},t.$watch("contract",function(e,t){R.equals(e,t)||(D.newState=!1,D.tab=null,C(),y())}),t.$watch("station",function(e,n){t.station&&(t.station.lastPrice?(D.tab="buy",D.priceSelected=t.station.lastPrice):t.station.weightedLastPrice&&(D.tab="sell",D.priceSelected=t.station.weightedLastPrice)),R.equals(e,n)||b(e)}),t.$watch("id",function(e,n){D.typeFund=t.id,R.equals(e,n)||v(e)}),t.changeSettlement2=function(e){D.cmd[e].typeValue=o("currencyCustom")(D.cmd[e].typeValue2/D.priceSelected,0)},t.changeSettlement=function(e){D.cmd[e].typeValue2=D.cmd[e].typeValue*D.priceSelected},D.changeTab=function(e){"sell"===e&&(p(),n.getBanks(t.contract).then(function(e){e.data&&angular.isDefined(e.data.outCommonHeader)&&1===e.data.outCommonHeader.result.result?D.bankModel=R.map(function(e){return e.text=e.bankAccounts.bankName,e},e.data.outDestinationAccountQuery.outA2KBankAccountsQuery.bankAccountsList):D.bankModel=[]})),D.newState=!1,D.tab=e,t.columnsExpand=!1,t.focusElement(),D.cmd.station&&y()},D.confirm=function(){D.cmd.evtentType=D.tab,n.confirmDoll(D.cmd,t.contract,D.anticipedSell).then(function(e){D.confirmationModel=e.data,0===D.confirmationModel.issuerTitlesSold.amount&&(D.confirmationModel.issuerTitlesSold.amount=D.confirmationModel.issuerTitlesSold.titlesQty*D.priceSelected),D.confirmationModel.issuerTitlesSold.price=D.priceSelected},function(e){if(e){var t=R.find(function(e){if("N"===e.responseType)return"FATAL"===e.responseCategory||"ERROR"===e.responseCategory})(e.data),n=t?t.responseMessage:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk";i.error(n)}})},D.capture=function(){var e=c.sclient.data.name+" "+c.sclient.data.lastName+" "+c.sclient.data.secondLastName;n.captureDoll(D.cmd,t.contract,e,D.confirmationModel,D.anticipedSell,D.contractType).then(function(e){if(1===e.data.outCommonHeader.result.result){var n;"FundOrderRegistration"===e.data.outCommonHeader.operationName?(D.captureModel=e.data.outFundOrderRegistration.fundOrderResult,n="La "+("buy"===D.tab?"compra":"venta")+" se envió de manera correcta.",n+="<br>Con el folio de la operación <b>"+D.captureModel.issuerTitlesSold.operationReference+"</b>"):(D.captureModel=D.confirmationModel,n=e.data.outAdviserPendingOpRegistration.operationsDetails[0].message,n+="<br>Con el ID Registro <b>"+e.data.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),C(),t.$emit("updateTab"),i.done(n)}}).catch(function(e){i.error(u.createError(e.data))})},D.cleanModels=C,D.modify=function(){D.confirmationModel=null},D.finally=function(){C()},D.onChangeTypeMedio=function(e,t){"4"===t.id?l.validateUserTokens().then(function(e){d(e.success,e.msg)}).catch(function(e){d(e.success,e.msg)}):d(!0,"")},v(t.id)}e.$inject=["$rootScope","$scope","dollSrvFund","$filter","transfersSrv","contractTypeSrv","CommonModalsSrv","investmentSrv","$sessionStorage","ErrorMessage","loginSrvc"],angular.module("actinver.controllers").controller("dollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){}function s(){return n(function(n,o){function a(e){sessionStorage.setItem("__csrf",e.headers("X-CSRF-TOKEN")),n({success:!0})}function r(e){o({success:!1,data:{},error:e,message:"Ha ocurrido un error de seguridad"})}e.get(t.csrfRest).then(a).catch(r)})}return i.prototype.getDoll=function(n){return e({method:"GET",url:t.getInitDoll+n+"/1/1/0/?language=SPA"})},i.prototype.getDollFund=function(n,o){var a=3===o?2:1;return e({method:"GET",url:t.getInitDoll+n+"/"+a+"/1/0/?language=SPA"})},i.prototype.getDoll2=function(n,o,a,r){return r=r?1:0,e({method:"GET",url:t.getInitDoll2+n+"/"+(o.issuerName||o.issuer).trim()+"/"+o.serie+"/"+("buy"===a?1:2)+"/0/"+r+"?language=SPA"})},i.prototype.getBanks=function(n){return e({method:"get",url:t.getDollAccounts+"02/01/"+n+"?language=SPA&accountStatus=1"})},i.prototype.confirmDoll=function(r,i,c){c=c?1:0;var u=r.evtentType,l={contractNumber:i,buyCaptureType:0,buyExecutionDate:a(r.dates.settlementDate).format("DDMMYYYY"),buyIssuerName:null,buyOperationDate:a(r.dates.operationDate).format("DDMMYYYY"),buySerie:null,buyTitlesAmount:0,buyTitlesQty:0,captureType:"titles"===r.type?1:2,executionDate:a(r.dates.settlementDate).format("DDMMYYYY"),movementType:"sell"===r.evtentType?2:1,netAmount:r[u].typeValue2,operationDate:a(r.dates.operationDate).format("DDMMYYYY"),settlementType:r.BankSelected?"R":null,titlesAmount:"titles"===r.type?r[u].typeValue:r[u].typeValue2,titlesQty:r[u].typeValue,issuerName:r.station.issuer?r.station.issuer:r.station.issuerName,serie:r.station.serie,clabe:r.BankSelected?r.BankSelected.bankAccounts.clabe:0,anticipatedSell:c,settlementDate:a(r.dates.settlementDate).format("DDMMYYYY"),registrationType:"titles"===r.type?1:2,buyCLABE:r.BankSelected?r.BankSelected.bankAccounts.clabe:0,buyNetAmount:0,buyRegistrationType:0};return n(function(n,a){function r(){e({method:"post",url:t.confirmDoll,data:$.param(l)}).then(function(e){1===e.data.outCommonHeader.result.result?n({success:!0,data:e.data.outFundOrderQuotation.fundOrderResult}):a({success:!0,data:e.data.outCommonHeader.result.messages})},function(){o.systemError(),a(null)})}function i(e){a(e)}s().then(r).catch(i)})},i.prototype.captureDoll=function(i,c,u,l,d,m){d=d?1:0;var p=i.evtentType,f={Contrato:c,Movimiento:"buy"===i.evtentType?"COMPRA":"VENTA",Emisora:l.issuerTitlesSold.issuerName,Precio:l.issuerTitlesSold.netAmount,"Títulos":l.issuerTitlesSold.titlesQty,"Ejecución de la orden":a(l.issuerTitlesSold.operationDate).format("DD/MM/YYYY"),"Liquidación de la orden":a(l.issuerTitlesSold.settlementDate).format("DD/MM/YYYY")};f=JSON.stringify(f);var g={contractNumber:c,buyIssuerName:null,clabe:i.BankSelected?i.BankSelected.bankAccounts.clabe:0,issuerName:i.station.issuer?i.station.issuer:i.station.issuerName,movementType:"sell"===i.evtentType?2:1,operationDate:a(i.dates.operationDate).format("DDMMYYYY"),settlementDate:a(i.dates.settlementDate).format("DDMMYYYY"),registrationType:"titles"===i.type?1:2,serie:i.station.serie,titlesAmount:"titles"===i.type?i[p].typeValue:i[p].typeValue2,titlesQty:i[p].typeValue,netAmount:i[p].typeValue2,buyOperationDate:a(i.dates.operationDate).format("DDMMYYYY"),buyRegistrationType:0,buySettlementDate:a(i.dates.operationDate).format("DDMMYYYY"),buyTitlesAmount:0,buyTitlesQty:0,buySerie:null,settlementType:i.BankSelected?"R":null,anticipatedSell:d,name:u,buyNetAmount:0,buyCLABE:i.BankSelected?i.BankSelected.bankAccounts.clabe:0,jsonDetails:f};return g=r.sendBinnacle(m,g,i),n(function(n,a){function r(){e({method:"post",url:t.capture,data:$.param(g)}).then(function(e){1===e.data.outCommonHeader.result.result?n({success:!0,data:e.data}):a({success:!0,data:e.data.outCommonHeader.result.messages})},function(){o.systemError(),a(null)})}function i(e){a(e)}s().then(r).catch(i)})},new i}e.$inject=["$http","URLS","$q","CommonModalsSrv","moment","contractTypeSrv"],angular.module("actinver.services").service("dollSrvFund",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#station").focus()},250)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/doll/doll.html",scope:{station:"=",id:"=",contract:"@",columnsExpand:"=?"},controller:"dollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actDoll",e)}(),function(){"use strict";function e(e){function t(t){function n(){angular.isDefined(t.onReset)&&t.$watch("onReset",function(e){e&&t.uploader&&t.uploader.removeFromQueue&&t.uploader.removeFromQueue.length>0&&t.uploader.removeFromQueue(0)})}function o(){t.uploader=new e({queueLimit:2,onBeforeUploadItem:function(e){e.headers={Authorization:"bearer "+sessionStorage.getItem("__token"),"X-CSRF-TOKEN":sessionStorage.getItem("__csrf")}}})}function a(){t.filter&&t.uploader.filters.push({name:"formatsAndSize",fn:r})}function r(e){if(R.find(function(t){return t.formats.indexOf(e.type)>=0&&e.size<=t.size})(t.filter))return!0;t.onErrorSetFile&&"function"==typeof t.onErrorSetFile&&(t.onErrorSetFile("El formato o tamaño no es permitido."),t.uploader.removeFromQueue(0))}function i(){t.uploader.onAfterAddingFile=function(e){t.uploader.queue.length>1&&t.uploader.removeFromQueue(0);var n=new FileReader;n.onload=function(n){t.$apply(function(){t.onSuccessSetFile&&"function"==typeof t.onSuccessSetFile&&t.onSuccessSetFile(n.target.result,e)})},n.readAsDataURL(e._file)}}t.uploaderFile=function(){document.getElementById("file-uploader").click(),angular.isDefined(t.onReset)&&(t.onReset=!1)},function(){o(),a(),i(),n()}()}return{restrict:"EA",replace:!0,template:"<div class='file-uploader'><div class='icon-file' ng-class='{ active: uploader.queue.length > 0, pdf: uploader.queue[0].file.type === &quot;application/pdf&quot; }' ng-click='uploaderFile()'></div><input id='file-uploader' type='file' ng-if='uploader' nv-file-select uploader='uploader'><div class='info-file' ng-show='uploader.queue.length > 0'><div class='name'>{{ uploader.queue[0].file.name }}</div><button class='change-file' ng-click='uploaderFile()'>Cambiar</button><div></div>",scope:{filter:"=?",onSuccessSetFile:"=?",onErrorSetFile:"=?",onReset:"=?"},link:t}}e.$inject=["FileUploader"],angular.module("actinver.directives").directive("fileUploader",e)}(),function(){"use strict";function e(e){return{restrict:"A",require:"?ngModel",link:function(t,n,o,a){a&&(a.$formatters.unshift(function(){return e(o.format)(a.$modelValue)}),n.bind("blur",function(){var t=n.val().replace(/[^\d|\-+|\.+]/g,"");n.val(e(o.format)(t))}),n.bind("focus",function(){n.val("")}))}}}e.$inject=["$filter"],angular.module("actinver.directives").directive("format",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c){function u(e,t){E.tipoMedio.msg=e?"":t,E.tipoMedio.showMsg=!e}function l(){g(),C(),f(),E.clientNumber=a.sclient.data.clientNumber,e.selected&&!E.isObjectSell?(E.loading=!0,E.stationName=e.selected.slateKey+" "+e.selected.serie,E.serie=e.selected.serie,E.buyLiquidity=e.selected.buyLiquidity,E.sellLiquidity=e.selected.sellLiquidity,E.currentCash=e.selected.price,"1"===e.selected.sellingByImportOrTitles.typeID?"buy"===E.tab?(E.rulesBuy={registrationType:"IMPORTE"},E.cmd={
evtentType:"buy",type:"import"}):"sell"===E.tab&&(E.rulesBuy={registrationType:"TITULOS"},E.cmd={evtentType:"sell",type:"import"}):"2"===e.selected.sellingByImportOrTitles.typeID&&(E.rulesBuy={registrationType:"AMBOS"}),E.loading=!1,e.focusElement(),d((new Date).getTime()),S()):e.selected&&E.isObjectSell&&(E.fund={sell:{titlesQty:e.selected.titlesQty,fundID:e.selected.idFund,settlementDate:e.selected.settlementDate,dueDate:e.selected.dueDate,currentPrice:e.selected.currentPrice,position:e.selected.position,movementType:e.selected.movementType,stationName:e.selected.emissionID,serie:e.selected.serie,foreignExchangeID:e.selected.foreignExchangeID}},E.loading=!1,E.stationName=E.fund.sell.stationName+" "+e.selected.serie,S())}function d(e){E.dateExecution=s(e).format("YYYY-MM-DD HH:mm:ss"),E.isObjectSell?p("venta",E.anticipedSellCheck?"1":"0"):p("compra","0")}function m(t){t=E.anticipedSellCheck?"1":"0",e.sellLiquidity="0"===t,p("venta",t)}function p(n,a){var r=null;"compra"===n?r={v1:e.selected.fundID,v3:1,v4:E.dateExecution}:"venta"===n&&(r={v1:e.selected.idFund,v3:2,v4:E.dateExecution}),o.getCalendarBank(r,e.selected.serie,a).then(function(t){if("compra"===n)E.cmd.calendarExc=t.calendarsInformation.calendarInformation[0].calendarDateTime.timestamp,E.cmd.fhLiquidacion=t.calendarsInformation.calendarInformation[0].settlementDateTime,e.fechaLiquidacion=E.cmd.fhLiquidacion;else if(e.sellLiquidity){var o=[];angular.forEach(t.calendarsInformation.calendarInformation,function(e){var t=new Date(e.settlementDateTime),n=new Date(e.calendarDateTime.timestamp);o.push({settlementDateTime:t,text:s(n).format("DD/MM/YYYY"),calendarOp:n})}),E.operationDate=o,E.cmd.fhLiquidacion=t.calendarsInformation.calendarInformation[0].settlementDateTime,e.fechaLiquidacion=E.cmd.fhLiquidacion}else E.cmd.calendarExc=t.calendarsInformation.calendarInformation[0].calendarDateTime.timestamp,E.cmd.fhLiquidacion=t.calendarsInformation.calendarInformation[0].settlementDateTime,e.fechaLiquidacion=E.cmd.fhLiquidacion}).catch(function(e){t.error(i.createError(e.messages)),E.newStateInit=!0,E.confirmationModel=!1})}function f(){E.loading=!0,o.getMediaBank().then(function(e){var t=e.data.result,n=[];angular.forEach(t,function(e){n.push({id:e.identifier,text:e.instructionTypeDescription})}),E.Media=n})}function g(){E.invest=null,null===e.selected||E.isObjectSell?null!==e.selected&&E.isObjectSell?D("venta"):E.cmd={type:"titles",binnacle:{date:new Date}}:D("compra"),E.transaction=null,E.confirmationModel=null,E.captureModel=null,E.anticipedSellCheck=!1,u(!0,"")}function h(){var n=parseFloat(E.cmd.importRules),o=parseFloat(E.balance.availableBalance);if("buy"===E.cmd.evtentType){if(n>o)return void t.error("No se puede realizar la compra por que el importe es mayor al saldo disponible  "+r("currency")(o,"$",2));E.confirmationModel=e.selected,P()}else E.confirmationModel=e.selected,P()}function v(){E.confirmationModel=null,d((new Date).getTime())}function y(){"buy"===E.cmd.evtentType?A():"sell"===E.cmd.evtentType&&M()}function b(){E.newStateInit=!0,g(),l()}function C(){var n="",a=null;E.loading=!0,o.bankContractBalance(e.contract.contractNumber,E.bankingArea).then(function(e){if(1===e.data.outCommonHeader.result.result)a=e.data.outBankContractBalance.balanceData,E.balance=a;else{var o=e.data.outCommonHeader.result.messages;angular.forEach(o,function(e){n+=e.responseMessage}),t.error(n),E.newStateInit=!0,E.confirmationModel=!1,E.loading=!1}}).catch(function(e){var n=e.data.outCommonHeader.result.messages;t.error(i.createError(n)),E.newStateInit=!0,E.confirmationModel=!1,E.loading=!1})}function S(){E.loading=!0;var n=e.contract.contractNumber,a=null,r=null,s=null;E.isObjectSell?E.isObjectSell&&(a=E.fund.sell.fundID,r="venta",s=E.fund.sell.serie,E.tab="sell"):(a=e.selected.fundID,r="compra",s=E.serie,E.tab="buy"),o.getCurrencyFundByIDAndContract(a,n,r).then(function(t){var n,o=null;1===t.data.outCommonHeader.result.result&&(n=t.data.outBankInvstFundsByContractQuery.funds.fund,angular.forEach(n,function(e){e.serie===s&&(o=e)})),e.anticipedS=o.advanceSaleFlag,"buy"===E.tab?e.buyLiquidity="0"!==o.buyLiquidity:"0"===o.sellLiquidity?e.sellLiquidity=!1:"1"===o.sellLiquidity&&o.advanceSaleFlag?e.sellLiquidity=!0:"1"!==o.sellLiquidity||o.advanceSaleFlag||(e.sellLiquidity=!1),"venta"===r&&d((new Date).getTime()),"1"===o.sellingByImportOrTitles.typeID?"buy"===E.tab?(E.rulesBuy={registrationType:"IMPORTE"},E.cmd={evtentType:"buy",type:"import"}):"sell"===E.tab&&(E.rulesSell={registrationType:"TITULOS"},E.cmd={evtentType:"sell",type:"titles"}):"2"===o.sellingByImportOrTitles.typeID&&(E.rulesBuy={registrationType:"AMBOS"})}).catch(function(e){var n=e.data.outCommonHeader.result.messages;t.error(i.createError(n))}).finally(function(){E.loading=!1})}function D(t){"compra"===t?E.cmd={type:"titles",evtentType:"buy",binnacle:{date:new Date}}:"venta"===t&&(E.rulesSell={registrationType:"AMBOS"},E.cmd={type:"titles",evtentType:"sell",binnacle:{date:new Date}},E.fund={sell:{titlesQty:e.selected.titlesQty,fundID:e.selected.idFund,settlementDate:e.selected.settlementDate,dueDate:e.selected.dueDate,currentPrice:e.selected.currentPrice,position:e.selected.position,movementType:e.selected.movementType,stationName:e.selected.emissionID}},E.anticipedSellCheck=!1,d((new Date).getTime())),E.transaction=null,E.confirmationModel=null,E.captureModel=null}function M(){var a=null,r=0,c="";"titles"===E.cmd.type?(!1,r=E.cmd.sell.typeValue):(!0,r=parseInt(Math.abs(parseFloat(E.cmd.importRules).toFixed(2))/parseFloat(E.fund.sell.currentPrice)),E.cmd.sell.typeValue=r),a=e.sellLiquidity?s(E.cmd.operationDate.calendarOp).format("DDMMYYYY"):s(E.cmd.calendarExc).format("DDMMYYYY");var u;"0"===E.fund.sell.foreignExchangeID?u=!1:"1"===E.fund.sell.foreignExchangeID&&(u=!0),P();var l=JSON.stringify(E.detail);E.transaction={language:"SPA",clientContractNumber:e.contract.contractNumber,clientBankingArea:E.bankingArea,time:"00:00:00",fundID:E.fund.sell.fundID,settlementID:"9",titlesQty:r,ai_operationDate:a,ai_addPaymentAmountFlag:!1,ai_clabe:"0",ai_checkAccount:"0",ai_addFreeOfOperationFeeFlag:!1,ai_dollarFlag:u,buyerContractNumber:e.contract.contractNumber,buyerFundID:E.fund.sell.fundID,ca_bankingArea:E.bankingArea,amount:E.cmd.importRules,currencyTypeKey:0,advanceSaleFlag:E.anticipedSellCheck,jsonDetails:l},E.transaction=n.sendBinnacle(E.contractType,E.transaction,E.cmd),E.loading=!0,E.confirmationModel=null,o.bankFundSellRequest(E.transaction).then(function(e){"BankFundSellRequest"===e.outCommonHeader.operationName?(E.captureModel=e,t.done(i.createError(e.outCommonHeader.result.messages))):(E.captureModel=E.confirmationModel,c=e.outAdviserPendingOpRegistration.operationsDetails[0].message,c+="<br>Con el ID Registro <b>"+e.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>",t.done(c))}).catch(function(e){t.error(i.createError(e.outCommonHeader.result.messages)),E.captureModel=null,E.cmd.evtentType="sell"}).finally(function(){b()})}function A(){var a=0,r=!1,c=s(E.cmd.calendarExc).format("DDMMYYYY"),u=s(E.cmd.calendarExc).format("DDMMYYYY");"titles"===E.cmd.type?(r=!1,a=E.cmd.buy.typeValue):(r=!0,a=0),P();var l=JSON.stringify(E.detail);"3"!==E.cmd.media.type.id&&(E.cmd.binnacle={time:"00:01:00",date:new Date});var d;"MXN"===e.selected.currency?d="CCEJE":"USD"===e.selected.currency&&(d="EFECMXN"),E.transaction={language:"SPA",clientBankingArea:E.bankingArea,clientContractNumber:e.contract.contractNumber,addFreeOfOperationFeeFlag:!1,addPaymentAmountFlag:r,fundID:e.selected.fundID,operationDate:c,titlesQty:a,depositDate:u,applyRegistrationFlag:!0,totalAmount:parseFloat(E.cmd.importRules).toFixed(2),currency:0,bankingArea:E.bankingArea,operationSource:d,jsonDetails:l},E.transaction=n.sendBinnacle(E.contractType,E.transaction,E.cmd),E.loading=!0,E.confirmationModel=null,o.bankFundBuyRequest(E.transaction).then(function(e){var n="";1===e.outCommonHeader.result.result?"BankFundBuyRequest"===e.outCommonHeader.operationName?(E.captureModel=e,t.done(i.createError(e.outCommonHeader.result.messages))):(E.captureModel=E.confirmationModel,n=e.outAdviserPendingOpRegistration.operationsDetails[0].message,n+="<br>Con el ID Registro <b>"+e.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>",t.done(n)):(t.error(i.createError(e.outCommonHeader.result.messages)),E.captureModel=null,E.cmd.evtentType="buy")}).catch(function(e){t.error(e.outCommonHeader.result.messages),E.captureModel=null}).finally(function(){b()})}function P(){var t=0,n=0,o=0,a=null,i=null,c=null;"buy"===E.cmd.evtentType?(c="Compra",t=r("currency")(E.currentCash,"$",6),n=E.cmd.buy.typeValue,o=r("currency")(E.cmd.buy.typeValue2,"$")):"sell"===E.cmd.evtentType&&(c="Venta",t=r("currency")(E.fund.sell.currentPrice,"$",6),n=E.cmd.sell.typeValue,o=r("currency")(E.cmd.sell.typeValue2,"$")),a=s(E.cmd.calendarExc).format("YYYY-MM-DD"),i=s(E.cmd.fhLiquidacion).format("YYYY-MM-DD");var u=s((new Date).getTime()).format("YYYY-MM-DD"),l=r("currency")(E.cmd.importRules,"$");E.detail={Contrato:e.contract.contractNumber,Movimiento:c,Emisora:E.stationName,Serie:E.serie,Titulos:n,Precio:t,Importe:o,Total:l,"Fecha Orden":a,"Fecha Liquidacion":i,"Fecha Ejecucion":u}}var E=this;E.currentCash=0,E.transaction={},E.cleanModels=g,E.modify=v,E.confirm=h,E.capture=y,E.finish=b,E.getCalendar=m,e.date=new Date,E.viewNewState=!1,E.newStateInit=!0,E.cmd={},E.cmd.binnacle={comments:"",time:"00:01:00"},E.isObjectSell=!1,E.bankingArea="001",E.cmd.importRules=0,e.sellLiquidity=!0;var I=JSON.parse(localStorage.getItem("contractSelected"));E.contractType=n.contractType(I.isPropia,I.isEligible,I.isDiscretionary),E.anticipedSellCheck=!1,E.tipoMedio={msg:"",showMsg:!1},E.findDate=function(){d(new Date(E.orderDate).getTime())},E.changeTab=function(t){g(),"buy"===t?(e.$emit("activeSell",!1),E.cmd.evtentType="buy",E.newStateInit=!1):"sell"===t&&(e.$emit("activeSell",!0),E.cmd.evtentType="sell",E.newStateInit=!1),E.tab=t},e.$watch("selected",function(){if(E.isObjectSell=!1,e.selected&&(e.selected.instrumentID?E.isObjectSell=!0:E.isObjectSell=!1),e.selected&&e.contract.isDinn)return void t.error("No es posible operar un contrato DINN");e.selected&&!E.isObjectSell?(E.loading=!0,E.viewNewState=!0,E.newStateInit=!1,E.confirmationModel=!0,E.captureModel=!1,E.tab="buy",l()):e.selected&&E.isObjectSell?(E.loading=!0,E.viewNewState=!0,E.newStateInit=!1,E.confirmationModel=!0,E.captureModel=!1,E.tab="sell",l()):(E.newStateInit=!0,E.viewNewState=!1,E.loading=!1)}),e.changeSettlement2=function(e){void 0!==E.cmd[e].typeValue2?E.cmd.importRules=Math.abs(E.cmd[e].typeValue2):E.cmd.importRules=0},e.changeSettlement=function(e){void 0!==E.cmd[e].typeValue?(E.isObjectSell?E.cmd.importRules=Math.abs(E.cmd[e].typeValue*E.fund.sell.currentPrice):E.cmd.importRules=Math.abs(E.cmd[e].typeValue*E.currentCash),E.cmd.importRules=E.cmd.importRules.toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]):E.cmd.importRules=0},E.AddStation=function(t){e.selected=t,E.captureModel=null,E.confirmationModel=null,E.loading=!0,l()},E.AddStationOrders=function(t){e.selected=t,D("venta"),E.loading=!0,E.captureModel=null,E.confirmationModel=null},E.cleanImport=function(e){"sell"===e?E.cmd.sell&&(E.cmd.sell.typeValue="",E.cmd.sell.typeValue2=""):"buy"===e&&E.cmd.buy&&(E.cmd.buy.typeValue="",E.cmd.buy.typeValue2=""),E.cmd.importRules=""},E.onChangeTypeMedio=function(e,t){"10"===t.id?c.validateUserTokens().then(function(e){u(e.success,e.msg)}).catch(function(e){u(e.success,e.msg)}):u(!0,"")}}e.$inject=["$scope","CommonModalsSrv","contractTypeSrv","fundBankDollSrv","$sessionStorage","$filter","ErrorMessage","moment","loginSrvc"],angular.module("actinver.controllers").controller("fundBankDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.getCalendarBank=function(o,a,r){var i="";for(var s in o)i+=o[s]+"/";return e(function(e,o){t({method:"GET",url:n.getCalendarBank+i,params:{language:"SPA",serie:a,anticipatedSell:r}}).then(function(t){1===t.data.outCommonHeader.result.result?e(t.data.outBankInvstCalendarByFundsQuery):o(t.data.outCommonHeader.result)})})},a.prototype.getMediaBank=function(){return t({method:"GET",url:n.getMediaBank+"?language=SPA"})},a.prototype.getCurrentCash=function(e){return t({method:"GET",url:n.getCurrentCash+e+"/1/1/0",params:{language:"SPA"}})},a.prototype.confirmDoll=function(e){var o={language:"SPA",contract:e.contract,term:e.sinstrument.minTerm,netAmount:e.invest.amount,rateOfReturn:e.sinstrument.maxRate,valueType:e.sinstrument.valueType,minTerm:e.sinstrument.minTerm,maxTerm:e.sinstrument.maxTerm,maxRate:e.sinstrument.maxRate,minAmount:e.sinstrument.minNetAmount,maxAmount:e.sinstrument.maxNetAmount,minRate:e.sinstrument.minRate,binnacle:e.binnacle};return t({method:"get",url:n.confirmFundBankDoll,data:o})},a.prototype.bankFundBuyRequest=function(a){return e(function(e,r){function i(){t({method:"POST",url:n.bankFundBuyRequest,data:$.param(a)}).then(function(t){e(t.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},a.prototype.bankFundSellRequest=function(a){return e(function(e,r){function i(){t({method:"POST",url:n.bankFundSellRequest,data:$.param(a)}).then(function(t){1===t.data.outCommonHeader.result.result?e(t.data):r(t.data)}).catch(function(e){r(e.data)})}o.csrfValidate().then(i)})},a.prototype.bankContractBalance=function(e,o){return t({method:"GET",url:n.bankContractBalance+e+"/"+o,params:{language:"SPA"}})},a.prototype.bankReportoBuyingPowerQuery=function(e,o){return t({method:"GET",url:n.bankReportoBuyingPowerQuery+e+"/"+o,params:{language:"SPA"}})},a.prototype.bankInvstUserInfoQuery=function(){return t({method:"GET",url:n.bankInvstUserInfoQuery,params:{language:"SPA"}})},a.prototype.getCurrencyFundByIDAndContract=function(e,o,a){var r=0;return"compra"===a?r=1:"venta"===a&&(r=2),t({method:"GET",url:n.getFundBank+o+"/"+r+"/"+e+"/",params:{language:"SPA"}})},a.prototype.bankFundBuyCancelation=function(a){return e(function(e,r){function i(){t({method:"POST",url:n.bankFundBuyCancelationRequest,data:$.param(a)}).then(function(t){e(t.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},a.prototype.bankFundSellCancelation=function(a){return e(function(e,r){function i(){t({method:"POST",url:n.bankFundSellCancelationRequest,data:$.param(a)}).then(function(t){e(t.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},new a}e.$inject=["$q","$http","URLS","csrfSrv"],angular.module("actinver.services").service("fundBankDollSrv",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#station").focus()},250)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/fund-bank-doll/fund-bank-doll.html",scope:{contract:"=",selected:"=",stations:"=",orders:"=?"},controller:"fundBankDollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actFundBankDoll",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){return t.open({templateUrl:"/app/advisers/goals/views/accountState/account-state-login.html",controller:"accountStateLoginCtrl",controllerAs:"login"}).result.finally(angular.noop).then(angular.noop,angular.noop)}function s(t){t.commissionPercentage=Math.round(100*t.commissionPercentage),e.chartDataBank=[];var n=t.generationBank.bank+t.generationBrokerageHouse.brokerageHouse+t.generationChanges.changes+t.generationInsurance.insurance;e.chartDataBank.push(Math.round(t.generationBank.bank/n*100)),e.chartDataBank.push(Math.round(t.generationBrokerageHouse.brokerageHouse/n*100)),e.chartDataBank.push(Math.round(t.generationChanges.changes/n*100)),e.chartDataBank.push(Math.round(t.generationInsurance.insurance/n*100))}function c(t){e.labelsHouse=[],e.seriesHouse=[],e.dataHouse=[],l.dataHouseFinal=[];t.percentageBase;t.listDetailIntegrationChart.forEach(function(t){e.labelsHouse.push(new String(t.name)),e.dataHouse.push(t.percentage)}),t.percentageBase=Math.round(100*t.percentageBase),e.seriesHouse.push(" % "),l.dataHouseFinal.push(e.dataHouse)}function u(t){e.labelsPayments=[],e.dataPayments=[],e.labelsPayments.push("Comisiones del Mes%"),e.labelsPayments.push("Referenciados%"),e.labelsPayments.push("Seguros%"),e.labelsPayments.push("Arrendamientos%"),e.labelsPayments.push("Crédito%"),e.dataPayments.push(Math.round(t.generation.commission/t.payments.total*100)),e.dataPayments.push(Math.round(t.payments.referenced/t.payments.total*100)),e.dataPayments.push(Math.round(t.payments.insurance/t.payments.total*100)),e.dataPayments.push(Math.round(t.payments.leases/t.payments.total*100)),e.dataPayments.push(Math.round(t.payments.credit/t.payments.total*100))}var l=this,d=JSON.parse(a.user);l.year=moment().format("YYYY");var m=d.roles.includes("RRHH");!function(){2019==l.year?l.listYear={optionYear:[{id:l.year,text:l.year}]}:l.listYear={optionYear:[{id:l.year,text:l.year},{id:l.year-1,text:l.year-1}]}}(),function(){2019==l.year?l.listMonth={optionMonth:[{id:"05",text:"Mayo"},{id:"06",text:"Junio"},{id:"07",text:"Julio"},{id:"08",text:"Agosto"},{id:"09",text:"Septiembre"},{id:"10",text:"Octubre"},{id:"11",text:"Noviembre"},{id:"12",text:"Diciembre"}]}:l.listMonth={optionMonth:[{id:"01",text:"Enero"},{id:"02",text:"Febrero"},{id:"03",text:"Marzo"},{id:"04",text:"Abril"},{id:"05",text:"Mayo"},{id:"06",text:"Junio"},{id:"07",text:"Julio"},{id:"08",text:"Agosto"},{id:"09",text:"Septiembre"},{id:"10",text:"Octubre"},{id:"11",text:"Noviembre"},{id:"12",text:"Diciembre"}]}}(),e.colours=["#1750a7","#4868F5","#609FF4","#F1F50B","#0DEDEA"],e.datasetOverride=[{fill:!0,backgroundColor:["#1750a7"]}],l.monthSelected=null,l.yearSelected=null,l.employeeId=null,l.banderaGeneration=!1,l.banderaIntegration=!1,l.banderaPayments=!1,l.detail=!1,e.chartLabelsBank=["BANCO %","CASA DE BOLSA %","CAMBIOS %","SEGUROS %"],e.chartDataBank=[],e.labelsHouse=[],e.dataHouse=[],e.labelsPayments=[],e.dataPayments=[],o.detailAccountState=void 0,l.getInfoIntegration=function(){0==l.banderaIntegration?l.banderaIntegration=!0:l.banderaIntegration=!1},l.getInfoGeneration=function(){0==l.banderaGeneration?l.banderaGeneration=!0:l.banderaGeneration=!1},l.getInfoPayments=function(){0==l.banderaPayments?l.banderaPayments=!0:l.banderaPayments=!1},o.$watch("detailAccountState",function(){l.detailAccountState=o.detailAccountState,s(l.detailAccountState.result.generation),c(l.detailAccountState.result.integration),u(l.detailAccountState.result)}),o.$watch("detail",function(){l.detail=o.detail}),l.sendLogin=function(){var e=!1;null==l.monthSelected?e="Seleccione un mes a consultar":null==l.yearSelected?e="Seleccione un año a consultar":void 0!==l.employeeId&&null!=l.employeeId||(e="Ingrese numero de empleado"),e?n.error(e):(o.month=l.monthSelected.id,o.year=l.yearSelected.id,o.employeeId=l.employeeId,m?r.getAccountStateRh(o.month,o.year,o.employeeId,d.userName,"xxxxxxx",m).then(function(e){1!==e.data.outCommonHeader.result.result?n.error(e.data.outCommonHeader.result.messages[0].responseMessage):(o.detailAccountState=e.data,o.detail=!0)}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e}):i())},l.reset=function(){o.detail=!1,l.detail=o.detail,l.monthSelected=null,l.yearSelected=null,l.employeeId=null,l.banderaGeneration=!1,l.banderaIntegration=!1,l.banderaPayments=!1},l.help=function(){return t.open({templateUrl:"/app/advisers/goals/views/accountState/account-state-help.html",controller:"accountStateHelpCtrl",controllerAs:"help"}).result.finally(angular.noop).then(angular.noop,angular.noop)}}e.$inject=["$scope","$uibModal","CommonModalsSrv","$rootScope","$sessionStorage","accountStateSrv"],angular.module("actinver.controllers").controller("accountStateResumeCtrl",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/goals/accountState-resume.html",scope:{type:"@",obj:"=",datepicker:"=",search:"="},controller:"accountStateResumeCtrl",controllerAs:"resume"}}angular.module("actinver.directives").directive("accountStateResume",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/goals/products.html",scope:{data:"=",type:"@?"}}}angular.module("actinver.directives").directive("goalsProducts",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){s.search=null,s.selected_filter_type={text:s.filter_types[0].text}}function i(n,o,a){var r=t("orderBy")(n,"centroFinanciero");s.centers=t("groupJSON")(r,"centroFinanciero"),s.totals=e.search.info[a],s.filters={filter:o,totals:a},s.filtered_report_empty=0===r.length}var s=this,c=moment().businessSubtract(1);s.filter_types=o.search_filter_types,s.updateReport=function(t){var n=moment(t).format("DD/MM/YY");s.current_date=n,e.$emit("changeDate",n),r()},s.getFilter=function(t){switch(s.search=null,t.id){case 1:i(e.search.info.elements,"elements","total");break;case 2:i(e.search.info.maxAdviser,"maxAdviser","maxAdviserTotal");break;case 3:i(e.search.info.minAdviser,"minAdviser","minAdviserTotal");break;case 4:i(e.search.info.maxFinancialCenter,"maxFinancialCenter","maxFinancialCenterTotal");break;case 5:i(e.search.info.minFinancialCenter,"minFinancialCenter","minFinancialCenterTotal")}},s.getSearchInfo=function(){n(function(){i(t("filter")(e.search.info[s.filters.filter],s.search),s.filters.filter,s.filters.totals)},100)},s.getCenterGoals=function(t,n){a.showCenterDetail(t,e.$parent.$parent.goals.sadviser.employeeID,n,s.current_date)},s.getAdviserGoals=function(e,t){a.showAdviserDetail(e,t,s.current_date)},function(){s.updateReport(c)}(),e.$watch("search.info",function(t){void 0!==t&&e.search.info.elements.length>0&&i(e.search.info.elements,"elements","total")})}e.$inject=["$scope","$filter","$timeout","goalsSupervisorSrv","goalsModalSrv"],angular.module("actinver.controllers").controller("goalsResumeCtrl",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/goals/resume.html",scope:{type:"@",obj:"=",datepicker:"=",search:"="},controller:"goalsResumeCtrl",controllerAs:"resume"}}angular.module("actinver.directives").directive("goalsResume",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/goals/totals.html",scope:{data:"=",modal:"=?"}}}angular.module("actinver.directives").directive("goalsTotals",e)}(),function(){"use strict";function e(){function e(e,t){var n=0;$(window).scroll(function(){if($(window).width()<1055){var e=$(document).scrollLeft();n!==e&&(n=e,t.css("left",-e))}}),$(window).resize(function(){$(window).width()>1054&&t.css("left",0)})}return{restrict:"A",link:e}}angular.module("actinver.directives").directive("headerScroll",e)}(),function(){"use strict";function e(e){return{restrict:"A",link:function(){8!==$("#ipc-ticker ul li").length||$("#ipc-ticker").hasClass("initialized")||e(function(){$("#ipc-ticker").addClass("initialized").liMarquee({drag:!1,hoverstop:!0,scrollamount:50,runshort:!1})},50)}}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("onFinishRender",e)}(),function(){"use strict";function e(e,t,n,o){function a(e){var t=!0;return-1!==e.indexOf("-")&&(t=!1),t}function r(){c.disconnect(),u.disconnect()}function i(){var n=e.CapitalsWebSocket+"?access_token="+sessionStorage.getItem("__token"),a=new SockJS(n);l.socketIpc.stompclient=Stomp.over(a),l.socketIpc.stompclient.debug=null,l.socketIpc.stompclient.connect({},function(){l.socketIpc.susbcribeBmvIpcFacts=l.socketIpc.stompclient.subscribe("/topic/capitales/bmvIpcFacts",function(e){t.$apply(function(){var t=JSON.parse(e.body);l.objIPCFact=c.info(t.index,t.percentage)})}),l.socketIpc.susbcribeBmvIpc=l.socketIpc.stompclient.subscribe("/topic/capitales/bmvIpc",function(e){t.$apply(function(){var t=JSON.parse(e.body);l.objIPC[t.issuer.issuerSerie]=u.info(t)})})},function(){o(i,3e3)})}function s(){null!==l.socketIpc.stompclient&&(l.socketIpc.susbcribeBmvIpc.unsubscribe(),l.socketIpc.susbcribeBmvIpcFacts.unsubscribe(),l.socketIpc.stompclient.disconnect())}var c={},u={},l=this;l.objIPC={},l.objIPCFact={},l.streamWS=[],l.streamWSFact=[],l.finish=!1,l.socketIpc={stompclient:null,susbcribeBmvIpc:null,susbcribeBmvIpcFacts:null},t.$on("close-socket-ipc-status",function(){s()}),c={disconnect:function(){R.isEmpty(l.objIPCFact)&&n({method:"GET",url:e.getIPC,ignoreLoadingBar:!0,params:{language:"SPA"}}).then(function(e){var t=e.data;l.objIPCFact=c.info(t.ipcIndex,t.ipcVar)},function(){})},info:function(e,t){return l.finish=!0,{index:e.toString(),percentage:t.toString(),class:a(t.toString())}}},u={disconnect:function(){R.isEmpty(l.objIPC)},info:function(e){return l.finish=!0,{issuerSerie:e.issuer.issuerSerie,lastPrice:e.lastPrice.toString(),priceVar:e.priceVar.toString(),class:a(e.priceVar.toString())}}},function(){r(),i()}()}e.$inject=["URLS","$scope","$http","$timeout"],angular.module("actinver.controllers").controller("ipcCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/ipc/ipc.html",controller:"ipcCtrl",controllerAs:"ipc"}}angular.module("actinver.directives").directive("ipc",e)}(),function(){"use strict";function e(e){var t=this;t.details={finish:!1},e.getInfo(69,4,2).then(function(e){t.details=e},function(e){t.details=e})}e.$inject=["incomesInfo"],angular.module("actinver.controllers").controller("incomesWidgetCtrl",e)}(),function(){"use strict";function e(e,t,n){return{getInfo:function(){return n(function(n,o){t({method:"GET",url:e.dashboardIncomes}).then(function(e){e.data.status?n({success:!0,data:e.data.result,finish:!0}):o({success:!1,finish:!0})},function(){o({success:!1,finish:!0})})})}}}e.$inject=["URLS","$http","$q"],angular.module("actinver.services").factory("incomesInfo",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/incomes/incomes.html",controller:"incomesWidgetCtrl",controllerAs:"incomesWidget",scope:!0}}angular.module("actinver.directives").directive("incomes",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){c.editing={},c.sissuer={}}function i(t){var n=0,o={tipo:0,monto:t};return angular.isDefined(e.invest)&&(Object.values(e.invest).forEach(function(e){angular.isArray(e)&&e.forEach(function(e){n+=e.amount})}),e.portfolioValue<Number((n+t).toFixed(2))&&(o={tipo:1,monto:e.portfolioValue-n})),o}function s(e,t){return t+" "+e.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}var c=this,u=e.type,l=0;e.invest[u]=[],c.issuers_list=[],c.form={},c.sissuer={},c.editing={},c.listCF=function(e,t){return R.map(function(t){switch(e){case"client":t.text=t.description;break;default:t.text=t.name}return t},t)}("client",a.listClassFav),e.productsList&&(c.products=function(n){return c.listPrueba=[],R.map(function(n){return n.text=n.issuerName+" "+n.serie,"reportos"===e.type&&(n.text=n.investmentType+" "+t("currency")(n.minNetAmount)+" - "+t("currency")(n.maxNetAmount)),"derivatives"===e.type&&(n.text=n.nota),"actions"===e.type&&(n.text=null,c.listPrueba.push(n)),n},n)}(e.productsList)),c.listClassFav={optionClas:c.listCF},c.getIssuersInfo=function(){c.form.issuer=null,"all"===c.issuers&&n.getAllIssuers().then(function(e){angular.forEach(e.data,function(e){-1===c.issuers_list.indexOf(e.issuer.issuerSerie)&&c.issuers_list.push(e.issuer.issuerSerie)})})},c.calcAmount=function(t){var n=e.portfolioValue;void 0!==t.percentage&&""!==t.percentage&&(t.amount=t.percentage*n)},c.calcPercent=function(t){var n=e.portfolioValue;void 0!==t.amount&&""!==t.amount&&(t.percentage=t.amount/n)},c.recCalPercent=function(){var t=e.portfolioValue;angular.isDefined(e.invest)&&angular.isDefined(e.invest[u])&&angular.isArray(e.invest[u])&&e.invest[u].forEach(function(e){e.amount=e.percentage*t})},c.addProduct=function(){var n,a="object"==typeof c.form.issuer?c.form.issuer.text:c.form.issuer,r=R.findIndex(R.propEq("issuer",a))(e.invest[u]),l={};l=i(c.form.amount),l.tipo>0?o.info("Solo puedes invertir una cantidad menor o igual a "+s(l.monto,"$")):void 0!==a?-1===r?(n={id:Math.floor(Math.random()*(1e6+1)+1),issuer:a,amount:c.form.amount,percentage:c.form.percentage},"invest"===u&&t("filter")(e.issuers,c.form.issuer.issuerName).length>0&&(n.description=t("filter")(e.issuers,c.form.issuer.issuerName)[0].description),"derivatives"===u&&(n.description=c.form.issuer.aDetalle),e.invest[u].push(n),c.form={}):o.error("El producto seleccionado ya se ha agregado anteriormente"):o.error("El producto no ha sido seleccionado")};for(var d=0;d<e.invest[u].length;d++)c.editing[e.invest[u][d].id]=!1;c.edit=function(e){c.reset(c.sissuer.id),c.editing[e.id]=!0,c.sissuer=angular.copy(e)},c.delete=function(t){var n=R.findIndex(R.propEq("id",t))(e.invest[u]),a="¿Estás seguro de eliminar el registro?";c.reset(c.sissuer.id),o.warning(a).result.then(function(){-1!==n?(e.invest[u].splice(n,1),o.done("El registro se ha eliminado exitosamente.")):(a="Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk",o.error(a))}).finally(angular.noop).then(angular.noop,angular.noop)},c.reset=function(t){var n=R.findIndex(R.propEq("id",t))(e.invest[u]);e.invest[u][n]=c.sissuer,r()},c.save=function(t){var n,a,c,l;a=R.findIndex(R.propEq("id",t))(e.invest[u]),c=e.invest[u][a],n=i(0),l=e.portfolioValue-(e.totals-c.amount),n.tipo>0?o.info("Solo puedes invertir una cantidad menor o igual a "+s(l,"$")):r()},c.classificationFav=function(e){c.pruebaFilterFav=[],c.prueba=c.listPrueba.map(function(t){return e.idClassification==t.idClassification&&(t.text=t.issuerName,c.pruebaFilterFav.push(t)),t}),c.form.issuer=null},e.$watch("portfolioValue",function(){c.calcPercent(c.form),c.recCalPercent()}),e.$watch("invest",function(){l=0,angular.isDefined(e.invest)&&Object.values(e.invest).forEach(function(e){angular.isArray(e)&&e.forEach(function(e){l+=e.amount})}),e.totals=l},!0)}e.$inject=["$scope","$filter","proposalsProposalSrv","CommonModalsSrv","$rootScope"],angular.module("actinver.controllers").controller("proposalsInstrumentsCtrl",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/instruments/instruments.html",scope:{idx:"=",type:"@",title:"@",portfolioValue:"=",productsList:"=",invest:"=",totals:"=",issuers:"=?",isOpen:"=?"},controller:"proposalsInstrumentsCtrl",controllerAs:"ins"}}angular.module("actinver.directives").directive("instruments",e)}(),function(){"use strict";function e(e){return{restrict:"A",link:function(t,n){t.isLoading=function(){return e.pendingRequests.length>0},t.$watch(t.isLoading,function(e){e?n.show():n.hide()})}}}e.$inject=["$http"],angular.module("actinver.directives").directive("loading",e)}(),function(){"use strict";function e(e){return{restrict:"A",scope:!0,compile:function(t){0===t.children().length&&t.append("<div>"+t.text()+"</div>");var n=t.children(),o=$(t);return $(t).empty(),t.append('<div class="angular-marquee" style="float:left;">'+n.clone()[0].outerHTML+"</div>"),o.find(".angular-marquee").clone().css("display","none").appendTo(o),o.wrapInner('<div style="width:100000px" class="angular-marquee-wrapper"></div>'),{post:function(t,n,o){e(function(){function a(){y=parseInt(p.width()),b=parseInt(f.width()),v=b>y,v?h.show():h.hide(),p.height(f.height())}function r(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+":"+e[n]);return t.push(),"{"+t.join(",")+"}"}function i(e){var t=(b+y)/y*e/1e3;return v&&(t/=2),t}function s(){for(var e=document.body||document.createElement("div"),t=["webkit","moz","O","ms","Khtml"],n=0;n<t.length;n++)if(void 0!==e.style[t[n]+"AnimationName"]){var o=t[n].toLowerCase();return o}}function c(e){var t=s(),n=b,o="@-"+t+"-keyframes simpleMarquee"+e,a={"margin-left":-n+"px"},i=o+"{ 100%"+r(a)+"}",c=$("style");0!==c.length?c.filter(":last").append(i):$("head").append("<style>"+i+"</style>")}function u(){g.css("margin-left",0),""!==M&&g.css(M,"")}function l(e){var t=i(S),n=s();M="-"+n+"-animation",A=M+"-delay";var o="simpleMarquee"+e+" "+t+"s 0s linear infinite"
;if(g.css(M,o).css(A,"1s"),v)g.css("margin-left",0);else{var a=y+C;g.css("margin-left",a)}}function d(){a();var e=Math.floor(1e6*Math.random());c(e),l(e)}function m(){D?d():u()}var p=$(n),f=p.find(".angular-marquee:first"),g=p.find(".angular-marquee-wrapper"),h=p.find(".angular-marquee:last"),v=!1,y=parseInt(p.width()),b=parseInt(f.width()),C=20,S=3e3,D=!1,M="",A="";t.$watch(o.scroll,function(e){D=e,m()});var P;t.$on("recalculateMarquee",function(){console.log("receive recalculateMarquee event"),P&&e.cancel(P),P=e(function(){m()},500)}),t.$watch(o.duration,function(e){S=parseInt(e),D&&d()})})}}}}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("angularMarquee",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){var e=a.dashboardWebSocket+"?access_token="+sessionStorage.getItem("__token"),n=new SockJS(e);c.socketLastNews.stompclient=Stomp.over(n),c.socketLastNews.stompclient.debug=null,c.socketLastNews.stompclient.connect({},function(){c.socketLastNews.susbcribe=c.socketLastNews.stompclient.subscribe("/topic/feedInfosel/lastNews",function(e){s(JSON.parse(e.body))})},function(){t(r,3e3)})}function i(){null!==c.socketLastNews.stompclient&&(c.socketLastNews.susbcribe.unsubscribe(),c.socketLastNews.stompclient.disconnect())}function s(e){c.noticias.unshift(e),c.noticiasFilter=Array.from(c.noticias)}var c=this;c.noticias=[],c.noticiasFilter=[],c.opcionListarNoticias=0,c.socketLastNews={stompclient:null,susbcribe:null},e.$on("close-socket-last-news",function(){i()}),c.info={success:!1},n.getInfo().then(function(e){c.noticias=Array.from(e.data.result),c.noticiasFilter=Array.from(e.data.result),c.info=e},function(e){c.info=e,c.noticias=[]}),c.changeOpcion=function(t){c.opcionListarNoticias=t,c.noticiasFilter=1===t?c.noticias.slice(0,c.noticias.length>=10?10:c.noticias.length):Array.from(c.noticias),e.$broadcast("recalculateMarquee")},c.verListadoNews=function(){o.showNews(c.noticias)},r()}e.$inject=["$scope","$timeout","lastNewsInfo","newsModalSrv","URLS"],angular.module("actinver.controllers").controller("lastNewsCtrl",e)}(),function(){"use strict";function e(e,t,n){return{getInfo:function(){return n(function(n,o){t({method:"GET",url:e.dashboardNews||"",ignoreLoadingBar:!0,params:{language:"SPA"}}).then(function(e){e.status?n({success:!0,data:e.data,finish:!0}):o({success:!1,finish:!0})},function(){console.log("error"),o({success:!1,finish:!0})})})}}}e.$inject=["URLS","$http","$q"],angular.module("actinver.services").factory("lastNewsInfo",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/last-news/last-news.html",controller:"lastNewsCtrl",controllerAs:"lastNewsWidget"}}angular.module("actinver.directives").directive("lastNews",e)}(),function(){"use strict";function e(){function e(e,t){function n(){if(e.ngModel){e.ngModel=e.ngModel.toString();var t=e.ngModel.substr(2).replace(/./g,"*");i=e.ngModel.substr(0,2)+t,o()}}function o(){t.find("~ .mask-directive").html(i).css("display","block")}function a(){t.after('<div class="mask-directive" >'+(i||e.placeholder||"")+"</div>")}function r(){t.bind("focusout",function(){n()}),t.bind("focus",function(){t.find("~ .mask-directive").css("display","none")}),t.find("~ .mask-directive").bind("click",function(){t.focus()})}var i;e.$watch("ngModel",function(e){null!==e&&void 0!==e&&""!==e.toString().trim()||t.find("~ .mask-directive").css("display","none")}),function(){e.ngModel&&n(),a(),r()}()}return{restrict:"EA",templateUrl:"/scripts/directives/datetime/datetime.html",link:e,scope:{ngModel:"=",placeholder:"@"}}}angular.module("actinver.directives").directive("masks",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(e){var t=JSON.parse(JSON.parse(sessionStorage["ngStorage-user"])),n=-1;return angular.isDefined(t.roles)&&angular.isArray(t.roles)&&(n=t.roles.findIndex(function(t){return t.toUpperCase()===e})),n>-1}function u(){null!==g.socketNotification.stompclient&&(g.socketNotification.susbcribe.unsubscribe(),g.socketNotification.stompclient.disconnect())}function l(){a.getNotifications(sessionStorage.__username).then(function(e){g.numeroNotificacionesLumina=e.totalNoLeido}).catch(function(e){i(e.message),g.numeroNotificacionesLumina=0})}function d(){var e=t.LuminaWebSocket+"?access_token="+sessionStorage.getItem("__token"),n=new SockJS(e);g.socketNotification.stompclient=Stomp.over(n),g.socketNotification.stompclient.debug=null,g.socketNotification.stompclient.connect({},function(){var e=JSON.parse(JSON.parse(sessionStorage["ngStorage-user"])),t="/topic/notifications/"+e.userName;g.socketNotification.susbcribe=g.socketNotification.stompclient.subscribe(t,function(e){var t=JSON.parse(e.body);r.information(t)})},function(){o(d,3e3)})}function m(){var e={divMenu:document.getElementById("idMenuDiv").getBoundingClientRect().width-5,ulMenu:document.getElementById("idContentMenu").getBoundingClientRect().width+30};return e.ulMenu>e.divMenu?e.restantes=e.ulMenu-e.divMenu:e.restantes=0,e}function p(){var e=m();g.menu.showButtonLeft=!(g.menu.position<=0),g.menu.showButtonRight=!(g.menu.position>=e.restantes)}var f,g=this;g.sclient=JSON.parse(e.user),g.numeroNotificacionesLumina=0,g.socketNotification={stompclient:null,susbcribe:null},g.menu={showSlide:!1,position:0,showButtonLeft:!1,showButtonRight:!1},n.$on("closeSocketNotificationLumina",function(){c("ASESOR")&&u()}),n.$on("mensajesLuminaNoLeidos",function(e,t){g.numeroNotificacionesLumina=t}),g.validatePermiso=function(e){return!!s.userHasPermission(e)},g.slideMenuLeft=function(){g.menu.position=g.menu.position<=0?0:g.menu.position-30,p(),document.getElementById("idContentMenu").style.right=g.menu.position+"px",g.menu.position<=0?o.cancel(f):f=o(g.slideMenuLeft,150)},g.slideMenuRight=function(){var e=m();g.menu.position=g.menu.position>e.restantes?e.restantes:g.menu.position+30,p(),document.getElementById("idContentMenu").style.right=g.menu.position+"px",g.menu.position>e.restantes?o.cancel(f):f=o(g.slideMenuRight,150)},g.resize=function(){g.menu.position=0,document.querySelector("#idContentMenu").style.right="0px",p(),n.$apply()},g.mouseOver=function(e){1===e?g.slideMenuLeft():g.slideMenuRight()},g.mouseLeave=function(){f&&null!==f&&o.cancel(f)},function(){c("ASESOR")&&(l(),o(d,3e3)),p()}()}e.$inject=["$sessionStorage","URLS","$scope","$timeout","notificationLuminaSrv","LuminaModalsSrv","ErrorMessagesSrv","Auth"],angular.module("actinver.controllers").controller("menuCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/menu/menu.html",controller:"menuCtrl",controllerAs:"menuCtrl"}}angular.module("actinver.directives").directive("menu",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u){function l(e,t){S.tipoMedio.msg=e?"":t,S.tipoMedio.showMsg=!e}function d(){n.getMediaBank().then(function(e){S.loading=!1,1===e.data.outCommonHeader.result.result&&(S.Media=R.map(function(e){return e.id=e.identifier,e.text=e.instructionTypeDescription,e},e.data.result)),m(),p()})}function m(){if("subastas"===S.operationTypeMM){var t=u(new Date(S.sinstrument.settlementDate)).format("DDMMYYYY");i.bankReportoBuyingPowerQuery(e.contract.contractNumber,t).then(function(e){S.contractBalance=e.data.outBankReportoBuyingPowerQuery.totalPosition}).catch(function(){S.contractBalance=null})}else i.bankContractBalance(e.contract.contractNumber,"001").then(function(e){S.contractBalance=e.data.outBankContractBalance.balanceData.availableBalance}).catch(function(){S.contractBalance=null})}function p(){"directo"===e.type&&(S.operationTypeMM="directo",S.cmd={type:"titles",media:{}}),"reporto"===e.type&&(S.operationTypeMM="reporto",S.cmd={type:"import",media:{}}),"subastas"===e.type&&(S.operationTypeMM="subastas",S.cmd={type:"import",media:{}})}function f(e){var t="",n=-1;if(null!=e&&e.length>0){for(var o=0;o<e.length;o++)e.charCodeAt(o)>=48&&e.charCodeAt(o)<=57&&(t+=e[o]);t.length>0&&(n=parseInt(t)/24)}return parseInt(n)}function g(e){return e<=100&&e>=10&&null!=e?parseFloat("0."+String(e).replace(".","")):e<10&&e>=0&&null!=e?parseFloat("0.0"+String(e).replace(".","")):parseFloat(e/100)}function h(){S.cmd={},S.plazo_emision=null,S.titles=null,S.import=null,S.money_calc={},S.confirmModel=!1,S.capturedModel=!1,S.finishModel=!1,l(!0,""),S.getValuesData=!1,S.infoMessage="",p()}function v(){"Yield"===S.money_calc.originalConvention||"YIELD"===S.money_calc.originalConvention?y(S.money_calc.originalConvention,S.money_calc.originPrice):"Residual Dirty"!==S.money_calc.originalConvention&&"RESIDUAL_DIRTY"!==S.money_calc.originalConvention||y(S.money_calc.originalConvention,S.money_calc.dirtyPrice)}function y(t,o){var i=f("buy"===S.tab?S.sinstrument.term:S.sinstrument.selectedInstrument.term);if(null!==S.titles&&!S.import&&void 0!==S.titles&&"directo"===e.type&&"number"==typeof o||null!==S.import&&!S.titles&&void 0!==S.import&&"directo"===e.type&&"number"==typeof o){S.loading=!0,S.getValuesData=!1;var s,c="buy"===S.tab?S.sinstrument.exchangeRate:S.sinstrument.selectedInstrument.exchangeRate;"Yield"===t||"YIELD"===t?(t="YIELD",s="RESIDUAL_DIRTY",o=Number((o/100).toFixed(8))):"Residual Dirty"!==t&&"RESIDUAL_DIRTY"!==t||(t="RESIDUAL_DIRTY",s="YIELD",o/=c,o=Number(o.toFixed(8))),C={instrumentDesc:S.sinstrument.instrumentDesc,price:o,originalConvention:t,daysToMaturity:null==i?0:i,destinationConvention:s,language:"SPA"},"titles"===S.cmd.type?C.quantity=S.titles:"import"===S.cmd.type&&(C.amount=S.import/c,C.amount=Number(C.amount.toFixed(8))),n.getMoneyMarketCalculation(C).then(function(t){S.calc=!0,S.loading=!1;var n=t.data.outMMBondPriceCalculationQuery;if(S.money_calc={amount:n.amount?n.amount*c:S.import,titles:n.quantity||S.titles,originalConvention:n.originalConvention},"RESIDUAL_DIRTY"===n.originalConvention?(S.money_calc.originPrice=Number((100*n.calculatedPrice).toFixed(8)),S.money_calc.dirtyPrice=n.originPrice):"YIELD"===n.originalConvention&&(S.money_calc.originPrice=Number((100*n.originPrice).toFixed(8)),S.money_calc.dirtyPrice=n.calculatedPrice),"directo"===e.type){S.directSection.changeInstrument&&(S.directSection.changeInstrument=!1,S.directSection.valueOriginalCalculator=n);var o="import"===S.cmd.type?S.money_calc.titles:S.titles,a=S.directSection.valueOriginalCalculator.dirtyPrice*c;S.money_calc.dirtyPrice=Number((S.money_calc.dirtyPrice*c).toFixed(8));var r=(S.money_calc.dirtyPrice-a)*o,i=(a-S.money_calc.dirtyPrice)*o;S.directSection.pAndL="buy"===S.tab?r:i,S.directSection.pAndL=S.directSection.pAndL}}).catch(function(e){S.calc=!1,S.loading=!1,a.error(r.createError(e.data)),h()})}}function b(){S.tab="buy",S.loading=!0,d()}var C,S=this,D={};S.sinstrument,S.directSection={changeInstrument:!1,valueOriginalCalculator:null,pAndL:0};var M=JSON.parse(localStorage.getItem("contractSelected"));S.contractType=o.contractType(M.isPropia,M.isEligible,M.isDiscretionary),S.tipoMedio={msg:"",showMsg:!1};var A;S.changeOperationType=function(e){S.money_calc.titles=null,S.money_calc.amount=null,"titles"===e?S.import=null:S.titles=null},S.getValues=y,S.getValuesbyImport=v,S.cleanModels=h,S.confirm=function(){if("directo"===S.operationTypeMM)D={instrumentDesc:S.sinstrument.instrumentDesc,priceType:"RESIDUAL_DIRTY"===S.money_calc.originalConvention?"Residual Dirty":"Yield",bonusOrderType:"SECURITY",operationType:"SHORT_NAME",exchangeRate:1},"buy"===S.tab&&(D.daysToMaturity=f(S.sinstrument.term)),"sell"===S.tab&&(D.daysToMaturity=f(S.sinstrument.selectedInstrument.term)),"Yield"===S.money_calc.originalConvention||"YIELD"===S.money_calc.originalConvention?D.price=S.money_calc.originPrice:"Residual Dirty"!==S.money_calc.originalConvention&&"RESIDUAL_DIRTY"!==S.money_calc.originalConvention||(D.price=S.money_calc.dirtyPrice),"titles"===S.cmd.type?D.quantity=S.titles:"import"===S.cmd.type&&(D.amount=S.import),D=o.sendBinnacle(S.contractType,D,S.cmd),n.captureDirectBank(D).then(function(e){angular.forEach(e.data.outCommonHeader.result.messages,function(e){S.infoMessage+=e.responseMessage}),S.confirmModel=!0,S.capturedModel=!1}).catch(function(e){S.finish(),a.error(r.createError(e.data.messages))});else if("reporto"===S.operationTypeMM)D={securityGroupL1:S.sinstrument.bondType,securityGroupL2:S.sinstrument.bondType,amount:S.import,daysDuration:S.sinstrument.period,rate:g(S.money_calc.originPrice),bonusOrderType:"SECURITY"},D=o.sendBinnacle(S.contractType,D,S.cmd),n.captureReportoBank(D).then(function(e){angular.forEach(e.data.outCommonHeader.result.messages,function(e){S.infoMessage+=e.responseMessage}),S.confirmModel=!0,S.capturedModel=!1}).catch(function(e){S.finish(),a.error(r.createError(e.data.messages))});else if("subastas"===S.operationTypeMM){var t;if(S.import<=S.contractBalance){t="Yield"===S.cmd.auctionPrice.type.priceType||"YIELD"===S.cmd.auctionPrice.type.priceType?Number((100*S.cmd.auctionPrice.type.price).toFixed(8)):Number(S.cmd.auctionPrice.type.price.toFixed(8)),D={priceType:S.cmd.auctionPrice.type.priceType,price:t,amount:S.import,bonusOrderType:"PUBLIC_OFFERING",auctionName:S.sinstrument.auctionID},D=o.sendBinnacle(S.contractType,D,S.cmd);var i=u(S.cmd.binnacle.date).format("YYYY-MM-DD"),s=u(new Date(S.sinstrument.settlementDate)).format("YYYY-MM-DD"),c=new Date(i),l=new Date(s),d=l.getTime()-c.getTime(),m=Math.round(d/864e5);-1===Math.sign(m)&&(m=0),D.daysDuration=m,n.captureDirectBank(D).then(function(e){angular.forEach(e.data.outCommonHeader.result.messages,function(e){S.infoMessage+=e.responseMessage}),S.confirmModel=!0,S.capturedModel=!1}).catch(function(e){S.finish(),a.error(r.createError(e.data.messages))})}else a.error("El importe es mayor al poder de compra")}D.actionType="VALIDATE",D.buySell="buy"===S.tab?"B":"S",D.clientID=e.contract.contractNumber,D.language="SPA",D.comments=u(S.cmd.binnacle.date).format("YYYY-MM-DD")+" | "+S.cmd.media.type.text+" "+("3"===S.cmd.media.type.id?S.cmd.binnacle.phoneNumber+" "+S.cmd.binnacle.time:" ")+" | "+S.cmd.binnacle.comments,D.jsonDetails="",A=u(S.cmd.binnacle.date).format("YYYY-MM-DD")+" | "+S.cmd.media.type.text+" "+("3"===S.cmd.media.type.id?S.cmd.binnacle.phoneNumber+" "+S.cmd.binnacle.time:" ")+" | "+S.cmd.binnacle.comments},S.modify=function(){S.confirmModel=!1,S.infoMessage=""},S.capture=function(){D.actionType="SAVE";var e,t;"directo"===S.operationTypeMM?n.captureDirectBank(D).then(function(n){S.infoMessage=r.createError(n.data.outCommonHeader.result.messages),e=n.data.outMMDirectBondOrdersRegistration.orderData[0].orderID,t="La orden se envió de manera correcta.<br>OrderId: "+e+"<br>"+S.infoMessage,a.done(t),S.loading=!1,m(),S.finish()}).catch(function(e){S.finish(),a.error(r.createError(e.data.messages))}).finally(function(){h(),S.finish()}):"reporto"===S.operationTypeMM?(S.loading=!0,D=o.sendBinnacle(S.contractType,D,S.cmd),D.comments=A,n.captureReportoBank(D).then(function(n){S.infoMessage=r.createError(n.data.outCommonHeader.result.messages),e=n.data.outMMReportoBondOrdersRegistration.orderData[0].orderID,t="La orden se envió de manera correcta.<br>OrderId: "+e+"<br>"+S.infoMessage,a.done(t),S.loading=!1,S.finish()}).catch(function(e){S.finish(),a.error(r.createError(e.data.messages))}).finally(function(){S.loading=!1})):"subastas"===S.operationTypeMM&&(D=o.sendBinnacle(S.contractType,D,S.cmd),n.captureDirectBank(D).then(function(n){S.infoMessage=r.createError(n.data.outCommonHeader.result.messages),e=n.data.outMMDirectBondOrdersRegistration.orderData[0].orderID,t="La orden se envió de manera correcta.<br>OrderId: "+e+"<br>"+S.infoMessage,a.done(t),S.loading=!1,S.finish()}).catch(function(e){S.finish(),a.error(r.createError(e.data.messages))}).finally(function(){h(),S.finish()}));var i={Contrato:D.clientID,Movimiento:D.buySell};i=JSON.stringify(i),D.jsonDetails=i,S.confirmModel=!1,S.capturedModel=!0},S.finish=function(){h(),S.finishModel=!0,S.tab=null,e.instrument=null},S.onChangeTypeMedio=function(e,t){"10"===t.id?c.validateUserTokens().then(function(e){l(e.success,e.msg)}).catch(function(e){l(e.success,e.msg)}):l(!0,"")},e.$watch("type",function(){S.tab=!1,e.instrument=null,h()}),e.$watch("instrument",function(t,o){if(S.sinstrument=e.instrument,t!==o&&"directo"===e.type&&(S.directSection.changeInstrument=!0),h(),void 0!==S.sinstrument&&null!==S.sinstrument)if(S.confirmModel=!1,"POSICION"!==S.sinstrument.origen||"reporto"!==e.type&&"subastas"!==e.type)if("reporto"===e.type)S.tab="buy",b();else if("directo"===e.type)if("Yield"===S.sinstrument.priceType||"Residual Dirty"===S.sinstrument.priceType){var r=S.sinstrument.averagePurchaseMargin*S.sinstrument.exchangeRate,i="Residual Dirty"===S.sinstrument.priceType?Number(r.toFixed(8)):S.sinstrument.averagePurchaseMargin;S.tab="buy",S.titles=1,S.cmd.type="titles",S.getValuesData=!0,y(S.sinstrument.priceType,i),d()}else if("POSICION"===S.sinstrument.origen){var r=S.sinstrument.selectedInstrument.averagePurchaseMargin*S.sinstrument.selectedInstrument.exchangeRate,i="Residual Dirty"===S.sinstrument.selectedInstrument.priceType?Number(r.toFixed(8)):Number(S.sinstrument.selectedInstrument.averagePurchaseMargin.toFixed(8));S.tab="sell",S.titles=1,S.cmd.type="titles",S.getValuesData=!0,y(S.sinstrument.selectedInstrument.priceType,i),d()}else e.instrument=null;else"subastas"===e.type&&(S.tab="buy",n.getAuctionsPrice(S.sinstrument.auctionID).then(function(e){e.success&&(S.auctionPriceList=R.map(function(e){return e.text=e.priceType,e},e.data.outMoneyMarketAuctionsPriceQuery.auctionsQueryList.auctionRecord))}).catch(function(e){e.success?a.error(e.msg):a.systemError()}),d());else e.instrument=null})}e.$inject=["$scope","$q","moneyBankDollSrv","contractTypeSrv","CommonModalsSrv","ErrorMessage","fundBankDollSrv","$sessionStorage","loginSrvc","moment"],angular.module("actinver.controllers").controller("moneyBankDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getMoneyMarketCalculation=function(r){return o(function(o,i){function s(){e({method:"POST",url:t.getMoneyMarketCalculation,params:r}).then(function(e){1===e.data.outCommonHeader.result.result?o(e):i({success:!0,data:e.data.outCommonHeader.result.messages})},function(){a.systemError(),i(null)})}function c(e){i(e)}n.csrfValidate().then(s).catch(c)})},r.prototype.getMediaBank=function(){return e({method:"GET",url:t.getMediaBank+"?language=SPA"})},r.prototype.getCurrentCash=function(n){return e({method:"GET",url:t.getCurrentCash+n+"/1/1/0",params:{language:"SPA"}})},r.prototype.captureDirectBank=function(r){return o(function(o,i){function s(){e({method:"POST",url:t.captureDirectBank,params:r}).then(function(e){1===e.data.outCommonHeader.result.result?o(e):i({success:!0,data:e.data.outCommonHeader.result})},function(){a.systemError(),i(null)})}function c(e){i(e)}n.csrfValidate().then(s).catch(c)})},r.prototype.getAuctionsPrice=function(a){return o(function(o,r){function i(){e({method:"POST",url:t.getAuctionsPrice,data:$.param({auctionName:a,language:"SPA"})}).then(function(e){1===e.data.outCommonHeader.result.result?o({success:!0,data:e.data,msg:e.data.outCommonHeader.result.messages[0].responseMessage}):r({success:!0,data:null,msg:e.data.outCommonHeader.result.messages[0].responseMessage})},function(){r({success:!1,data:null,msg:""})})}function s(e){r(e)}n.csrfValidate().then(i).catch(s)})},r.prototype.captureReportoBank=function(r){return o(function(o,i){function s(){e({method:"POST",url:t.captureReportoBank,params:r}).then(function(e){1===e.data.outCommonHeader.result.result?o(e):i({success:!0,data:e.data.outCommonHeader.result})},function(){a.systemError(),i(null)})}function c(e){i(e)}n.csrfValidate().then(s).catch(c)})},new r}e.$inject=["$http","URLS","csrfSrv","$q","CommonModalsSrv"],angular.module("actinver.services").service("moneyBankDollSrv",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#station").focus()},250)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/money-bank-doll/money-bank-doll.html",scope:{type:"=?",contract:"=",instrument:"=",selected:"=",orders:"=?"},controller:"moneyBankDollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actMoneyBankDoll",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c){function u(e,t){f.tipoMedio.msg=e?"":t,f.tipoMedio.showMsg=!e}function l(){f.table="62",f.contractNumber=i.contract.contractNumber,!0===f.stepA&&(r.bands=null),r.distOrder=!1,r.pageConfig={itemsPerPage:5,fillLastPage:!0},u(!0,""),s.getMedia().then(function(e){var t=e.data.outContactMeansCatalog.contactMeansCatalogData.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description})}),f.Media=n}),t.getMoneyMarketContactMeansCatalogs("3","MONEDA","currency").then(function(e){var t=e.data.outMoneyMarketContactMeansCatalogs.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description,shortKey:e.shortKey,numericKey:e.numericKey})}),f.Currency=n.splice(1,6)}),t.getMoneyMarketContactMeansCatalogs("23","VOR","operationType").then(function(e){var t=e.data.outMoneyMarketContactMeansCatalogs.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description,shortKey:e.shortKey,numericKey:e.numericKey})}),f.operationType=n}),t.getMoneyMarketContactMeansCatalogs("23","RCTIPINS","instrument").then(function(e){var t=e.data.outMoneyMarketContactMeansCatalogs.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description,shortKey:e.shortKey,numericKey:e.numericKey})}),f.titleType=n}),t.getMoneyMarketContactMeansCatalogs("3","VALOR","settlement").then(function(e){var t=e.data.outMoneyMarketContactMeansCatalogs.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description,shortKey:e.shortKey,numericKey:e.numericKey})}),f.settlementType=n})}function d(){f.isDistribuida&&parseFloat(f.titlesQty)<parseFloat(f.totalTitles)?(f.validoNumTitulos=!1,f.msgTitulos="El número de titulos operados no debe ser mayor al de titulos distribuidos"):(f.msgTitulos=null,f.validoNumTitulos=!0)}function m(){f.cmd.media=null,f.operationTimeNumber=null,f.currencyTypeDesc=null,f.table=null,f.instrumentType=null,f.captureModel=null,f.confirmationModel=null,f.settlement=null,f.term=null,f.instrument=null,f.vencimiento=null,f.reporto=null,f.typeTitles=null,f.typeImport=null,f.titlesQty=null,f.amount=null,f.operationTypeV=null,f.price=null,f.adviserPrice=null,f.adviserSurtaxRate=null,f.adviserRate=null,f.adviserDiscountRate=null,f.adviserRate=null,f.adviserDiscountRate=null,f.adviserSurtaxRate=null,f.surtaxRate=null,f.price=null,f.discountRate=null,f.rate=null,f.issuerReporto=null,f.serieReporto=null,f.amount=null,r.bands=null,u(!0,"")}function p(){f.issuerReporto&&f.serieReporto?(g=f.issuerReporto,h=f.serieReporto):f.instrument?(g=f.instrument.issuer,h=f.instrument.serie):(f.issuerReporto||f.serieReporto)&&f.instrument||(g=" ",h=" ")}var f=this;f.stepA=!0,f.isDistribuida=!1,f.validoNumTitulos=!1,f.totalTitles=0,f.cmd={binnacle:{comments:"",date:new Date},type:"titles",media:{}};var g,h,v=JSON.parse(localStorage.getItem("contractSelected"));f.contractType=a.contractType(v.isPropia,v.isEligible,v.isDiscretionary),f.tipoMedio={msg:"",showMsg:!1},f.isValidoTitulo=function(){d()},f.changeOperationType=function(e){"titles"===e?f.import=null:f.titles=null},f.changeTab=function(e){f.tab=e,f.loading=null,f.confirmModel=null,f.confirmationModel=null,f.stepA=!1,f.stepB=!0,f.cleanModels(),l()},f.getType=function(e){f.getBands(e.id),"2"===e.id&&(f.issuerReporto="",f.serieReporto="",f.cmd.type="titles",null!==f.term&&void 0!==f.term&&t.getMoneyMarketIssuersSeriesQuery(f.settlement.shortKey,f.term).then(function(e){r.bands=e}).catch(function(e){m(),o.error(n.createError(e.data.messages))}))},f.getBands=function(e){"2"===e.id?null!==f.term&&void 0!==f.term&&t.getMoneyMarketIssuersSeriesQuery(f.settlement.shortKey,f.term).then(function(e){r.bands=e}).catch(function(e){m(),o.error(n.createError(e.data.messages))}):(f.cmd.type="import",r.bands=null)},f.distributedOrder=function(){r.distOrder=!0,f.totalTitles=0,f.advider="9055",t.getMoneyMarketAdviserContractsQuery(f.advider,f.contractNumber).then(function(e){r.adviserContracts=e.contract.contracts,f.isDistribuida=!1}).catch(function(e){m(),o.error(n.createError(e.data.messages))})},f.confirm=function(){p(),f.stepA=!1,f.stepB=!1,f.confirmModel=!0;var e=f.operationTimeNumber.replace(":","."),a={language:"SPA",contractNumber:f.contractNumber,issuer:g,serie:h,transactionType:"buy"===f.tab?1:2,term:f.term,amount:f.amount?f.amount:0,titlesQty:f.titlesQty?f.titlesQty:0,operationType:f.operationTypeV.shortKey,settlementType:f.settlement.shortKey,rate:f.rate?f.rate:0,discountRate:f.discountRate?f.discountRate:0,price:f.price?f.price:0,surtaxRate:f.surtaxRate?f.surtaxRate:0,distributedIndicator:f.isDistribuida?"SI":"NO",distributedTitlesQty:f.totalTitles,distributedTitlesAmount:0,instrumentType:f.instrumentType.shortKey,tableNumber:f.table,operationTimeNumber:e,currencyTypeDesc:f.currencyTypeDesc.numericKey,adviserRate:f.adviserRate?f.adviserRate:0,adviserDiscountRate:f.adviserDiscountRate?f.adviserDiscountRate:0,adviserPrice:f.adviserPrice?f.adviserPrice:0,adviserSurtaxRate:f.adviserSurtaxRate?f.adviserSurtaxRate:0};t.getMoneyMarketOrderQuotation(a).then(function(e){f.confirmModel=e}).catch(function(e){f.stepB=!0,f.stepA=!1,f.confirmModel=null,o.error(n.createError(e.data.messages))})},f.capture=function(){var s=e.sclient.data.name+" "+e.sclient.data.lastName+" "+e.sclient.data.secondLastName,c={language:"SPA",contractNumber:f.confirmModel.contractNumber,issuer:f.confirmModel.issuer,serie:f.confirmModel.serie,transactionType:"buy"===f.tab?1:2,term:f.confirmModel.term,amount:f.confirmModel.amount,titlesQty:f.confirmModel.titlesQty,operationType:f.confirmModel.operationType,settlementType:f.confirmModel.settlementType,rate:f.confirmModel.rate?f.confirmModel.rate:0,discountRate:f.confirmModel.discountRate?f.confirmModel.discountRate:0,price:f.price?f.confirmModel.price:0,surtaxRate:f.confirmModel.surtaxRate?f.confirmModel.surtaxRate:0,distributedIndicator:f.confirmModel.isDistribuida?"SI":"NO",distributedTitlesQty:f.confirmModel.titlesQty,distributedTitlesAmount:0,instrumentType:f.confirmModel.instrumentType,tableNumber:f.confirmModel.tableNumber,operationTimeNumber:f.confirmModel.operationTimeNumber,currencyTypeDesc:f.confirmModel.currencyTypeDesc,adviserRate:f.confirmModel.adviserInfo.adviserRate?f.confirmModel.adviserInfo.adviserRate:0,adviserDiscountRate:f.confirmModel.adviserInfo.adviserDiscountRate?f.confirmModel.adviserInfo.adviserDiscountRate:0,adviserPrice:f.confirmModel.adviserInfo.adviserPrice?f.confirmModel.adviserInfo.adviserPrice:0,adviserSurtaxRate:f.confirmModel.adviserInfo.adviserSurtaxRate?f.confirmModel.adviserInfo.adviserSurtaxRate:0,requestorName:s};c=a.sendBinnacle(f.contractType,c,f.cmd),t.getMoneyMarketOrderRegistration(c).then(function(e){var t;f.captureModel=e;var n=e.length>0?e[0].operationID:f.captureModel.operationReference;t="La "+("buy"===f.tab?"compra":"venta")+" se envió de manera correcta.",t+="<br>Con el folio de la operación <b>"+n+"</b>",o.done(t),i.$emit("updateTab"),f.finalStep=!0,f.stepA=!0,f.stepB=!1,f.confirmModel=null,f.captureModel=null,r.bands=null,m()}).catch(function(e){f.stepB=!0,f.stepA=!1,f.confirmModel=null,o.error(n.createError(e.data.messages))})},f.finish=function(){f.stepA=!0,f.stepB=!1,f.confirmModel=null,f.captureModel=null,r.bands=null,m()},f.modify=function(){f.stepB=!0,f.stepA=!1,f.confirmModel=!1},f.cleanModels=m,r.getInstrument=function(e){f.instrument=e},r.getValue=function(){var e=r.totalTitles;f.totalTitles=0,angular.forEach(e,function(e){""!==e&&(f.totalTitles+=parseFloat(e))}),d()},f.onChangeTypeMedio=function(e,t){"4"===t.id?c.validateUserTokens().then(function(e){u(e.success,e.msg)}).catch(function(e){u(e.success,e.msg)}):u(!0,"")}}e.$inject=["$sessionStorage","moneyDirectDollSrv","ErrorMessage","CommonModalsSrv","contractTypeSrv","$rootScope","$scope","transfersSrv","loginSrvc"],angular.module("actinver.controllers").controller("moneyDirectDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getMoneyMarketIssuersSeriesQuery=function(r,i){return o(function(o,s){function c(){e({method:"POST",url:t.getMoneyMarketIssuersSeriesQuery,params:{language:"SPA",settlementType:r,term:i}}).then(function(e){1===e.data.outCommonHeader.result.result?o(e.data.outMoneyMarketIssuersSeriesQuery.issuerData):s({success:!0,data:e.data.outCommonHeader.result})},function(){a.systemError(),s(null)})}function u(e){s(e)}n.csrfValidate().then(c).catch(u)})},r.prototype.getMoneyMarketContactMeansCatalogs=function(n,o){return e({method:"GET",url:t.getMoneyMarketContactMeansCatalogs+n+"/"+o,params:{language:"SPA"}})},r.prototype.getMoneyMarketAdviserContractsQuery=function(r,i){return o(function(o,s){function c(){e({method:"POST",url:t.getMoneyMarketAdviserContractsQuery,params:{language:"SPA",adviserNumber:r,contractNumber:i}}).then(function(e){1===e.data.outCommonHeader.result.result?o(e.data.outMoneyMarketAdviserContractsQuery):s({success:!0,data:e.data.outCommonHeader.result})},function(){a.systemError(),s(null)})}function u(e){s(e)}n.csrfValidate().then(c).catch(u)})},r.prototype.getMoneyMarketOrderQuotation=function(r){return o(function(o,i){function s(){e({method:"POST",url:t.getMoneyMarketOrderQuotation,data:$.param(r)}).then(function(e){1===e.data.outCommonHeader.result.result?o(e.data.outMoneyMarketOrderQuotation.orderQuotation):i({success:!0,data:e.data.outCommonHeader.result})},function(){a.systemError(),i(null)})}function c(e){i(e)}n.csrfValidate().then(s).catch(c)})},r.prototype.getMoneyMarketOrderRegistration=function(r){return o(function(o,i){function s(){console.log("modelo directo",r);var n={Instrumento:r.issuer,"Tipo inversión":"DIRECTO",Plazo:r.term,"Tasa descuento cliente":r.discountRate,"Tasa descuento asesor":r.adviserDiscountRate,Titulos:r.titlesQty};r.jsonDetails=JSON.stringify(n),e({method:"POST",url:t.getMoneyMarketOrderRegistration,data:$.param(r)}).then(function(e){1===e.data.outCommonHeader.result.result?o(e.data.outAdviserPendingOpRegistration?e.data.outAdviserPendingOpRegistration.operationsDetails:e.data.outMoneyMarketOrderRegistration.orderRegistration):i({success:!0,data:e.data.outCommonHeader.result})},function(){a.systemError(),i(null)})}function c(e){i(e)}n.csrfValidate().then(s).catch(c)})},new r}e.$inject=["$http","URLS","csrfSrv","$q","CommonModalsSrv"],angular.module("actinver.services").service("moneyDirectDollSrv",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/money-direct-doll/money-direct-doll.html",scope:{contract:"="},controller:"moneyDirectDollCtrl",controllerAs:"doll"}}angular.module("actinver.directives").directive("actMoneyDirectDoll",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/money-direct-doll/table-direct.html",scope:{contract:"@",instrument:"=",tab:"="},controller:"moneyDirectDollCtrl",controllerAs:"doll"}}angular.module("actinver.directives").directive("actTableDirect",e)}(),function(){"use strict";function e(e){return{restrict:"A",scope:{ngModel:"=",currency:"@"},template:"<div ng-class=\"{'blink-me red': red, 'blink-me green': green }\"> {{ ::currency }} {{ ngModel | currency: \"\" : 3 }}</div>",link:function(t){function n(){t.green=!1,t.red=!1}function o(o,s){i||(i=!0,n(),e.cancel(a),e.cancel(r),t.green=o>s,t.red=o<s,a=e(function(){n()},1500),r=e(function(){i=!1},450))}var a,r,i=!1;t.$watch("ngModel",function(e,t){t!==e&&o(e,t)})}}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("ngBlink",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){v.cmd={type:"titles",media:{}}}function c(){v.cmd.typeBank="efectivo"}function u(e){var t,n=e.mode,o=e.date;if("day"===n){var a=R.find(function(e){var t=new Date(e.operationDate)
;return o.getDate()===t.getDate()&&o.getMonth()===t.getMonth()&&o.getFullYear()===t.getFullYear()},v.dollDescription.fund.operationDatesData.operationDateItem);if(a){var r=a?new Date(a.operationDate):null;t=R.find(function(e){var t=new Date(e);return r.getDate()===t.getDate()&&r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear()},v.dollDescription.fund.holidayDatesData.holidayDate)}return!!t||!a}return!1}function l(){t.getDoll2(e.contract,v.cmd.station,v.tab,v.anticipedSell).then(function(e){1===e.data.outCommonHeader.result.result&&(v.dollDescription=e.data.outFundQuery,v.cmd.dates=v.dollDescription.fund.operationDatesData.operationDateItem[0],v.orderDate=v.cmd.dates.operationDate)})}function d(e){return R.find(function(t){return t.operationDate===e},v.dollDescription.fund.operationDatesData.operationDateItem)}function m(t){r.getStations(e.contract,t).then(function(e){v.stations=e.data.outInvestmentIssuersQuery.issuer}),s()}function p(){l(),t.getDoll(e.contract).then(function(e){1===e.data.outCommonHeader.result.result&&(v.currentCash=e.data.outA2KContractBalance)}),r.getDetailStations(v.cmd.station.issuerName||v.cmd.station.issuer,v.cmd.station.serie).then(function(e){if(1===e.data.outCommonHeader.result.result){var t=e.data.outFundOperationDataQuery.fundOperationData;v.rulesBuy=R.find(function(e){return"COMPRA"===e.movementType.trim()},t),v.rulesSell=R.find(function(e){return"VENTA"===e.movementType.trim()},t)}})}function f(e,t){v.newState=!t,v.tab=t?v.tab:null,h=e,v.cmd.station=h,g(),p()}function g(){v.cmd={type:"titles",media:{},station:h},v.captureModel=null,v.confirmationModel=null,v.cmd.dates=v.dollDescription?v.dollDescription.fund.operationDatesData.operationDateItem[0]:null}var h,v=this;v.stations=[],v.currentDate=n("date")(new Date,"dd/MM/yyyy"),v.changeAnticipedSell=function(){l()},e.datepickerOptions={showWeeks:!1,formatMonth:"MMM",yearColumns:3,dateDisabled:u},o.getMedia().then(function(e){var t=e.data.outContactMeansCatalog.contactMeansCatalogData.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description})}),v.Media=n}),v.findDate=function(){v.cmd.dates=d(new Date(v.orderDate).getTime())},v.AddStation=function(e){f(e,"input")},e.$watch("contract",function(e,t){R.equals(e,t)||(v.newState=!1,v.tab=null,g(),p())}),e.$watch("station",function(e,t){R.equals(e,t)||f(e)}),e.$watch("id",function(e,t){R.equals(e,t)||m(e)}),e.changeSettlement2=function(e){v.cmd[e].typeValue=n("currencyCustom")(v.cmd[e].typeValue2/v.dollDescription.fund.price,0)},e.changeSettlement=function(e){v.cmd[e].typeValue2=v.cmd[e].typeValue*v.dollDescription.fund.price},v.changeTab=function(n){"sell"===n&&(c(),t.getBanks(e.contract).then(function(e){1===e.data.outCommonHeader.result.result?v.bankModel=R.map(function(e){return e.text=e.bankAccounts.bankName,e},e.data.outDestinationAccountQuery.outA2KBankAccountsQuery.bankAccountsList):v.bankModel=[]})),v.newState=!1,v.tab=n,e.columnsExpand=!1,e.focusElement(),v.cmd.station&&p()},v.confirm=function(){v.cmd.evtentType=v.tab,t.confirmDoll(v.cmd,e.contract).then(function(e){v.confirmationModel=e.data},function(e){if(e){var t=R.find(function(e){if("N"===e.responseType)return"FATAL"===e.responseCategory||"ERROR"===e.responseCategory})(e.data),n=t?t.responseMessage:"Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk";a.error(n)}})},v.capture=function(){var n=i.sclient.data.name+" "+i.sclient.data.lastName+" "+i.sclient.data.secondLastName;t.captureDoll(v.cmd,e.contract,n,v.confirmationModel).then(function(t){if(1===t.data.outCommonHeader.result.result){var n;"FundOrderRegistration"===t.data.outCommonHeader.operationName?(v.captureModel=t.data.outFundOrderRegistration.fundOrderResult,n="La "+("buy"===v.tab?"compra":"venta")+" se envió de manera correcta.",n+="<br>Con el folio de la operación <b>"+v.captureModel.issuerTitlesSold.operationReference+"</b>"):(v.captureModel=v.confirmationModel,n=t.data.outAdviserPendingOpRegistration.operationsDetails[0].message,n+="<br>Con el ID de operación <b>"+t.data.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),e.$emit("updateTab"),a.done(n)}})},v.cleanModels=g,v.modify=function(){v.confirmationModel=null},v.finally=function(){g()},m(e.id)}e.$inject=["$scope","dollSrv","$filter","transfersSrv","CommonModalsSrv","investmentSrv","$sessionStorage"],angular.module("actinver.controllers").controller("moneyDirectoDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}function i(){return n(function(n,o){function a(e){sessionStorage.setItem("__csrf",e.headers("X-CSRF-TOKEN")),n({success:!0})}function r(e){o({success:!1,data:{},error:e,message:"Ha ocurrido un error de seguridad"})}e.get(t.csrfRest).then(a).catch(r)})}return r.prototype.getDoll=function(n){return e({method:"GET",url:t.getInitDoll+n+"/1/1/0/?language=SPA"})},r.prototype.getDoll2=function(n,o,a,r){return r=r?1:0,e({method:"GET",url:t.getInitDoll2+n+"/"+(o.issuerName||o.issuer).trim()+"/"+o.serie+"/"+("buy"===a?1:2)+"/0/"+r+"?language=SPA"})},r.prototype.getBanks=function(n){return e({method:"get",url:t.getDollAccounts+"02/01/"+n+"?language=SPA&accountStatus=1"})},r.prototype.confirmDoll=function(r,s){var c=r.evtentType,u={contractNumber:s,buyCaptureType:0,buyExecutionDate:a(r.dates.settlementDate).format("DDMMYYYY"),buyIssuerName:null,buyOperationDate:a(r.dates.operationDate).format("DDMMYYYY"),buySerie:null,buyTitlesAmount:0,buyTitlesQty:0,captureType:"titles"===r.type?1:2,executionDate:a(r.dates.settlementDate).format("DDMMYYYY"),movementType:"sell"===r.evtentType?2:1,netAmount:"buy"===r.evtentType?r[c].typeValue2:r.station.lastPrice,operationDate:a(r.dates.operationDate).format("DDMMYYYY"),settlementType:null,titlesAmount:"titles"===r.type?r[c].typeValue:r[c].typeValue2,titlesQty:r[c].typeValue,issuerName:r.station.issuer?r.station.issuer:r.station.issuerName,serie:r.station.serie,clabe:0,anticipatedSell:null,settlementDate:a(r.dates.settlementDate).format("DDMMYYYY"),registrationType:"titles"===r.type?1:2,buyCLABE:0,buyNetAmount:0,buyRegistrationType:0};return n(function(n,a){function r(){e({method:"post",url:t.confirmDoll,data:$.param(u)}).then(function(e){1===e.data.outCommonHeader.result.result?n({success:!0,data:e.data.outFundOrderQuotation.fundOrderResult}):a({success:!0,data:e.data.outCommonHeader.result.messages})},function(){o.systemError(),a(null)})}function s(e){a(e)}i().then(r).catch(s)})},r.prototype.captureDoll=function(r,s,c,u){var l=r.evtentType,d={Contrato:s,Movimiento:"buy"===r.evtentType?"COMPRA":"VENTA",Emisora:u.issuerTitlesSold.issuerName,Precio:u.issuerTitlesSold.netAmount,"Títulos":u.issuerTitlesSold.titlesQty,"Ejecución de la orden":a(u.issuerTitlesSold.operationDate).format("DD/MM/YYYY"),"Liquidación de la orden":a(u.issuerTitlesSold.settlementDate).format("DD/MM/YYYY")};d=JSON.stringify(d);var m={contractNumber:s,buyIssuerName:null,clabe:0,issuerName:r.station.issuer?r.station.issuer:r.station.issuerName,movementType:"sell"===r.evtentType?2:1,operationDate:a(r.dates.operationDate).format("DDMMYYYY"),settlementDate:a(r.dates.settlementDate).format("DDMMYYYY"),registrationType:"titles"===r.type?1:2,serie:r.station.serie,titlesAmount:"titles"===r.type?r[l].typeValue:r[l].typeValue2,titlesQty:r[l].typeValue,netAmount:"buy"===r.evtentType?r[l].typeValue2:r.station.lastPrice,buyOperationDate:a(r.dates.operationDate).format("DDMMYYYY"),buyRegistrationType:0,buySettlementDate:a(r.dates.operationDate).format("DDMMYYYY"),buyTitlesAmount:0,buyTitlesQty:0,buySerie:null,settlementType:null,anticipatedSell:null,name:c,buyCLABE:0,buyNetAmount:0,instructionDate:a(r.binnacle.date).format("DDMMYYYY"),instructionTime:"TELEFONO"===r.media.type.text?r.binnacle.time+":00":null,extensionNumber:"TELEFONO"===r.media.type.text?r.binnacle.phone:null,tracingKey:r.media.type.id,comments:r.binnacle.comments,jsonDetails:d};return n(function(n,a){function r(){e({method:"post",url:t.capture,data:$.param(m)}).then(function(e){1===e.data.outCommonHeader.result.result?n({success:!0,data:e.data}):a({success:!0,data:e.data.outCommonHeader.result.messages})},function(){o.systemError(),a(null)})}function s(e){a(e)}i().then(r).catch(s)})},new r}e.$inject=["$http","URLS","$q","CommonModalsSrv","moment"],angular.module("actinver.services").service("dollSrv",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#station").focus()},250)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/money-directo-doll/money-directo-doll.html",scope:{station:"=",id:"=",contract:"@",columnsExpand:"=?",tipooperacion:"="},controller:"moneyDirectoDollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actMoneyDirectoDoll",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(e,t){g.tipoMedio.msg=e?"":t,g.tipoMedio.showMsg=!e}function c(){l(),o.getCurrentCash(e.contract.contractNumber).then(function(n){1===n.data.outCommonHeader.result.result&&(g.currentCash=n.data.outA2KContractBalance.balance.buyingPowerData.cash48),t.getMedia().then(function(e){var t=e.data.outContactMeansCatalog.contactMeansCatalogData.contactMeans,n=[];angular.forEach(t,function(e){n.push({id:e.key,text:e.description})}),g.Media=n}),g.loading=!1,e.focusElement()})}function u(){g.invest?g.interestCattle=g.sinstrument.maxRate/36e3*g.invest*g.sinstrument.minTerm:g.interestCattle=0}function l(){g.cmd={media:{}},g.interestCattle=0,g.invest=null,g.transaction=null,g.confirmationModel=null,g.captureModel=null,g.operationReference=null,g.optimumRate=null,g.term=null,s(!0,"")}function d(){g.loading=!0,g.transaction={contract:e.contract,invest:{amount:g.invest},sinstrument:g.sinstrument,operationReference:g.operationReference,optimumRate:g.optimumRate,term:g.term},o.confirmDoll(g.transaction).then(function(e){g.confirmationModel=e,g.loading=!1}).catch(function(e){g.loading=!1;var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),n.error(t)})}function m(){g.confirmationModel=null}function p(){g.loading=!0;var t=a.sclient.data.name+" "+a.sclient.data.lastName+" "+a.sclient.data.secondLastName;o.captureDoll(g.transaction,g.cmd,t,g.contractType).then(function(t){var o;"BondMarketOrderRegistration"===t.outCommonHeader.operationName?(g.captureModel=t.outBondMarketOrderRegistration.bondOrder,o="La "+("buy"===g.tab?"compra":"venta")+" se envió de manera correcta.",o+="<br>Con el folio de la operación <b>"+g.captureModel.orderReference+"</b>"):(g.captureModel=g.confirmationModel,o=t.outAdviserPendingOpRegistration.operationsDetails[0].message,o+="<br>Con el ID Registro <b>"+t.outAdviserPendingOpRegistration.operationsDetails[0].operationID+"</b>"),g.finish(),e.$emit("updateItems"),n.done(o),g.loading=!1}).catch(function(e){g.loading=!1;var t="";angular.forEach(e,function(e){t+=e.responseMessage+"<br>"}),n.error(t),g.finish()})}function f(){e.instrument=null,g.operationReference=null,g.optimumRate=null,g.term=null}var g=this;g.sinstrument,g.currentCash=0,g.interestCattle=0,g.transaction={},g.calculateInterest=u,g.cleanModels=l,g.modify=m,g.confirm=d,g.capture=p,g.finish=f;var h=JSON.parse(localStorage.getItem("contractSelected"));g.contractType=r.contractType(h.isPropia,h.isEligible,h.isDiscretionary),g.tipoMedio={msg:"",showMsg:!1},g.onChangeTypeMedio=function(e,t){"4"===t.id?i.validateUserTokens().then(function(e){s(e.success,e.msg)}).catch(function(e){s(e.success,e.msg)}):s(!0,"")},e.$watch("instrument",function(){g.sinstrument=e.instrument,null!==g.sinstrument&&(g.loading=!0,c())})}e.$inject=["$scope","transfersSrv","CommonModalsSrv","moneyDollSrv","$sessionStorage","contractTypeSrv","loginSrvc"],angular.module("actinver.controllers").controller("moneyDollCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){}return i.prototype.getCurrentCash=function(n){return e({method:"GET",url:t.getCurrentCash+n+"/1/1/0",params:{language:"SPA"}})},i.prototype.confirmDoll=function(a){var r={contractNumber:a.contract.contractNumber,term:a.term,netAmount:a.invest.amount,rateOfReturn:a.sinstrument.maxRate,valueType:a.sinstrument.valueType,minTerm:a.sinstrument.minTerm,maxTerm:a.sinstrument.maxTerm,maxRate:a.sinstrument.maxRate,minAmount:a.sinstrument.minNetAmount,maxAmount:a.sinstrument.maxNetAmount,minRate:a.sinstrument.minRate,optimumRate:a.optimumRate?a.optimumRate:a.sinstrument.maxRate,promoter:0};return a.operationReference&&(r.operationReference=a.operationReference),n(function(n,a){function i(){e({method:"POST",url:t.confirmMoneyDoll,data:$.param(r)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.outBondMarketOrderQuotation.bondMarketData):a(e.data.outCommonHeader.result.messages)})}function s(e){a(e)}o.csrfValidate().then(i).catch(s)})},i.prototype.captureDoll=function(i,s,c,u){var l={Instrumento:i.sinstrument.description,"Tipo inversión":"REPORTO",Plazo:i.sinstrument.minTerm,Tasa:i.sinstrument.maxRate,"Fecha vencimiento":a(i.sinstrument.dueDate).format("DD/MM/YYYY"),Importe:i.invest.amount};l=JSON.stringify(l);var d={contractNumber:i.contract.contractNumber,term:i.term,netAmount:i.invest.amount,rateOfReturn:i.optimumRate?i.optimumRate:i.sinstrument.maxRate,valueType:i.sinstrument.valueType,minTerm:i.sinstrument.minTerm,maxTerm:i.sinstrument.maxTerm,maxRate:i.sinstrument.maxRate,minAmount:i.sinstrument.minNetAmount,maxAmount:i.sinstrument.maxNetAmount,minRate:i.sinstrument.minRate,optimumRate:i.optimumRate?i.optimumRate:i.sinstrument.maxRate,promoter:0,promoterNumber:0,recordStatus:"V",status:"I",name:c,jsonDetails:l};return i.operationReference&&(d.operationReference=i.operationReference),d=r.sendBinnacle(u,d,s),n(function(n,a){function r(){e({method:"POST",url:t.doMoneyTransaction,data:$.param(d)}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data):a(e.data.outCommonHeader.result.messages)})}function i(e){a(e)}o.csrfValidate().then(r).catch(i)})},new i}e.$inject=["$http","URLS","$q","csrfSrv","moment","contractTypeSrv"],angular.module("actinver.services").service("moneyDollSrv",e)}(),function(){"use strict";function e(e){function t(t,n){t.focusElement=function(){e(function(){n.find("#invest").focus()},250)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/money-doll/money-doll.html",scope:{contract:"=",instrument:"="},controller:"moneyDollCtrl",controllerAs:"doll",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("actMoneyDoll",e)}(),function(){"use strict";function e(e){function t(t,n){t.$watch(e.isLoggedIn,function(){e.userHasPermission(t.permission)?n.show():n.hide()})}return{restrict:"A",scope:{permission:"="},link:t}}e.$inject=["Auth"],angular.module("actinver.directives").directive("permission",e)}(),function(){"use strict";function e(e,t){var n=this;n.details={finish:!1,data:null},e.getInfo().then(function(e){n.details=e,n.openMonthGoalDetails=function(){t.open({controller:"monthGoalModalCtrl",controllerAs:"monthGoalModal",templateUrl:"/scripts/directives/month-goal/month-goal-modal.html",resolve:{info:e.data}}).result.then(function(e){n.selected=e},function(){return!1})}},function(e){n.details=e})}e.$inject=["monthGoalInfo","$uibModal"],angular.module("actinver.controllers").controller("monthGoalCtrl",e)}(),function(){"use strict";function e(e,t,n){return{getInfo:function(){return n(function(n,o){t({method:"GET",url:e.dashboardMonthGoal}).then(function(e){var t={};t={amount:null,grow:null,goal_left:null,percentage:null,chart:{colors:["#7ed321","#00bebe","#3c86f6","#f5f047"],labels:["DINERO","SEGUROS","CRÉDITOS","FONDOS"],data:[35,25,30,10]},modal_info:{col1:{title:"Productos"}}},e.data.status?(t.amount=e.data.result.amount,t.grow=e.data.result.grow,t.goal_left=t.grow>=t.amount?0:t.amount-t.grow,t.percentage=100*t.grow/t.amount,t.infoModal=e.data.result.infoModal,Math.round(t.percentage)!==t.percentage&&(t.percentage=t.percentage.toFixed(1)),n({success:!0,data:t,finish:!0})):o({success:!1,finish:!0})},function(){o({success:!1,finish:!0})})})}}}e.$inject=["URLS","$http","$q"],angular.module("actinver.services").factory("monthGoalInfo",e)}(),function(){"use strict";function e(e,t){var n=this;n.modal_info=t.modal_info,n.infoModal=t.infoModal,n.close_modal=function(){e.dismiss("cancel")}}e.$inject=["$uibModalInstance","info"],angular.module("actinver.controllers").controller("monthGoalModalCtrl",e)}(),function(){"use strict";function e(e,t){function n(e,n){e.$watch("monthGoalWidget.details.data",function(){e.monthGoalWidget.details.data&&t(function(){var t=e.monthGoalWidget.details.data,o=n.find(".percent"),a=o.find("> strong");o.removeClass("negative"),t.label_pos=o.find("> div").width()-a.width()/2,t.percentage<=0&&o.addClass("negative"),a.width()>=o.find("> div").width()&&(t.label_pos=0),t.label_pos+a.width()>o.width()&&(t.label_pos=o.width()-a.width())})})}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/month-goal/month-goal.html",link:n,controller:"monthGoalCtrl",controllerAs:"monthGoalWidget"}}e.$inject=["$uibModal","$timeout"],angular.module("actinver.directives").directive("monthGoal",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/outline/outline.html"}}angular.module("actinver.directives").directive("outline",e)}(),function(){"use strict";function e(e,t){var n=this;n.products_list=[],n.getSubproducts=function(o,a){e.model.products[a].subproducts={},t.getSubProducts(a).then(function(e){n.products_list[o].subproducts=e.data},function(){n.products_list[o].subproducts=[]})},function(){t.getProducts().then(function(e){angular.forEach(e.data,function(e){e.subproducts={},n.products_list.push(e)})})}()}e.$inject=["$scope","proposalsProposalSrv"],angular.module("actinver.controllers").controller("proposalsProductsCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/products/products.html",scope:{model:"="},controller:"proposalsProductsCtrl",controllerAs:"list"}}angular.module("actinver.directives").directive("products",e)}(),function(){"use strict";function e(){var e=this;e.propertyName="issuer",e.reverse=!1,e.sortBy=function(t){e.reverse=e.propertyName===t&&!e.reverse,e.propertyName=t}}angular.module("actinver.controllers").controller("portfolioDetailsBankCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/portfolio-details/details-bank.html",scope:{title:"@",infoResume:"="},controller:"portfolioDetailsBankCtrl",controllerAs:"details"}}angular.module("actinver.directives").directive("portfolioDetailsBank",e)}(),function(){"use strict";function e(e){var t=this,n={valuation:0,appreciation:0};t.contracts=!1,t.contracts_totals=n,t.contract_totals=[],t.contract_info=[],t.topic_by_currency=[],t.topicsbank={"ACCIONES DE SOCIEDADES DE INVERSION DE INSTRUMENTOS DE DEUDA":"siid","ACCIONES DE SOCIEDADES DE INVERSION":"asi"},t.getContractTopicInfo=function(n){var o=n.data,a=e("groupJSON")(o,"market"),r=e("sumByColumn")(o,"lastPrice"),i=e("sumByColumn")(o,"appreciation");t.contract_totals.push([r,i]),t.contract_info.push([a]),t.contracts_totals.valuation+=r,t.contracts_totals.appreciation+=i},t.getTopicInfoCurrency=function(t){return e("groupJSON")(t,"currencyTypeDesc")},t.getFundTypes=function(t){return e("groupJSON")(t,"fundType")}}e.$inject=["$filter"],angular.module("actinver.controllers").controller("portfolioDetailsCtrl",e)}(),function(){"use strict";function e(){var e=this;e.propertyName="issuer",e.reverse=!1,e.sortBy=function(t){e.reverse=e.propertyName===t&&!e.reverse,e.propertyName=t}}angular.module("actinver.controllers").controller("portfolioDetailsCurrencyCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/portfolio-details/details-currency.html",scope:{title:"@",infoResume:"="},controller:"portfolioDetailsCurrencyCtrl",controllerAs:"details"}}angular.module("actinver.directives").directive("portfolioDetailsCurrency",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/portfolio-details/details.html",scope:{sclient:"=",topics:"=",contractInfo:"=",showTotals:"@"},controller:"portfolioDetailsCtrl",controllerAs:"pdetail"}}angular.module("actinver.directives").directive("portfolioDetails",e)}(),function(){"use strict";function e(e,t,n,o){function a(a){a.edit=function(){t.addActivity("Modificar actividad",a.ngModel).result.then(function(){e.done("La actividad se actualizo de manera exitosa."),a.$emit("updateDetailProspect")})},a.complete=function(){e.warning("¿Esta seguro que desea completar la actividad seleccionada?").result.then(function(){n.completeActivity(a.ngModel.idActivityStage).then(function(){e.done("La actividad se completo de manera exitosa."),a.$emit("updateDetailProspect")})})},a.close=function(){var t=JSON.parse(o.user);e.warning("¿Deseas eliminar esta actividad?").result.then(function(){var o={language:"SPA",idActivityStage:a.ngModel.idActivityStage,mail:t.mail,temp:"",sendNotification:!0,outlookId:a.ngModel.outlookId};n.removeActivity(o).then(function(){e.done("La actividad se eliminó de manera exitosa."),a.$emit("updateDetailProspect")})})}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/prospect-activity/activity.html",scope:{ngModel:"=",hiddeTool:"=?"},link:a}}e.$inject=["CommonModalsSrv","prospectModalsSrv","prospectSrv","$sessionStorage"],angular.module("actinver.directives").directive("prospectActivity",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(e,t){return R.map(function(t){switch(e){case"client":t.text=t.description;break;default:t.text=t.name}return t},t)}var u=this,l=e.model.form,d=l.portfolio;u.fields={strategies:[]},u.selected_portfolio=!1,u.resetPortfolioChilds=function(e){0===e&&d.length>1&&d.pop(),delete d[e].strategyItems,delete d[e].invest,delete d[e].profile_type,delete d[e].client_type,delete u.manual_info,d[e].totals=0,"model"===d[e].type&&o.getProfiles().then(function(e){u.fields.profiles_types=c("profiles",e.data)})},u.checkPortfolio=function(t,n){d[n].value=1e6,e.model.form.portfolio[e.idx].invest&&(e.model.form.portfolio[e.idx].invest.invest=[],d[n].totals=0,u.openIinvest=!1),"model"===d[n].type?u.modelConfig(t,n):(u.manualConfig(t.key),u.getClassFav())},u.modelConfig=function(e,n){var r=e.key,i=[];u.hide_strategies=!1,d[n].strategyItems={},d[n].strategy="",r<0?(u.hide_strategies=!0,u.fields.strategies[n]=c("strategies",t("orderBy")(i,"key"))):o.getStrategies(r).then(function(e){angular.forEach(e,function(e){angular.forEach(e.data,function(e){i.push(e)})}),angular.forEach(i,function(e){e.key=parseInt(e.key)}),u.fields.strategies[n]=c("strategies",t("orderBy")(i,"key"))},function(){a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")})},u.getStrategyDetails=function(e,n){d[n].strategyItems={},o.getStrategyDetail(e.key).then(function(e){angular.forEach(e.data.limits,function(e){d[n].strategyItems[e.subGroup.grouper.name]={info:[]}}),angular.forEach(d[n].strategyItems,function(n,o){n.info=t("filter")(e.data.limits,{subGroup:{grouper:{name:o}}})})})},u.manualConfig=function(e){return u.manual_info=!1,n.all([o.getInvIssuersCatalog(e),o.getBandsCatalog(e),o.getIssuersCatalog(e),o.getFavorites(),o.getDerivativesCatalog()]).then(function(e){u.manual_info={},angular.forEach(e,function(e){u.manual_info[e.topic]=e.data})},function(){a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),u.manual_info=null})},u.getClassFav=function(e){o.getClassificationFav().then(function(e){s.listClassFav=e.data},function(){a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),s.listClassFav=null})},e.$watch("model.form",function(t){0===t.portfolio.length&&(t=e.model.form,d=t.portfolio)},!0),e.chargerPortfolio=function(){var t=e.contract.numContrato,n=i.user.employeeID,o=e.contract.origen;u.changePortfolio?r.getCurrentPortfolio(n,t,o).then(function(t){e.model.form.portfolio[e.idx].invest.invest=t.portfolio.map(function(e){var n={};return n.amount=e.monto,n.description=e.description,n.description=e.description,n.issuer=e.producto,n.percentage=e.monto/t.portfolioValue,n}),e.model.form.portfolio[e.idx].value=t.portfolioValue,u.openIinvest=!0}):(e.model.form.portfolio[e.idx].invest.invest=[],u.openIinvest=!1)},function(){u.fields.client_types=c("client",o.client_types),o.getIssuersInfo().then(function(e){u.issuers=e.data})}()}e.$inject=["$scope","$filter","$q","proposalsProposalSrv","CommonModalsSrv","proposalsPropTracingSrv","userConfig","$rootScope"],angular.module("actinver.controllers").controller("proposalFormCtrl",e)}(),function(){"use strict";function e(){function e(e){e.idx=Number(e.idx)}return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/proposal-form/proposal-form.html",scope:{edit:"=?",obj:"=",model:"=",idx:"=",contract:"=?"},link:e,controller:"proposalFormCtrl",controllerAs:"propForm"}}angular.module("actinver.directives").directive("proposalForm",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/reports/reports.html",link:function(){}}}angular.module("actinver.directives").directive("report",e)}(),function(){"use strict";function e(e,t){var n={};return n.show=function(n){return e.open({templateUrl:"/scripts/directives/refresh-session/refresh-session-modal.html",windowClass:"session",controllerAs:"session",controller:["$uibModalInstance",function(e){function o(){e.close()}function a(){if(i<=10)return console.log("se acabo"),"";r.time=i,i-=1,t(function(){a()},1e3)}var r=this,i=n;r.refreshSession=o,r.close=function(){e.dismiss()},r.done=function(){e.close()},a()}]})},n}e.$inject=["$uibModal","$timeout"],angular.module("actinver.services").service("RemainingModal",e)}(),function(){"use strict";function e(e,t,n,o,a){return{restrict:"EA",replace:!1,templateUrl:"/scripts/directives/refresh-session/refresh-session.html",link:function(r){function i(){o.getTime().then(function(t){u=t,e.cancel(l),c()})}function s(){function e(e){sessionStorage.setItem("__token",e.token),i()}function t(){}o.updateSession().then(e).catch(t)}function c(){if(u<=300&&!d&&(s(),d=!0,n.show(u).result.then(function(){s(),d=!1}).catch(function(){d=!1})),u<=10)return location.assign("/asesoria/login"),"";r.time=t("remainingTime")(u),u-=1,l=e(function(){c()},1e3)}r.today=new Date;var u,l,d=!1;r.updateReloj=s,a(function(){i()},6e4),i()}}}e.$inject=["$timeout","$filter","RemainingModal","RefreshSrv","$interval"],angular.module("actinver.directives").directive("refreshSession",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.getTime=function(){return t(function(t){e({method:"GET",url:n.getTimeSession}).then(function(e){t(e.data)})})},a.prototype.updateSession=function(){return t(function(t,a){function r(){function o(e){t({success:!0,token:e.data.access_token})}function r(e){a(e)}e.post(n.updateSession).then(o).catch(r)}o.csrfHead().then(r).catch()})},new a}e.$inject=["$http","$q","URLS","csrfSrv"],angular.module("actinver.services").service("RefreshSrv",e)}(),function(){"use strict";function e(e){return{restrict:"A",scope:{onSizeChanged:"&"},link:function(t){function n(){t.onSizeChanged()}e.addEventListener("resize",n)}}}e.$inject=["$window"],angular.module("actinver.directives").directive("onSizeChanged",e)}();!function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/schedule/schedule.html"}}angular.module("actinver.directives").directive("schedule",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getMedia=function(){return t(function(t){e({method:"GET",url:n.getBinnacleCatalog,params:{language:"SPA"}}).then(function(e){e.data.status&&t(e.data.result)})})},new o}e.$inject=["$http","$q","URLS"],angular.module("actinver.services").service("SectionActivitySrv",e)}(),function(){"use strict";function e(e){function t(t){function n(e,t){return R.map(function(e){return e.text=e[t],e},e)}function o(){e.getMedia().then(function(e){t.optionsDropdowm=n(e,"description")})}t.changeDateActivity=function(e){t.ngModel.activity.date=e},function(){t.ngModel||(t.ngModel={activity:{}}),t.ngConfigdate||(t.ngConfigdate={locale:{format:"DD/MM/YYYY"},singleDatePicker:!0}),t.options={locale:{format:"DD/MM/YYYY"},singleDatePicker:!0},o()}()}return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/section-activity/section.html",link:t,scope:{ngModel:"=",ngConfigdate:"=?"}}}e.$inject=["SectionActivitySrv"],angular.module("actinver.directives").directive("sectionActivity",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.filterInfo=function(){o.table.filter({$:o.filter})},function(){var t={page:1,count:10},a=angular.merge({},t,e.settings);o.table=new n(a,{counts:[],paginationMaxBlocks:7,dataset:e.info})}()}e.$inject=["$scope","$filter","NgTableParams"],angular.module("actinver.controllers").controller("searchListCtrl",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:function(e,t){return"/scripts/directives/search-list/"+t.tmpl},scope:{typeoperation:"@?",employee:"@?",info:"=",tmpl:"@",settings:"=?",cb:"=?",estado:"=?",invocacion:"=?",ctrl:"=?"},controller:"searchListCtrl",controllerAs:"search_list"}}angular.module("actinver.directives").directive("searchList",e)}(),function(){"use strict";function e(){return{restrict:"A",replace:!0,template:'<div class="spinner" ng-show="show"><i class="fa fa-refresh fa-spin fa-3x fa-fw"></i><span class="sr-only">Loading...</span></div>',scope:{show:"="}}}angular.module("actinver.directives").directive("spinner",e)}(),function(){"use strict";function e(e){function t(t){t.onSelect=function(){e(function(){t.show_info=!0})}}return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/strategies/strategies.html",scope:{index:"=",amount:"=",model:"=",issuers:"="},link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("strategies",e)}(),function(){"use strict";function e(e){var t=this;t.posts={success:!1},e.getInfo().then(function(e){t.posts=e},function(e){t.posts=e})}e.$inject=["socialFeedInfo"],angular.module("actinver.controllers").controller("socialFeedCtrl",e)}(),function(){"use strict";function e(e,t,n){return{getInfo:function(){return n(function(n,o){t({method:"GET",url:e.dashboardSocial}).then(function(e){e.data.status?n({success:!0,data:e.data.result,finish:!0}):o({success:!1,finish:!0})},function(){o({success:!1,finish:!0})})})}}}e.$inject=["URLS","$http","$q"],angular.module("actinver.services").factory("socialFeedInfo",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/social-feed/social-feed.html",controller:"socialFeedCtrl",controllerAs:"socialFeedWidget"}}angular.module("actinver.directives").directive("socialFeed",e)}(),function(){"use strict";function e(e){function t(t,n,o,a,r){function i(){r(t,function(t,o){o.order||$(t).find("tbody tr").attr("ng-repeat","item in data"),o.numberRowByPag&&$(t).find("tbody tr").attr("ng-show","$index >= ((currentPagination - 1) * numberRowByPag)  && $index < (numberRowByPag * currentPagination) "),o.order&&($(t).find("tbody tr").attr("ng-repeat","item in data | orderBy: groupOrder"),$(t).find("thead th").each(function(){$(this).attr("ng-click","orderBy('"+$(this).attr("orderBy")+"')"),$(this).append("<span class='icon glyphicon glyphicon-triangle-bottom' ng-show='groupOrder.indexOf(&quot;"+$(this).attr("orderBy")+"&quot;) >= 0'></span>"),$(this).append("<span class='icon glyphicon glyphicon-triangle-top' ng-show='groupOrder.indexOf(&quot;-"+$(this).attr("orderBy")+"&quot;) >= 0'></span>")}));var a="";t.each(function(e,t){a+=t.outerHTML||""}),n.find(".content-table").prepend(a),e(n.contents())(o)})}function s(){l=$(n).find("table"),d=l.find("thead tr th").length,t.data=[],
t.showTable=!1,t.order=t.order||null,t.groupOrder=[],t.currentTab=1,t.numberColsByTab=t.numberColsByTab||null,t.labelButtonBackTab=t.labelButtonBackTab||null,t.labelButtonNextTab=t.labelButtonNextTab||null,t.totalTabs=Math.ceil(d/t.numberColsByTab),t.currentPagination=1,t.numberRowByPag=t.numberRowByPag||null,t.totalPaginations=null}function c(){setTimeout(function(){l.find("thead tr th").filter(function(e){return u(e)}).show(),l.find("thead tr th").filter(function(e){return!u(e)}).hide();var e=[],t=[];l.find("tbody tr").each(function(){$(this).find("td").each(function(n,o){u(n)?e.push(o):t.push(o)})}),$(e).show(),$(t).hide()})}function u(e){return t.numberColsByTab*(t.currentTab-1)<=e&&e<t.numberColsByTab*t.currentTab}var l=null,d=null,m=Date.now()-100;t.setData=function(e){t.numberRowByPag&&(t.totalPaginations=Math.ceil(e.length/t.numberRowByPag)),t.numberColsByTab&&c(),t.data=e,t.showTable=!0},t.backTab=function(){Date.now()-m>=100&&(t.currentTab--,c(),m=Date.now())},t.nextTab=function(){Date.now()-m>=100&&(t.currentTab++,c(),m=Date.now())},t.nextPagination=function(){t.goPagination(t.currentPagination+1)},t.backPagination=function(){t.goPagination(t.currentPagination-1)},t.goPagination=function(e){t.currentPagination=e},t.orderBy=function(e){return t.groupOrder.indexOf(e)>=0?void(t.groupOrder[t.groupOrder.indexOf(e)]="-"+e):t.groupOrder.indexOf("-"+e)>=0?void(t.groupOrder[t.groupOrder.indexOf("-"+e)]=e):(t.groupOrder.push(e),void(t.groupOrder.length>=3&&t.groupOrder.shift()))},function(){i(),s()}()}return{restrict:"EA",transclude:!0,template:"<div class='container-tab-table' ng-show='showTable'> <div class='button-back-tab' ng-click='backTab()' ng-show='numberColsByTab && currentTab > 1'><span class='icon glyphicon glyphicon-triangle-left'></span><span class='text' ng-if='labelButtonBackTab'>{{labelButtonBackTab}}</span></div> <div class='content-table'><div class='no-results' ng-show='data.length === 0'><img src='img/bg/binnacle-empty-state.svg' /><p><strong> No se encontraron </strong>resultados con esta<br/>búsqueda. Vuelve a intentar otro dato.</p></div></div> <div class='button-next-tab' ng-click='nextTab()' ng-show='numberColsByTab && currentTab < totalTabs'><span class='text' ng-if='labelButtonNextTab'>{{labelButtonNextTab}}</span><span class='icon glyphicon glyphicon-triangle-right'></span></div><div class='pagination' ng-if='numberRowByPag'><button class='back-pagination' ng-click='backPagination()' ng-disabled='currentPagination <= 1'><span class='glyphicon glyphicon-chevron-left'></span></button><span class='list-pagination' ng-repeat='i in [] | range:totalPaginations' ng-click='goPagination(i+1)' ng-class='{active: $index + 1 === currentPagination}'>{{i + 1}}</span><button class='next-pagination' ng-click='nextPagination()' ng-disabled='currentPagination >= totalPaginations'><span class='glyphicon glyphicon-chevron-right'></span></button></div><span class='note-tabs' ng-if='numberColsByTab && totalTabs > 1'>* Para <strong> VER el resto </strong> de la tabla, da clic en <strong class='text-button-next-tab'> <span class='icon glyphicon glyphicon-triangle-right' ng-if='!labelButtonNextTab'></span>{{labelButtonNextTab}}. </strong> </span></div>",scope:{labelButtonBackTab:"@",labelButtonNextTab:"@",numberColsByTab:"=?",numberRowByPag:"=?",setData:"=",order:"=?"},link:t}}e.$inject=["$compile"],angular.module("actinver.directives").directive("tabTable",e)}(),function(){"use strict";function e(e){function t(t,n){n.bind("scroll",function(){n.find("table").find("tr th:first-child").css("left",this.scrollLeft+"px"),n.find("table").find("tr td:first-child").css("left",this.scrollLeft+"px")}),t.$watch(function(){return n.find("table").height()},function(t,o){t!==o&&e(function(){n.find("table tr td:first-child").css("left",n.scrollLeft()+"px")},0)})}return{restrict:"EA",link:t}}e.$inject=["$timeout"],angular.module("actinver.directives").directive("tableColumnPosition",e)}(),function(){"use strict";function e(e,t,n){function o(o){o.tableInfo=new e(o.tableSet.initialParams,o.tableSet.initialSettings),o.tableType=o.type,o.emptyTable=o.empty,o.resourceCrashed=o.crashed,o.$watch("tableInfo.data",function(){(o.tableInfo.total()>0||!1===o.tableInfo.data.loading)&&(o.tableSet.loading=!1)}),o.outlineClient=function(e){t.outlineClient(n.user.employeeID,e.numSolContrato,e.tipoOrigenTO.id,e.tipoServicioTO.value.idTipoServicio,e.cliente.value.tipoPersonaTO.id,o.type)}}return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-list/table-list.html",link:o,scope:{crashed:"@",empty:"@",tableSet:"=",type:"@",origin:"@?"}}}e.$inject=["NgTableParams","binnacleModalSrv","userConfig"],angular.module("actinver.directives").directive("tableList",e)}(),function(){"use strict";function e(e,t,n,o){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-orders/table.html",scope:{contract:"@",tag:"@",update:"=?",type:"@?",clean:"=?",origin:"@?"},link:function(a){function r(t){a.sortReverse=!0,a.sortType="subOrders.operationDate",a.loading=!0,a.orders=[];var n=null,o=null;t&&(n=moment(t.startDate._d).format("DDMMYYYY"),o=moment(t.endDate._d).format("DDMMYYYY")),e.getOrders(a.contract,a.type,n,o).then(function(e){if(e.data.outOrdersByDateQuery.orders){var t=e.data.outOrdersByDateQuery.orders;angular.forEach(t,function(e,n){t[n].issuer=e.order.issuer.issuerName+" "+e.order.issuer.serie}),a.orders=t}}).finally(function(){a.loading=!1})}function i(){a.orders=[]}a.viewMore=function(n){"MC"===a.type?e.moreInfoCapital(a.contract,n.order.orderReference).then(function(e){1===e.data.outCommonHeader.result.result&&t.moreInfoMarketOrder(e.data.outCapitalMarketOrderDetailQuery,n.order)}):e.moreInfo(a.contract,n.order.orderReference).then(function(e){1===e.data.outCommonHeader.result.result&&t.moreInfo(e.data.outFundsOrderDetailQuery)})},a.delete=function(t){n.warning("¿Estás seguro de cancelar la orden seleccionada?").result.then(function(){"MC"===a.type?e.deleteMarket(t).then(function(e){r(),n.done(o.createError(e.data.outCommonHeader.result.messages))}).catch(function(e){n.error(o.createError(e.message))}):e.delete(a.contract,t).then(function(){r(),n.done("Se ha realizado la cancelación de manera exitosa.")}).catch(function(e){n.error(o.createError(e.message))})})},a.update=r,a.clean=i}}}e.$inject=["investmentSrv","investmentModalSrv","CommonModalsSrv","ErrorMessage"],angular.module("actinver.directives").directive("actTableOrders",e)}(),function(){"use strict";function e(e,t,n,o,a,r){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-orders-bank/table.html",scope:{contract:"@",tag:"@",update:"=?",type:"@?",orders:"=?",clean:"=?",origin:"@?",holder:"@"},link:function(i){function s(t){var n,o,a,s;t?(n=r("date")(t.startDate._d,"yyyy-MM-dd HH:mm:ss"),o=r("date")(t.endDate._d,"yyyy-MM-dd HH:mm:ss"),a=r("date")(t.startDate._d,"yyyyMMdd"),s=r("date")(t.endDate._d,"yyyyMMdd")):(n=r("date")(new Date,"yyyy-MM-dd 00:00:00"),o=r("date")(new Date,"yyyy-MM-dd HH:mm:ss"),a=r("date")(new Date,"yyyyMMdd"),s=r("date")(new Date,"yyyyMMdd")),i.sortReverse=!0,i.sortType="subOrders.operationDate",i.loading=!0,i.orders=[],"2"!==i.type?e.getOrdersBank(i.contract,i.type,n,o).then(function(e){if(e.data.outBankFundsAndMoneyMarketMvmntsQuery.movements.movement.length>0||null!==e.data.outBankFundsAndMoneyMarketMvmntsQuery){var t=e.data.outBankFundsAndMoneyMarketMvmntsQuery.movements.movement;i.orders=t}}).finally(function(){i.loading=!1}):"2"===i.type&&e.getOrdersMoneyMarketBank(i.contract,a,s).then(function(e){if(e.data.outBankContractInvstMovementsQuery.movements.length>0||null!==e.data.outBankContractInvstMovementsQuery){var t=e.data.outBankContractInvstMovementsQuery.movements;i.orders=t}}).finally(function(){i.loading=!1})}function c(){i.orders=[]}function u(e){var t={clientBankingArea:"001",clientContractNumber:i.contract,language:"SPA",orderReference:e.orderReference},r="";a.bankFundBuyCancelation(t).then(function(e){if(1===e.outCommonHeader.result.result)angular.forEach(e.outCommonHeader.result.messages,function(e){r+=e.responseMessage}),n.done(r),s();else{var t=e.outCommonHeader.result.messages;angular.forEach(t,function(e){r+=e.responseMessage+"<br>"}),n.error(r)}}).catch(function(e){n.error(o.createError(e.message))})}function l(e){var t={clientBankingArea:"001",clientContractNumber:i.contract,language:"SPA",orderReference:e.orderReference},r="";a.bankFundSellCancelation(t).then(function(e){if(1===e.outCommonHeader.result.result)angular.forEach(e.outCommonHeader.result.messages,function(e){r+=e.responseMessage+"<br>"}),n.done(r),s();else{var t=e.outCommonHeader.result.messages;angular.forEach(t,function(e){r+=e.responseMessage+"<br>"}),n.error(r)}}).catch(function(e){n.error(o.createError(e.message))})}function d(t){e.deleteOrderLumina(t).then(function(){s(),n.done("Solicitud de cancelación recibida")}).catch(function(e){n.error(o.createError(e.message))})}function m(t){e.deleteDirectSell(t,i.contract).then(function(e){s(),n.done(o.createError(e.data.outCommonHeader.result.messages))}).catch(function(e){n.error(o.createError(e.message))})}function p(t){e.deleteDirectBuy(t).then(function(e){s(),n.done(o.createError(e.data.outCommonHeader.result.messages))}).catch(function(e){n.error(o.createError(e.message))})}i.viewMore=function(e){t.moreInfoFundsBank(e)},i.delete=function(e){n.warning("¿Estás seguro de cancelar la orden seleccionada?").result.then(function(){if("2"===i.type)d(e);else switch(e.transactionType){case 1:u(e);break;case 2:l(e);break;case 30:p(e);break;case 37:deleteReportoBuy(e);break;case 29:m(e)}})},i.update=s,i.clean=c,i.aux={sortType:void 0,sortReverse:!1},i.viewLetter=function(e,n,o){var a=r("date")(n,"yyyyMMdd");t.reportoConfirmLetter(e,a,o)}}}}e.$inject=["investmentSrv","investmentModalSrv","CommonModalsSrv","ErrorMessage","fundBankDollSrv","$filter"],angular.module("actinver.directives").directive("actTableOrdersBank",e)}(),function(){"use strict";function e(e,t,n,o){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-orders-lumina/table-orders-lumina.html",scope:{contract:"@",tag:"@",update:"=?",type:"@?",fechaordenes:"=",selected:"=?"},link:function(t){function a(n){t.sortReverse=!0,t.sortType="order.orderReference",t.loading=!0,t.orders=[],r!==n&&(r=n,e.getOrdersLumina(t.contract,t.type,t.fechaordenes).then(function(e){if(1===e.data.outCommonHeader.result.result){var n;if(e.data.outCapitalMarketOrderQuery.orderData&&e.data.outCapitalMarketOrderQuery.orderData.length>0){n=e.data.outCapitalMarketOrderQuery.orderData;var o=[];R.forEach(function(e){o.push({orderReference:e.orderReference,contractNumber:e.contractNumber,operationDate:e.captureDate.date,movementDescription:e.operationType,operationType:"COMPRA"===e.operationType?"buy":"sell",modify:!0,issuer:e.instrumentDesc.operationType,amountTitles:e.orderTitles.titlesQty,price:e.orderPrice.price,titlesAssigned:-1===e.assignedTitles.titlesQty?0:e.assignedTitles.titlesQty,assignedPrice:e.assignedPrice.price,pricev:e.orderValuation.valuation,status:e.orderStatus.operationType,secancela:"1"===e.canceled,statusDesc:e.statusDesc})},n),t.orders=o}}}).finally(function(){t.loading=!1,r=!1}))}var r=!1;t.modificar=function(e){t.selected=e},t.showinfostatus=function(e){n.info(e)},t.delete=function(t){n.warning("¿Estás seguro de cancelar la orden seleccionada?").result.then(function(){e.deleteOrderLumina(t).then(function(){a(),n.done("Solicitud de cancelación recibida")}).catch(function(e){n.error(o.createError(e.message))})})},a(),t.$watch("contract",function(){a()}),t.$watch("fechaordenes",function(){a()}),t.update=a}}}e.$inject=["investmentSrv","investmentModalSrv","CommonModalsSrv","ErrorMessage"],angular.module("actinver.directives").directive("actTableOrdersLumina",e)}(),function(){"use strict";function e(e,t){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-portafolio-investment-lumina/table-lumina.html",scope:{contract:"@",update:"=?",selected:"=?",type:"@?",nodata:"@?"},link:function(n){function o(o){n.sortReverse=!0,n.sortType="subOrders.operationDate",n.orders=[],n.loading=!0,a!==o&&(a=o,e.getPortfolioInvestmentLumina(n.contract,n.type).then(function(e){if(1===e.data.outCommonHeader.result.result){var o;if(e.data.outCapitalMarketPositionQuery.positionData&&e.data.outCapitalMarketPositionQuery.positionData.length>0){o=e.data.outCapitalMarketPositionQuery.positionData;var a=[];R.forEach(function(e){var t=e.instrumentDesc.operationType.split(" ");a.push({issuer:e.instrumentDesc.operationType,issuerName:t[1],serie:t[2],finalPosition:e.titlesQty.titlesQty,virtualCost:e.unitCost.price,weightedLastPrice:e.closingPrice.price,valuationLastPrice:e.valuation.valuation,capitalGain:e.capitalGain.price,accumulatedVariance:e.calculatedCapitalGain.price,instrumentDesc:e.instrumentDesc.operationType})},o),t.capitalsPortfolioBank=o,n.orders=a}}}).finally(function(){n.loading=!1,a=!1}))}var a=!1;o(),n.$watch("contract",function(){o()}),n.nodata=void 0===n.nodata?"No hay información":n.nodata,n.update=o,n.ChangeDoll=function(e){n.selected=e,t.actionStation={type:"sell",origen:"portafolio",station:n.selected,contract:n.contract,operationType:"Banco",rand:Math.random()}}}}}e.$inject=["investmentSrv","$rootScope"],angular.module("actinver.directives").directive("tablePortfolioInvLumina",e)}(),function(){"use strict";function e(e,t,n,o){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-portfolio-investment-bank/table.html",scope:{contract:"@",update:"=?",selected:"=?",type:"@?",nodata:"@?",orders:"=?",bandsDirect:"=?",tabseleccion:"=?"},link:function(a){function r(n){if(a.sortReverse=!0,a.sortType="subOrders.operationDate",a.orders=[],a.loading=!0,c!==n)if(c=n,"2"===a.type)e.getPortfolioInvestmentBank(a.contract,a.type).then(function(e){if(1===e.data.outCommonHeader.result.result){var t=e.data.outBankInvstFundsAndMMPositionsQuery.positions.positionInformation,n=[];R.forEach(function(e){n.push({idFund:e.fundID,serie:e.operationSource,position:e.position,cost:e.cost,currentPrice:e.currentPrice,dueDate:e.dueDate,emissionID:e.emissionID,instrumentID:e.emissionID,settlementDate:e.settlementDate,titlesQty:e.titlesQty,amount:e.amount,netRate:e.netRate.rate,appreciation:e.appreciation,couponRate:e.couponRate.rate,weightedAmount:e.weightedAmount,foreignExchangeID:e.foreignExchangeID})},t),a.orders=n}}).finally(function(){a.loading=!1,c=!1});else if("1"===a.type){var o=t(new Date).format("YYYYMMDD");e.getPortfolioReportoBank(a.contract,o).then(function(e){if(1===e.data.outCommonHeader.result.result){var t=e.data.outMoneyMarketIntradayPositionQuery.positionData,n=[];R.forEach(function(e){n.push({idFund:e.instrumentID,serie:e.issuer,position:e.titlesQty,cost:e.closingPrice,currentPrice:e.closingPrice,emissionID:e.instrumentID,instrumentID:e.instrumentID,positionType:e.positionType,titlesQty:e.titlesQty,warrantyTitles:e.warrantyTitles,amount:e.unitCostValuation,netRate:e.plusMinusCalc,appreciation:e.plusMinusCalc,couponRate:e.plusMinusCalc,weightedAmount:e.unitCostValuation,lastPrice:e.lastPrice,instrumentDesc:e.instrumentID,origen:"POSICION",exchangeRate:e.exchangeRate})},t),a.orders=n}}).finally(function(){a.loading=!1,c=!1})}}function i(e){var t=JSON.parse(u);t.term=e.term,t.selectedInstrument=e,a.selected=t}var s=[],c=!1,u=null;a.$watch("bandsDirect",function(e,t){s=e}),r(),a.nodata=void 0===a.nodata?"No hay información":a.nodata,a.update=r,a.ChangeDoll=function(e){var t=[];u=JSON.stringify(e),e&&e.positionType&&"DIRECTO"===e.positionType.toUpperCase()&&a&&1===a.tabseleccion?null!=s&&s.length>0?(s.forEach(function(n){n.instrumentDesc.toUpperCase()===e.instrumentDesc.toUpperCase()&&null!==n.averagePurchaseMargin&&(n.selected=!1,t.push(n))}),t.length<1?n.done("No existen bandas para operar"):o.information(t,i)):n.done("No existen bandas para operar"):a.selected=e},a.aux={sortType:void 0,sortReverse:!1}}}}e.$inject=["investmentSrv","moment","CommonModalsSrv","directsBandsSrv"],angular.module("actinver.directives").directive("tablePortfolioInvBank",e)}(),function(){"use strict";function e(e,t,n,o){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-portfolio-investment/table.html",scope:{contract:"@",update:"=?",selected:"=?",type:"@?",nodata:"@?"},link:function(a){function r(n){a.sortReverse=!0,a.sortType="subOrders.operationDate",a.orders=[],a.loading=!0,i!==n&&(i=n,e.getPortfolioInvestment(a.contract,a.type).then(function(e){if(1===e.data.outCommonHeader.result.result){var n;if(e.data.outPortfolioDetailQuery&&e.data.outPortfolioDetailQuery.portfolios.portfolioDetail.length>0){n=e.data.outPortfolioDetailQuery.portfolios.portfolioDetail;var o=[];R.forEach(function(e){o.push({issuer:e.issuerName,serie:e.serie.trim(),virtualCost:e.cost,valuation:e.titlesQty,accumulatedVariance:e.appreciationPercentage,capitalGain:e.appreciation,finalPosition:e.finalPositionTitles,valuationLastPrice:e.positionValuation,weightedLastPrice:e.lastPrice,marketTypeDesc:e.marketTypeDesc,portfolioType:e.portfolioType,portfolioTypeDesc:e.portfolioTypeDesc,currencyTypeKey:e.currencyTypeKey,foreingExchangeRate:e.foreingExchangeRate,finalPositionTitles:e.finalPositionTitles,settlementPosMoreThan72H:e.settlementPosMoreThan72H,settlementPosition48H:e.settlementPosition48H,settlementPosition24H:e.settlementPosition24H,settlementPositionToday:e.settlementPositionToday,saleAvailableTitles:e.saleAvailableTitles,suspendedIndicator:e.suspendedIndicator})},n),o.sort(o.portfolioType);var r=[];angular.forEach(_.groupBy(o,"portfolioTypeDesc"),function(e){r.push({title:e[0].portfolioTypeDesc,portfolioType:e[0].portfolioType,portfolio:e})}),t.capitalsPortfolio=n,a.orders=r}else a.orders=[]}}).finally(function(){a.loading=!1,i=!1}))}var i=!1;r(),a.viewMoreTitles=function(e){n.moreInfoTitles(e)},a.showInfoEmisora=function(e){e&&"1"===e.suspendedIndicator?o.error("La emisora <b>"+e.issuer+" "+e.serie+"</b> se encuentra actualmente suspendida."):e&&t.ChangeDoll(e)},a.$watch("contract",function(){r()}),a.nodata=void 0===a.nodata?"No hay información":a.nodata,a.update=r,t.ChangeDoll=function(e){a.selected=e,t.actionStation={type:"sell",origen:"portafolio",station:a.selected,operationType:"Casa",rand:Math.random()}},t.showDetails=function(e){e.show=!e.show}}}}e.$inject=["investmentSrv","$rootScope","investmentModalSrv","CommonModalsSrv"],angular.module("actinver.directives").directive("tablePortfolioInv",e)}(),function(){"use strict";function e(e,t){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-stations/table.html",scope:{contract:"@",id:"@",update:"=?",selected:"=?",columnsExpand:"=?"},link:function(n){function o(){n.loading=!0,e.getStations(n.contract,n.id).then(function(e){1===e.data.outCommonHeader.result.result?n.stations=e.data.outInvestmentIssuersQuery.issuer:n.stations=[]}).finally(function(){n.loading=!1})}n.update=n.update?o:null,n.viewMore=function(n){e.getDetailStations(n.issuerName,n.serie).then(function(e){1===e.data.outCommonHeader.result.result&&t.moreInfoStations(e.data,n)})},n.$watch("contract",function(){o()}),n.$watch("id",function(){o()}),n.ChangeDoll=function(e){n.selected=e},o()}}}e.$inject=["investmentSrv","investmentModalSrv"],angular.module("actinver.directives").directive("actTableStations",e)}(),function(){"use strict";function e(e,t){function n(){}return n.prototype.getReporto=function(n){return e({method:"get",url:t.getReporto+n+"/1/0/0/0",params:{language:"SPA"}})},new n}e.$inject=["$http","URLS"],angular.module("actinver.services").service("reportoSrv",e)}(),function(){"use strict";function e(e){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-reporto/table-reporto.html",scope:{contract:"@",instrument:"=",tab:"="},link:function(t){function n(){t.loading=!0,t.bands=[]}function o(){e.getReporto(t.contract).then(function(e){var n;1===e.data.outCommonHeader.result.result&&(n=e.data.outBondMarketBands.bondMarketBandsByInstrumentIDData[0].bondMarketBandsData,t.bands=n.length>0?n:[])}).finally(function(){t.loading=!1})}function a(){console.log("DIRECTO")}t.$watch("tab",function(){switch(n(),t.tab){case 2:o();break;case 1:a()}}),t.showDoll=function(e){t.instrument=e},n()}}}e.$inject=["reportoSrv"],angular.module("actinver.directives").directive("actTableReporto",e)}(),function(){"use strict";function e(e,t){function n(){}return n.prototype.getReportoBands=function(){return e({method:"GET",url:t.getReportoBands,params:{language:"SPA"}})},n.prototype.getDirectBands=function(){return e({method:"GET",url:t.getDirectBands+"DINERO-DIRECTO",params:{language:"SPA"}})},n.prototype.getAuctionBands=function(){return e({method:"GET",url:t.getAuctionBands,params:{language:"SPA"}})},new n}e.$inject=["$http","URLS"],angular.module("actinver.services").service("reportoBankSrv",e)}(),function(){"use strict";function e(e){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-reporto-bank/table-reporto-bank.html",scope:{contract:"@",instrument:"=",tab:"=",id:"@",bandsDirect:"=?"},link:function(t){function n(){t.loading=!0,t.bandsReporto=[],t.bandsDirect=[],t.bandsAuction=[]}function o(){e.getReportoBands(t.contract).then(function(e){var n;1===e.data.outCommonHeader.result.result&&(n=e.data.outMoneyMarketBandsReportoQuery.bandsReportData,t.bandsReporto=n.length>0?n:[])}).finally(function(){t.loading=!1})}function a(){e.getDirectBands().then(function(e){var n;1===e.data.outCommonHeader.result.result&&(n=e.data.outMoneyMarketBandsDirectQuery.bandsDirectData,null!==n&&n.length>0&&n.forEach(function(e){null!==e.priceType&&"YIELD"===e.priceType.toUpperCase()&&(e.averagePurchaseMargin=100*e.averagePurchaseMargin)}),t.bandsDirect=n.length>0?n:[])}).finally(function(){t.loading=!1})}function r(){e.getAuctionBands().then(function(e){var n;1===e.data.outCommonHeader.result.result&&(n=e.data.outMMAuctionsQuery.auction,t.bandsAuction=n.length>0?n:[])}).finally(function(){t.loading=!1})}t.showDoll=function(e){t.instrument=e},t.$watch("tab",function(){switch(n(),t.tab){case 3:r();break;case 2:o();break;case 1:a()}}),n()}}}e.$inject=["reportoBankSrv"],angular.module("actinver.directives").directive("actTableReportoBank",e)}(),function(){"use strict";function e(e,t){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-stations-bank/table.html",scope:{contract:"@",id:"@",update:"=?",selected:"=?",columnsExpand:"=?",stations:"=",bandera:"="},link:function(n){function o(){n.loading=!0,e.getStationsBank(n.contract).then(function(e){if(1===e.data.outCommonHeader.result.result){var t=e.data.outBankInvstFundsByContractQuery.funds.fund,o=[];"3"===n.id?angular.forEach(t,function(e){"FONDOS DE DEUDA"===e.instrumentIDDescription.description&&o.push(e)}):"2"===n.id?angular.forEach(t,function(e){"RENTA VARIABLE"===e.instrumentIDDescription.description&&o.push(e)}):"1"===n.id&&angular.forEach(t,function(e){"FONDOS DE COBERTURA"===e.instrumentIDDescription.description&&o.push(e)}),n.stations=o}else n.stations=[];n.bandera=!0}).finally(function(){n.loading=!1})}n.bandera=!1,n.update=n.update?o:null,n.viewMore=function(e){t.moreInfoStationsBank(e)},n.$watch("contract",function(){o()}),n.$watch("id",function(){o()}),n.ChangeDoll=function(e){n.style=1,n.selected=e}}}}e.$inject=["investmentSrv","investmentModalSrv"],angular.module("actinver.directives").directive("actTableStationsBank",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(e){if(o.stations&&e){var t=o.stations.filter(function(t){return t.issuer.issuerSerie===e.issuer.issuerSerie&&t.feed===e.feed});angular.isArray(t)&&t.length>0?v.indiceSeleccionado=t[0].indice:v.indiceSeleccionado=-1}else v.indiceSeleccionado=-1}function m(){null!==v.worker&&(n.info("disconnect socket capitals2.1"),v.worker.postMessage({config:null,step:2}),v.worker=null)}function p(){if("undefined"!=typeof Worker){var e=window.location.port?window.location.protocol+"//"+window.location.hostname+":"+window.location.port+"/asesoria":window.location.protocol+"//"+window.location.hostname+"/asesoria";v.worker=new Worker(URL.createObjectURL(new Blob(["("+l.principal+")()"])));var n={emisoras:o.stations,url:t.CapitalsWebSocket+"?access_token="+sessionStorage.getItem("__token"),urlResource:e,throwSocket:r.is("investment.capitals")};v.worker.postMessage({config:n,step:1}),v.worker.onmessage=function(e){o.stations[e.data.indice].lastRegisters=e.data.lastRecord,o.stations[e.data.indice].averagePrice=e.data.newRecord.averagePrice,o.stations[e.data.indice].minPrice=e.data.newRecord.minPrice,o.stations[e.data.indice].maxPrice=e.data.newRecord.maxPrice,o.stations[e.data.indice].tradeDateTime=e.data.newRecord.tradeDateTime,o.stations[e.data.indice].tradeSell=e.data.newRecord.tradeSell,o.stations[e.data.indice].tradeSellPrice=e.data.newRecord.tradeSellPrice,o.stations[e.data.indice].tradeBuyPrice=e.data.newRecord.tradeBuyPrice,o.stations[e.data.indice].tradeBuy=e.data.newRecord.tradeBuy,o.stations[e.data.indice].lastPrice=e.data.newRecord.lastPrice,o.stations[e.data.indice].priceVar=e.data.newRecord.priceVar,g(e.data.last,e.data.nuevo,e.data.id)}}}function f(e,t){setTimeout(function(){e.removeClass(t)},300)}function g(e,t,n){var o=angular.element(document.querySelector("#"+n));o&&t>e?(o.scope().$digest(),o.addClass("refresh-prices-green"),f(o,"refresh-prices-green")):o&&t<e&&(o.scope().$digest(),o.addClass("refresh-prices-red"),f(o,"refresh-prices-red"))}function h(e){o.loading=!0,o.stations=[],i.getStationsLumina(o.contract,o.ids.val1,"EQUITY","B").then(function(t){var n=u("orderBy")(t,"issuer.issuerSerie");n.forEach(function(e,t){var n=JSON.parse(JSON.stringify(e));e.indice=t,e.lastRegisters=n,null!==e.feed&&null!==e.issuer&&null!==e.issuer.issuerSerie?e.idIssuerSerie=e.issuer.issuerSerie.replace(/\s/g,"").replace(/\*/g,"-").replace(/\&/g,"-")+e.feed.replace(/\s/g,"").replace(/\*/g,"-").replace(/\&/g,"-"):e.idIssuerSerie=t}),o.stations=n,c.statiosnTable=n,2===e&&c.$broadcast("select-emisora-toTable-changeTab"),p()}).catch(function(){n.info("get stations error"),o.stations=[]}).finally(function(){o.loading=!1})}var v=this;v.indiceSeleccionado=-1;v.worker=null,o.$on("disconnectCapitals",function(){m()}),c.$on("select-emisora-toTable",function(e,t){d(t)}),o.$watch("ids",function(e,t){e!==t&&(m(),h(2))}),v.ChangeDoll=function(e,t){v.tab=t,v.indiceSeleccionado=e.indice,o.selected=e,c.actionStation={type:t,origen:"stations",contract:o.contract,station:o.selected,operationType:"Banco",rand:Math.random()}},v.viewMore=function(e){s.moreInfoMarket(e)},h()}e.$inject=["$stomp","URLS","$log","$scope","$timeout","$state","TableStationsSrv","investmentModalSrv","$rootScope","$filter","workerConfigSrv"],angular.module("actinver.controllers").controller("tableSocketLuminaCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-stations-lumina/table-stations-lumina.html",scope:{contract:"@",ids:"=",selected:"=?",columnsExpand:"=?"},controller:"tableSocketLuminaCtrl",controllerAs:"socket"}}angular.module("actinver.directives").directive("actTableStationsLumina",e)}(),function(){"use strict";function e(e,t,n,o){var a=this;a.search_form={finish:!1,sent:!1,contract:null,typeContractSelected:{id:"998",text:"Casa"},optionTypeContract:[{id:"998",text:"Casa"},{id:"999",text:"Banco"}]},a.sadviser=t.user;var r=new Date;r.setDate(r.getDate()-1),a.datepicker_opts={isInvalidDate:function(e){return 0===e.day()||6===e.day()},maxDate:r},a.resetChilds=function(t,n){e.model.form[t]||delete e.model.form[n]},a.submitSearch=function(){a.search_form.finish=!1,a.search_form.sent=!0,e.model.form={scontract:""},n.getContractInfo(a.search_form.contract,a.search_form.typeContractSelected.id).then(function(t){var n=t.data;t.success?0!==n.numContrato?(e.model.form.scontract=n,"999"===a.search_form.typeContractSelected.id&&(e.model.form.scontract.origen="BANCO")):e.model.form.scontract="":(e.model.form.scontract="",o.error(t.message))},function(e){o.error(e.message)}).finally(function(){a.search_form.finish=!0,a.search_form.sent=!1})}}e.$inject=["$scope","userConfig","proposalsTracingSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("tracingFormCtrl",e)}(),function(){"use strict";function e(){return{restrict:"E",replace:!0,templateUrl:"/scripts/directives/tracing-form/tracing-form.html",scope:{model:"=",formType:"=?"},controller:"tracingFormCtrl",controllerAs:"tracingForm"}}angular.module("actinver.directives").directive("tracingForm",e)}(),function(){"use strict";function e(e,t){function n(){}return n.prototype.getCapitalStop=function(n,o){return e({method:"GET",url:t.getCapitalStop+n+"/"+(o||"SL")+"?language=SPA"})},new n}e.$inject=["$http","URLS"],angular.module("actinver.services").service("TableStopLossSrv",e)}(),function(){"use strict";function e(e,t,n,o){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-stop-loss/table.html",scope:{contract:"@",update:"=?",type:"@?"},link:function(t){function a(n){t.sortReverse=!0,t.sortType="subOrders.operationDate",t.loading=!0,r!==n&&(r=n,e.getCapitalStop(t.contract,t.type).then(function(e){1===e.data.outCommonHeader.result.result&&(t.orders=e.data.outSecuritiesForStopLossQuery.issuerList)}).finally(function(){t.loading=!1,r=!1}))}var r=!1;t.delete=function(e){var r="¿Estás seguro de cancelar la orden seleccionada?";n.warning(r).result.then(function(){o.deleteStopLoss(t.contract,e).then(function(e){1===e.data.outCommonHeader.result.result?(a(),n.done("Se ha realizado la cancelación de manera exitosa.")):(r="Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk",n.error(r))})})},t.update=a}}}e.$inject=["TableStopLossSrv","investmentModalSrv","CommonModalsSrv","investmentSrv"],angular.module("actinver.directives").directive("tableStopLoss",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(){null!==y.worker&&(n.info("disconnect socket capitals2.1"),y.worker.postMessage({config:null,step:2}),y.worker=null)}function m(e,t){setTimeout(function(){e.removeClass(t)},300)}function p(e,t,n){var o=angular.element(document.querySelector("#"+n));o&&t>e?(o.scope().$digest(),o.addClass("refresh-prices-green"),m(o,"refresh-prices-green")):o&&t<e&&(o.scope().$digest(),o.addClass("refresh-prices-red"),m(o,"refresh-prices-red"))}function f(e){return new Worker(URL.createObjectURL(new Blob(["("+e+")()"])))}function g(){if("undefined"!=typeof Worker){var e=window.location.port?window.location.protocol+"//"+window.location.hostname+":"+window.location.port+"/asesoria":window.location.protocol+"//"+window.location.hostname+"/asesoria";y.worker=f(b);var n={emisoras:o.stations,url:t.CapitalsWebSocket+"?access_token="+sessionStorage.getItem("__token"),urlResource:e,throwSocket:r.is("investment.capitals")};y.worker.postMessage({config:n,step:1}),y.worker.onmessage=function(e){o.stations[e.data.indice].lastRegisters=e.data.lastRecord,o.stations[e.data.indice].averagePrice=e.data.newRecord.averagePrice,o.stations[e.data.indice].minPrice=e.data.newRecord.minPrice,o.stations[e.data.indice].maxPrice=e.data.newRecord.maxPrice,o.stations[e.data.indice].tradeDateTime=e.data.newRecord.tradeDateTime,o.stations[e.data.indice].tradeSell=e.data.newRecord.tradeSell,o.stations[e.data.indice].tradeSellPrice=e.data.newRecord.tradeSellPrice,o.stations[e.data.indice].tradeBuyPrice=e.data.newRecord.tradeBuyPrice,o.stations[e.data.indice].tradeBuy=e.data.newRecord.tradeBuy,o.stations[e.data.indice].lastPrice=e.data.newRecord.lastPrice,o.stations[e.data.indice].priceVar=e.data.newRecord.priceVar,p(e.data.last,e.data.nuevo,e.data.id)}}}function h(e){if(o.stations&&e){var t=o.stations.filter(function(t){return t.issuer.issuerSerie===e.issuer.issuerSerie&&t.feed===e.feed});angular.isArray(t)&&t.length>0?y.indice=t[0].indice:y.indice=-1}else y.indice=-1}function v(e){o.loading=!0,o.stations=[],i.getStations(o.contract,o.ids.val1).then(function(t){var n=u("orderBy")(t,"issuer.issuerSerie");n.forEach(function(e,t){
var n=JSON.parse(JSON.stringify(e));e.indice=t,e.lastRegisters=n,null!==e.feed&&null!==e.issuer&&null!==e.issuer.issuerSerie?e.idIssuerSerie=e.issuer.issuerSerie.replace(/\s/g,"").replace(/\*/g,"-").replace(/\&/g,"-")+e.feed.replace(/\s/g,"").replace(/\*/g,"-").replace(/\&/g,"-"):e.idIssuerSerie=t}),o.stations=n,2===e&&c.$broadcast("select-emisora-toTable-changeTab-cb"),g()}).catch(function(e){n.info("get stations error"),o.stations=[]}).finally(function(){o.loading=!1})}var y=this;y.indice=-1,y.worker=null,y.socket={client:null,subscription:null},l.onbeforeunload=function(){d()},o.$on("disconnectCapitals",function(){d()}),o.$watch("ids",function(e,t){e!==t&&(d(),v(2))}),y.ChangeDoll=function(e,t){y.indice=e.indice,o.selected=e,c.actionStation={type:t,origen:"stations",station:o.selected,operationType:"Casa",rand:Math.random()}},y.viewMore=function(e){s.moreInfoMarket(e)},c.$on("select-emisora-toTable-cb",function(e,t){h(t)});var b=function(){function e(e){importScripts(e),function(){t()}()}function t(){i++;var e=new SockJS(s.url);c.client=Stomp.over(e),c.client.debug=null,c.client.connect({},a,n)}function n(){s.throwSocket&&i<4&&setTimeout(t,3e3)}function o(e){var t=[];return e&&e.forEach(function(e){t.indexOf(e.issuer.issuerSerie)<0&&t.push(e.issuer.issuerSerie)}),t}function a(){o(s.emisoras).forEach(function(e){c.client.subscribe("/topic/capitales/bmvAll/"+e,function(e){r(JSON.parse(e.body))})})}function r(e){var t=s.emisoras.findIndex(function(t){return t.issuer.issuerSerie===e.issuer.issuerSerie&&t.feed===e.feed});if(t>=0){var n=JSON.parse(JSON.stringify(s.emisoras[t]));(n.lastPrice>e.lastPrice||n.lastPrice<e.lastPrice)&&postMessage({last:n.lastPrice,nuevo:e.lastPrice,id:s.emisoras[t].idIssuerSerie+"lastPrice",lastRecord:n,newRecord:e,indice:t}),(n.tradeBuyPrice>e.tradeBuyPrice||n.tradeBuyPrice<e.tradeBuyPrice)&&postMessage({last:n.tradeBuyPrice,nuevo:e.tradeBuyPrice,id:s.emisoras[t].idIssuerSerie+"tradeBuyPrice",lastRecord:n,newRecord:e,indice:t}),(n.tradeSellPrice>e.tradeSellPrice||n.tradeSellPrice<e.tradeSellPrice)&&postMessage({last:n.tradeSellPrice,nuevo:e.tradeSellPrice,id:s.emisoras[t].idIssuerSerie+"tradeSellPrice",lastRecord:n,newRecord:e,indice:t}),s.emisoras[t].averagePrice=e.averagePrice,s.emisoras[t].minPrice=e.minPrice,s.emisoras[t].maxPrice=e.maxPrice,s.emisoras[t].tradeDateTime=e.tradeDateTime,s.emisoras[t].tradeSell=e.tradeSell,s.emisoras[t].tradeSellPrice=e.tradeSellPrice,s.emisoras[t].tradeBuyPrice=e.tradeBuyPrice,s.emisoras[t].tradeBuy=e.tradeBuy,s.emisoras[t].lastPrice=e.lastPrice,s.emisoras[t].priceVar=e.priceVar}}var i=0,s=null,c={client:null};onmessage=function(t){switch(t.data.step){case 1:s=t.data.config,e(s.urlResource+"/bower/worker.js");break;case 2:null!==c.client&&c.client.disconnect()}}};v()}e.$inject=["$stomp","URLS","$log","$scope","$timeout","$state","TableStationsSrv","investmentModalSrv","$rootScope","$filter","$window"],angular.module("actinver.controllers").controller("tableSocketCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getStations=function(o,a){return n(function(n,r){e({method:"GET",url:t.getNewCapitalsStation+o+"/"+a+"/0/0/1?language=SPA&delFlag=false"}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.outContractIssuersMarketInfoQuery.marketDataTuple):r("error")})})},o.prototype.getStationsLumina=function(o,a,r,i){return n(function(n,s){e({method:"GET",url:t.getNewCapitalsStation+o+"/"+a+"/0/0/1?language=SPA&delFlag=false&isLumina=true&instrumentType="+r+"&isLumina=true&operationType="+i}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.outContractIssuersMarketInfoQuery.marketDataTuple):s("error")})})},o.prototype.getOptionsTypeOperation=function(){return n(function(n,o){e({method:"GET",url:t.getOptionsTypeOperation+"?language=SPA"}).then(function(e){1===e.data.outCommonHeader.result.result?n(e.data.result):o("error")})})},new o}e.$inject=["$http","URLS","$q"],angular.module("actinver.services").service("TableStationsSrv",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/table-stations-sockets/table-socket.html",scope:{contract:"@",ids:"=",selected:"=?",columnsExpand:"=?"},controller:"tableSocketCtrl",controllerAs:"socket"}}angular.module("actinver.directives").directive("actTableStationsSocket",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(e){if(angular.isArray(e)){return e.map(function(e){return{id:e.toString(),text:e.toString()}})}return e}var s=this,c=o.user;s.user={name:c.name,mail:c.mail},s.promotorA2K={list:[],selected:null},s.usuarioFix={list:[],selected:null},s.changePromotorA2K=function(e,t){s.promotorA2K.selected={id:e.id,text:e.text},a.warning("¿Está seguro de cambiar al Promotor A2K:"+t.text+" para operar?",function(){r.saveAdviserNumber(2,t.text).then(function(e){e.success?(s.promotorA2K.selected={id:t.id,text:t.text},a.done(e.message)):a.error(e.message)}).catch(function(e){a.error(e.message)})})},s.changeUsuarioFix=function(e,t){s.usuarioFix.selected={id:e.id,text:e.text},a.warning("¿Está seguro de cambiar al Usuario Fix: "+t.text+" para operar?",function(){r.saveAdviserNumber(1,t.text).then(function(e){e.success?(s.usuarioFix.selected={id:t.id,text:t.text},a.done(e.message)):a.error(e.message)}).catch(function(e){a.error(e.message)})})},s.logout=function(){t.$emit("closeSocketNotificationLumina",{tipo:"Cerrar Socket"}),e.$broadcast("close-socket-ipc-status"),e.$broadcast("close-socket-last-news"),n.logout()},function(){r.makeDataUser().then(function(e){e.success&&(s.promotorA2K.list=i(e.user.userSession.adviserNumberA2kList),s.promotorA2K.selected={id:e.user.userSession.adviserNumberA2k,text:e.user.userSession.adviserNumberA2k},s.usuarioFix.list=i(e.user.userSession.userIDFixList),s.usuarioFix.selected={id:e.user.userSession.userIDFix,text:e.user.userSession.userIDFix})}).catch(function(e){a.error(e.messagge)})}()}e.$inject=["$rootScope","$scope","Auth","userConfig","CommonModalsSrv","loginSrvc"],angular.module("actinver.controllers").controller("userDataCtrl",e)}(),function(){"use strict";function e(){return{restrict:"EA",replace:!0,templateUrl:"/scripts/directives/userData/userData.html",link:function(){},controller:"userDataCtrl",controllerAs:"udc"}}angular.module("actinver.directives").directive("userData",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){s.informationDate.contactType="Visita a CF","0"===s.informationDate.branchID?s.informationDate.brancheName="Julio Verne":"1"===s.informationDate.branchID?s.informationDate.brancheName="Montes Urales":"2"===s.informationDate.branchID?s.informationDate.brancheName="Corporativo Santa Fe":"-1"===s.informationDate.branchID&&(s.informationDate.contactType="Llamada"),1===s.informationDate.clientStatus?s.informationDate.statusType="Registrado":2===s.informationDate.clientStatus?s.informationDate.statusType="Cita agendada":3===s.informationDate.clientStatus&&(s.informationDate.statusType="Llamada agendada");var e=new Date(s.informationDate.interviewTime),t=0===e.getHours()?"00":e.getHours(),n=0===e.getMinutes()?"00":e.getMinutes();s.informationDate.dateHour=t+":"+n+" Hrs."}function i(t){e.getDCDocumentQueryByClient(t).then(function(e){Array.isArray(e)&&(s.documentInfo=e)}).catch(function(){})}var s=this;s.informationDate,s.getDocument=function(e){n.getPresentationsFile(e).then(function(){})},s.dCDocumentQuery=function(t){e.getDCDocumentQuery(t.documentID).then(function(e){var n=atob(e);if(n.includes("data:application/pdf;base64")){var a=document.getElementById("dwnldLnk");a.href=n,a.click()}else n.includes("data:image/jpeg;base64")&&o.open({templateUrl:"/app/dinn/adviser/dinnImage.html",controller:"dinnImageCtrl",controllerAs:"image",size:"lg",resolve:{dataResolve:function(){return{image:n,title:t.documentTypeDesc}}}})}).catch(function(){})},function(){s.informationDate=t.informationDate,console.log("vm.informationDate",s.informationDate),null===s.informationDate?a.go("dinn.show"):(i(s.informationDate.clientId),r())}()}e.$inject=["dinnSrv","$stateParams","PresentationSrv","$uibModal","$state"],angular.module("actinver.controllers").controller("dinnBookCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.getDCScheduleQueryByDate=function(){void 0===o.dateCalendar&&(o.dateCalendar=new Date),o.informationData=[];var n=t("date")(o.dateCalendar,"yyyy-MM-dd");e.getDCScheduleQueryByDateDetails(n,"2").then(function(e){o.informationData=t("orderBy")(e,"interviewTime")}).catch(function(){o.informationData=[]})},o.getDetail=function(e){n.go("dinn.book",{informationDate:e})},o.getType=function(e){var t,n=e.branchID;return"0"===n||"1"===n||"2"===n?t="Visita a CF":"-1"!==n&&null===n.phoneNumber&&null===n.otherPhoneNumber||(t="Llamada "),t},function(){o.getDCScheduleQueryByDate()}()}e.$inject=["dinnSrv","$filter","$state"],angular.module("actinver.controllers").controller("dinnCtrl",e)}(),function(){"use strict";function e(e,t){var n=this;n.close=function(){t.dismiss()},function(){n.image=e.image,n.title=e.title}()}e.$inject=["dataResolve","$uibModalInstance"],angular.module("actinver.controllers").controller("dinnImageCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.getDCScheduleQuery=function(a){return t(function(t,r){n({method:"GET",url:e.getDCScheduleQuery,params:{interviewNumber:a.interviewNumber,clientId:a.clientId,registryType:2,language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outDCScheduleQuery.scheduleInfo.otherPhoneNumber):2===e.data.outCommonHeader.result.result&&t("response.data.outCommonHeader.result.messages[0].responseMessage")}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),r({error:e.data})})})},a.prototype.getDCDocumentQuery=function(a){return t(function(t,r){n({method:"GET",url:e.getDCDocumentQuery+a,params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outDCDocumentQuery.documentInfo[0].arrayFile):2===e.data.outCommonHeader.result.result&&t("response.data.outCommonHeader.result.messages[0].responseMessage")}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),r({error:e.data})})})},a.prototype.getDCDocumentQueryByClient=function(a){return t(function(t,r){n({method:"GET",url:e.getDCDocumentQueryByClient+a,params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outDCDocumentQueryByClient.documentInfo):2===e.data.outCommonHeader.result.result&&t(e.data.outCommonHeader.result.messages[0].responseMessage)}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),r({error:e.data})})})},a.prototype.getDCScheduleQueryByDate=function(a,r){return t(function(t,i){n({method:"GET",url:e.getDCScheduleQueryByDate+a+"/"+r,params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outDCScheduleQueryByDate):2===e.data.outCommonHeader.result.result&&t("response.data.outCommonHeader.result.messages[0].responseMessage")}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),i({error:e.data})})})},a.prototype.getDCScheduleQueryByDateDetails=function(a,r){return t(function(t,i){n({method:"GET",url:e.getDCScheduleQueryByDateDetails+a+"/"+r,params:{language:"SPA"}}).then(function(e){t(e.data.result)}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),i({error:e.data})})})},a.prototype.getDCInvestmentProspectQueryById=function(a){return t(function(t,r){n({method:"GET",url:e.getDCInvestmentProspectQueryById+a,params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outDCInvestmentProspectQueryById):2===e.data.outCommonHeader.result.result&&t("response.data.outCommonHeader.result.messages[0].responseMessage")}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),r({error:e.data})})})},a.prototype.getDCInvestmentProspectQuery=function(a){return t(function(t,r){n({method:"GET",url:e.getDCInvestmentProspectQuery,params:{language:"SPA",email:a}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outDCInvestmentProspectQuery):2===e.data.outCommonHeader.result.result&&t("response.data.outCommonHeader.result.messages[0].responseMessage")}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),r({error:e.data})})})},new a}e.$inject=["URLS","$q","$http","ErrorMessagesSrv"],angular.module("actinver.services").factory("dinnSrv",e)}(),function(){"use strict";function e(e){e.state("dinn",{templateUrl:"/app/dinn/adviser/dinn.html",url:"/dinn",parent:"app",ncyBreadcrumb:{label:"Dinn",parent:"app.dashboard"},redirectTo:"dinn.show"}).state("dinn.show",{templateUrl:"/app/dinn/adviser/dinnShow.html",url:"/dinnShow",controller:"dinnCtrl",controllerAs:"show",parent:"dinn",ncyBreadcrumb:{label:"Citas Dinn",parent:"dinn"}}).state("dinn.book",{templateUrl:"/app/dinn/adviser/dinnBook.html",url:"/dinnBook",controller:"dinnBookCtrl",controllerAs:"book",parent:"dinn",ncyBreadcrumb:{label:"Información citas",parent:"dinn.show"},params:{informationDate:null}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e){var t={};return t.addReason=function(t,n){return e.open({templateUrl:"/scripts/modals/views/pending/reason.html",size:"md",controller:"addPendingModalCtrl",controllerAs:"pending",resolve:{params:function(){return n},title:function(){return t}}})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("pendingModalsSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){p.asesor=!1,p.cat=!1,o.makeDataUser().then(function(e){e.user.scope.forEach(function(e){"ASESOR"===e&&(p.asesor=!0),"CAT"===e&&(p.cat=!0)}),s()})}function s(){p.asesor&&p.cat?(p.selectFilter="3",d(3)):(p.asesor&&(p.selectFilter="1",d(1)),p.cat&&(p.selectFilter="3",d(3)))}function c(e,t){p.operacion=t;var n=parseInt(e),o=p.po.indexOf(n);o>-1?p.po.splice(o,1):p.po.push(n),0===p.po.length&&(p.selectAll=!1)}function u(e){p.pendingOp[e].show=!p.pendingOp[e].show,p.pendingOp[e].icon="+"===p.pendingOp[e].icon?"-":"+",p.detail=p.pendingOp[e]}function l(){p.po=[],p.modeIdPo={},p.selectAll=!1,p.disabled=!1,p.operacion=""}function d(t){function n(e){if(null!==e.response.data.outEBPendingOpQuery){var t=e.response.data.outEBPendingOpQuery.operationList.operation;0===e.response.data.outEBPendingOpQuery.operationList.operation.length?p.data=!0:p.data=!1,angular.forEach(t,function(e,n){try{var o=JSON.parse(t[n].operation);t[n].operation=o}catch(e){t[n].operation={}}t[n].show=!1,t[n].icon="+",t[n].key=n}),p.pendingOp=t}else p.data=!0}function o(){}e.getOperationsHistoric(t).then(n).catch(o)}function m(t){var n=angular.toJson(p.po);n=n.replace("[",""),n=n.replace("]","");var o={operationID:n,rejectionReason:p.operacion,language:"SPA"};if("reject"===t){var r=[];p.po.length>1?p.nameOperation="Otro":p.nameOperation=p.operacion,e.cancelation(p.nameOperation).then(function(e){o.rejectionReason=e,a.addReason("Agregar un Motivo",o).result.then(function(e){"Otro"===p.nameOperation?angular.forEach(p.po,function(t){r.push({operationID:t,rejectionReason:e.description,idRejection:e.id})}):r.push({operationID:p.po[0],rejectionReason:e.description,idRejection:e.id}),o={pendingReject:JSON.stringify(r),language:"SPA"},p.send(o,t)})})}}var p=this;p.checkAll=function(){p.po=[],angular.forEach(p.pendingOp,function(e,t){p.selectAll?"0"!==e.stateID&&"9"!==e.stateID||(p.modeIdPo[t]=p.selectAll,c(e.operationID,e.moduleDescription.description)):p.modeIdPo[t]=p.selectAll})},p.getOpHistoricFilter=function(e){d(e)},p.columns=[{name:"operationID",value:"Id"},{name:"statusID",value:"Estatus"},{name:"JSON.parse(moduleDescription)",value:"Operación"},{name:"instructionDate",value:"Fecha"}],p.selectPo=c,p.showDetail=u,p.searchPO="",p.detail,p.pendingOp=[],p.modeIdPo=[],p.show,p.disabled=!1,p.pageSize="20",p.currentPage=1,p.sortType="operationID",p.sortReverse=!0,p.po=[],p.sendOperation=m,p.removeItemsPo=l,p.send=function(o,a){function r(e){var o=JSON.parse($sessionStorage.user);o.enviroment;if("reject"===a)p.data=e.response.outAdviserPendingOpsModification.operationsDetails;else try{e.response.outAdviserPendingOpsExecution.operationsDetails&&(p.data=e.response.outAdviserPendingOpsExecution.operationsDetails)}catch(t){p.data=e}e.status?n.go("pending-operations-adviser-result",{poResult:p.data,typeOperation:a,operations:p.nameAndId,views:"historic"}):t.error(e.responseMessage)}function i(){}p.nameAndId=[],p.po.forEach(function(e){p.pendingOp.forEach(function(t){if(e===t.operationID){var n={id:e,tipoOperacion:t.moduleDescription};p.nameAndId.push(n)}})}),e.sendPendingOperations(o,a).then(r).catch(i),l()},p.primero=1,p.preview=function(){p.expand(),p.primero=0,r(function(){p.primero=1;var e=document.getElementById("segundo");angular.element(e).triggerHandler("click")},0)},p.expand=function(){for(var e=p.currentPage*p.pageSize-p.pageSize;e<(p.pendingOp.length||p.currentPage*p.pageSize);e++)"+"===p.pendingOp[e].icon&&u(e)},function(){i()}()}e.$inject=["pendingOperationsAdviser","CommonModalsSrv","$state","loginSrvc","pendingModalsSrv","$timeout"],angular.module("actinver.controllers").controller("pending-operations-historic",e)}(),function(){"use strict";function e(e,t){function n(e){try{o.result[e].show=!o.result[e].show,o.result[e].icon="+"===o.result[e].icon?"-":"+",o.result[e].text="Más Información"===o.result[e].text?"Cerrar":"Más Información",o.detail=o.result[e]}catch(e){o.result[0].show=!o.result[0].show,o.result[0].icon="+"===o.result[0].icon?"-":"+",o.result[0].text="Más Información"===o.result[0].text?"Cerrar":"Más Información",o.detail=o.result[0]}}var o=this;o.result,o.show,o.showDetail=n,o.typeOperation="approve"===t.typeOperation?"Aprobación":"Rechazo";var a=t.poResult;o.nameoperation=t.operations,o.views=t.views,function(){if(null===a)e.go("pending-operations-adviser");else try{if(3===a.response.outCommonHeader.result.result){o.result=[];var t={};t.message={},t.message.message=a.response.result,t.message.estatus=a.response.outCommonHeader.result.messages[0].responseSystemCode,t.message.tipoOperacion=a.response.outCommonHeader.result.messages[0].responseMessage,t.show=!1,t.icon="+",t.text="Más Información",o.result.push(t)}}catch(e){var n=a;angular.forEach(n,function(e,t){if("Aprobación"===o.typeOperation&&(n[t].message=JSON.parse(n[t].message)),"Rechazo"===o.typeOperation){var a=n[t].message;n[t].message={},n[t].message.message=a,e.successFlag?n[t].message.estatus="Éxito":n[t].message.estatus="Error",o.nameoperation.forEach(function(o){o.id===e.operationID&&(n[t].message.tipoOperacion=o.tipoOperacion.description)})}n[t].show=!1,n[t].icon="+",n[t].text="Más Información",n[t].key=t}),o.result=n}}(),o.Change=function(){"operations"===o.views?e.go("pending-operations-adviser"):e.go("pending-operations-historic")}}e.$inject=["$state","$stateParams"],angular.module("actinver.controllers").controller("pending-operations-adviser-result.controller",e)}(),function(){"use strict";function e(e,t){function n(e){a.pendingOp[e].show=!a.pendingOp[e].show,a.pendingOp[e].icon="+"===a.pendingOp[e].icon?"-":"+",a.detail=a.pendingOp[e]}function o(){function t(e){if(null!==e.response.data.outEBPendingOpQuery){var t=e.response.data.outEBPendingOpQuery.operationList.operation;0===e.response.data.outEBPendingOpQuery.operationList.operation.length?a.data=!0:a.data=!1,angular.forEach(t,function(e,n){try{var o=JSON.parse(t[n].operation);t[n].operation=o}catch(e){t[n].operation={}}t[n].show=!1,t[n].icon="+",t[n].key=n}),a.pendingOp=t}else a.data=!0}function n(){}e.getOperationsSent().then(t).catch(n)}var a=this;a.po=[],a.columns=[{name:"operationID",value:"Id"},{name:"statusID",value:"Estatus"},{name:"JSON.parse(moduleDescription)",value:"Operación"},{name:"instructionDate",value:"Fecha"}],a.showDetail=n,a.searchPO="",a.detail,a.pendingOp=[],a.modeIdPo=[],a.show,a.disabled=!1,a.pageSize="20",a.currentPage=1,a.sortType="operationID",a.sortReverse=!0,a.primero=1,a.preview=function(){a.expand(),a.primero=0,t(function(){a.primero=1;var e=document.getElementById("segundo");angular.element(e).triggerHandler("click")},0)},a.expand=function(){for(var e=a.currentPage*a.pageSize-a.pageSize;e<(a.pendingOp.length||a.currentPage*a.pageSize);e++)"+"===a.pendingOp[e].icon&&n(e)},function(){o()}()}e.$inject=["pendingOperationsAdviser","$timeout"],angular.module("actinver.controllers").controller("pending-operations-sent-ctrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){f.asesor=!1,f.cat=!1,o.makeDataUser().then(function(e){e.user.scope.forEach(function(e){"ASESOR"===e&&(f.asesor=!0),"CAT"===e&&(f.cat=!0)}),c()})}function c(){f.asesor&&f.cat?(f.selectFilter="3",p(3)):(f.asesor&&(f.selectFilter="1",p(1)),f.cat&&(f.selectFilter="3",p(3)))}function u(e,t){f.operacion=t;var n=parseInt(e),o=f.po.indexOf(n);o>-1?f.po.splice(o,1):f.po.push(n),0===f.po.length&&(f.selectAll=!1)}function l(){f.po=[],f.modeIdPo={},f.selectAll=!1,f.disabled=!1,f.operacion=""}function d(t){var n=angular.toJson(f.po);n=n.replace("[",""),n=n.replace("]","");var o={operationID:n,rejectionReason:f.operacion,language:"SPA"};if("reject"===t){var r=[];f.po.length>1?f.nameOperation="Otro":f.nameOperation=f.operacion,e.cancelation(f.nameOperation).then(function(e){o.rejectionReason=e,a.addReason("Agregar un Motivo",o).result.then(function(e){"Otro"===f.nameOperation?angular.forEach(f.po,function(t){r.push({operationID:t,rejectionReason:e.description,idRejection:e.id})}):r.push({operationID:f.po[0],rejectionReason:e.description,idRejection:e.id}),o={pendingReject:JSON.stringify(r),language:"SPA"},f.send(o,t)})})}else f.send(o,t)}function m(e){f.pendingOp[e].show=!f.pendingOp[e].show,f.pendingOp[e].icon="+"===f.pendingOp[e].icon?"-":"+",f.detail=f.pendingOp[e]}function p(t){function n(e){if(null!==e.response.data.outEBPendingOpQuery){var t=e.response.data.outEBPendingOpQuery.operationList.operation;0===e.response.data.outEBPendingOpQuery.operationList.operation.length?f.data=!0:f.data=!1,angular.forEach(t,function(e,n){try{var o=JSON.parse(t[n].operation);t[n].operation=o}catch(e){t[n].operation={}}t[n].show=!1,t[n].icon="+",t[n].key=n}),f.pendingOp=t}else f.data=!0}function o(){}e.getOperations(t).then(n).catch(o)}var f=this;f.po=[],f.columns=[{name:"operationID",value:"Id"},{name:"statusID",value:"Estatus"},{name:"JSON.parse(moduleDescription)",value:"Operación"},{name:"instructionDate",value:"Fecha"}],f.selectPo=u,f.showDetail=m,f.removeItemsPo=l,f.searchPO="",f.detail,f.pendingOp=[],f.modeIdPo=[],f.show,f.disabled=!1,f.pageSize="20",f.currentPage=1,f.sortType="operationID",f.sortReverse=!0,f.sendOperation=d,f.getAsesoresFilter=function(e){l(),p(e)},f.getCfFilter=function(e){l(),p(e)},f.getCatFilter=function(e){l(),p(e)},f.checkAll=function(){f.po=[],angular.forEach(f.pendingOp,function(e,t){f.modeIdPo[t]=f.selectAll,f.selectAll&&u(e.operationID,e.moduleDescription.description)})},f.primero=1,f.preview=function(){f.expand(),f.primero=0,r(function(){f.primero=1;var e=document.getElementById("segundo");angular.element(e).triggerHandler("click")},0)},f.expand=function(){for(var e=f.currentPage*f.pageSize-f.pageSize;e<(f.pendingOp.length||f.currentPage*f.pageSize);e++)"+"===f.pendingOp[e].icon&&m(e)},f.send=function(o,a){function r(e){var o=JSON.parse(i.user);o.enviroment;if("reject"===a)f.data=e.response.outAdviserPendingOpsModification.operationsDetails;else try{e.response.outAdviserPendingOpsExecution.operationsDetails&&(f.data=e.response.outAdviserPendingOpsExecution.operationsDetails)}catch(t){f.data=e}e.status?n.go("pending-operations-adviser-result",{poResult:f.data,typeOperation:a,operations:f.nameAndId,views:"operations"}):t.error(e.responseMessage)}function s(){}f.nameAndId=[],f.po.forEach(function(e){f.pendingOp.forEach(function(t){if(e===t.operationID){var n={id:e,tipoOperacion:t.moduleDescription};f.nameAndId.push(n)}})}),e.sendPendingOperations(o,a).then(r).catch(s),l()},function(){s(),c()}()}e.$inject=["pendingOperationsAdviser","CommonModalsSrv","$state","loginSrvc","pendingModalsSrv","$timeout","$sessionStorage"],angular.module("actinver.controllers").controller("pending-operations-adviser.controller",e)}(),function(){"use strict";function e(e){e.state("pending-operations",{templateUrl:"/app/pending-operations/adviser/pending-operation.html",parent:"app",url:"/pending-operations",ncyBreadcrumb:{label:"Operaciones Pendientes",parent:"app.dashboard"},redirectTo:"received"}).state("received",{templateUrl:"/app/pending-operations/adviser/pending-operations-received.html",parent:"pending-operations",url:"/received",ncyBreadcrumb:{label:"Recibidas",parent:"pending-operations"},redirectTo:"pending-operations-adviser"}).state("sent",{templateUrl:"/app/pending-operations/adviser/pending-operations-sent.html",parent:"pending-operations",url:"/sent",controller:"pending-operations-sent-ctrl",controllerAs:"poCtrl",ncyBreadcrumb:{label:"Enviadas",parent:"pending-operations"}}).state("pending-operations-adviser",{templateUrl:"/app/pending-operations/adviser/pending-operations.html",parent:"received",controller:"pending-operations-adviser.controller",controllerAs:"poCtrl",url:"/pending-operations-adviser",ncyBreadcrumb:{label:"Operaciones Pendientes",parent:"received"}}).state("pending-operations-historic",{templateUrl:"/app/pending-operations/adviser/historic.html",parent:"received",controller:"pending-operations-historic",controllerAs:"poCtrl",url:"/historic",ncyBreadcrumb:{label:"Historico",parent:"received"}}).state("pending-operations-adviser-result",{templateUrl:"/app/pending-operations/adviser/pending-operations-result.html",parent:"app",controller:"pending-operations-adviser-result.controller",controllerAs:"porCtrl",url:"/pending-operations-adviser-result",ncyBreadcrumb:{label:"Resultado",parent:"pending-operations-adviser"},params:{poResult:null,typeOperation:null,operations:null,views:null}})}e.$inject=["$stateProvider"],angular.module("actinver").config(e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(o){var a;return t(function(t,i){r.makeDataUser().then(function(r){function s(e){"ERROR"===e.data.type?i({status:!1,response:e.data,responseMsg:"No existen operaciones pendientes"}):t({status:!0,response:e})}function c(){}for(var u=0;u<r.user.scope.length;u++){var l=r.user.scope[u];if("CAT"===l){a=n.getPendingOperationsCat+o+"?language=SPA";break}if("ASESOR"===l){a=n.getPendingOperations+o+"?language=SPA";break}}e.get(a).then(s).catch(c)})})}function c(s,c){var u,l=JSON.parse(i.user);l.enviroment;return t(function(t){r.makeDataUser().then(function(r){function i(){e({method:"POST",url:u,data:$.param(s)}).then(function(e){if(e.data.error){if(void 0===e||1!==e.data.outCommonHeader.result.result)return{status:!1,responseMessage:e.data.error.responseMessage};t({status:!0,response:e.data})}else t({status:!0,response:e.data})}).catch(function(){a("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function l(){}for(var d=0;d<r.user.scope.length;d++){var m=r.user.scope[d];if("CAT"===m){u="reject"===c?n.PendingOperationsRejectCatNotification:n.PendingOperationsApproveCatNotification;break}if("ASESOR"===m){u="reject"===c?n.PendingOperationsRejectNotification:n.PendingOperationsApproveNotification;break}}o.csrfValidate().then(i).catch(l)})})}function u(e){return t(function(t){var n=null;switch(e){case"Otro":n=-1;break;case"COMPRA/VENTA DE TITULOS DE EMISORAS SOCIEDADES DE INVERSIÓN":n=0;break;case"TRASPASO SPEI DESDE CONTRATO DE CASA DE BOLSA":n=3;break;case"REGISTRO DE ORDEN PARA MERCADO DE DINERO (BONOS)":n=2;break;case"REGISTRO DE ORDEN DE MERCADO DE CAPITALES":case"REGISTRO STOPLOSS DE UNA EMISORA DE MERCADO DE CAPITALES":n=1;break;case"COMPRA DE FONDOS DE INVERSIÓN DE BANCO":case"VENTA DE FONDOS DE INVERSIÓN DE BANCO":n=0;break;case"REGISTRO DE VENTA DE DIRECTO MERCADO DE DINERO":case"REGISTRO DE COMPRA DE DIRECTO MERCADO DE DINERO":case"REGISTRO DE VENTA DE REPORTO MERCADO DE DINERO":n=2;break;case"TransferExecution No se tiene desc":n=3}t(n)})}function l(o){var a;return t(function(t,i){r.makeDataUser().then(function(r){function s(e){"ERROR"===e.data.type?i({status:!1,response:e.data,responseMsg:"No existen operaciones pendientes"}):t({status:!0,response:e})}function c(){}for(var u=0;u<r.user.scope.length;u++){var l=r.user.scope[u];if("CAT"===l){a=n.PendingOperationsHistoricCat+o+"?language=SPA";break}if("ASESOR"===l){a=n.PendingOperationsHistoric+o+"?language=SPA";break}}e.get(a).then(s).catch(c)})})}function d(){var o=n.getPendingOperationsSent+"?language=SPA";return t(function(t,n){function a(e){"ERROR"===e.data.type?n({status:!1,response:e.data,responseMsg:"No existen operaciones pendientes"}):t({status:!0,response:e})}function r(){}e.get(o).then(a).catch(r)})}return{getOperations:s,sendPendingOperations:c,cancelation:u,getOperationsHistoric:l,getOperationsSent:d}}e.$inject=["$http","$q","URLS","csrfSrv","ErrorMessagesSrv","loginSrvc","$sessionStorage"],angular.module("actinver.services").factory("pendingOperationsAdviser",e)}(),function(){"use strict";function e(e,t,n,o,a){var r=this;r.reminder={},r.sent_reminder=!1,r.info=o.info,r.reminder.congratulation=!1,r.sendReminder=function(){r.sent_reminder=!0;var e=r.reminder,t={language:"SPA",nameClient:o.info.name,contract:o.info.contract,phoneNumber:o.info.phoneNumber,message:e.message,subject:e.subject,email:o.info.email};a.sendMessage(t).then(function(e){1===e.status?n.done("El mensaje se ha enviado exitosamente."):2===e.status&&n.error(e.message[0].description),r.loading=!1}).catch(function(){n.error("Error al enviar el correo")}).finally(function(){r.done()})},r.close=function(){t.dismiss()},r.done=function(){t.close()}}e.$inject=["$timeout","$uibModalInstance","CommonModalsSrv","clientInfo","binnacleBirthdaysSrv"],angular.module("actinver.controllers").controller("clientInfoModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){var i=this;i.form={employee:r.employee,contrato:r.contrato,tipoOrigen:r.tipoOrigen,typeServicio:r.typeServicio,tipoPersona:r.tipoPersona,typeoperation:r.typeoperation,investmentProfile:r.investmentProfile},i.sent_type=!1,i.sendType=function(){i.sent_type=!0;var e=i.form.type;e="confirm"===e?1:"update"===e?2:3;var t={type:e,contratoXactualizar:r.contrato,origenPeticion:r.tipoOrigen,tipoPersona:r.tipoPersona,tipoServicio:r.typeServicio,language:"SPA",idEmployee:i.form.employee};o.getSellsPracticeUrl(t).then(function(e){1===e.data.status?window.open(e.data.result,"_blank"):a.error("No se puedo realizar la operación")},function(){a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),i.done()}),i.sent_type=!1,i.done()},i.close=function(){t.dismiss()},i.done=function(){t.close()}}e.$inject=["$window","$uibModalInstance","$httpParamSerializer","binnacleOutlineSrv","CommonModalsSrv","outlineItemDetails"],angular.module("actinver.controllers").controller("outlineClientModalCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.close=function(){e.dismiss()},o.done=function(){e.close(o.fav)}}e.$inject=["$uibModalInstance","title","favorite"],angular.module("actinver.controllers").controller("admonDerivativeModalCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){a.title=t,a.employee=n}var a=this;a.close=function(){e.dismiss()},a.done=function(){e.close(a.employee)},function(){o()}()}e.$inject=["$uibModalInstance","title","employee"],angular.module("actinver.controllers").controller("admonEmployeeModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){u.loading=!0,o.getClassifications().then(function(e){u.products=e.map(function(e){return e.text=e.description,e}),
u.loading=!1})}function c(){u.title=t,u.factsheet=n}var u=this;u.loading=!1,u.uploaderOptions=[{formats:["image/png","image/jpeg","image/jpg"],size:2097152}],n.idProduct&&i.getImage(n.idProduct).then(function(e){u.product_factsheet_img_url=e}).catch(function(e){a.error(e.error)}),u.previewFile=function(e,t){u.imgPreview=e,u.factsheet.file=t},u.errorFile=function(e){u.imgPreview=!1,u.factsheet.file=!1,a.error(e)},u.cleanFields=function(){u.imgPreview=!1,u.factsheet={}},u.close=function(){e.close()},u.done=function(){u.loading=!0,o.doFactsheet(u.factsheet).then(function(t){null!==t.data?u.factsheet.file?o.updateImg(t.data,u.factsheet.file).then(function(){e.close("success")}).catch(function(){e.close("error")}).finally(function(){u.loading=!1,u.cleanFields()}):e.close("success"):(u.close(),a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"))})},function(){c(),n.name||s()}()}e.$inject=["$uibModalInstance","title","factsheet","FactsheetsSrv","CommonModalsSrv","URLS","factSheetSrv"],angular.module("actinver.controllers").controller("admonFactsheetModalCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(o){return t(function(t,a){function r(e){for(var t="",n=new Uint8Array(e),o=n.byteLength,a=0;a<o;a++)t+=String.fromCharCode(n[a]);return window.btoa(t)}e({method:"GET",url:n.getProductFactsheetImg+o,responseType:"arraybuffer",params:{language:"SPA"}}).then(function(e){var n=r(e.data);t(n)}).catch(function(e){a({error:e.data})})})}return{getImage:o}}e.$inject=["$http","$q","URLS"],angular.module("actinver.services").service("factSheetSrv",e)}(),function(){"use strict";function e(e,t,n,o){function a(){n&&(n.classification.text=n.classification.description),i.title=t,i.favorite=n,i.states=["Chiapas","Veracruz","Paracio de hierro","Liverpool","Sams","Fabricas de francia"],i.fav=n||{}}function r(){o.getClassificationFavAdm().then(function(e){i.classification=e.data.map(function(e){return e.text=e.description,e})},function(){CommonModalsSrv.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),$rootScope.listClassFav=null})}var i=this;n&&(i.idIssuer=n.idIssuer,i.issuerName=n.issuerName,i.serie=n.serie,i.idClassification=n.idClassification),"Nuevo favorito"===t?i.type="newFav":"Editar favorito"===t?i.type="updateFav":"Eliminar clasificacón"===t&&(i.type="deleteClassification"),i.close=function(){e.dismiss()},i.done=function(){e.close(i.fav)},i.setType=function(e){i.type=e},function(){a(),r()}()}e.$inject=["$uibModalInstance","title","favorite","FavAdminSrv"],angular.module("actinver.controllers").controller("admonFavoriteModalCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){a.title=t,a.group=n}var a=this;a.close=function(){e.close()},a.done=function(){e.close(a.group)},function(){o()}()}e.$inject=["$uibModalInstance","title","group"],angular.module("actinver.controllers").controller("admonGroupModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){o.getFundTypes().then(function(e){i.clasification=e.map(function(e){return e.text=e.description,e})})}function r(){i.title=t,n&&(n.clasification.text=n.clasification.description),i.type=n?"fund":"",i.fund=n||{}}var i=this;i.setType=function(e){i.type=e},i.close=function(){e.dismiss()},i.done=function(){i.fund.type=i.type,e.close(i.fund)},function(){r(),a()}()}e.$inject=["$uibModalInstance","title","investment","InvestmentAdminSrv"],angular.module("actinver.controllers").controller("admonInvestmentModalCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(o){return t(function(t,a){e({method:"GET",url:n.getPresentationFileAdm+o,responseType:"arraybuffer",params:{language:"SPA"}}).then(function(e){var n=new Blob([e.data],{type:"application/pdf"}),o=URL.createObjectURL(n);window.open(o,"_blank","Presentación"),t({response:e.data})}).catch(function(e){a({error:e.data})})})}return{getPDF:o}}e.$inject=["$http","$q","URLS"],angular.module("actinver.services").service("PresentationAdminSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){a.getTypes().then(function(e){l.products=e.map(function(e){return e.text=e.description,e})})}function c(){return o}function u(){l.title=n,l.pres=o?c():{}}var l=this;l.loading=!1,l.uploaderOptions=[{formats:["application/pdf"],size:10485760}],l.previewFile=function(e,t){l.pres.file=t},l.errorFile=function(e){l.pres.file=!1,r.warning(e)},l.cleanFields=function(){l.pres.file=!1},l.changeOptions=function(){var e=l.pres.type;l.clas={},l.subclas={},l.pres={type:e}},l.close=function(){e.dismiss()},l.done=function(t){l.loading=!0,"presentation"===t?a.savePresentation(l.pres).then(function(t){if(null!==t.data)if(l.pres.file){var n=l.pres.idPresentationType||l.pres.clasification.idPresentationType;a.updateFile(t.data,t.params.idPresentationSubType,l.pres.file,n).then(function(){e.close({msg:"success",type:"presentación"})}).catch(function(){e.close("error")}).finally(function(){l.loading=!1,l.cleanFields()})}else e.close({msg:"success",type:"presentación"});else l.close(),r.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")}):"clasification"===t?a.saveClasification(l.clas).then(function(t){null!==t.data?(e.close({msg:"success",type:"clasificación"}),l.loading=!1,l.cleanFields()):(l.close(),r.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"))}):a.saveSubClasification(l.subclas,l.pres.clasification.idPresentationType).then(function(t){null!==t.data?(e.close({msg:"success",type:"subclasificación"}),l.loading=!1,l.cleanFields()):(l.close(),r.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"))})},l.getPDF=function(e){i.getPDF(e).then(function(){}).catch(function(e){r.error(e.error)})},l.getSubclasification=function(e){a.getPresentationSubTypesByClassification(e.idPresentationType).then(function(e){l.subProducts=e.map(function(e){return e.text=e.description,e})})},function(){u(),s()}()}e.$inject=["$uibModalInstance","URLS","title","presentations","PresentationsAdminSrv","CommonModalsSrv","PresentationAdminSrv"],angular.module("actinver.controllers").controller("admonPresentationsModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){o.getRoles().then(function(e){s.listTabs=e})}function r(){s.title=t,s.profile=n}function i(){o.getRoles().then(function(e){s.products=e.map(function(e){return e.text=e.description,e})})}var s=this;s.close=function(){e.dismiss()},s.changeOptionSelectedDropdowm=function(e){s.profile.idRole=e.idRole},s.done=function(){e.close(s.profile)},function(){r(),a(),i()}()}e.$inject=["$uibModalInstance","title","profile","ProfilesSrv"],angular.module("actinver.controllers").controller("admonProfilesModalCtrl",e)}(),function(){"use strict";function e(e){var t=this;t.close=function(){e.dismiss("cancel")},t.done=function(){e.close()}}e.$inject=["$uibModalInstance"],angular.module("actinver.controllers").controller("outProfile",e)}(),function(){"use strict";function e(e,t){var n=this;n.message=t,n.close=function(){e.dismiss("cancel")},n.done=function(){e.close()}}e.$inject=["$uibModalInstance","message"],angular.module("actinver.controllers").controller("doneModalCtrl",e)}(),function(){"use strict";function e(e,t){var n=this;n.message=t,n.close=function(){e.dismiss("cancel")},n.done=function(){e.close()}}e.$inject=["$uibModalInstance","message"],angular.module("actinver.controllers").controller("errorModalCtrl",e)}(),function(){"use strict";function e(e,t){var n=this;n.message=t,n.close=function(){e.dismiss("cancel")},n.done=function(){e.close()}}e.$inject=["$uibModalInstance","message"],angular.module("actinver.controllers").controller("warningModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){var r=this;r.getAdviserInfo=function(){return r.get_info=!0,r.report_info=!1,t.all([o.getGoalsPositionsRpt(e.adviserID,e.date),o.getSumGoalsPositionsRpt(e.adviserID,e.date),o.getGoalsContractsRpt(e.adviserID,e.date)]).then(function(t){r.report_info={},r.report_empty=!0,angular.forEach(t,function(e){r.report_empty&&0!==e.data.length&&(r.report_empty=!1),r.report_info[e.topic]=e.data}),r.personal_data=e},function(){a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")}).finally(function(){r.get_info=!1})},r.close=function(){n.dismiss()},r.done=function(){n.close()},r.getAdviserInfo()}e.$inject=["adviserInfo","$q","$uibModalInstance","goalsReportsSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("adviserDetailModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){var i=this;i.getCenterInfo=function(){var n=[];switch(i.get_info=!0,i.report_info=!1,e.type){case"supervisor":n.push(o.getCenterInfo(e.employee,e.center,e.date),o.getCenterProducts(e.employee,e.center,e.date));break;case"custom":n.push(a.getCustomCenterInfoRpt(e.center,e.date),a.getCustomCenterProductsRpt(e.center,e.date))}return t.all(n).then(function(e){i.report_info={},i.report_empty=!0,angular.forEach(e,function(e){i.report_empty&&0!==e.data.length&&(i.report_empty=!1),i.report_info[e.topic]=e.data.elements||e.data})},function(){r.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),i.done()}).finally(function(){i.get_info=!1})},i.close=function(){n.dismiss()},i.done=function(){n.close()},i.getCenterInfo()}e.$inject=["centerInfo","$q","$uibModalInstance","goalsSupervisorSrv","goalsCustomSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("centerDetailModalCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.info=t.list,o.contract=t.contract,o.close=function(){e.dismiss()},o.done=function(){e.close()},o.contractSelected=function(t){n.selectedContact=t,e.close()}}e.$inject=["$uibModalInstance","info","$rootScope"],angular.module("actinver.controllers").controller("accountContractCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){var e={count:20};c.configTable=new o(e,{getData:function(n){return i(t.wordToSearch,n,e.count)}})}function i(e,t,n){return a.getBankContractsByClientQuery(e,t.page(),n).then(function(e){return e.success?(t.total(e.data.pagination.totalResult),c.showEmptyMessage=0===e.data.pagination.totalResult,e.data.clientsList.client):[]}).catch(function(){return[]})}function s(e){var t={count:20};c.configTable=new o(t,{dataset:e.list})}var c=this;c.showEmptyMessage=!1,c.info=t,c.close=function(){e.dismiss()},c.done=function(){e.close()},c.nameSelected=function(t){n.selectedClient=t,e.close()},function(){"1"===t.personType?r():s(t)}()}e.$inject=["$uibModalInstance","info","$rootScope","NgTableParams","accountSrv"],angular.module("actinver.controllers").controller("accountNameCtrl",e)}(),function(){"use strict";function e(e,t){var n=this;n.info=t,n.date=new Date,n.close=function(){e.dismiss()},n.done=function(){e.close()}}e.$inject=["$uibModalInstance","info"],angular.module("actinver.controllers").controller("invModalCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.data=n,o.contenido="",o.close=function(){e.close()},o.linkTo=function(e){t.open(e.uri,"_blank")},o.filter=function(e){return function(t){var n=moment(t.publishedDate).format("yyyy-MM-dd HH:mm");return!(!t.title.toUpperCase().includes(e.toUpperCase())&&!n.includes(e))}}}e.$inject=["$uibModalInstance","$window","data"],angular.module("actinver.controllers").controller("newsModalCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.selected=null,o.data=t,o.close=function(){e.dismiss("cancel")},o.calculate=function(){o.close(),n(o.selected)},o.changeSelected=function(e){null!==o.data&&(o.data.forEach(function(t){t.selected=!1,t.instrumentDesc===e.instrumentDesc&&t.term===e.term&&(t.selected=!0)}),o.selected=e)}}e.$inject=["$uibModalInstance","data","fn"],angular.module("actinver.controllers").controller("directsBandsMdlCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(e,t){var n=null;if(e){for(var o=atob(e),a=new Array(o.length),r=0;r<o.length;r++)a[r]=o.charCodeAt(r);var i=[],s=new Uint8Array(a);i.push(s),n=new Blob(i,{type:t})}return n}var m=this;m.mailTo=[],m.mailConfirm=a,m.contract=JSON.parse(localStorage.getItem("contractSelected")),m.close=function(){e.close()},m.confirmMail=function(){if(0==m.mailTo.length){var e=JSON.parse(localStorage.getItem("contractSelected")).bankingArea,t={contractNumber:m.contract.contractNumber,bankingArea:e};i.getContractInfoDetail(t).then(function(e){0===e.holder.emailList.email.length?(c.error("No tiene correos asignados"),m.mailConfirm=!1):(angular.forEach(e.holder.emailList.email,function(e,t){m.mailTo.push(e.toLowerCase())}),m.mailConfirm=!0)}).catch(function(e){c.error(l.createError(e))})}else m.mailConfirm=!0},m.getPdf=function(){e.close();var a={language:"SPA",contractNumber:m.contract.contractNumber,operationID:t,operationDate:n,holder:o,adviser:r.user.name};s.getConfirmLtr(a).then(function(e){e.success?(u.saveAs(d(e.info,"application/zip"),"Carta_Confirmacion.zip"),c.done("Descarga exitosa!")):c.error(e.info)}).catch(function(e){c.error(e.info)})},m.sendMail=function(){e.close();var a={language:"SPA",emailFrom:"info@actinver.com.mx",idTemplate:"buildDBTemplate|19",emailSubject:"Carta Confirmación Reporto",mailTo:m.mailTo,mailCC:"",contractNumber:m.contract.contractNumber,operationID:t,operationDate:n,holder:o,adviser:r.user.name};s.sendEmail(a).then(function(e){e.success?c.done(e.info):c.error(e.info)}).catch(function(e){c.error(e.info)})}}e.$inject=["$uibModalInstance","operation","operDate","holder","mailConfirm","userConfig","accountSrv","reportoLetterModalSrv","CommonModalsSrv","FileSaver","ErrorMessage"],angular.module("actinver.controllers").controller("reportoLetterModalCtrl",e)}(),function(){"use strict";function e(e,t,n){return{getConfirmLtr:function(o){return t(function(t,a){n({method:"GET",url:e.getReportoConfirmLtr,params:o}).then(function(e){1==e.data.outCommonHeader.result.result?t({success:!0,info:e.data.result.file}):a({success:!1,info:e.data.outCommonHeader.result.messages[0].responseMessage})},function(){a({success:!1,info:"Ocurrió un problema (Bad Request)"})})})},sendEmail:function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailReportoLtr,params:o}).then(function(e){var n;1==e.data.outCommonHeader.result.result?(n="Envío de correo exitoso",t({success:!0,info:n})):(n=e.data.outCommonHeader.result.messages[0].responseMessage,a({success:!1,info:n}))},function(){a({success:!1,info:"Ocurrió un problema (Bad Request)"})})})}}}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("reportoLetterModalSrv",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.data=n,o.close=function(){e.dismiss("cancel")},o.done=function(n){t.saveStateNotification({adviserNotificationID:n}).then(function(){e.close()}).catch(function(){e.close()})}}e.$inject=["$uibModalInstance","notificationLuminaSrv","data"],angular.module("actinver.controllers").controller("luminaModalCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;o.title=t,o.cancel=function(){e.dismiss()},o.done=function(){if("Otro"===o.reason.description){var t={id:0,text:o.reasontext,description:o.reasontext};e.close(t)}else e.close(o.reason)},o.catalogo=[{id:0,title:"Fondos de Inversión",items:[{id:2,text:"Orden no instruida por cliente",description:"Orden no instruida por cliente"},{id:3,text:"Importe erróneo",description:"Importe erróneo"},{id:4,text:"Error en N° de títulos",description:"Error en N° de títulos"},{id:5,text:"Fondo Inversión erróneo",description:"Fondo Inversión erróneo"},{id:6,text:"Forma o cuenta de liquidación errónea",description:"Forma o cuenta de liquidación errónea"}]},{id:1,title:"Mercado de Capitales",items:[{id:8,text:"Orden no instruida por cliente"},{id:9,text:"Importe erróneo"},{id:10,text:"Error en N° de títulos"},{id:11,text:"Emisora errónea"},{id:12,text:"Precio erróneo"},{id:13,text:"Plazo erróneo"},{id:14,text:"Error en tipo de orden"}]},{id:2,title:"Mercado de Dinero",items:[{id:16,text:"Orden no instruida por cliente"},{id:17,text:"Importe erróneo"},{id:18,text:"Tipo de instrumento erróneo"},{id:19,text:"Plazo erróneo"},{id:20,text:"Tasa errónea"}]},{id:3,title:"Transferencias",items:[{id:22,text:"Orden no instruida por cliente"},{id:23,text:"Importe erróneo"},{id:24,text:"Contrato o Cuenta destino errónea"},{id:25,text:"Contrato origen erróneo"}]},{id:-1,title:"Otro",items:[{id:0,text:"Otro",description:"Otro"},{id:2,text:"Orden no instruida por cliente",description:"Orden no instruida por cliente"},{id:3,text:"Importe erróneo",description:"Importe erróneo"},{id:4,text:"Error en N° de títulos",description:"Error en N° de títulos"},{id:5,text:"Fondo Inversión erróneo",description:"Fondo Inversión erróneo"},{id:6,text:"Forma o cuenta de liquidación errónea",description:"Forma o cuenta de liquidación errónea"},{id:8,text:"Orden no instruida por cliente"},{id:9,text:"Importe erróneo"},{id:10,text:"Error en N° de títulos"},{id:11,text:"Emisora errónea"},{id:12,text:"Precio erróneo"},{id:13,text:"Plazo erróneo"},{id:14,text:"Error en tipo de orden"},{id:16,text:"Orden no instruida por cliente"},{id:17,text:"Importe erróneo"},{id:18,text:"Tipo de instrumento erróneo"},{id:19,text:"Plazo erróneo"},{id:20,text:"Tasa errónea"},{id:22,text:"Orden no instruida por cliente"},{id:23,text:"Importe erróneo"},{id:24,text:"Contrato o Cuenta destino errónea"},{id:25,text:"Contrato origen erróneo"}]}],function(){o.catalogo.forEach(function(e){e.id===n.rejectionReason&&(o.items=e.items)}),n.rejectionReason}()}e.$inject=["$uibModalInstance","title","params"],angular.module("actinver.controllers").controller("addPendingModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c){function u(e,t){var n="";return e.forEach(function(e){n=e.description===t?e.idActivity:1}),n}function l(e){c.getMedia().then(function(t){g.idActivity=u(t,e)})}function d(){a.getStageProspect(r.user.employeeID,i.id).then(function(e){g.detailProspect=e,m()})}function m(){a.getDetailProspect(i.id,g.detailProspect.idStage).then(function(e){g.prospectDetail=e})}function p(){return n&&(g.varsActivity={activity:{type:n.contactType,note:n.notes,place:n.location,affair:n.subject,time:n.schedule,date:n.date,agendar:!(!n.subject&&!n.location),media:{description:n.contactType,text:n.contactType}}},g.varsActivity.activity.date=n.date?moment(n.date):moment()),""}function f(){o.dateConfiguration={singleDatePicker:!0},g.configdate={singleDatePicker:!0,minDate:moment(),maxDate:n.closeDate,locale:{format:"DD/MM/YYYY"}}}var g=this;g.title=t||"NUEVA ACTIVIDAD",g.cancel=function(){e.dismiss()},g.saveActivity=function(){console.log("userConfig:",r),console.log("vm.detailProspect:",g.detailProspect),console.log("vm.varsActivity:",g.varsActivity),console.log("activity:",n),o.$broadcast("updateDetailProspect");var t=g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.time?g.varsActivity.activity.time.split("-"):["",""];if("NUEVA ACTIVIDAD"===g.title){var c={language:"SPA",idProspect:i.id,idEmployee:r.user.employeeID,idStage:g.detailProspect.idStage,contactDate:g&&g.varsActivity.activity&&g.varsActivity.activity.date?s("date")(g.varsActivity.activity.date._d,"yyyy-MM-dd"):"",idActivity:g.varsActivity.activity.media.idActivity,startTime:t[0].replace(/ /g,""),endTime:t[1].replace(/ /g,""),notes:g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.note?g.varsActivity.activity.note:"",mail:r.user.mail,temp:"",subject:g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.affair?g.varsActivity.activity.affair:"",location:g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.place?g.varsActivity.activity.place:"",name:n.name,prospectMail:n.mail,sendNotification:!!(g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.notify)&&g.varsActivity.activity.notify};a.saveActivity(c).then(function(){e.close()})}else{var u={language:"SPA",idActivityStage:n.idActivityStage,contactDate:g&&g.varsActivity.activity&&g.varsActivity.activity.date?s("date")(g.varsActivity.activity.date._d,"yyyy-MM-dd"):"",idActivity:void 0===g.varsActivity.activity.media.idActivity?g.idActivity:g.varsActivity.activity.media.idActivity,startTime:t[0].replace(/ /g,""),endTime:t[1].replace(/ /g,""),notes:g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.note?g.varsActivity.activity.note:"",mail:r.user.mail,temp:"",subject:g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.affair?g.varsActivity.activity.affair:"",location:g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.place?g.varsActivity.activity.place:"",name:n.prospectDetail.nombreProspecto,prospectMail:n.prospectDetail.mailProspect,sendNotification:!!(g&&g.varsActivity&&g.varsActivity.activity&&g.varsActivity.activity.notify)&&g.varsActivity.activity.notify,outlookId:n.outlookId};a.updateActivity(u).then(function(){e.close()})}},function(){f(),d(),p(),l(n.contactType)}()}e.$inject=["$uibModalInstance","title","activity","$scope","prospectSrv","userConfig","$stateParams","$filter","SectionActivitySrv"],angular.module("actinver.controllers").controller("addActivityProsModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(){A.opportunity&&A.opportunity.highDate&&r.$watch("add.opportunity.highDate",function(){var e=M();if(e.maxDate=A.prospect.highDate,A.addActivity&&A.varsActivity&&A.varsActivity.activity&&A.varsActivity.activity.date&&A.prospect&&A.prospect.highDate){var t=A.varsActivity.activity.date;A.varsActivity.activity.date=A.prospect.highDate>=t?t:moment()}A.datepicker_opts_Actividad=e})}function m(){l.getStrategy().then(function(e){e.success?A.strategy=e.data.map(function(e){return e.text=e.strategy,e}):u.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")})}function p(){l.getSegment().then(function(e){e.success?A.segment=e.data.map(function(e){return e.text=e.segment,e}):u.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")})}function f(){l.setOpportunity(A.opportunity,A.varsActivity).then(function(e){e.success?o.close():(o.dismiss(),u.error(e.data))})}function g(e){var t=e.idStage-A.detailOpportunity.asrStage.idStage;return 8===e.idStage&&0==A.detailOpportunity.contacted?(u.error("Para cambiar de etapa, el cliente debe ser contactado"),!1):t>=2&&10!=e.idStage?(u.error("Te falta seleccionar la Etapa PROSPECTO"),!1):!(!A.opportunity.lowMotive&&A.activeLowMotive)||(u.error("Seleccione el origen de la Baja"),!1)}function h(){A.prospect.refersName="",A.prospect.clientNumber=""}function v(e,t,n){var o={type:0,titularFlag:!0,bankingArea:e,contractNumber:"",clientNumber:""};return"contract"===t?(o.type=2,o.contractNumber=n):(o.type=1,o.clientNumber=n),o}function y(e){a.updateOpportunity(A.opportunity,e).then(function(e){e.success?(o.close(),u.done(e.data),10==A.opportunity.stage.idStage&&t.go("prospects.myProfile")):(o.dismiss(),u.error(e.data))})}function b(){a.getOpportunityById(c).then(function(e){A.detailOpportunity=e,S(),C()}).catch(function(){u.error("Ha ocurrido un error.")})}function C(){var e=A.detailOpportunity.asrStage.idStage,t=[];a.getStages().then(function(n){n.forEach(function(n){n.idStage>=e&&9!=e&&t.push(n)}),A.stageList=t.map(function(e){return e.text=e.description,e})})}function S(){"2"==A.detailOpportunity.asrStrategy.idStrategy?(A.isReactivation=!0,A.isNewOpportunity=!1,A.readonlyNoClient=!0,A.readonly=!0):"3"==A.detailOpportunity.asrStrategy.idStrategy?(A.isNewOpportunity=!0,A.isReactivation=!1,A.readonly=!1):(A.isReactivation=!1,A.readonly=!1),A.detailOpportunity.asrStrategy.text=A.detailOpportunity.asrStrategy.strategy,A.detailOpportunity.segmentObject={},A.detailOpportunity.segmentObject.id=A.detailOpportunity.idSegment,A.detailOpportunity.segmentObject.text=A.detailOpportunity.segment,A.detailOpportunity.asrStage.text=A.detailOpportunity.asrStage.description,A.opportunity={},A.opportunity.stage=A.detailOpportunity.asrStage,A.opportunity.strategy=A.detailOpportunity.asrStrategy,A.opportunity.clientNumber=A.detailOpportunity.clientNumber,A.opportunity.clientName=A.detailOpportunity.nameOpportunity,A.opportunity.segment=A.detailOpportunity.segmentObject,A.opportunity.phone=A.detailOpportunity.phone,A.opportunity.email=A.detailOpportunity.mail,A.opportunity.highDate=A.detailOpportunity.creationDate,A.stageBlockade=A.opportunity.stage.idStage}function D(){A.prospect={type:"prospect",referred:"false",typeClient:"contract",highDate:moment()},A.datepicker_opts_Fecha_Alta={parentEl:"idDateEnd",singleDatePicker:!0,minDate:moment(),locale:{format:"DD/MM/YYYY"}},A.datepicker_opts_Actividad=M(),A.opportunity&&(A.opportunity.clientName="",A.opportunity.phone="",A.opportunity.email="",A.opportunity.clientNumber="",A.opportunity.segment=null)}function M(){return{singleDatePicker:!0,initDate:moment(),minDate:moment(),maxDate:moment(),locale:{format:"DD/MM/YYYY"}}}var A=this;A.oldValueContract="";i.user.employeeID;A.title=s||"NUEVA OPORTUNIDAD",A.date=n("date")(new Date,"dd/MM/yyyy"),A.isReactivation=!1,A.isNewOpportunity=!1,A.readonly=!1,A.opportunity,A.lowMotive={optionMotive:[{id:"01",text:"SIN POTENCIAL"},{id:"02",text:"ILOCALIZABLE"},{id:"03",text:"CIERRE"}]},A.changeStrategy=function(e){"2"==e.idStrategy?(A.isReactivation=!0,A.isNewOpportunity=!1,A.readonlyNoClient=!1,A.readonly=!0):"3"==e.idStrategy?(A.isNewOpportunity=!0,A.isReactivation=!1,A.readonly=!1):(A.isReactivation=!1,A.readonly=!1),D()},A.lostFocusClient=function(){if(A.opportunity&&A.opportunity.clientNumber){A.oldValueContract=A.opportunity.clientNumber;var e=v(A.contracts.typeContractSelected.id,A.opportunity.typeClient,A.opportunity.clientNumber);a.getInfoClient(e).then(function(e){if(e.success){var t=e.data[0],n=t.name.trim()+" "+t.lastName.trim()+" "+t.secondLastName.trim();A.opportunity.clientName="1"===t.personType?n:t.companyName}else A.opportunity.clientName="",A.readonly=!0,u.info(e.msg)}).catch(function(e){u.info(e.msg)})}},A.done=function(){c?g(A.opportunity.stage)&&(A.disabledModal=!0,u.warning("¿Deseas modificar los datos personales del prospecto?").result.then(function(){y(c)},function(){A.disabledModal=!1})):f()},A.changeStage=function(e){A.activeLowMotive=10===e.idStage,A.opportunity.lowMotive=null},A.contracts={optionTypeContract:[{id:"998",text:"Casa"},{id:"999",text:"Banco"}],typeContractSelected:{id:"998",text:"Casa"}},A.changeTypeProspect=function(){A.prospect.DTP=null,h()},A.changeContractClient=function(){"contract"!==A.prospect.typeClient&&(A.contracts.typeContractSelected={id:"998",text:"Casa"}),h()},A.changeTypeContract=function(){h()},A.lostFocusClientContract=function(){if(A.prospect&&A.prospect.clientNumber){A.oldValueContract=A.prospect.clientNumber;var e=v(A.contracts.typeContractSelected.id,A.prospect.typeClient,A.prospect.clientNumber);a.getInfoClient(e).then(function(e){if(e.success){var t=e.data[0],n=t.name.trim()+" "+t.lastName.trim()+" "+t.secondLastName.trim();A.prospect.refersName="1"===t.personType?n:t.companyName}else A.prospect.refersName="",u.info(e.msg)}).catch(function(e){u.info(e.msg)})}},A.changeActivity=function(){A.addActivity||(A.varsActivity=null)},r.$watch("add.addActivity",function(){!A.varsActivity&&A.addActivity&&(A.varsActivity={activity:{date:moment()}})}),A.close=function(){o.dismiss()},function(){c?(A.isUpdateOp=!0,b()):(A.isUpdateOp=!1,D()),m(),p(),d()}()}e.$inject=["$injector","$state","$filter","$uibModalInstance","prospectSrv","$scope","userConfig","msg","IDOpportunity","CommonModalsSrv","addProspectSrv"],angular.module("actinver.controllers").controller("prospectsModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(){c.getReportOpportunityDetail(g,f).then(function(e){p.listReportDetail=e.result}).catch(function(){})}function m(){c.getReportOpportunityDetailFC(h,f).then(function(e){p.listReportDetail=e.result}).catch(function(){})}var p=this,f=(l.user.employeeID,n("date")(t.date,"MM/yyyy")),g=e.adviserID,h=e.idCF,v=e.type;p.name=e.name,p.close=function(){o.dismiss()},p.reportDetail=function(){var e=a.tableToExcel("#idTablaResultadosReportDetail","Reporte por estrategias"),t=document.createElement("a");t.download="Reporte por Estrategia.xls",t.href=e,t.click()},function(){1==v?d():m()}()}e.$inject=["adviserInfo","dateInfo","$filter","$uibModalInstance","exportTableToExcel","binnacleInfo","prospectModalsSrv","NgTableParams","prospectSrv","$state","userConfig"],angular.module("actinver.controllers").controller("reportDetailCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){var r=this;r.info=t,r.info.transfer.import=r.info.transfer.import.replace(/[^\d|\-+|\.+]/g,""),t.transfer.account&&t.transfer.account.bankAccounts&&t.transfer.account.bankAccounts.beneficiaryName&&(r.info.transfer.account.beneficiaryName=t.transfer.account.bankAccounts.beneficiaryName),t.transfer.account.contractNumber?r.info.transfer.account.contractNumber=t.transfer.account.contractNumber:t.transfer.account.bankAccounts.clabe&&(r.info.transfer.account.contractNumber=t.transfer.account.bankAccounts.clabe),r.date=new Date,r.close=function(){e.dismiss()},r.done=function(){o.loadingMakeTransfer=!0;var i=a.sclient.data.clientNumber,s=a.sclient.data.name+" "+a.sclient.data.lastName+" "+a.sclient.data.secondLastName;"2"===t.typeTrans&&"Casa"===t.contract.companyName?n.makeTransferOtherAccount(t,r.date,i,s).then(function(t){e.close(t)}):n.makeTransfer(t,r.date,i,s).then(function(t){e.close(t)})}}e.$inject=["$uibModalInstance","info","transfersSrv","$scope","$sessionStorage"],angular.module("actinver.controllers").controller("transferModalCtrl",e)}(),function(){"use strict";function e(e,t){var n=this;n.info=t,n.close=function(){e.dismiss()},n.done=function(){e.close()}}e.$inject=["$uibModalInstance","info"],angular.module("actinver.controllers").controller("detailModalCtrl",e)}(),function(){"use strict";function e(e){this.close=function(){e.dismiss()}}e.$inject=["$uibModalInstance"],angular.module("actinver.controllers").controller("errorSystemModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){c.table.headers=[],c.table.body=[],c.loadingDer=!0,i.getDerivatives().then(function(e){c.table.headers.push({name:"Nota",originalName:"nota"}),e&&e.length>0&&e.forEach(function(e,t){for(var n in e){var o;0==t&&"nota"!==n.toString()&&(o=n.toString().replace("a",""),c.table.headers.push({name:o,originalName:n}))}}),c.table.body=e}).finally(function(){c.loadingDer=!1})}var c=this;c.table={headers:[],body:[]},c.saveCSV=function(){i.saveCSV(c.csv).then(function(){n.done("El CSV se a guardado de manera exitosa."),c.csv="",s()})},function(){s()}()}e.$inject=["userConfig","MessagesSrv","CommonModalsSrv","modalActivity","$uibModal","administratorModalsSrv","derivativesSrv"],angular.module("actinver.controllers").controller("derivativesCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}function i(e){for(var t=e.split("\n"),n=[],o=t[0].split("|"),a=1;a<t.length;a++){for(var r={},i=t[a].split("|"),s=0;s<o.length;s++)r[o[s]]=i[s];n.push(r)}return JSON.stringify(n)}function s(e){var t=[],n={};return $.each(JSON.parse(e),function(e,o){n={},$.each(o,function(e,t){"nota"!==e?n["a"+e]=t:n[e]=t}),t[e]=n}),JSON.stringify(t)}return r.prototype.getDerivatives=function(){return t(function(t,o){n({method:"GET",url:e.getDerivatives,params:{language:"SPA"}}).then(function(e){t(e.data)}).catch(o)})},r.prototype.saveCSV=function(o){var r=o;r=r.replace(/([^\t]+)/i,"nota"),r=r.replace(/\t/g,"|");var c=i(r);return o=s(c),t(function(t,r){function i(){var a={derivatives:o};n({method:"POST",url:e.updateDerivatives,data:$.param(a),transformResponse:function(e){return{status:1,messages:[{type:null,criticality:null,code:null,description:"OPERACIÓN EXITOSA"}],result:null}}}).then(function(e){t(e.data)})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},new r}
e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("derivativesSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){l.message=null,l.rangeDate=null,l.search.endDate=new Date,l.search.startDate=new Date(l.search.endDate.getFullYear(),l.search.endDate.getMonth(),1),s(l.search.startDate,l.search.endDate)}function s(e,t){l.modal=!0,a.getDatedMessages(e,t).then(function(e){l.optionsDropdowm=c(e),l.modal=!1}).catch(function(){l.modal=!1,n.error("Ocurrio un error al obtener los mensajes.")})}function c(e){return e.forEach(function(e){e.text=e.message}),e}function u(e,t){var n=null;if(e){for(var o=atob(e),a=[],r=new Array(o.length),i=0;i<o.length;i++)r[i]=o.charCodeAt(i);var s=new Uint8Array(r);a.push(s),n=new Blob(a,{type:t})}return n}var l=this;l.modal=!1,l.search={},l.fieldSearch="",l.changeOptionSelectedDropdowm=function(e){l.fieldSearch=e.message,t.getAdvisersBinnacleMessage(e.idMessage).then(function(e){l.message=e},function(){n.error("Ocurrio un error al obtener el mensaje seleccionado.")})},l.getxlsx=function(){var n=e("date")(l.rangeDate.startDate._d,"yyyyMMdd"),a=e("date")(l.rangeDate.endDate._d,"yyyyMMdd");t.getAdvisersBinnacleBinnacle(o.user.employeeID,n,a)},l.getSearchMessagesByDates=function(){s(l.search.startDate,l.search.endDate),l.message=null,l.fieldSearch=""},l.downloadFile=function(e){var t=u(e.fileContent,e.contentType);r.saveAs(t,"file_"+e.idMessage)},l.filter=function(e){return function(t){var n=moment(t.creationDate).format("yyyy-MM-dd HH:mm"),o=moment(t.expirationDate).format("YYYY-MM-DD");return!!t.userCode.toUpperCase().includes(e.toUpperCase())||(!!t.message.toUpperCase().includes(e.toUpperCase())||!(!n.includes(e)&&!o.includes(e)))}},function(){i()}()}e.$inject=["$filter","administratorSrv","CommonModalsSrv","userConfig","MessagesSrv","FileSaver"],angular.module("actinver.controllers").controller("advisersBinnacleCtrl",e)}(),function(){"use strict";function e(e,t){function n(){t.getEconomicEnvironment().then(function(e){a.html=e},function(){a.html="Intentarlo más tarde"})}function o(){a.taOptions=[["bold","italics","ol","ul"]],a.htmlVariable="",a.html=""}var a=this;a.clearEditor=function(){a.htmlVariable=""},a.setTextEconomic=function(){a.htmlVariable.length>=5800?e.error("Ha excedido el limite de caracteres. El número máximo permitido es de 5800"):t.saveCSV(a.htmlVariable).then(function(t){1===t.status?(e.done("El texto se guardó de manera exitosa."),a.html=a.htmlVariable,a.htmlVariable=""):e.error(t.messages[0].description)})},function(){o(),n()}()}e.$inject=["CommonModalsSrv","EconomicSrv"],angular.module("actinver.controllers").controller("economicCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.getEconomicEnvironment=function(){return t(function(t,o){n({method:"GET",url:e.getEconomicEnvironment,params:{language:"SPA"}}).then(function(e){t(e.data)}).catch(o)})},a.prototype.saveCSV=function(a){return t(function(t,r){function i(){var o={economicEnvironment:a};n({method:"POST",url:e.updateEconomicEnvironment,data:$.param(o),transformResponse:function(e){return e={status:"success"===e?1:2,messages:[{type:null,criticality:null,code:null,description:e}],result:null}}}).then(function(e){t(e.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},new a}e.$inject=["URLS","$q","$http","csrfSrv"],angular.module("actinver.services").service("EconomicSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){a.table.headers=[],a.table.body=[],a.loadingEE=!0,e.getGlobalForecasts().then(function(e){a.table.headers.push({name:"Estados Unidos/ Global",originalName:"indicador"}),e&&e.length>0&&e.forEach(function(e,t){for(var n in e){var o;0==t&&5===n.toString().length&&(o=n.toString().replace("a",""),a.table.headers.push({name:o,originalName:n}))}}),a.table.body=e}).finally(function(){a.loadingEE=!1})}var a=this;a.table={headers:[],body:[]},a.saveCSV=function(){e.saveCSV(a.csv).then(function(){n.done("El CSV se a guardado de manera exitosa."),a.csv="",o()})},function(){o()}()}e.$inject=["EeuuSrv","NgTableParams","CommonModalsSrv"],angular.module("actinver.controllers").controller("eeuuCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}function r(e){for(var t=e.split("\n"),n=[],o=t[0].split(","),a=1;a<t.length;a++){for(var r={},i=t[a].split(","),s=0;s<o.length;s++)r[o[s]]=i[s];n.push(r)}return JSON.stringify(n)}function i(e){var t=[],n={};return $.each(JSON.parse(e),function(e,o){n={},$.each(o,function(e,t){"indicador"!==e?n["a"+e]=t.replace(/,/g,"."):n[e]=t}),t[e]=n}),JSON.stringify(t)}return a.prototype.getGlobalForecasts=function(){return t(function(t,o){n({method:"GET",url:e.getGlobalForecasts,params:{language:"SPA"}}).then(function(e){t(e.data)}).catch(o)})},a.prototype.saveCSV=function(a){var s=a;s=s.replace(/([^\t]+)/i,"indicador"),s=s.replace(/\t/g,",");var c=r(s);return a=i(c),t(function(t,r){function i(){var o={globalForecasts:a};n({method:"POST",url:e.updateGlobalForecasts,data:$.param(o),transformResponse:function(e){return{status:1,messages:[{type:null,criticality:null,code:null,description:"OPERACIÓN EXITOSA"}],result:null}}}).then(function(e){t(e.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},new a}e.$inject=["URLS","$q","$http","csrfSrv"],angular.module("actinver.services").service("EeuuSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){c.loadingEmpl=!0,o.getEmployeeMap(c.sadviser.employeeID).then(function(e){s(e)}).catch(function(){c.errorLoadingEmpl=!0}).finally(function(){c.loadingEmpl=!1})}function i(){c.sadviser=a.user}function s(e){c.tableParams=new n({count:10},{dataset:e})}var c=this;c.updateSearch=function(){var e=c.name;c.tableParams.filter({$:e})},c.showModalCreateEmployee=function(){e.admonEmployee("Nuevo mapeo").then(function(e){e.idEmployeeRegister=c.sadviser.employeeID,o.saveEmployeeMap(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},c.showModalRemoveEmployee=function(e){t.warning("¿Estás seguro de eliminar el mapeo?").result.then(function(){o.removeEmployeeMap(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},function(){i(),r()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","NgTableParams","EmployeeAdminSrv","userConfig"],angular.module("actinver.controllers").controller("employeeCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getEmployeeMap=function(a){return t(function(t,r){n({method:"GET",url:e.getEmployeeMap+a,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),r())}).catch(r)})},r.prototype.saveEmployeeMap=function(r){return t(function(t,i){function s(){var a={prevIdEmployee:r.old,idEmployee:r.new,idEmployeeRegister:r.idEmployeeRegister,language:"SPA"};n({method:"POST",url:e.saveEmployeeMap,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.removeEmployeeMap=function(r){return t(function(t,i){function s(){var a={idEmployeeMap:r,language:"SPA"};n({method:"POST",url:e.deleteEmployeMap,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("EmployeeAdminSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){i.selectedTab=1}function a(){i.loadingProducts=!0,n.getClassifications().then(function(e){i.products=e,r(i.products[0].idClassification)},function(){i.errorLoadingProducts=!0}).finally(function(){i.loadingProducts=!1})}function r(e){i.loadingSubProducts=!0,n.getProductsByClassification(e).then(function(e){i.subProducts=e,i.loadingSubProducts=!1},function(){i.subProducts=[]})}var i=this;i.showModalCreateFactsheet=function(){e.admonFactsheet("Agregar nuevo",{}).then(function(e){void 0!==e&&("success"===e?(t.done("El producto se agregó de manera exitosa."),r(i.selectedTab)):t.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"))}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},i.showModalEditFactsheet=function(n){e.admonFactsheet("Editar producto",n).then(function(e){void 0!==e&&("success"===e?(t.done("El producto se modificó de manera exitosa."),r(i.selectedTab)):t.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"))}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},i.showModalRemoveFactsheet=function(e){t.warning("¿Estás seguro de eliminar el producto?").result.then(function(){n.removeClassifications(e).then(function(){t.done("El producto se eliminó de manera exitosa."),r(i.selectedTab)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},i.changeTab=function(e){i.selectedTab=e,r(e)},function(){o(),a()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","FactsheetsSrv"],angular.module("actinver.controllers").controller("factsheetsCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getClassifications=function(){return t(function(t,a){n({method:"GET",url:e.getClassifications,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),a())}).catch(a)})},r.prototype.getProductsByClassification=function(a){return t(function(t,r){n({method:"GET",url:e.getProductsByClassification+a,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),r())}).catch(r)})},r.prototype.doFactsheet=function(o){return t(function(t,r){function i(){var a="",r="",i={name:o.name,language:"SPA"};o.idProduct?(a="edit",r=e.updateFactsheetProduct,i.idProduct=o.idProduct):(a="add",r=e.doFactsheet,i.idClassification=o.clasification.idClassification),n({method:"POST",url:r,params:i}).then(function(e){t(void 0!==e&&1===e.data.status?{success:!0,data:e.data.result?e.data.result:o.idProduct,type:a}:{success:!1,data:null})})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},r.prototype.updateImg=function(n,o){return t(function(t,r){function i(){o.url=e.updateFactsheetImg,o.alias="image",o.formData.push({idProduct:n}),o.formData.push({language:"SPA"}),o.upload(),o.onSuccess=function(e){t({success:!0,data:e})},o.onError=function(e){t({success:!1,data:e})}}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},r.prototype.removeClassifications=function(r){return t(function(t,i){function s(){n({method:"POST",url:e.deleteProduct,data:$.param({idProduct:r,language:"SPA"})}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),i())})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("FactsheetsSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){i.loadingGroups=!0,n.getGroups().then(function(e){i.groups=e}).finally(function(){i.loadingGroups=!1})}var i=this,s=o.user.employeeID;i.editName=function(e){a.open({templateUrl:"/app/advisers/administrator/group/modal/group-modal.html",size:"lg",windowClass:"administrator",controller:"admonGroupModalCtrl",controllerAs:"modal",resolve:{group:function(){return e}}}).result.catch(function(e){throw e})},i.showModalCreateGroup=function(){e.admonGroup("Agregar nuevo",{}).then(function(e){e.employeeID=s,n.saveGroup(e).then(function(){t.done("El grupo se agregó de manera exitosa."),r()}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},i.showModalEditGroup=function(o){e.admonGroup("Editar grupo",o).then(function(e){n.updateNameGroup(e).then(function(){t.done("El grupo se modificó de manera exitosa."),r()})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},i.showModalRemoveGroup=function(e){t.warning("¿Estás seguro de eliminar el grupo?").result.then(function(){n.deleteGroup(e).then(function(){t.done("El grupo se eliminó de manera exitosa."),r()})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},function(){r()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","GroupSrv","userConfig","$uibModal"],angular.module("actinver.controllers").controller("groupCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getGroups=function(){return t(function(t,o){n({method:"GET",url:e.getGroups,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(a(e.data.messages),o())}).catch(o)})},r.prototype.saveGroup=function(r){return t(function(t,i){function s(){var o={name:r.name,idEmployee:r.employeeID,language:"SPA"};n({method:"POST",url:e.saveGroup,data:$.param(o)}).then(function(e){e.data.status&&1===e.data.status?t(e.data.result):(a(e.data.messages),i())}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})}function c(e){i(e)}o.csrfValidate().then(s).catch(c)})},r.prototype.updateNameGroup=function(a){return t(function(t,r){function i(){var o={name:a.name,idTargetGroup:a.idTargetGroup,language:"SPA"};n({method:"POST",url:e.updateNameGroup,data:$.param(o)}).then(function(e){e.data.status&&t(e.data.result)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},r.prototype.deleteGroup=function(r){return t(function(t,i){function s(){var o={idTargetGroup:r,language:"SPA"};n({method:"POST",url:e.deleteGroup,data:$.param(o)}).then(function(e){e.data.status?t(e.data.result):(a(e.data.messages),i())})}function c(e){i(e)}o.csrfValidate().then(s).catch(c)})},r.prototype.service=function(o,r,i){var s={userGroups:"getAllUser/",financialCenters:"getFinancialCenters/",saveCenter:"saveFinancialCenter/",saveUser:"saveUser/",deleteCenter:"deleteFinancialCenter/",deleteUser:"deleteUser/"},c={language:"SPA"};if(i)for(var u in i)c[u]=i[u];return t(function(t,i){n({method:r||"GET",url:e.ServiceGroups+s[o]||"/",params:{language:"SPA"},data:$.param(c)}).then(function(e){e.data.status?t(e.data.result):(a(e.data.messages),i())})})},new r}e.$inject=["URLS","$q","$http","csrfSrv","ErrorMessagesSrv"],angular.module("actinver.services").service("GroupSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){u.loadingFav=!0,a.getClassificationFavAdm().then(function(e){i(e.data)},function(){u.errorLoadingFav=!0,u.loadingFav=!1})}function i(e){a.getFavorites().then(function(t){c(s(t.data,e)),u.loadingFav=!1})}function s(e,t){var n;return e.map(function(e){return n=R.find(function(t){return t.idClassification===e.idClassification},t||[]),e.classification=n||"",e})}function c(e){u.tableParams=new n({count:10},{dataset:e})}var u=this;u.updateSearch=function(){var e=u.name;u.tableParams.filter({$:e})},u.deleteClassification=function(){e.admonFavorites("Eliminar clasificacón").then(function(e){a.deleteClassFav(e).then(function(e){e.success?t.done(e.data):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},u.showModalCreateFavorites=function(){e.admonFavorites("Nuevo favorito").then(function(e){"clasification"===e.idSelected?a.saveClassFav(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)}):"favorite"===e.idSelected&&a.saveFav(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},u.showModalRemoveFavorites=function(e){t.warning("¿Estás seguro de eliminar la emisora?").result.then(function(){a.removeFav(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},u.showModalEditFavorites=function(n){e.admonFavorites("Editar favorito",n).then(function(e){e.idFavorite=n.idIssuer,a.updateFav(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},function(){r()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","NgTableParams","proposalsProposalSrv","FavAdminSrv"],angular.module("actinver.controllers").controller("favoritesCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.saveFav=function(r){return t(function(t,i){function s(){var a={name:r.issuerName,serie:r.serie,idClassification:r.classification.idClassification,language:"SPA"};n({method:"POST",url:e.saveFavorite,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.deleteClassFav=function(r){return t(function(t,i){function s(){var a={idClassification:r.classification.idClassification,language:"SPA"};n({method:"POST",url:e.deleteClassificationFav,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.saveClassFav=function(r){return t(function(t,i){function s(){var a={nameClassification:r.name,language:"SPA"};n({method:"POST",url:e.saveClassificationFav,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.updateFav=function(r){return t(function(t,i){function s(){var a={idFavorite:r.idFavorite,name:r.issuerName,serie:r.serie,idClassification:r.classification.idClassification,language:"SPA"};n({method:"POST",url:e.updateFavorite,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.removeFav=function(r){return t(function(t,i){function s(){var a={idFavorite:r,language:"SPA"};n({method:"POST",url:e.deleteFavorite,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.getFavorites=function(){return t(function(t,o){n({method:"GET",url:e.getFavorites,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"favorites"}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},r.prototype.getClassificationFavAdm=function(){return t(function(t,o){n({method:"GET",url:e.getClassificationFavAdm,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.status?t({success:!0,data:e.data.result,topic:"classificationFav"}):o({success:!1,data:[]})},function(){o({success:!1,data:[]})})})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("FavAdminSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){u.loadingInvest=!0,o.getFundTypes().then(function(e){s(e)},function(){u.errorLoadginInvest=!0,u.loadingInvest=!1})}function i(e,t){var n;return e.map(function(e){return n=R.find(function(t){return t.idFundType===e.idFundType},t||[]),e.clasification=n||"",e})}function s(e){n.getIssuersInfo().then(function(t){c(i(t.data,e)),u.loadingInvest=!1})}function c(e){var t={page:1,count:6};u.configTable=new a(t,{paginationMaxBlocks:4,paginationMinBlocks:2,dataset:e})}var u=this;u.showModalCreateInvestment=function(){e.admonInvestment("Agregar nuevo").then(function(e){o.saveInvestment(e).then(function(n){if(n.success){if("fund"===e.type)return t.done(n.data),void r();t.done(n.data)}else t.error(n.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},u.showModalEditInvestment=function(n){e.admonInvestment("Editar fondo",n).then(function(e){o.updateInvestment(e).then(function(e){e.success?t.done(e.data):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},u.showModalRemoveInvestment=function(e){t.warning("¿Estás seguro de eliminar el fondo ACTIREN?").result.then(function(){o.removeInvestment(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},function(){r()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","proposalsProposalSrv","InvestmentAdminSrv","NgTableParams"],angular.module("actinver.controllers").controller("adminInvestmentCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getFundTypes=function(){return t(function(t,a){n({method:"GET",url:e.getFundTypes,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),a())}).catch(a)})},r.prototype.saveInvestment=function(r){return t(function(t,i){function s(){var a={name:r.name,description:r.description,idFundType:r.clasification.idFundType,language:"SPA"};n({method:"POST",url:e.saveFund,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.updateInvestment=function(r){return t(function(t,i){function s(){var a={name:r.name,description:r.description,idFund:r.idFund,language:"SPA"};n({method:"POST",url:e.updateFund,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.removeInvestment=function(r){return t(function(t,i){function s(){var a={idFund:r,language:"SPA"};n({method:"POST",url:e.deleteFund,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("InvestmentAdminSrv",e)}(),function(){"use strict";function e(e,t){function n(){t.getAnnoucement().then(function(e){a.html=e},function(){a.html="Intentarlo más tarde"})}function o(){a.taOptions=[["bold","italics","ol","ul"]],a.htmlVariable="",a.html=""}var a=this;a.clearEditor=function(){a.htmlVariable=""},a.setTextLegal=function(){t.saveCSV(a.htmlVariable).then(function(t){null!==t&&(a.html=a.htmlVariable,a.htmlVariable="",e.done(t.messages[0].description))})},function(){o(),n()}()}e.$inject=["CommonModalsSrv","LegalSrv"],angular.module("actinver.controllers").controller("legalCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.getAnnoucement=function(){return t(function(t,o){n({method:"GET",url:e.getAnnoucement,params:{language:"SPA"}}).then(function(e){t(e.data)}).catch(o)})},a.prototype.saveCSV=function(a){return t(function(t,r){function i(){var o={announcement:a};n({method:"POST",url:e.updateAnnouncement,data:$.param(o),transformResponse:function(e){return{status:1,messages:[{type:null,criticality:null,code:null,description:"OPERACIÓN EXITOSA"}],result:null}}}).then(function(e){t(e.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},new a}e.$inject=["URLS","$q","$http","csrfSrv"],angular.module("actinver.services").service("LegalSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){i.title="Crea un nuevo mensaje",i.model={},i.endDate=new Date,i.startDate=new Date(i.endDate.getFullYear(),i.endDate.getMonth(),1)}var i=this;i.uploaderOptions=[{formats:["image/png","image/jpeg","image/jpg"],size:2097152},{formats:["application/pdf"],size:10485760}],i.resetFile=!1,i.modal=!1,i.fieldSearch="",i.messages=[],i.messageInfo=function(e){o.notice(e)},i.previewFile=function(e,t){i.model.file=t},i.errorFile=function(e){i.model.file=!1,n.warning(e)},i.cleanFields=function(){i.model={},i.model.file=!1,i.resetFile=!0},i.filter=function(e){return function(t){var n=moment(t.creationDate).format("yyyy-MM-dd HH:mm"),o=moment(t.expirationDate).format("YYYY-MM-DD");return!!t.userCode.toUpperCase().includes(e.toUpperCase())||(!!t.message.toUpperCase().includes(e.toUpperCase())||!(!n.includes(e)&&!o.includes(e)))}},i.done=function(){i.model.file?t.saveMessageImg(e.user.employeeID,i.model,i.model.file).then(function(e){e.success?a.open({templateUrl:"/scripts/modals/views/commons/done.html",size:"sm",windowClass:"commons done",controller:"doneModalCtrl",backdrop:"static",keyboard:!1,controllerAs:"done",resolve:{message:function(){return e.data.messages[0].description}}}).closed.then(function(){i.getDatedMessages(),i.cleanFields()}):(n.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),i.cleanFields())}):(i.model.file={formData:[],disabledMultipart:!1,method:"POST",alias:"file"},t.saveMSG(e.user.employeeID,i.model).then(function(e){a.open({templateUrl:"/scripts/modals/views/commons/done.html",size:"sm",windowClass:"commons done",controller:"doneModalCtrl",backdrop:"static",keyboard:!1,controllerAs:"done",resolve:{message:function(){return e.msg}}}).closed.then(function(){i.getDatedMessages(),i.cleanFields()})}).catch(function(){n.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")}))},i.getDatedMessages=function(){i.fieldSearch="",i.modal=!0,t.getDatedMessages(i.startDate,i.endDate).then(function(e){i.messages=e,i.modal=!1}).catch(function(){i.modal=!1})},function(){r(),i.getDatedMessages()}()}e.$inject=["userConfig","MessagesSrv","CommonModalsSrv","modalActivity","$uibModal"],angular.module("actinver.controllers").controller("messagesCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){}return i.prototype.getMessages=function(){return t(function(t,a){n({method:"GET",url:e.getMessages,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),t())}).catch(a)})},i.prototype.getDatedMessages=function(a,i){var s=r("date")(a,"yyyyMMdd"),c=r("date")(i,"yyyyMMdd");return a._d&&(s=moment(a._d).format("YYYYMMDD")),i._d&&(c=moment(i._d).format("YYYYMMDD")),t(function(t,a){n({method:"GET",url:e.getAllMessagesByRange+s+"/"+c,params:{language:"SPA"}}).then(function(e){1===e.data.status?t(e.data.result):(o(e.data.messages),t([]))}).catch(a)})},i.prototype.getMessageDetail=function(a,r){return t(function(t,i){n({method:"POST",url:e.getMessageDetail,params:{language:"SPA"},data:$.param({idEmployee:a,idMessage:r})}).then(function(e){1===e.data.status?t(e.data.result[0]):(o(e.data.messages),i())}).catch(i)})},i.prototype.saveMessageImg=function(n,o,r){return t(function(t,i){function s(){r.url=e.messageRegistration,r.alias="file",r.formData.push({idEmployee:n}),r.formData.push({message:o.message}),r.formData.push({descriptionMessage:o.descriptionMessage}),r.formData.push({expirationDate:moment(o.expirationDate).format("DDMMYYYY")}),void 0!==o.destinations&&r.formData.push({destinations:o.destinations}),r.formData.push({language:"SPA"}),r.upload(),r.onSuccess=function(e){t({success:!0,data:e})},r.onError=function(){t({success:!1,data:null})}}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},i.prototype.saveMSG=function(o,a){var r=new FormData;return r.append("idEmployee",o),r.append("file",void 0),r.append("message",a.message),r.append("descriptionMessage",a.descriptionMessage),r.append("expirationDate",moment(a.expirationDate).format("DDMMYYYY")),r.append("language","SPA"),void 0!==a.destinations&&r.append("destinations",a.destinations),t(function(t,o){n({method:"POST",url:e.messageRegistration,data:r,headers:{"Content-Type":void 0,ocupateMyHeader:!0}}).then(function(e){t({success:!0,msg:e.data.messages[0].description})}).catch(function(){o({success:!1})})})},new i}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv","$filter"],angular.module("actinver.services").service("MessagesSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){s.selectedTab=1,s.groupSelectedTab=0}function a(){s.loadingProducts=!0,n.getTypes().then(function(e){s.products=e,r(s.products[0].idPresentationType)},function(){s.errorLoadingProducts=!0}).finally(function(){s.loadingProducts=!1})}function r(e){s.loadingSubProducts=!0,n.getPresentationsByType(e).then(function(e){s.subProducts=[],angular.forEach(e,function(e){s.subProducts.push(e)}),s.loadingSubProducts=!1})}function i(e){n.getPresentationSubTypesByClassification(e).then(function(e){s.ClasificationProducts=e.map(function(e){return e.text=e.description,e})})}var s=this;s.showModalCreateFactsheet=function(){e.admonPresentations("Agregar nueva presentación",{}).then(function(e){void 0!==e.msg&&("success"===e.msg?(t.done("La "+e.type+" se agregó de manera exitosa."),r(s.selectedTab),i(s.selectedTab)):t.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")),a()}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},s.showModalEditFactsheet=function(n){n.idPresentationType=s.selectedTab,e.admonPresentations("Editar presentación",n).then(function(e){void 0!==e.msg&&("success"===e.msg?(t.done("La "+e.type+" se modificó de manera exitosa."),r(s.selectedTab),i(s.selectedTab)):t.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"))}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},s.showModalRemoveFactsheet=function(e){t.warning("¿Estás seguro de eliminar la presentación?").result.then(function(){n.deletePresentation(e).then(function(){t.done("La presentación se eliminó de manera exitosa."),r(s.selectedTab),i(s.selectedTab)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},s.changeTab=function(e){s.selectedTab=e,r(e),i(e)},s.nextTab=function(){s.groupSelectedTab++},s.beforeTab=function(){
s.groupSelectedTab--},function(){o(),a()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","PresentationsAdminSrv"],angular.module("actinver.controllers").controller("presentationsAdminCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getTypes=function(){return t(function(t,a){n({method:"GET",url:e.getTypes,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),a())}).catch(a)})},r.prototype.getPresentationSubTypes=function(){return t(function(t,a){n({method:"GET",url:e.getPresentationSubTypes,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),a())}).catch(a)})},r.prototype.getPresentationSubTypesByClassification=function(a){return t(function(t,r){n({method:"GET",url:e.getPresentationSubTypesByClassification+a,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),r())})})},r.prototype.getPresentationsByType=function(a){return t(function(t,r){n({method:"GET",url:e.getPresentationsByType+a,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),r())})})},r.prototype.savePresentation=function(o){return t(function(t,r){function i(){var a="",r="",i={name:o.name,language:"SPA"};o.clasification?(r="add",a=e.savePresentation,i.idPresentationType=o.clasification.idPresentationType,i.idPresentationSubType=o.subClasification.idPresentationSubType):(r="edit",a=e.updateNamePresentation,i.idPresentation=o.idPresentation),n({method:"POST",url:a,data:$.param(i)}).then(function(e){t(void 0!==e&&1===e.data.status?{success:!0,data:e.data.result?e.data.result:o.idPresentation,params:i,type:r}:{success:!1,data:null})})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},r.prototype.saveClasification=function(o){return t(function(t,r){function i(){var a={classification:o.name,language:"SPA"};n({method:"POST",url:e.saveClasification,data:$.param(a)}).then(function(e){t(void 0!==e&&1===e.data.status?{success:!0,data:!0}:{success:!1,data:null})})}function s(e){r(e)}a.csrfValidate().then(i).catch(s)})},r.prototype.saveSubClasification=function(o,r){return t(function(t,i){function s(){var a={idPresentationType:r,description:o.name,language:"SPA"};n({method:"POST",url:e.saveSubClasification,data:$.param(a)}).then(function(e){t(void 0!==e&&1===e.data.status?{success:!0,data:!0}:{success:!1,data:null})})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.updateFile=function(n,o,r,i){return t(function(t,s){function c(){r.url=e.updatePresentationImg,r.alias="file",r.formData.push({idPresentation:n}),o&&r.formData.push({idPresentationSubType:o}),r.formData.push({language:"SPA"}),r.formData.push({idPresentationType:i}),r.upload(),r.onSuccess=function(e){t({success:!0,data:e})},r.onError=function(){t({success:!1,data:null})}}function u(e){s(e)}a.csrfValidate().then(c).catch(u)})},r.prototype.updateNamePresentation=function(r){return t(function(t,i){function s(){var a={idPresentation:r.idPresentation,file:"",idPresentationSubType:r.idPresentationSubType,language:"SPA"};n({method:"POST",url:e.updateNamePresentation,data:$.param(a)}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),i())})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.deletePresentation=function(r){return t(function(t,i){function s(){var a={idPresentation:r,language:"SPA"};n({method:"POST",url:e.deletePresentation,data:$.param(a)}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),i())})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("PresentationsAdminSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){a.table.headers=[],a.table.body=[],a.loadingEE=!0,e.getLocalForecasts().then(function(e){a.table.headers.push({name:"México",originalName:"indicador"}),e&&e.length>0&&e.forEach(function(e,t){for(var n in e){var o;0==t&&5===n.toString().length&&(o=n.toString().replace("a",""),a.table.headers.push({name:o,originalName:n}))}}),a.table.body=e}).finally(function(){a.loadingEE=!1})}var a=this;a.table={headers:[],body:[]},a.saveCSV=function(){e.saveCSV(a.csv).then(function(){n.done("El CSV se a guardado de manera exitosa."),a.csv="",o()})},function(){o()}()}e.$inject=["MexicoSrv","NgTableParams","CommonModalsSrv"],angular.module("actinver.controllers").controller("mexicoCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}function r(e){for(var t=e.split("\n"),n=[],o=t[0].split(","),a=1;a<t.length;a++){for(var r={},i=t[a].split(","),s=0;s<o.length;s++)r[o[s]]=i[s];n.push(r)}return JSON.stringify(n)}function i(e){var t=[],n={};return $.each(JSON.parse(e),function(e,o){n={},$.each(o,function(e,t){"indicador"!==e?n["a"+e]=t.replace(/,/g,"."):n[e]=t}),t[e]=n}),JSON.stringify(t)}return a.prototype.getLocalForecasts=function(){return t(function(t,o){n({method:"GET",url:e.getLocalForecasts,params:{language:"SPA"}}).then(function(e){t(e.data)}).catch(o)})},a.prototype.saveCSV=function(a){var s=a;s=s.replace(/([^\t]+)/i,"indicador"),s=s.replace(/\t/g,",");var c=r(s);return a=i(c),t(function(t,r){function i(){var o={localForecasts:a};n({method:"POST",url:e.updateLocalForecasts,data:$.param(o),transformResponse:function(e){return{status:1,messages:[{type:null,criticality:null,code:null,description:"OPERACIÓN EXITOSA"}],result:null}}}).then(function(e){t(e.data)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},new a}e.$inject=["URLS","$q","$http","csrfSrv"],angular.module("actinver.services").service("MexicoSrv",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){d.loadingRoles=!0,n.getRoles().then(function(e){d.listTabs=e,s(e)})}function i(e,t){var n,o=[];return t.map(function(e){o[e.description]=[]}),e.map(function(e){(n=R.find(function(t){return t.description===e.roleDescription},t||[]))&&o[n.description].push(e)}),o}function s(e){n.getUserRoles(1).then(function(t){l=i(t,e),c(""!==d.selectedTabPresent?d.selectedTabPresent:e[0].description),d.loadingRoles=!1})}function c(e){var t=l[e],n={page:1,count:5};d.listLength=t.length,d.configTable=new o(n,{paginationMaxBlocks:4,paginationMinBlocks:2,dataset:t})}function u(){d.selectedTab=4,d.groupSelectedTab=0,d.selectedTabPresent=""}var l,d=this,m=a.user.employeeID;d.changeTab=function(e){d.selectedTabPresent=e.description,d.selectedTab=e.idRole,c(e.description)},d.showModalCreateProfiles=function(){e.admonProfiles("Nuevo perfil",{}).then(function(e){e.employeeID=m,n.saveProfile(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},d.showModalRemoveProfiles=function(e){t.warning("¿Estás seguro de eliminar el perfil?").result.then(function(){n.removeProfile(e).then(function(e){e.success?(t.done(e.data),r()):t.error(e.data)})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},d.nextTab=function(){d.groupSelectedTab++},d.beforeTab=function(){d.groupSelectedTab--},function(){u(),r()}()}e.$inject=["administratorModalsSrv","CommonModalsSrv","ProfilesSrv","NgTableParams","userConfig"],angular.module("actinver.controllers").controller("profilesCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){}return r.prototype.getRoles=function(){return t(function(t,a){n({method:"GET",url:e.getRoles,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),a())})})},r.prototype.getUserRoles=function(a){return t(function(t,r){n({method:"GET",url:e.getUserRoles+a,params:{language:"SPA"}}).then(function(e){e.data.status?t(e.data.result):(o(e.data.messages),r())})})},r.prototype.saveProfile=function(r){return t(function(t,i){function s(){var a={userCodeRegister:r.userCodeRegister,idRole:r.idRole,idEmployeeRegister:r.employeeID,language:"SPA"};n({method:"POST",url:e.saveUserRole,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},r.prototype.removeProfile=function(r){return t(function(t,i){function s(){var a={idUserRole:r,language:"SPA"};n({method:"POST",url:e.deleteUserRole,data:$.param(a)}).then(function(e){1===e.data.status?t({success:!0,data:e.data.messages[0].description}):2===e.data.status&&t({success:!1,data:e.data.messages[0].description})}).catch(function(){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function c(e){i(e)}a.csrfValidate().then(s).catch(c)})},new r}e.$inject=["URLS","$q","$http","ErrorMessagesSrv","csrfSrv"],angular.module("actinver.services").service("ProfilesSrv",e)}(),function(){"use strict";function e(e,t,n,o){function a(){r.dataOperativeBinnacle=[]}var r=this;r.datepicker_opts={isInvalidDate:function(e){return 0===e.day()||6===e.day()},maxDate:moment().format("DD/MM/YY")},r.changeDate=function(t){r.date=t;var a=moment(t.startDate._d).format("YYYYMMDD"),i=moment(t.endDate._d).format("YYYYMMDD");n.getOperativeBank(a,i,e.binnacle.sadviser.employeeID).then(function(e){r.dataOperativeBinnacle=e,r.setData(r.dataOperativeBinnacle)},function(){o.error("Lo sentimos ocurrio un error.")})},r.downloadPDF=function(){var e="<div align='center'> <table border='1'>";e+="<tr bgcolor='#3920A9'>",e+="<th>REGION</th>",e+="<th>C.FINANCIERO</th>",e+="<th>CONTRATO</th>",e+="<th>CLIENTE</th>",e+="<th>OPERACION</th>",e+="<th>ASESOR</th>",e+="<th>F.OPERACIÓN</th>",e+="<th>IMPORTE</th>",e+="</tr>",angular.forEach(r.dataOperativeBinnacle,function(n){e+="<tr>",e+="<td>",e+=n.region,e+="</td>",e+="<td>",e+=n.centroFinanciero,e+="</td>",e+="<td>",e+=n.contrato,e+="</td>",e+="<td>",e+=n.nombreCliente,e+="</td>",e+="<td>",e+=n.tipoOperacion,e+="</td>",e+="<td>",e+=n.nombreAsesor,e+="</td>",e+="<td>",e+=moment(n.fechaOperacion).format("YYYY-MM-DD"),e+="</td>",e+="<td>",e+=t("currency")(n.importe,"$",2),e+="</td>",e+="</tr>"}),e+="</table></div>";var n=window.open("IMPRESIÓN","_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0");n.document.open(),n.document.write('<html><head><link rel="stylesheet" type="text/css" href="style.css" /></head><body onload="window.print()">'+e+"</body></html>"),n.document.close()},function(){a()}()}e.$inject=["$scope","$filter","binnacleSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("binnacleBankCtrl",e)}(),function(){"use strict";function e(e,t,n,o){var a=this;a.type=n.current.name,a.sadviser=o.user,a.currentState=function(){n.$current.includes["binnacle.commercial"]&&(a.type="binnacle.commercial"),(n.is("binnacle")||n.is("binnacle.commercial"))&&n.go("binnacle.commercial.strategy"),n.is("binnacle.operative")&&n.go("binnacle.operative.bank")},a.getType=function(e){n.go("binnacle."+e)},e.$on("$stateChangeSuccess",function(){a.currentState()})}e.$inject=["$rootScope","$scope","$state","userConfig"],angular.module("actinver.controllers").controller("binnacleCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){var i=this;i.soon=!1,i.expired=!1,i.all=!1,i.showOutlineInfo=function(n){i[n]=!1,t.getClientsInfo(e.binnacle.sadviser.employeeID,n).then(function(e){i[n]=e.data},function(){i[n]=[]})},i.getInfo=function(){o.getBinnacleClients(e.binnacle.sadviser.employeeID).then(function(e){var t=[];e.data&&e.data.length>0?(angular.forEach(e.data,function(e){angular.forEach(e.contractsList,function(e){t.push({numSolContrato:e.numContrato,tipoOrigenTO:{nombre:"CB"===e.origen.trim()?"CASA DE BOLSA":e.origen.trim(),id:"CB"===e.origen.trim()?2:1},sfechaActualizacion:"",tipoServicioTO:{value:{idTipoServicio:1}},cliente:{value:{nombre:e.nombreCliente,tipoPersonaTO:{id:null}}},perfil:{value:{nombre:""}}})})}),i.all=t):i.all=[]},function(){i.all=[]})},i.outlineClient=function(e,t,o,i,s,c){if("all"===c){var u={contractNumber:t,bankingArea:2===o?998:999};a.getContractInfoDetail(u).then(function(a){n.outlineClient(e,t,o,i,a.holder.personType.personTypeID,c,a.investmentProfile)}).catch(function(e){r.error(e.messages[0].responseMessage)})}else n.outlineClient(e,t,o,i,s,c)}}e.$inject=["$scope","binnacleOutlineSrv","binnacleModalSrv","binnacleStrategySrv","accountSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("binnacleOutlineCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(e,n,a){if("profile"===e)c.show_info=a,s.idCliente=a;else if("advisers"===e){t.adviser={id:o.id};var i=r.adviserList;0!==parseInt(o.estado)&&(s.estado=parseInt(o.estado)),i?("2"===o.action?(r.adviserList[s.estado]={id:o.id,name:o.employee},s.idCliente=o.id,s.name=o.employee):"1"===o.action&&(r.adviserList[s.estado]=r.adviserList[s.estado],s.idCliente=r.adviserList[s.estado].id,s.name=r.adviserList[s.estado].name),c.show_info=s.idCliente):(r.adviserList=[],c.show_info=a,s.idCliente=a)}c.type=e,c.filter=n,s.selected_type=!0,s.getInfo(c)}var s=this,c={adviser:t.binnacle.sadviser};s.estado=0,s.action=0,s.employee,s.idCliente,s.typeSelect,s.adviser,s.name,s.adviserList=[],s.nombreAsesor="",s.changeAdviser=function(e){s.idEmpleado=e.employeeID,s.nombreAsesor=e.name,s.filters={},s.filters.advisers="profile",s.getType("profile")},s.getType=function(e){s.typeSelect=e,"profile"===e?i(e,["single"],s.idEmpleado):"advisers"===e&&i(e,["advisers"],s.idEmpleado)},s.getInfo=function(e){s.finish=!1,s.reports_info=!1,s.adviser=e,a.getInfo(e).then(function(e){s.reports_info={chart:e.data},s.advisers_range=!1,s.advisers=!1,s.finish=!0},function(){s.finish=!0})},s.showAdvisersInfo=function(e,t,n){s.advisers_range=e,s.advisers=!1;var o=null;o=parseInt(t)<10?"0"+t+"/"+n:t+"/"+n,a.getAdvisersInfo(s.idCliente,o).then(function(e){s.advisers=e.data},function(){s.advisers=[]})},s.showAdviserResume=function(){i("advisers",["advisers"],o.id)},function(){s.nombreAsesor=t.binnacle.sadviser.name,s.idEmpleado=t.binnacle.sadviser.employeeID,s.filters={},s.filters.advisers="profile",s.getType("profile")}()}e.$inject=["Auth","$scope","$state","$stateParams","binnacleReportsSrv","$rootScope"],angular.module("actinver.controllers").controller("binnacleReportsCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){r.dataOperativeBinnacle=[]}var r=this;r.datepicker_opts={isInvalidDate:function(e){return 0===e.day()||6===e.day()},maxDate:moment().format("DD/MM/YY")},r.changeDate=function(t){r.date=t;var a=moment(t.startDate._d).format("YYYYMMDD"),i=moment(t.endDate._d).format("YYYYMMDD");n.getOperativeStockExchange(a,i,e.binnacle.sadviser.employeeID).then(function(e){r.dataOperativeBinnacle=e,r.setData(r.dataOperativeBinnacle)},function(){o.error("Lo sentimos ocurrio un error.")})},r.downloadPDF=function(){var e="<div align='center'> <table border='1'>";e+="<tr bgcolor='#3920A9'>",e+="<th>ASESOR</th>",e+="<th>CAPTURADO</th>",e+="<th>C.FINANCIERO</th>",e+="<th>CLIENTE</th>",e+="<th>EMISORA</th>",e+="<th>EXTENSIÓN</th>",e+="<th>CONTRATO</th>",e+="<th>F.OPERACIÓN</th>",e+="<th>MOVIMIENTO</th>",e+="<th>SERIE</th>",e+="<th>SOLICITUD</th>",e+="<th>IMPORTE</th>",e+="<th>TITULOS</th>",e+="</tr>",angular.forEach(r.dataOperativeBinnacle,function(n){e+="<tr>",e+="<td>",e+=n.asesor,e+="</td>",e+="<td>",e+=n.capturado,e+="</td>",e+="<td>",e+=n.centroFinanciero,e+="</td>",e+="<td>",e+=n.cliente,e+="</td>",e+="<td>",e+=n.emisora,e+="</td>",e+="<td>",e+=n.extension,e+="</td>",e+="<td>",e+=n.contrato,e+="</td>",e+="<td>",e+=moment(n.fechaOperacion).format("YYYY-MM-DD"),e+="</td>",e+="<td>",e+=n.movimiento,e+="</td>",e+="<td>",e+=n.serie,e+="</td>",e+="<td>",e+=n.solicitud,e+="</td>",e+="<td>",e+=t("currency")(n.importe,"$",2),e+="</td>",e+="<td>",e+=n.titulos,e+="</td>",e+="</tr>"}),e+="</table></div>";var n=window.open("IMPRESIÓN","_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0");n.document.open(),n.document.write('<html><head><link rel="stylesheet" type="text/css" href="style.css" /></head><body onload="window.print()">'+e+"</body></html>"),n.document.close()},function(){a()}()}e.$inject=["$scope","$filter","binnacleSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("binnacleStockExchangeCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l){function d(){h(),f(),g(moment().format("M"),moment().format("YYYY"))}function m(e){var t={page:1,count:e.length,filter:{}};S.filterTable.nombreCliente&&(t.filter.nombreCliente=S.filterTable.nombreCliente),S.filterTable.idSponsor&&(t.filter.idSponsor=S.filterTable.idSponsor),S.filterTable.numContrato&&(t.filter.numContrato=S.filterTable.numContrato),S.filterTable.typeOrigin&&(t.filter.typeOrigin=S.filterTable.typeOrigin),S.filterTable.clasification&&(t.filter.clasification=S.filterTable.clasification),S.filterTable.contactNameStatus&&(t.filter.contactNameStatus=S.filterTable.contactNameStatus),S.configTable=new l(t,{dataset:e,filterOptions:{filterFn:function(e,t){var n=e;return S.filterTable=t,t.nombreCliente&&(n=n.filter(function(e){return e.nombreCliente.search(new RegExp(t.nombreCliente,"i"))>-1})),t.idSponsor&&(n=n.filter(function(e){return e.idSponsor.toString().search(new RegExp(t.idSponsor,"i"))>-1})),t.numContrato&&(n=n.filter(function(e){return e.numContrato.toString().search(new RegExp(t.numContrato,"i"))>-1})),t.typeOrigin&&(n=n.filter(function(e){return e.typeOrigin.search(new RegExp(t.typeOrigin,"i"))>-1})),t.contactNameStatus&&(n=n.filter(function(e){return e.contactNameStatus.search(new RegExp(t.contactNameStatus,"i"))>-1})),t.clasification&&(n=n.filter(function(e){return e.clasification.toLowerCase()===t.clasification.toLowerCase()})),n}}}),S.filter={nombreCliente:{nombreCliente:{id:"text",placeholder:"Buscar"}},idSponsor:{idSponsor:{id:"text",placeholder:"Buscar"}},numContrato:{numContrato:{id:"text",placeholder:"Buscar"}},typeOrigin:{typeOrigin:{id:"select",placeholder:"Buscar"}},clasification:{clasification:{id:"select",placeholder:"Buscar"}},contactNameStatus:{contactNameStatus:{id:"select",placeholder:"Buscar"}}}}function p(e){return R.find(function(t){return angular.equals(t.options,e)},S.binnacleCatalogChild)}function f(){i.getBinnacleCatalog().then(function(e){S.binnacleCatalog=e.data},function(){c.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")})}function g(n,o){i.getCommentsDetailsByContract(e.binnacle.sadviser.employeeID,t.params.sponsor,t.params.id,n,o).then(function(e){S.CommentsByContract=e&&e.commentSection.length>0?e:[]},function(){S.CommentsByContract=[]})}function h(){S.binnacleCatalogChild=[],S.selectedOptions={},S.lastSelectedOpt=null,S.catalogOption=null,S.catalogComments=null}function v(){for(var e=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],t=new Date,n=t.getMonth()+1,o=t.getFullYear(),a=[],r=0;r<24;r++)0===n&&(o-=1,n=12),n-=1,a.push({year:o,month:n+1,monthDesc:e[n],select:n===t.getMonth()&&o===t.getFullYear()});S.listMonths=a}function y(){var e=b();S.menu.showButtonLeft=!(S.menu.position<=0),S.menu.showButtonRight=!(S.menu.position>=e.restantes)}function b(){var e={divMenu:document.getElementById("contentPrin").getBoundingClientRect().width+2,ulMenu:document.getElementById("contentMonth").getBoundingClientRect().width};return e.ulMenu>e.divMenu?e.restantes=e.ulMenu-e.divMenu:e.restantes=0,e}function C(e){angular.forEach(S.listMonths,function(e){e.select=!1}),e.select=!0}var S=this;S.listDateBirthday={},S.listDatesSelected=[],S.birthday_filter="today",S.hasBirthday=!1,S.filterTable={};var D;S.menu={showSlide:!1,position:0,showButtonLeft:!1,showButtonRight:!1},S.clients=[],S.listClasification=[{title:"A",id:"A"},{title:"AA",id:"AA"},{title:"AAA",id:"AAA"},{title:"B",id:"B"},{title:"C",id:"C"},{title:"R",id:"R"}],S.listTipos=[{title:"Banco",id:"Banco"},{title:"Casa de Bolsa",id:"Casa de Bolsa"}],S.listEstatus=[{title:"Pendiente",id:"Pendiente"},{title:"Contactado",id:"Contactado"}],S.clients_search={finish:!1,sent:!1},e.myInterval=5e3,e.active=0,S.saveStateView=function(e){u.saveState(S.filterTable),t.go("binnacle.commercial.strategy.id",{id:e.numContrato,sponsor:e.idSponsor,clasificacion:e.clasification}),v()},S.comeBack=function(){t.go("binnacle.commercial.strategy"),S.goToLastState()},S.goToLastState=function(){var e=u.infoStrategyCommercial;S.filterTable=null===e||void 0===e?{}:e,S.submitSearch()},S.submitSearch=function(){S.clients_search={finish:!1,sent:!0},i.getBinnacleClients(e.binnacle.sadviser.employeeID).then(function(e){var t=[];e.data&&e.data.length>0?angular.forEach(e.data,function(e){angular.forEach(e.contractsList,function(n){n.idSponsor=e.idSponsor,n.typeOrigin="CB"===n.origen.trim()?"CASA DE BOLSA":n.origen.trim(),n.contactNameStatus=n.contactStatus?" CONTACTADO":" PENDIENTE",t.push(n)})}):S.clients=[],S.clients=t,m(t),S.clients_search.finish=!0},function(){S.clients=[],S.clients_search.finish=!0,m(S.clients)})},S.empty_birthdays=!0,S.getBirthdays=function(t){S.status.open&&0===S.listDatesSelected.length&&(S.dates={finish:!1},s.getInfo(e.binnacle.sadviser.employeeID).then(function(e){S.listDateBirthday=e.data,S.getBirthdayFilter(t),S.dates=e},function(e){S.dates=e}))},S.getBirthdayFilter=function(e){var t=0,n=0;switch(S.birthday_filter=e,S.listDatesSelected=[],e){case"today":for(S.hasBirthday=S.listDateBirthday.flag.hasBirhtdayToday,t=0;t<S.listDateBirthday.lista.today.length;t++)for(n=0;n<S.listDateBirthday.lista.today[t].records.length;n++)S.listDatesSelected.push(S.listDateBirthday.lista.today[t].records[n]);break;case"prev":for(S.hasBirthday=S.listDateBirthday.flag.hasBirthdayLastweek,t=0;t<S.listDateBirthday.lista.lastWeek.length;t++)for(n=0;n<S.listDateBirthday.lista.lastWeek[t].records.length;n++)S.listDatesSelected.push(S.listDateBirthday.lista.lastWeek[t].records[n]);break;case"next":for(S.hasBirthday=S.listDateBirthday.flag.hasBirthdayNextweek,t=0;t<S.listDateBirthday.lista.nextWeek.length;t++)for(n=0;n<S.listDateBirthday.lista.nextWeek[t].records.length;n++)S.listDatesSelected.push(S.listDateBirthday.lista.nextWeek[t].records[n]);break;default:S.hasBirthday=!1}},S.showClientInfo=function(e){var t="",n="";a.getClientDetail(e.contract,e.origen.trim()).then(function(o){if(2===o.outCommonHeader.result.result)return n=o.outCommonHeader.result.messages,angular.forEach(n,function(e){e.responseMessage&&(t+=e.responseMessage+"<br>")}),void c.error(t);o.outClientOrContractClientInfoQuery&&o.outClientOrContractClientInfoQuery.client&&0!=o.outClientOrContractClientInfoQuery.client.length&&0!=o.outClientOrContractClientInfoQuery.client[0].email.length?(e.email=o.outClientOrContractClientInfoQuery.client[0].email[0].email,e.phoneNumber=0!=o.outClientOrContractClientInfoQuery.client[0].telephoneData.length?Number(o.outClientOrContractClientInfoQuery.client[0].telephoneData[0].phoneNumber):"",r.showClientInfo(e)):c.error("No se encontró información del cliente.")},function(e){c.error(e.msg)}).finally(function(){})},S.getClientDetails=function(e,n,a){return S.client_data=!1,o.all([i.getClientDetails(e,n,a),i.getClientType(e,a),i.getClientProfile(a)]).then(function(e){S.client_data={},angular.forEach(e,function(e){S.client_data[e.type]=e.data}),S.client_data.clasificacion=t.params.clasificacion,d()},function(){S.client_data=null,c.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")})},S.addChild=function(e,t,n){S.lastSelectedOpt=e.idActivity,t&&(S.catalogOption=S.lastSelectedOpt,S.binnacleCatalogChild=[],S.selectedOptions={}),i.getBinnacleCatalogChild(S.lastSelectedOpt).then(function(e){var t,o=e.data,a=S.binnacleCatalogChild.length;a>0&&(t=p(e.data)),t||(void 0!==S.binnacleCatalogChild[n+1]&&(S.binnacleCatalogChild.length=n+1),o.length>0&&S.binnacleCatalogChild.push({model:"level_"+a,options:o,text:o[0].descriptionCode}))},function(){c.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")})},S.sent_binnacle=!1,S.saveCatalog=function(n){if(S.lastSelectedOpt&&n.$valid){var o={idContract:t.params.id,name:S.client_data.details.nombreCliente,idEmployee:e.binnacle.sadviser.employeeID,sponsorNumber:t.params.sponsor,idActivity:S.lastSelectedOpt,description:S.catalogComments,especification:"",clasification:t.params.clasificacion,language:"SPA"};i.doBinnacleComment(o).then(function(){S.submitSearch(),c.done("El mensaje se ha enviado exitosamente.")},function(e){c.error(e.msg)}).finally(function(){S.sent_binnacle=!1,d()})}else c.error("Para guardar cambios es necesario llenar los campos requeridos")},S.getComment=function(e){C(e),g(e.month,e.year)},S.mouseOver=function(e){1===e?S.slideMenuLeft():S.slideMenuRight()},S.mouseLeave=function(){D&&null!==D&&n.cancel(D)},S.slideMenuLeft=function(){S.menu.position=S.menu.position<=0?0:S.menu.position-30,y(),document.getElementById("contentMonth").style.right=S.menu.position+"px",S.menu.position<=0?n.cancel(D):D=n(S.slideMenuLeft,150)},S.slideMenuRight=function(){var e=b();S.menu.position=S.menu.position>e.restantes?e.restantes:S.menu.position+30,y(),document.getElementById("contentMonth").style.right=S.menu.position+"px",S.menu.position>e.restantes?n.cancel(D):D=n(S.slideMenuRight,150)},S.resize=function(){S.menu.position=0,document.querySelector("#contentMonth").style.right="0px",y(),e.$apply()},function(){S.submitSearch(),v()}()}e.$inject=["$scope","$state","$timeout","$q","CalendarSrv","binnacleModalSrv","binnacleStrategySrv","binnacleBirthdaysSrv","CommonModalsSrv","binnacleStrategyCommercialFtr","NgTableParams"],angular.module("actinver.controllers").controller("binnacleStrategyCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){this.close=function(){t.dismiss(),console.log("cerrar")}}e.$inject=["$scope","$uibModalInstance","$sessionStorage","$rootScope","accountStateSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("accountStateHelpCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){t.dismiss()}var s=this,c=JSON.parse(n.user);s.sendType=function(e){var t=c.roles.includes("RRHH");t?a.getAccountStateRh(o.month,o.year,o.employeeId,e.user,e.password,t).then(function(e){i(),1!==e.data.outCommonHeader.result.result?r.error(e.data.outCommonHeader.result.messages[0].responseMessage):(o.detailAccountState=e.data,o.detail=!0)}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e}):a.getAccountState(o.month,o.year,o.employeeId,e.user,e.password,t).then(function(e){i(),1!==e.data.outCommonHeader.result.result?r.error(e.data.outCommonHeader.result.messages[0].responseMessage):(o.detailAccountState=e.data,o.detail=!0)}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},s.close=function(){t.dismiss(),console.log("cerrar")}}e.$inject=["$scope","$uibModalInstance","$sessionStorage","$rootScope","accountStateSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("accountStateLoginCtrl",e)}(),function(){"use strict";function e(e){this.getInfoIntegration=function(){}}e.$inject=["$scope"],angular.module("actinver.controllers").controller("accountStateCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(o){a.search_form_sent=!0,a.report_empty=!0,t.getGroupsByEmployeeRpt(e.goals.sadviser.employeeID,o).then(function(e){t.getInfoByGroupRpt(e.data[0].idTargetGroup,o).then(function(e){e.data.elements.length>0?(a.info=e.data,a.report_empty=!1,a.filtered_report_empty=!1):a.report_empty=!0},function(){n.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")}).finally(function(){a.search_form_sent=!1})},function(){n.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk"),a.search_form_sent=!1})}var a=this;e.goals.datepicker_opts.initDate=moment().businessSubtract(1),e.$on("changeDate",function(e,t){o(t)})}e.$inject=["$scope","goalsCustomSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("customCtrl",e)}(),function(){"use strict";function e(e){var t=this,n=moment().businessSubtract(1);!function(){t.sadviser=e.user,t.datepicker_opts={parentEl:".goals-page",singleDatePicker:!0,initDate:new Date(n),isInvalidDate:function(e){return 0===e.day()||6===e.day()},maxDate:n.format("DD/MM/YY")}}()}e.$inject=["userConfig"],angular.module("actinver.controllers").controller("goalsCtrl",e)}(),function(){"use strict";function e(e,t,n){var o=this;e.goals.datepicker_opts.initDate=new Date;var a=document.getElementById("frame");o.getReportInfo=function(r){var i=moment(r).format("DDMMYYYY"),s=e.goals.sadviser.employeeID,c="xxx/xxx/"+s+"/"+i+"/pdf";o.search_form_sent=!1,n({method:"GET",url:t.getSharedReport+c,params:{language:"SPA"},responseType:"arraybuffer"}).then(function(e){var t=new Blob([e.data],{type:"application/pdf"}),n=URL.createObjectURL(t);a.src=n}).catch(function(e){console.error(e)}).finally(function(){o.search_form_sent=!1})}}e.$inject=["$scope","URLS","$http"],angular.module("actinver.controllers").controller("managerCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(n){return i.search_form_sent=!0,i.report_info=!1,t.all([o.getGoalsPositionsRpt(e.goals.sadviser.employeeID,n),o.getSumGoalsPositionsRpt(e.goals.sadviser.employeeID,n),o.getGoalsContractsRpt(e.goals.sadviser.employeeID,n)]).then(function(e){i.report_info={},i.report_empty=!0,angular.forEach(e,function(e){i.report_empty&&0!==e.data.length&&(i.report_empty=!1),i.report_info[e.topic]=e.data})},function(){a.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")}).finally(function(){i.search_form_sent=!1})}var i=this;e.goals.datepicker_opts.initDate=moment().businessSubtract(1),i.updateReport=function(e){r(moment(e).format("DD/MM/YY"))},function(){i.updateReport(e.goals.datepicker_opts.initDate)}()}e.$inject=["$scope","$q","userConfig","goalsReportsSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("reportCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){var c=this;c.modal=!1,c.listRegister=[],c.getLista=function(){c.modal=!0,i.getListaLargeAndShort().then(function(e){e.success?c.listRegister=e.lista:(c.listRegister=[],s(e.message)),c.modal=!1}).catch(function(e){c.modal=!1,s(e.message)})},c.exportData=function(){var e=a.tableToExcel("#idTablaResultados","Reporte Cortos y Largos"),t=document.createElement("a");t.download=r.getNameFile()+".xls",t.href=e,t.click()},function(){c.getLista()}()}e.$inject=["$scope","URLS","$http","$timeout","exportTableToExcel","randomNamesSrv","reportLargeAndShortSrv","ErrorMessagesSrv"],angular.module("actinver.controllers").controller("reportLargeAndShortCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(o){a.search_form_sent=!0,a.report_empty=!0,t.getSupervisorInfo(e.goals.sadviser.employeeID,o).then(function(e){e.data.elements.length>0?(a.info=e.data,a.report_empty=!1,a.filtered_report_empty=!1):a.report_empty=!0},function(){n.error("Se Encontró Un Error Favor De Intentarlo Más Tarde, Comuníquese Con Su Help desk")}).finally(function(){a.search_form_sent=!1})}var a=this;e.goals.datepicker_opts.initDate=moment().businessSubtract(1),e.$on("changeDate",function(e,t){o(t)})}e.$inject=["$scope","goalsSupervisorSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("supervisorCtrl",e)}(),function(){"use strict";function e(e){var t={};return t.show=function(t){return e.open({controller:["$scope","$uibModalInstance","$sce",function(e,n,o){e.url=t.url,e.trustSrc=function(e){return o.trustAsResourceUrl(e)},e.close=function(){n.dismiss()}}],templateUrl:"/app/advisers/help/modals/video.html",windowClass:"help"})},t}e.$inject=["$uibModal"],angular.module("actinver.services").service("HelpModals",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){
r.getCatalogStreetTypeQuery().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.typeID,text:e.street})}),be.listStreetType=t)}).catch(function(e){})}function c(){r.getCatalogCardTypeQuery().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.cardID,text:e.cardType})}),be.ListCardType=t)}).catch(function(e){})}function u(){var e=!!be.cotizacionSeleccionada,t=e?JSON.parse(be.cotizacionSeleccionada.quotationJsonIni):null;r.getCatalogPaymentTypeQuery().then(function(n){var o=[],a=[];n.success&&(angular.forEach(n.info,function(e){"2"!==e.paymentManagerID&&"8"!==e.paymentManagerID||a.push({id:e.paymentManagerID,text:e.paymentManagerName}),o.push({id:e.paymentManagerID,text:"1"===e.paymentManagerID?"PAGO REFERENCIADO":e.paymentManagerName})}),be.ListPaymentTypeAll=o,be.ListPaymentTypeSinAgentes=a,e?1==t.catalogosCotizacion.kindPaid.type.id||2==t.catalogosCotizacion.kindPaid.type.id?be.ListPaymentType=o:be.ListPaymentType=a:1==be.cmd.kindPaid.type.id||2==be.cmd.kindPaid.type.id?be.ListPaymentType=o:be.ListPaymentType=a)}).catch(function(e){})}function l(e,t){r.getCatalogRoofType(t.id).then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.roofTypeID,text:e.roofType})}),be.cmd.kindRoof={},be.listRoof=t)}).catch(function(e){})}function d(e,t){var n=[];i.getCatalogMunicipalityCars(e.id).then(function(e){if(e.success)switch(angular.forEach(e.info,function(e){n.push({id:e.municipalityID,text:e.delegationOrMunicipality})}),t){case"fiscal":be.ListEntityFiscal=n;break;case"contractor":be.cmd.emission.contract.entityContractor={},be.cmd.emission.contract.pcContractor={},be.ListEntityContractor=n;break;case"beneficiary":be.cmd.emission.beneficiary.entityBeneficiary={},be.cmd.emission.beneficiary.pcBeneficiary={},be.ListEntityBeneficiary=n}})}function m(){be.cmd.emission.sameAddress?F():L()}function p(e,t){var n=[];r.getCatalogPostalCode(e.id).then(function(e){if(e.success)switch(angular.forEach(e.info.postalCode,function(e){n.push({id:e,text:e})}),t){case"fiscal":be.ListPCFiscal=n;break;case"contractor":be.cmd.emission.contract.pcContractor={},be.ListPCContractor=n;break;case"beneficiary":be.cmd.emission.beneficiary.pcBeneficiary={},be.ListPCBeneficiary=n}})}function f(){var e=[];be.cmd.dataHouseEntityRisk.type&&i.getCatalogMunicipalityCars(be.cmd.dataHouseEntityRisk.type.id).then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.municipalityID,text:t.delegationOrMunicipality})}),be.cmd.dataHouseMunicipalityRisk={},be.cmd.dataHousePostalCodeRisk={},be.ListPostalCodeHouse=[],be.ListMunicipalityHouse=e)})}function g(){var e=[];be.cmd.dataHouseMunicipalityRisk.type&&r.getCatalogPostalCode(be.cmd.dataHouseMunicipalityRisk.type.id).then(function(t){t.success&&(angular.forEach(t.info.postalCode,function(t){e.push({id:t,text:t})}),be.cmd.dataHousePostalCodeRisk={},be.ListPostalCodeHouse=e)})}function h(){for(var e=[],t=(new Date).getFullYear(),n=0;n<7;n++)e.push({id:t+n,text:t+n});return e}function v(){for(var e,t=[],n=1;n<=12;n++)e=n<10?"0"+n:n,t.push({id:e,text:e});return t}function y(){be.cmd.cardType=void 0===be.cmd.cardType?{}:be.cmd.cardType,be.cmd.dataBanks.type.text.toString().toUpperCase().startsWith("AMERICAN EXPRESS")?(be.accLen=15,be.cvvLen=4,be.cmd.cardType.type=be.ListCardType[C("AMERICAN")]):(be.accLen=16,be.cvvLen=3,be.cmd.cardType.type=[])}function b(){if(be.emission.payment.accountNumber)switch(be.emission.payment.accountNumber.toString().substr(0,1)){case"3":be.cmd.cardType.type=be.ListCardType[C("AMERICAN")];break;case"4":be.cmd.cardType.type=be.ListCardType[C("VISA")];break;case"5":be.cmd.cardType.type=be.ListCardType[C("MASTER")]}}function C(e){for(var t=0;t<be.ListCardType.length;t++)if(be.ListCardType[t].text.toString().toUpperCase().startsWith(e))return t}function S(){be.stepForm={step:0,stepA:!1,stepB:!1,stepC:!1,stepD:!1}}function D(){e.go("insurance.main",{model:t.model})}function M(){if(be.ListCotizaciones.length>1)P();else{var n=t.model;e.go("insurance.main",{model:n})}}function A(){be.isClienteObt=!1,be.cotizacionSeleccionada?I():E()}function P(){S(),be.stepForm.step=1,be.stepForm.stepA=!0}function E(){S(),be.stepForm.step=2,be.stepForm.stepB=!0,ue()}function I(){S(),s(),c(),u(),be.yearExpirationList=h(),be.monthExpirationList=v(),be.emission.payment={},be.emission.payment.email=be.emailUser,be.emissionPersonType="1"===Se.personType?"F":"M",be.cotizacionSeleccionada&&(be.emissionPersonType=1===be.cotizacionSeleccionada.tipoCliente?"F":"M",be.jsonQuotation=JSON.parse(be.cotizacionSeleccionada.quotationJsonFin).outHomeInsuranceQuotation.insurancePaymentData,be.cmd.kindPaid.type=JSON.parse(be.cotizacionSeleccionada.quotationJsonIni).catalogosCotizacion.kindPaid.type),be.stepForm.step=3,be.stepForm.stepC=!0,window.scrollTo(0,angular.element("contratacion").offsetTop)}function T(){be.tieneCotizaciones=!1,be.ListCotizaciones=k()}function k(){var e=[],t={language:"SPA",estado:"VIGENTE",idCliente:be.numeroCliente,tipoCliente:be.personType,productKey:"HOGAR"};return r.getListQuotations(t).then(function(t){t.success?(angular.forEach(t.info,function(t){var n="1"===be.personType?t.apellidoPaternoCliente:"",o="1"===be.personType?t.apellidoMaternoCliente:"",a=t.nombreCliente+" "+n+" "+o;e.push({cotizacion:t.idCotizacion,poliza:t.idPoliza,nombre:t.nombreCliente,primerApellido:n,segundoApellido:o,nombreCompleto:a,fecha:moment((new Date).setTime(t.fechaCotizacion)).format("DD-MM-YYYY"),vigencia:moment((new Date).setTime(t.vigenciaCotizacion)).format("DD-MM-YYYY"),prima:t.monto,estadoPoliza:t.estado,numeroCliente:t.idCliente,tipoCliente:t.tipoCliente,isCliente:t.isCliente,fechaNacimiento:"1"===be.personType?moment((new Date).setTime(t.fechaNacimiento)).format("DD-MM-YYYY"):t.fechaNacimiento,rfcCliente:t.rfcCliente,sexoCliente:t.sexoCliente,emailCliente:t.mailCliente,telefonoCliente:t.telefonoCliente,quotationJsonIni:t.quotationJsonIni,quotationJsonFin:t.quotationJsonFin,emisionJsonIni:t.emisionJsonIni,emisionJsonFin:t.emisionJsonFin,status:t.vstatus})}),t.info.length>0?(be.tieneCotizaciones=!0,P()):E()):E()}),e}function R(e){be.jsonCotizacion.catalogosCotizacion=be.cmd;var t="";t=be.validatePerson?moment(be.birthDay,"DD/MM/YYYY").format("YYYY-MM-DD"):moment(be.fechaNacimiento).format("YYYY-MM-DD");var n={language:"SPA",idCliente:be.numeroCliente,idCotizacion:be.datosCotizados.numeroCotizacion,idPoliza:0,fechaCotizacion:moment(new Date).format("YYYY-MM-DD"),vigenciaCotizacion:moment(new Date,"YYYY-MM-DD").add(15,"days").format("YYYY-MM-DD"),monto:Math.ceil(be.datosCotizados.primaTotal),tipoCliente:be.personType,isCliente:"9999"===be.numeroCliente?"0":"1",nombreCliente:"1"===be.personType.toString()?be.nombres.toUpperCase():be.nombreCliente.toUpperCase(),fechaNacimiento:t,rfcCliente:be.fiscalIDNumber,sexoCliente:"masculino"===be.sexo?"1":"2",mailCliente:be.emailUser,telefonoCliente:be.phoneUser,quotationJsonInit:be.jsonCotizacion,quotationJsonEnd:e,productKey:"HOGAR"};"1"===be.personType.toString()&&(n.apellidoPaternoCliente=be.apePaterno.toUpperCase(),n.apellidoMaternoCliente=be.apeMaterno.toUpperCase()),r.getCotizationAdd(n).then(function(t){t.success?(be.datosCotizacion=be.datosCotizados,a.done("Envío de Cotización exitosa Número de Cotización: "+be.datosCotizacion.numeroCotizacion),be.jsonQuotation=e.outHomeInsuranceQuotation.insurancePaymentData):a.error("Envío de Cotización no fue exitoso."),be.cargandoCotizacion=!1})}function x(){var e=JSON.parse(JSON.parse(sessionStorage["ngStorage-user"]));if(be.roles=e.roles,angular.isDefined(be.roles)&&angular.isArray(be.roles)){if(1===be.roles.length)return be.roles[0];if(be.roles.length>1){for(var t=999,n=0;n<be.roles.length;n++)"SEGUROS"===be.roles[n]&&t>1&&(t=1),"ASESOR"===be.roles[n]&&t>2&&(t=2);switch(t){case 1:return be.rol="SEGUROS","SEGUROS";case 2:return be.rol="ASESOR","ASESOR"}}}}function N(){var e=moment(be.fechaNacimiento).format("DD/MM/YYYY")+"",t=be.fechaConstitutiva+"",n=be.rfc,o=n.replace(/^([A-ZÑ\x26]{3,4})(([0-9]{2})(0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1]))(((([A-Z]|[a-z]|[0-9]){3}))?)$/,"$2")+"";e=e.replace(/^([0-9]{2})(\/)([0-9]{2})(\/)([0-9]{2})([0-9]{2})$/,"$6$3$1")+"",null!==e&&""!==e&&null!==o&&""!==o&&o!==e&&be.personType+""=="1"&&a.error("La fecha de nacimiento no coincide con la fecha del RFC"),null!==e&&""!==e&&null!==t&&""!==t&&t!==e&&2===be.personType&&a.error("La fecha constitutiva no coincide con la fecha del RFC")}function w(e){for(var t=document.getElementById(e),n=(t.value+"").split(""),o="",a=0;a<n.length;a++)(n[a]+"").match(/^[a-zA-ZÁÉÍÓÚÑáéíóúñ ]+$/)&&(o+=n[a]);t.value=o+""}function O(){if(!be.disabledRFC&&!be.validatePerson&&""===be.fechaNacimiento)return"1"===be.personType?(a.error("Favor de Capturar el campo de Fecha de Nacimiento"),!1):(a.error("Favor de Capturar el campo de Fecha de Constitución"),!1);be.disabledRFC?be.bnd=!0:q(),be.bnd&&B()}function B(){be.cargandoCotizacion=!0;var e,t,o,i,s,c=be.jsonCoberturas.coberturas.edificio.monto,u=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.monto,l=void 0===be.cmd.securityActions?"":be.cmd.securityActions.type.id,d=void 0===be.cmd.borderWall?"false":be.cmd.borderWall.type.id;be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes&&(e=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto,t=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limTerminado.monto,o=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limDesocupado.monto,i=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limConstruccion.monto,s=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limFija.monto);var m=be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.terremotoEdificio.monto;be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes&&(be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked,be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limTerminado.checked,be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limDesocupado.checked,be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limConstruccion.checked,be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limFija.checked);var p=be.jsonCoberturas.coberturas.contenidos.monto,f=be.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.monto;be.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.coberturasIntegrantes&&(be.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.coberturasIntegrantes.bienesContenidos.monto,be.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.coberturasIntegrantes.limContenidos.monto);var g,h=be.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.terremotoContenidos.monto,v=be.jsonCoberturas.coberturas.remocionEscombros.monto,y=be.jsonCoberturas.coberturas.rcFamiliar.monto,b=be.jsonCoberturas.coberturas.rcFamiliar.coberturasIntegrantes.rcArrendatario.monto,C=be.jsonCoberturas.coberturas.rcFamiliar.coberturasIntegrantes.rcArrendatario.checked,S=be.jsonCoberturas.coberturas.cristales.monto,D=be.jsonCoberturas.coberturas.cristales.checked,M=be.jsonCoberturas.coberturas.roboMenaje.monto,A=be.jsonCoberturas.coberturas.roboMenaje.coberturasIntegrantes.joyas.monto,P=be.jsonCoberturas.coberturas.gastosAsalto.monto,E=be.jsonCoberturas.coberturas.dinero.monto,I=be.jsonCoberturas.coberturas.dinero.coberturasIntegrantes.usoTarjetasDinero.monto,T=be.jsonCoberturas.coberturas.dinero.coberturasIntegrantes.usoTarjetasDinero.checked,k=be.jsonCoberturas.coberturas.objetosPersonales.monto;be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos&&(g=be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos.monto);var x=be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.bicicletasObjetos.monto;be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos&&be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos.checked;var N,w=be.jsonCoberturas.coberturas.electrodomesticos.monto,O=be.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.monto,B=be.jsonCoberturas.coberturas.electrodomesticos.checked,L=be.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.checked,F=be.jsonCoberturas.coberturas.asistenciaViajes.monto;be.jsonCoberturas.coberturas.extensionViajes&&(N=be.jsonCoberturas.coberturas.extensionViajes.monto);var j;if(be.jsonCoberturas.coberturas.asistenciaLegal&&(j=be.jsonCoberturas.coberturas.asistenciaLegal.monto),$=void 0,be.jsonCoberturas.coberturas.asistenciaInformatica)var $=be.jsonCoberturas.coberturas.asistenciaInformatica.monto;var Y,H=be.jsonCoberturas.coberturas.gastosFinales.monto,_=be.jsonCoberturas.coberturas.gastosExtras.monto,U=be.jsonCoberturas.coberturas.asistenciaViajes.checked;be.jsonCoberturas.coberturas.extensionViajes&&(Y=be.jsonCoberturas.coberturas.extensionViajes.checked);var z;be.jsonCoberturas.coberturas.asistenciaLegal&&(z=be.jsonCoberturas.coberturas.asistenciaLegal.checked);var V;be.jsonCoberturas.coberturas.asistenciaInformatica&&(V=be.jsonCoberturas.coberturas.asistenciaInformatica.checked);var Q=be.jsonCoberturas.coberturas.gastosFinales.checked,q=f?"true":"false",G=h?"true":"false",J=u?"true":"false",K=m?"true":"false",W=c?"true":"false",X="AMPARADO"===P?"true":"false",Z="AMPARADO"===F?"true":"false",ee="AMPARADO"===N?"true":"false",te="AMPARADO"===j?"true":"false",ne="AMPARADO"===$?"true":"false",oe="AMPARADO"===H?"true":"false";f=f||0,h=h||0,u=u||0,m=m||0,e=e||0,t=t||0,o=o||0,i=i||0,s=s||0,c=c||0,p=p||0,v=v||0,y=y||0,b="AMPARADO"===b?y:0,S=S||0,M=M||0,A=A||0,E=E||0,I=I||0,k=k||0,g=g||0,x=x||0,w=w||0,O=O||0,_=_||0,v=v||0;var ae="true"===q?2:1,re={};switch(re.language="SPA",re.agentID=n.$parent.agentSelected.id,re.ClientNumber=be.numeroCliente,re.InsurancePolicyDate=moment(new Date).format("YYYY-MM-DD"),re.PolicyMaturityDate=moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD"),be.cmd.currency.type.id){case 1:re.Currency="MXN";break;case 2:re.Currency="USD"}re.PaymentMethod=be.cmd.kindPaid.type.id,re.FederalEntityID=be.cmd.dataHouseEntityRisk.type.id,re.DelegationMunicipalityID=be.cmd.dataHouseMunicipalityRisk.type.id,re.PostalCode=be.cmd.dataHousePostalCodeRisk.type.id,re.Street=be.calle,re.WallTypeID=be.cmd.kindStructure.type.id,re.RoofTypeID=be.cmd.kindRoof.type.id,re.RiskTypeDetailAreaCode=be.cmd.kindRisk.type.id,re.BeachFrontCode=ae,re.ContInsuredSum=p,re.ContHydromPhenomCoverageFlag=q,re.ContHydromPhenomCoverageInsuredSum=f,re.ContHydromPhenomCoverageStoredItemsInsuredSum=e,re.ContEarthquakeEruptCoverageFlag=G,re.ContEarthquakeEruptCoverageInsuredSum=h,re.ExtExpHomeInsuredSum=_,re.ExtExpHomeHydromPhenomCoverageFlag=q,re.ExtExpHomeHydromPhenomInsuredSum="0",re.ExtExpHomeEarthquakeEruptCoverageFlag=G,re.ExtExpHomeEarthquakeEruptInsuredSum="0",re.DebRemInsuredSum=v,re.DebRemHydromPhenomCoverageFlag=q,re.DebRemHydromPhenomInsuredSum="0",re.DebRemEarthquakeEruptCoverageFlag=G,re.DebRemEarthquakeEruptInsuredSum="0",re.FamCivLiaInsuredSum=y,C&&(re.FamCivLiaTenCivLiaInsuredSum=b),re.BuilCoverageFlag=W,re.BuilInsuredSum=c,re.BuilHydromPhenomCoverageFlag=J,re.BuilHydromPhenomInsuredSum=u,re.BuilHydromPhenomFinishedBuildingInsuredSum=t,re.BuilHydromPhenomVacatedBuildingInsuredSum=o,re.BuilHydromPhenomConstructionBuildingInsuredSum=i,re.BuilHydromPhenomFixedAdaptationsInsuredSum=s,re.BuilEarthquakeEruptCoverageFlag=K,re.BuilEarthquakeEruptInsuredSum=m,D&&(re.CrystalsInsuredSum=S),re.HouseholdEquipmentTheftInsuredSum=M,re.JewelryAndValuablesInsuredSum=A,re.MedicalExpensesCoverage=X,re.CashSecInsuredSum=E,T&&(re.CashSecCreditCardFraudInsuredSum=I),re.PerItemsInsuredSum=k,re.PerItemsPersonalItemsInsuredSum=g,re.PerItemsBicycleInsuredSum=x,re.SecurityMeasuresCode=l,re.AdjoiningHomeFlag=d,B&&(re.ElecEquipInsuredSum=w),L&&(re.ElecEquipMobileInsuredSum=O),U&&(re.HomeAssistanceCoverageFlag=Z),Y&&(re.TravelsCoverageFlag=ee),z&&(re.LegalAssistanceCoverageFlag=te),V&&(re.CompAssistServCoverageFlag=ne),Q&&(re.FinalExpensesCoverageFlag=oe),be.jsonCotizacion.Street=re.Street,r.getServiceCotizacionHome(re).then(function(e){if(e.success){be.datosCotizados={primaNeta:e.info.insurancePaymentData.netPremium,derechosPoliza:e.info.insurancePaymentData.entitlement,recargos:e.info.insurancePaymentData.surcharge,iva:e.info.insurancePaymentData.vat,primaTotal:e.info.insurancePaymentData.totalPremium,numeroCotizacion:e.info.quotationNumber,coberturas:e.info.coverageList};var t=e.response;be.primatotalImpresion=e.info.insurancePaymentData.totalPremium,t.outCommonHeader={},R(t)}else a.error("Error en el Servicio, no se encuentra disponible - code: "+e.info.transactionID),be.cargandoCotizacion=!1})}function L(){be.isClienteObt=!1,be.emission.contract={gender:"1",name:"",lastName:"",secondLastName:"",birthdate:moment(new Date).format("YYYY-MM-DD"),fiscalIDNumber:"",email:"",phone:"",street:"",numberExt:"",numberInt:"",neighboarhood:"",stateContractor:{type:{}},entityContractor:{type:{}},pcContractor:{type:{}}},be.cmd.emission.contract={stateContractor:{type:null},entityContractor:{type:null},pcContractor:{type:null}}}function F(){var e="",t="",n=!!be.cotizacionSeleccionada,o=n?JSON.parse(be.cotizacionSeleccionada.quotationJsonIni):null;switch(be.flagSameAddressCheckBox=!!be.cotizacionSeleccionada,be.isClienteObt=!0,"9999"===be.numeroCliente?"string"==typeof be.fechaNacimiento?e=be.fechaNacimiento:void 0!==(e=moment(be.fechaNacimiento).format("DD/MM/YYYY"))&&"Invalid date"!==e||(e=moment(be.fechaNacimiento,"DD/MM/YYYY"),e=moment(e).format("DD/MM/YYYY")):"string"==typeof be.birthDay?e=be.birthDay:void 0!==(e=moment(be.birthDay).format("DD/MM/YYYY"))&&"Invalid date"!==e||(e=moment(be.birthDay,"DD/MM/YYYY"),e=moment(e).format("DD/MM/YYYY")),be.isClienteObt=!0,be.emissionPersonType){case"F":e=j(n?be.cotizacionSeleccionada.rfcCliente:be.fiscalIDNumber,"1"),be.emission.contract={gender:n?"1"===be.cotizacionSeleccionada.sexoCliente?"1":"2":"masculino"===be.sexo?"1":"2",name:n?be.cotizacionSeleccionada.nombre:be.nombres,lastName:n?be.cotizacionSeleccionada.primerApellido:be.apePaterno,secondLastName:n?be.cotizacionSeleccionada.segundoApellido:be.apeMaterno,birthdate:e,fiscalIDNumber:n?be.cotizacionSeleccionada.rfcCliente:be.fiscalIDNumber,email:n?be.cotizacionSeleccionada.emailCliente:be.emailUser,phone:n?be.cotizacionSeleccionada.telefonoCliente:be.phoneUser,street:n?o.Street:be.calle,numberExt:be.emission.riskNumberExt,numberInt:be.emission.riskInterior,neighboarhood:be.emission.riskNeighborhood,stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:be.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:be.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:be.cmd.dataHousePostalCodeRisk.type}},be.cmd.emission.contract={stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:be.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:be.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:be.cmd.dataHousePostalCodeRisk.type}};break;case"M":n&&(1===be.cotizacionSeleccionada.isCliente?"string"==typeof be.cotizacionSeleccionada.fechaNacimiento?t=be.cotizacionSeleccionada.fechaNacimiento:void 0!==(t=moment(be.cotizacionSeleccionada.fechaNacimiento).format("DD/MM/YYYY"))&&"Invalid date"!==t||(t=moment(be.cotizacionSeleccionada.fechaNacimiento,"DD/MM/YYYY"),t=moment(t).format("DD/MM/YYYY")):"string"==typeof be.cotizacionSeleccionada.fechaNacimiento?t=be.cotizacionSeleccionada.fechaNacimiento:void 0!==(t=moment(be.cotizacionSeleccionada.fechaNacimiento).format("DD/MM/YYYY"))&&"Invalid date"!==t||(t=moment(be.cotizacionSeleccionada.fechaNacimiento,"DD/MM/YYYY"),t=moment(e).format("DD/MM/YYYY"))),t=j(n?be.cotizacionSeleccionada.rfcCliente:be.fiscalIDNumber,"2"),be.emission.contract={gender:"1",name:n?be.cotizacionSeleccionada.nombre:be.nombreCliente,lastName:"",secondLastName:"",birthdate:t,fiscalIDNumber:n?be.cotizacionSeleccionada.rfcCliente:be.fiscalIDNumber,email:n?be.cotizacionSeleccionada.emailCliente:be.emailUser,phone:n?be.cotizacionSeleccionada.telefonoCliente:be.phoneUser,street:n?o.Street:be.calle,numberExt:be.emission.riskNumberExt,numberInt:be.emission.riskInterior,neighboarhood:be.emission.riskNeighborhood,stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:be.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:be.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:be.cmd.dataHousePostalCodeRisk.type}},be.cmd.emission.contract={stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:be.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:be.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:be.cmd.dataHousePostalCodeRisk.type}}}}function j(e,t){var n=moment(new Date).format("YY"),o="1"===t?e.substring(4,10):e.substring(3,9),a=o.substring(0,2),r=o.substring(2,4),i=o.substring(4,6);return a=a>n?"19"+a:"20"+a,o=i+"/"+r+"/"+a}function $(){var e=void 0===be.comboYearExpiration?"":be.comboYearExpiration.id,t=void 0===be.comboMonthExpiration?"":be.comboMonthExpiration.id,n=void 0===be.cmd.ListTypeCLABE?"":be.cmd.ListTypeCLABE.type.text,o=void 0===be.emission.payment.dateAprox?moment(new Date).format("YYYY-MM-DD"):moment(be.emission.payment.dateAprox).format("YYYY-MM-DD"),i=void 0===be.emission.payment.accountNumber?"":be.emission.payment.accountNumber,s=void 0===be.emission.payment.cvv?"":be.emission.payment.cvv,c=void 0===be.emission.payment.clabe?"":be.emission.payment.clabe,u="",l="",d="";d="string"==typeof be.emission.contract.birthdate?be.emission.contract.birthdate.split("/").reverse().join("-"):moment(new Date(be.emission.contract.birthdate)).format("YYYY-MM-DD"),"8"!==be.cmd.paymentType.type.id&&"2"!==be.cmd.paymentType.type.id||(u=e+"-"+t+"-01",l=o),"2"===be.cmd.paymentType.type.id&&"CLABE"===n&&(u=o,l=o);var m={QuotationNumber:be.datosCotizacion.numeroCotizacion||be.cotizacionSeleccionada.cotizacion,InsuInsurancePolicyDate:moment(new Date).format("YYYY-MM-DD"),InsuPolicyMaturityDate:moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD"),InsuNumberOfFloors:be.emission.floors,InsuNumberOfBasements:be.emission.basements,InsuPaymentManagerID:be.cmd.paymentType.type.id,RiskStreetTypeID:be.cmd.emission.streetType.type.id,RiskStreet:be.emission.riskStreet,RiskInteriorNumber:be.emission.riskInterior,RiskOutdoorNumber:be.emission.riskNumberExt,RiskNeighborhood:be.emission.riskNeighborhood,RiskSameAddressContractingPartyFlag:!0===be.cmd.emission.sameAddress?"1":"0",ContractPersonType:be.emissionPersonType,ContractFiscalIDNumber:be.emission.contract.fiscalIDNumber,ContractName:be.emission.contract.name,ContractLastName:be.emission.contract.lastName,ContractSecondLastName:be.emission.contract.secondLastName,ContractBirthDate:d,ContractGender:"F"===be.emissionPersonType?be.emission.contract.gender:"1",ContractPhoneNumber:be.emission.contract.phone,ContractEmail:be.emission.contract.email,ContractStreet:be.emission.contract.street,ContractNeighborhood:be.emission.contract.neighboarhood,ContractFederalEntityID:be.cmd.emission.contract.stateContractor.type.id,ContractDelegationMunicipalityID:be.cmd.emission.contract.entityContractor.type.id,ContractPostalCode:be.cmd.emission.contract.pcContractor.type.id,CheckBeneficiary:be.checkBeneficiary?"true":"false",BeneficiaryPersonType:be.checkBeneficiary?be.emission.beneficiary.type:"",BeneficiaryFiscalIDNumber:be.checkBeneficiary?be.emission.beneficiary.rfc:"",BeneficiaryName:be.checkBeneficiary?"F"===be.emission.beneficiary.type?be.emission.beneficiary.name:be.emission.beneficiary.social:"",BeneficiaryLastName:be.checkBeneficiary?be.emission.beneficiary.lastName:"",BeneficiarySecondLastName:be.checkBeneficiary?be.emission.beneficiary.secondLastName:"",BeneficiaryStreet:be.checkBeneficiary?be.emission.beneficiary.street:"",BeneficiaryNeighborhood:be.checkBeneficiary?be.emission.beneficiary.neighboarhood:"",BeneficiaryFederalEntityID:be.checkBeneficiary?be.cmd.emission.beneficiary.stateBeneficiary.type.id:"",BeneficiaryDelegationMunicipalityID:be.checkBeneficiary?be.cmd.emission.beneficiary.entityBeneficiary.type.id:"",BeneficiaryPostalCode:be.checkBeneficiary?be.cmd.emission.beneficiary.pcBeneficiary.type.id:"",TitularPersonType:be.emissionPersonType,TitularFiscalIDNumber:be.emission.contract.fiscalIDNumber,TitularName:be.emission.contract.name,TitularLastName:be.emission.contract.lastName,TitularSecondLastName:be.emission.contract.secondLastName,TitularBirthDate:d,TitularGender:"F"===be.emissionPersonType?be.emission.contract.gender:"1",TitularPhoneNumber:be.emission.contract.phone,TitularEmail:be.emission.contract.email,TitularStreet:be.emission.contract.street,TitularNeighborhood:be.emission.contract.neighboarhood,TitularFederalEntityID:be.cmd.emission.contract.stateContractor.type.id,TitularDelegationMunicipalityID:be.cmd.emission.contract.entityContractor.type.id,TitularPostalCode:be.cmd.emission.contract.pcContractor.type.id,BankingPaymentMethod:"8"===be.cmd.paymentType.type.id?"TC":"1"===be.cmd.paymentType.type.id?"":be.cmd.ListTypeCLABE.type.text,BankingBankID:"8"!==be.cmd.paymentType.type.id&&"2"!==be.cmd.paymentType.type.id||void 0===be.cmd.dataBanks.type?"":be.cmd.dataBanks.type.id,BankingName:be.emission.payment.name,BankingLastName:be.emission.payment.lastName,BankingSecondLastName:be.emission.payment.secondLastName,BankingEmail:be.emission.payment.email,BankingAccountNumber:i,BankingCardVerificationValue:s,BankingExpirationDate:u,BankingCardID:"8"!==be.cmd.paymentType.type.id&&"2"!==be.cmd.paymentType.type.id||void 0===be.cmd.cardType.type?"":be.cmd.cardType.type.id,BankingCLABE:c,BankingPaymentDate:l,TypeCardByClabe:void 0===be.cmd.ListTypeCLABE?"":be.cmd.ListTypeCLABE.type.text,language:"SPA"};r.getServiceEmisionHome(m).then(function(e){if(e.success){be.datosCotizacion=e.info,be.numPoliza=e.info.policyNumber,be.stepForm.stepD=!1,be.stepForm.stepE=!0;var t={language:"SPA",idCotizacion:m.QuotationNumber,idPoliza:be.numPoliza,quotationJsonInit:JSON.stringify(m),quotationJsonEnd:JSON.stringify(e.response),numberAuthorizer:0};r.updateQuotation(t).then(function(e){a.done("Emisión Exitosa. Número de póliza: "+be.numPoliza)}).catch()}else a.error("Error en el Servicio, no se encuentra disponible - code: "+e.info.transactionID)})}function Y(){var e=-1!==window.location.href.indexOf("asesoria.actinver.com/asesoria")?"https://negocios.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+be.numPoliza+"&Endoso=0":"https://negociosuat.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+be.numPoliza+"&Endoso=0";window.open(e,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function H(){var e;e="img/pdfs/actinver-condiciones-generales-mapfre-hogar30052019.pdf",window.open(e,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function _(){e.go("insurance.main",{model:null})}function U(){if(Number(be.emission.floors)<=0)return void a.error("El número de PISOS debe ser MAYOR a CERO");V()&&(be.stepForm.stepC=!1,be.stepForm.stepD=!0)}function z(){be.stepForm.stepC=!0,be.stepForm.stepD=!1}function V(){if(!Q(moment(be.emission.contract.birthdate).format("DD/MM/YYYY"),be.emission.contract.fiscalIDNumber,be.personType,"Contratante"))return!1;if(be.checkBeneficiary){var e="";if("F"===be.emission.beneficiary.type?personaBeneficiario="1":"M"===be.emission.beneficiary.type&&(personaBeneficiario="2"),"1"===personaBeneficiario?be.emission.beneficiary.dateF?e=be.emission.beneficiary.dateF:a.error("Favor de Capturar el campo de Fecha de Nacimiento del Beneficiario"):"2"===personaBeneficiario&&(be.emission.beneficiary.dateM?e=be.emission.beneficiary.dateM:a.error("Favor de Capturar el campo de Fecha de Constitución del Beneficiario")),e=moment(e).format("DD/MM/YYYY"),!Q(e,be.emission.beneficiary.rfc,personaBeneficiario,"Beneficiario"))return!1}return!0}function Q(e,t,n,o){if(be.isClienteObt)return!0;var r="",i=e.split("/");if(r+=i[2].substring(2,4),r+=i[1],r+=i[0],"1"===n){if(r!==t.substring(4,10))return a.error("La fecha de nacimiento del "+o+" no coincide con la fecha del RFC."),!1;be.bnd=!0}else if("2"===n){if(r!==t.substring(3,9))return t.length>12&&"2"===n?(a.error("El RFC del "+o+" no cumple con la longitud correcta. "),!1):(a.error("La fecha constitutiva del "+o+" no coincide con la fecha del RFC."),!1);be.bnd=!0}return!0}function q(){if(be.bnd=!1,be.isClienteObt)be.bnd=!0;else{var e=be.disabledRFC?be.birthDay:be.fechaNacimiento;e="string"==typeof e?e:moment(e).format("DD/MM/YYYY");var t=be.fiscalIDNumber,n="",o=e.split("/");n+=o[2].substring(2,4),n+=o[1],n+=o[0],"1"===be.personType?n===t.substring(4,10)?be.bnd=!0:a.error("La fecha de nacimiento no coincide con la fecha del RFC."):"2"===be.personType&&(n===t.substring(3,9)?be.bnd=!0:t.length>12&&"2"===be.personType?a.error("El RFC no cumple con la longitud correcta. "):a.error("La fecha constitutiva no coincide con la fecha del RFC."))}}function G(e){for(var t=document.getElementById(e),n=(t.value+"").split(""),o="",a=0;a<n.length;a++)(n[a]+"").match(/^[0-9a-zA-ZÁÉÍÓÚÑáéíóúñ ]+$/)&&(o+=n[a]);t.value=o+""}function J(e){for(var t=document.getElementById(e),n=(t.value+"").split(""),o="",a=0;a<n.length;a++)(n[a]+"").match(/^[0-9]+$/)&&(o+=n[a]);t.value=o+""}function K(e){var t=new RegExp("^[0-9]+$"),n=void 0!==event.charCode?event.charCode:event.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==event.charCode)return event.preventDefault(),!1}function W(e){return/^[1-9]+[0-9]*]*$/.test(e),!0}function X(e,t){var n=void 0!==event.charCode?event.charCode:event.which,o=void 0!==t?t.toUpperCase():String.fromCharCode(n).toUpperCase();if(o.length>2){var a=o.substring(o.length-3,o.length);if(W(a)){if(De=a.substring(0,1),Me=a.substring(1,2),Ae=a.substring(2,3),De.toString()===Me.toString()&&Me.toString()===Ae.toString())return event.preventDefault(),!1}else if(De=a.substring(0,1),Me=a.substring(1,2),Ae=a.substring(2,3),parseInt(Me)===parseInt(Ae)-1&&parseInt(De)===parseInt(Me)-1)return event.preventDefault(),!1}return!1}function Z(e,t){var n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n).toUpperCase(),a=angular.element("#"+t).val().toString().toUpperCase();if(a=void 0===a?"":a,a.substring(a.length-1,a.length)===o&&a.substring(a.length-2,a.length-1)===o)return e.preventDefault(),!1}function ee(e,t){var n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n).toUpperCase(),a=angular.element("#"+t).val().toString().toUpperCase();if(a=void 0===a?"":a,a.substring(a.length-1,a.length)===o&&a.substring(a.length-2,a.length-1)===o&&a.substring(a.length-3,a.length-2)===o)return e.preventDefault(),!1}function te(e,t){var n=t?new RegExp("^[a-zA-Z0-9 ]+$"):new RegExp("^[a-zA-Z0-9]+$"),o=void 0!==event.charCode?event.charCode:event.which,a=String.fromCharCode(o)
;return 241===event.which||209===event.which||225===event.which||233===event.which||237===event.which||243===event.which||250===event.which||193===event.which||201===event.which||205===event.which||211===event.which||218===event.which||(n.test(a)||0===event.charCode?void 0:(event.preventDefault(),!1))}function ne(e,t,n){var o=new RegExp("^[a-zA-Z]+$"),a=void 0!==e.charCode?e.charCode:e.which,r=String.fromCharCode(a);return 241===e.which||209===e.which||225===e.which||233===e.which||237===e.which||243===e.which||250===e.which||193===e.which||201===e.which||205===e.which||211===e.which||218===e.which||32===e.which||(o.test(r)||0===e.charCode?void 0:(e.preventDefault(),!1))}function oe(e,t){var n=angular.element("#"+t).val();return n=void 0===n?"":n,"01"!==n.toString()&&"001"!==n.toString()?!(n.toString().length>5&&"01234567890000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999".includes(n.toString())&&(e.preventDefault(),1)):(e.preventDefault(),!1)}function ae(e){var t=e.keyCode;if(t>=97&&t<=122&&!e.ctrlKey&&!e.metaKey&&!e.altKey){var n=t-32,o=e.target.selectionStart,a=e.target.selectionEnd;e.target.value=e.target.value.substring(0,o)+String.fromCharCode(n)+e.target.value.substring(a),e.target.setSelectionRange(o+1,o+1),e.preventDefault()}}function re(){var e=1*be.importeEdificio;be.sumaGastosExtras=e+.1*e+"",document.getElementById("sumaGastosExtras").disabled="true"}function ie(){var e=1*be.importeEdificio;be.sumaRemEsco=e+.1*e+"",document.getElementById("sumaRemEsco").disabled="true"}function se(e){be.tipoRiesgo=e,ce()}function ce(){"2"===be.tipoRiesgo.id?(be.roboMenaje.c.checked=!1,be.roboMenaje.ci.joyas.checked=!1,be.dinero.c.checked=!1,be.dinero.ci.usoTarjetasDinero.checked=!1,"SEGUROS"===be.rol&&(be.roboMenaje.c.montoDisabled=!0,be.roboMenaje.c.obligatorio=!0,be.dinero.c.montoDisabled=!0,be.dinero.c.obligatorio=!0)):"ASESOR"===be.rol?(be.roboMenaje.c.checked=!0,be.dinero.c.checked=!0,be.roboMenaje.ci.joyas.checked=!0):"SEGUROS"===be.rol&&(be.roboMenaje.c.montoDisabled=!1,be.roboMenaje.c.obligatorio=!1,be.dinero.c.montoDisabled=!1,be.dinero.c.obligatorio=!1),pe()}function ue(e){var t=[];r.getCoverage().then(function(n){angular.forEach(n.info,function(e){var n={};try{n=JSON.parse(ye(e.json))}catch(t){try{n=JSON.parse(e.json)}catch(e){a.error("No fue posible obtener las coberturas.")}}t.push({id:e.idCobertura,isCliente:e.isCliente,json:n,moneda:e.moneda,rollUsuario:e.rollUsuario,status:e.status,tipoCliente:e.tipoCliente})});for(var o=0;o<t.length;o++)"ASESOR"===t[o].rollUsuario&&"MXN"===t[o].moneda&&(be.jsonCoberturasAsesorMXN=t[o].json),"ASESOR"===t[o].rollUsuario&&"USD"===t[o].moneda&&(be.jsonCoberturasAsesorUSD=t[o].json),"SEGUROS"===t[o].rollUsuario&&"MXN"===t[o].moneda&&(be.jsonCoberturasSegurosMXN=t[o].json),"SEGUROS"===t[o].rollUsuario&&"USD"===t[o].moneda&&(be.jsonCoberturasSegurosUSD=t[o].json);le(e)})}function le(e){var t=1;if(e&&(t=e.id),"ASESOR"===be.rol)switch(t){case 1:be.jsonCoberturas=be.jsonCoberturasAsesorMXN;break;case 2:be.jsonCoberturas=be.jsonCoberturasAsesorUSD}if("SEGUROS"===be.rol)switch(t){case 1:be.jsonCoberturas=be.jsonCoberturasSegurosMXN;break;case 2:be.jsonCoberturas=be.jsonCoberturasSegurosUSD}be.limiteMaximoEquipoMovil=be.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.limiteMaximo,be.limiteMaximoCristales=be.jsonCoberturas.coberturas.cristales.limiteMaximo,be.limiteMaximoRoboMenaje=be.jsonCoberturas.coberturas.roboMenaje.limiteMaximo,be.limiteMaximoRcFamiliar=be.jsonCoberturas.coberturas.rcFamiliar.limiteMaximo,be.dineroMontoInicial=be.jsonCoberturas.coberturas.dinero.monto,be.limiteMaximoUsoTarjetas=be.jsonCoberturas.coberturas.dinero.coberturasIntegrantes.usoTarjetasDinero.limiteMaximo,be.bicicletasMontoInicial=be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.bicicletasObjetos.monto,be.objetosObjetosMontoInicial=be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos.monto,be.objetosMontoInicial=be.jsonCoberturas.coberturas.objetosPersonales.monto,be.equipoMovilMontoInicial=be.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.monto,be.edificio={c:be.jsonCoberturas.coberturas.edificio,ci:be.jsonCoberturas.coberturas.edificio.coberturasIntegrantes},be.contenidos={c:be.jsonCoberturas.coberturas.contenidos,ci:be.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes},be.rcFamiliar={c:be.jsonCoberturas.coberturas.rcFamiliar,ci:be.jsonCoberturas.coberturas.rcFamiliar.coberturasIntegrantes},be.roboMenaje={c:be.jsonCoberturas.coberturas.roboMenaje,ci:be.jsonCoberturas.coberturas.roboMenaje.coberturasIntegrantes},be.dinero={c:be.jsonCoberturas.coberturas.dinero,ci:be.jsonCoberturas.coberturas.dinero.coberturasIntegrantes},be.objetosPersonales={c:be.jsonCoberturas.coberturas.objetosPersonales,ci:be.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes},be.electrodomesticos={c:be.jsonCoberturas.coberturas.electrodomesticos,ci:be.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes},be.remocionEscombros={c:be.jsonCoberturas.coberturas.remocionEscombros,ci:be.jsonCoberturas.coberturas.remocionEscombros.coberturasIntegrantes},be.gastosAsalto={c:be.jsonCoberturas.coberturas.gastosAsalto,ci:be.jsonCoberturas.coberturas.gastosAsalto.coberturasIntegrantes},be.gastosFinales={c:be.jsonCoberturas.coberturas.gastosFinales,ci:be.jsonCoberturas.coberturas.gastosFinales.coberturasIntegrantes},be.gastosExtras={c:be.jsonCoberturas.coberturas.gastosExtras,ci:be.jsonCoberturas.coberturas.gastosExtras.coberturasIntegrantes},be.cristales={c:be.jsonCoberturas.coberturas.cristales,ci:be.jsonCoberturas.coberturas.cristales.coberturasIntegrantes},be.jsonCoberturas.coberturas.asistenciaInformatica&&(be.asistenciaInformatica={c:be.jsonCoberturas.coberturas.asistenciaInformatica,ci:be.jsonCoberturas.coberturas.asistenciaInformatica.coberturasIntegrantes}),be.jsonCoberturas.coberturas.asistenciaLegal&&(be.asistenciaLegal={c:be.jsonCoberturas.coberturas.asistenciaLegal,ci:be.jsonCoberturas.coberturas.asistenciaLegal.coberturasIntegrantes}),be.asistenciaViajes={c:be.jsonCoberturas.coberturas.asistenciaViajes,ci:be.jsonCoberturas.coberturas.asistenciaViajes.coberturasIntegrantes},be.jsonCoberturas.coberturas.extensionViajes&&(be.extensionViajes={c:be.jsonCoberturas.coberturas.extensionViajes,ci:be.jsonCoberturas.coberturas.extensionViajes.coberturasIntegrantes}),ce(),pe()}function de(e){return isNaN(e)?"NA"===e?"":void 0:"$"+he(e)}function me(e){var t=e.currentTarget;"edificio1"===t.id&&(t.checked?(be.edificio.c.monto=be.edificio.c.limiteMinimo,be.edificio.c.montoDisabled=!1,be.edificio.ci.incendioEdificio.checked=!0,be.contenidos.ci.hidroContenidos.checked&&(be.edificio.ci.hidroEdificio.checked=!0),be.contenidos.ci.terremotoContenidos.checked&&(be.edificio.ci.terremotoEdificio.checked=!0),be.rcFamiliar.ci.rcArrendatario.checked=!1,be.rcFamiliar.ci.rcArrendatario.monto=void 0,be.rcFamiliar.ci.rcArrendatario.montoDisabled=!0):(be.edificio.c.monto=void 0,be.edificio.c.montoDisabled=!0,be.edificio.ci.incendioEdificio.checked=!1,be.edificio.ci.incendioEdificio.monto=void 0,be.edificio.ci.incendioEdificio.montoDisabled=!0,be.edificio.ci.hidroEdificio.checked=!1,be.edificio.ci.hidroEdificio.monto=void 0,be.edificio.ci.hidroEdificio.montoDisabled=!0,be.edificio.ci.terremotoEdificio.checked=!1,be.edificio.ci.terremotoEdificio.monto=void 0,be.edificio.ci.terremotoEdificio.montoDisabled=!0,be.rcFamiliar.ci.rcArrendatario.checked=!0,be.rcFamiliar.ci.rcArrendatario.obligatorio=!0,be.rcFamiliar.ci.rcArrendatario.monto="AMPARADO")),"hidroEdificio1"===t.id&&be.edificio.c.checked&&(t.checked?be.contenidos.ci.hidroContenidos.checked=!0:(be.edificio.ci.hidroEdificio.monto=void 0,be.contenidos.ci.hidroContenidos.checked=!1,be.contenidos.ci.hidroContenidos.monto=void 0)),be.edificio.ci.hidroEdificio.coberturasIntegrantes&&(be.edificio.ci.hidroEdificio.checked||(be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked=!1,be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.montoDisabled=!0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.checked=!1,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.montoDisabled=!0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.checked=!1,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.montoDisabled=!0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.checked=!1,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.montoDisabled=!0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.checked=!1,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.montoDisabled=!0)),"hidroContenidos1"===t.id&&(t.checked?be.edificio.c.checked&&(be.edificio.ci.hidroEdificio.checked=!0):(be.contenidos.ci.hidroContenidos.monto=void 0,be.edificio.ci.hidroEdificio.checked=!1,be.edificio.ci.hidroEdificio.monto=void 0,void 0!==be.contenidos.ci.hidroContenidos.coberturasIntegrantes&&(be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.checked=!1,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.monto=void 0,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.montoDisabled=!0,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.checked=!1,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.monto=void 0,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.montoDisabled=!0))),be.edificio.ci.hidroEdificio.coberturasIntegrantes&&(be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked=!1),"limConstruccion1"===t.id&&(t.checked?be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.montoDisabled=!1:(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.montoDisabled=!0)),"limDesocupado1"===t.id&&(t.checked?be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.montoDisabled=!1:(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.montoDisabled=!0)),"limFija1"===t.id&&(t.checked?be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.montoDisabled=!1:(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.montoDisabled=!0)),"limTerminado1"===t.id&&(t.checked?be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.montoDisabled=!1:(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.monto=void 0,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.montoDisabled=!0)),be.edificio.ci.hidroEdificio.coberturasIntegrantes&&(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.checked||be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.checked||be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.checked||be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.checked)&&(be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked=!0),"bienesContenidos1"===t.id&&(t.checked?be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.montoDisabled=!1:(be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.monto=void 0,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.montoDisabled=!0)),"limContenidos1"===t.id&&(t.checked?be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.montoDisabled=!1:(be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.monto=void 0,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.montoDisabled=!0)),"terremotoEdificio1"===t.id&&be.edificio.c.checked&&(t.checked?be.contenidos.ci.terremotoContenidos.checked=!0:(be.edificio.ci.terremotoEdificio.monto=void 0,be.contenidos.ci.terremotoContenidos.checked=!1,be.contenidos.ci.terremotoContenidos.monto=void 0)),"terremotoContenidos1"===t.id&&(t.checked?be.edificio.c.checked&&(be.edificio.ci.terremotoEdificio.checked=!0):(be.contenidos.ci.terremotoContenidos.monto=void 0,be.edificio.ci.terremotoEdificio.checked=!1,be.edificio.ci.terremotoEdificio.monto=void 0)),"cristales1"===t.id&&(t.checked?be.cristales.c.montoDisabled=!1:(be.cristales.c.monto=void 0,be.cristales.c.montoDisabled=!0)),"roboMenaje1"===t.id&&(t.checked?"SEGUROS"===be.rol&&(be.roboMenaje.c.montoDisabled=!1):("SEGUROS"===be.rol&&(be.roboMenaje.c.montoDisabled=!0),be.roboMenaje.c.monto=void 0,be.roboMenaje.ci.joyas.checked=!1)),"joyas1"===t.id&&(t.checked?"SEGUROS"===be.rol&&(be.roboMenaje.ci.joyas.montoDisabled=!1):("SEGUROS"===be.rol&&(be.roboMenaje.ci.joyas.montoDisabled=!0),be.roboMenaje.ci.joyas.monto=void 0)),"dinero1"===t.id&&(t.checked?be.dinero.c.montoDisabled=!1:(be.dinero.c.monto=void 0,be.dinero.c.montoDisabled=!0,be.dinero.ci.usoTarjetasDinero.checked=!1)),"usoTarjetasDinero1"===t.id&&(t.checked?be.dinero.ci.usoTarjetasDinero.montoDisabled=!1:(be.dinero.ci.usoTarjetasDinero.monto=void 0,be.dinero.ci.usoTarjetasDinero.montoDisabled=!0)),"objetosPersonales1"===t.id&&(t.checked||(be.objetosPersonales.c.monto=void 0,be.objetosPersonales.ci.objetosObjetos.checked=!1,be.objetosPersonales.ci.objetosObjetos.monto=void 0,be.objetosPersonales.ci.objetosObjetos.montoDisabled=!0,be.objetosPersonales.ci.bicicletasObjetos.checked=!1,be.objetosPersonales.ci.bicicletasObjetos.monto=void 0,be.objetosPersonales.ci.bicicletasObjetos.montoDisabled=!0)),"objetosObjetos1"===t.id&&(t.checked?be.objetosPersonales.ci.objetosObjetos.montoDisabled=!1:(be.objetosPersonales.ci.objetosObjetos.monto=void 0,be.objetosPersonales.ci.objetosObjetos.montoDisabled=!0)),"bicicletasObjetos1"===t.id&&(t.checked?"SEGUROS"===be.rol&&(be.objetosPersonales.ci.bicicletasObjetos.montoDisabled=!1):"SEGUROS"===be.rol&&(be.objetosPersonales.ci.bicicletasObjetos.montoDisabled=!0)),"electrodomesticos1"===t.id&&(t.checked?be.electrodomesticos.c.montoDisabled=!1:(be.electrodomesticos.c.monto=void 0,be.electrodomesticos.c.montoDisabled=!0,be.electrodomesticos.ci.equipoMovil.checked=!1,be.electrodomesticos.ci.equipoMovil.monto=void 0,be.electrodomesticos.ci.equipoMovil.montoDisabled=!0)),"equipoMovil1"===t.id&&(t.checked?"SEGUROS"===be.rol&&(be.electrodomesticos.ci.equipoMovil.montoDisabled=!1):("SEGUROS"===be.rol&&(be.electrodomesticos.ci.equipoMovil.montoDisabled=!0),be.electrodomesticos.ci.equipoMovil.monto=void 0)),"asistenciaViajes1"===t.id&&(t.checked||be.jsonCoberturas.coberturas.extensionViajes&&(be.extensionViajes.c.checked=!1)),"extensionViajes1"===t.id&&t.checked&&(be.asistenciaViajes.c.checked=!0),pe()}function pe(){var e=be.edificio.c.monto?be.edificio.c.monto:0,t=be.contenidos.c.monto?be.contenidos.c.monto:0,n=.1*(parseFloat(e)+parseFloat(t));be.gastosExtras.c.monto=n,be.remocionEscombros.c.monto=n,be.edificio.ci.incendioEdificio.checked&&(be.edificio.ci.incendioEdificio.monto=e),be.edificio.ci.hidroEdificio.checked&&(be.edificio.ci.hidroEdificio.monto=e),be.edificio.ci.terremotoEdificio.checked&&(be.edificio.ci.terremotoEdificio.monto=e),be.contenidos.ci.incendioContenidos.checked&&(be.contenidos.ci.incendioContenidos.monto=be.contenidos.c.monto),be.contenidos.ci.hidroContenidos.checked&&(be.contenidos.ci.hidroContenidos.monto=be.contenidos.c.monto),be.contenidos.ci.terremotoContenidos.checked&&(be.contenidos.ci.terremotoContenidos.monto=be.contenidos.c.monto);var o=.3*e;if(be.edificio.ci.hidroEdificio.coberturasIntegrantes&&(be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.limiteMaximo=o,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.limiteMaximo=o,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.limiteMaximo=o,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.limiteMaximo=o,be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.limiteMaximo=o),be.edificio.ci.hidroEdificio.coberturasIntegrantes)if(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.checked||be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.checked||be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.checked||be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.checked){var a=be.edificio.ci.hidroEdificio.coberturasIntegrantes,r=a.limConstruccion.monto?a.limConstruccion.monto:0,i=a.limDesocupado.monto?a.limDesocupado.monto:0,s=a.limFija.monto?a.limFija.monto:0,c=a.limTerminado.monto?a.limTerminado.monto:0;be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto=r+i+s+c}else be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto=void 0;var o=.3*t;if(be.contenidos.ci.hidroContenidos.coberturasIntegrantes&&(be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.limiteMaximo=o,be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.limiteMaximo=o),o=.15*parseFloat(t),o<be.limiteMaximoCristales?be.cristales.c.limiteMaximo=o:be.cristales.c.limiteMaximo=be.limiteMaximoCristales,o=.8*parseFloat(t),o<be.limiteMaximoRoboMenaje?be.roboMenaje.c.limiteMaximo=o:be.roboMenaje.c.limiteMaximo=be.limiteMaximoRoboMenaje,"2"===be.tipoRiesgo.id?be.roboMenaje.c.monto=void 0:"ASESOR"===be.rol&&(be.roboMenaje.c.montoDisabled=!0,o=.5*parseFloat(t),o<be.limiteMaximoRoboMenaje?be.roboMenaje.c.monto=o:be.roboMenaje.c.monto=be.limiteMaximoRoboMenaje),o=.5*parseFloat(be.roboMenaje.c.monto),be.roboMenaje.ci.joyas.limiteMaximo=o,"ASESOR"===be.rol&&(be.roboMenaje.ci.joyas.monto=.5*be.roboMenaje.c.monto),be.roboMenaje.c.monto||(be.roboMenaje.ci.joyas.checked=!1,be.roboMenaje.ci.joyas.monto=void 0,be.roboMenaje.ci.joyas.montoDisabled=!0),"2"===be.tipoRiesgo.id?be.dinero.c.monto=void 0:"ASESOR"===be.rol&&(be.dinero.c.monto=be.dineroMontoInicial),be.dinero.c.monto&&(be.dinero.c.monto<be.limiteMaximoUsoTarjetas?be.dinero.ci.usoTarjetasDinero.limiteMaximo=be.dinero.c.monto:be.dinero.ci.usoTarjetasDinero.limiteMaximo=be.limiteMaximoUsoTarjetas),be.dinero.c.monto||(be.dinero.ci.usoTarjetasDinero.checked=!1,be.dinero.ci.usoTarjetasDinero.monto=void 0,be.dinero.ci.usoTarjetasDinero.montoDisabled=!0),"ASESOR"===be.rol&&(be.objetosPersonales.ci.bicicletasObjetos.checked?be.objetosPersonales.ci.bicicletasObjetos.monto=be.bicicletasMontoInicial:be.objetosPersonales.ci.bicicletasObjetos.monto=void 0),"ASESOR"===be.rol&&(be.objetosPersonales.ci.objetosObjetos.checked?be.objetosPersonales.ci.objetosObjetos.monto=be.objetosObjetosMontoInicial:be.objetosPersonales.ci.objetosObjetos.monto=void 0),be.objetosPersonales.c.checked){var u=be.objetosPersonales.ci,r=u.objetosObjetos.monto?u.objetosObjetos.monto:0,i=u.bicicletasObjetos.monto?u.bicicletasObjetos.monto:0;be.objetosPersonales.c.monto=r+i}o=.5*parseFloat(t),be.electrodomesticos.c.limiteMaximo=o;var l=.3*parseFloat(be.electrodomesticos.c.monto);"SEGUROS"===be.rol&&(l<be.limiteMaximoEquipoMovil?be.electrodomesticos.ci.equipoMovil.limiteMaximo=l:be.electrodomesticos.ci.equipoMovil.limiteMaximo=be.limiteMaximoEquipoMovil,be.electrodomesticos.c.monto||(be.electrodomesticos.ci.equipoMovil.checked=!1,be.electrodomesticos.ci.equipoMovil.monto=void 0,be.electrodomesticos.ci.equipoMovil.montoDisabled=!0)),"ASESOR"===be.rol&&(be.electrodomesticos.ci.equipoMovil.checked?l<be.equipoMovilMontoInicial?be.electrodomesticos.ci.equipoMovil.monto=l:be.electrodomesticos.ci.equipoMovil.monto=be.equipoMovilMontoInicial:be.electrodomesticos.ci.equipoMovil.monto=void 0),be.gastosAsalto.c.monto=void 0,be.asistenciaViajes.c.monto=void 0,be.gastosFinales.c.monto=void 0,be.extensionViajes.c&&(be.extensionViajes.c.monto=void 0),be.asistenciaInformatica.c&&(be.asistenciaInformatica.c.monto=void 0),be.asistenciaLegal.c&&(be.asistenciaLegal.c.monto=void 0),be.gastosAsalto.c.checked&&(be.gastosAsalto.c.monto="AMPARADO"),be.asistenciaViajes.c.checked&&(be.asistenciaViajes.c.monto="AMPARADO"),be.extensionViajes.c&&be.extensionViajes.c.checked&&(be.extensionViajes.c.monto="AMPARADO"),be.asistenciaInformatica.c&&be.asistenciaInformatica.c.checked&&(be.asistenciaInformatica.c.monto="AMPARADO"),be.asistenciaLegal.c&&be.asistenciaLegal.c.checked&&(be.asistenciaLegal.c.monto="AMPARADO"),be.gastosFinales.c.checked&&(be.gastosFinales.c.monto="AMPARADO")}function fe(){if(ge(be.edificio.c))return!0;if(be.edificio.ci.hidroEdificio.coberturasIntegrantes){if(ge(be.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio))return!0;if(ge(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado))return!0;if(ge(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado))return!0;if(ge(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion))return!0;if(ge(be.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija))return!0}if(ge(be.contenidos.c))return!0;if(be.contenidos.ci.hidroContenidos.coberturasIntegrantes){if(ge(be.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos))return!0;if(ge(be.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos))return!0}return!!ge(be.rcFamiliar.c)||(!!ge(be.cristales.c)||(!!ge(be.roboMenaje.c)||(!!ge(be.roboMenaje.ci.joyas)||(!!ge(be.dinero.c)||(!!ge(be.dinero.ci.usoTarjetasDinero)||(!(!be.objetosPersonales.ci.objetosObjetos||!ge(be.objetosPersonales.ci.objetosObjetos))||(!!ge(be.objetosPersonales.ci.bicicletasObjetos)||(!!ge(be.electrodomesticos.c)||!!ge(be.electrodomesticos.ci.equipoMovil)))))))))}function ge(e){return!(!e.checked||!(e.monto<e.limiteMinimo||e.monto>e.limiteMaximo||""===e.monto||void 0===e.monto))}function he(e){var t=2;if(e+="",e=parseFloat(e.replace(/[^0-9\.]/g,"")),t=t||0,isNaN(e)||0===e)return parseFloat(0).toFixed(t);e=""+e.toFixed(t);for(var n=e.split("."),o=/(\d+)(\d{3})/;o.test(n[0]);)n[0]=n[0].replace(o,"$1,$2");return n.join(".")}function ve(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t}function ye(e){for(var t="",n=0,o=0,a=0;n<e.length;)if((o=e.charCodeAt(n))<128)t+=String.fromCharCode(o),n++;else if(o>191&&o<224)a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2;else{a=e.charCodeAt(n+1);var r=e.charCodeAt(n+2);t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&r),n+=3}return t}var be=this,Ce=o.matchMedia("(max-width: 767px)");Ce.onchange=function(e){be.txtClass=e.target.matches?"text-left":"text-right"},be.pagina1=P,be.pagina2=E,be.pagina3=I,be.cleanForm=S,be.regresarMain=D,be.regresarPaginaCotizacion=M,be.cotizarContratar=A,be.validateBirthdateRFC=N,be.justAlphabet=w,be.justAlphanumeric=G,be.justNumeric=J,be.soloNumero=K,be.charrepeat=X,be.charrepeatText=Z,be.charrepeatTextTres=ee,be.soloTextAndNum=te,be.numberSecuential=oe,be.forceKeyPressUppercase=ae,be.calculaRFC=q,be.validarDatosACotizar=O,be.cotizarSeguroHogar=B,be.setValueGastosExtrasCasaHabitacion=re,be.setRemocionEscombros=ie,be.emisionSeguroHogar=U,be.changeSameAddress=m,be.imprimirCondiciones=H,be.printPolicy=Y,be.endEmission=_,be.isClienteObt=!1,be.getListaCotizaciones=k,be.getRolUsuario=x,be.backToEmission=z,be.yearExpirationList=[],be.monthExpirationList=[],be.cvvLen=3,be.accLen=16,be.txtClass=Ce.matches?"text-left":"text-right",be.selectBankId=y,be.selectTypeCard=b,be.emissionFunction=$,be.numPoliza="",be.jsonCotizacion={},be.primatotalImpresion="",be.emission={},be.cmd={kindPaid:{type:null}},be.cmd.emission={contract:null},be.stepForm={step:0,stepA:!1,stepB:!1,stepC:!1,stepD:!1},be.insurancePolicyDate=moment(new Date).format("YYYY-MM-DD"),be.policyMaturityDate=moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD");var Se=t.model;be.numeroCliente=Se?Se.numeroCliente:"",be.contract=Se?Se.contract:"",be.client=Se?Se.client:"",be.person=Se?Se.person:{},be.datosCliente=Se?Se.datosCliente:[],be.nombres=Se?Se.nombres:"",be.apePaterno=Se?Se.apePaterno:"",be.apeMaterno=Se?Se.apeMaterno:"",be.nombreCliente=Se?Se.nombreCliente:"",be.birthDay=Se?Se.birthDay:"",be.fiscalIDNumber=Se?Se.fiscalIDNumber:"",be.emailUser=Se?Se.emailUser:"",be.personType=Se?Se.personType:"1",be.phoneUser=Se?Se.phoneUser:"",be.importeEdificio="",be.limiteMaximoEquipoMovil=0,be.limiteMaximoCristales=0,be.limiteMaximoRoboMenaje=0,be.limiteMaximoRcFamiliar=0,be.limiteMaximoUsoTarjetas=0,be.dineroMontoInicial=0,be.bicicletasMontoInicial=0,be.objetosMontoInicial=0,be.equipoMovilMontoInicial=0,be.botonContratar="Cotizar",be.cotizacionSeleccionada=void 0,be.soloText=ne,be.pageSize=3,be.currentPage=1,be.disabledRFC=!!Se&&Se.disabledRFC,be.mostrarDatos=!!Se&&Se.mostrarDatos,be.validatePopup=!!Se&&Se.validatePopup,be.validatePerson=!!Se&&Se.validatePerson,be.roles=Se?Se.roles:[],be.rol=x(),be.revisaCotizaciones=T,be.tieneCotizaciones=!1,be.cargandoCotizacion=!1,be.datosCotizacion={},be.datosCotizados={},be.fechaNacimiento="",be.email="",be.rfc="",be.sexo="masculino",be.telefono="",be.fechaConstitutiva="",be.ContInsuredSum="",be.ExtExpHomeInsuredSum="",be.DebRemInsuredSum="",be.FamCivLiaInsuredSum="",be.ListCotizaciones=[],be.ListEntityFederativeHouse=function(){var e=[];return i.getCatalogEntityFederative().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.federalEntityID,text:t.federalEntityDescription})})}),e}(),be.ListMunicipalityHouse=[],be.ListBanksHouse=[],be.ListPostalCodeHouse=[],be.ListTypeCLABE=[{id:"1",text:"CLABE"},{id:"2",text:"DEBITO"}],be.optionsdpx={minDate:moment((new Date).setYear((new Date).getFullYear()-150)).format("DD/MM/YYYY"),maxDate:moment((new Date).setYear((new Date).getFullYear()-18)).format("DD/MM/YYYY")},be.optionsdpxPM={maxDate:moment((new Date).setYear((new Date).getFullYear())).format("DD/MM/YYYY")},be.ListCurrency=function(){return[{id:1,text:"PESOS"},{id:2,text:"DOLARES"}]}(),be.ListSecurityMeasurements=function(){return[{id:1,text:"VIGILANCIA"},{id:2,text:"ALARMA LOCAL/CENTRAL"},{id:3,text:"VIGILANCIA Y ALARMA LOCAL/CENTRAL"},{id:99999,text:"SIN MEDIDAS DE SEGURIDAD"}]}(),be.ListPaymentMethods=function(){return[{id:1,text:"CONTADO"},{id:2,text:"SEMESTRAL"},{id:3,text:"TRIMESTRAL"},{id:4,text:"MENSUAL"}]}(),be.ListBorderWall=function(){return[{id:"true",text:"SI"},{id:"false",text:"NO"}]}(),be.ListBanks=function(){var e=[];return console.log(),i.getCatalogBanksCars().then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.bankID,text:t.bankName})}),e.sort(function(e,t){return e.text.toLowerCase()<t.text.toLowerCase()?-1:e.text.toLowerCase()>t.text.toLowerCase()?1:0}))}),e}(),be.jsonCoberturas="{}",be.tipoRiesgo="",be.getCatalogRoof=l,be.getCatalogEntity=d,be.getCatalogCodes=p,be.getJsonCoberturas=le,be.getJsonCoberturasService=ue,be.onChangeTipoDeRiesgo=se,be.cambiaJoyasTipoDeRiesgo=ce,be.getCantidadLimite=de,be.realizaOperaciones=pe,be.validarTabla=fe,be.validarSiCumple=ge,be.formatCurrency=he,be.validaRFCFecha=V,be.validaFechaConRFC=Q,be.onChangeListMunicipality=g,be.onChangeListEntity=f,be.encode=ve,be.decode=ye,be.eventClickCheckbox=me,be.event="",be.edificio={},be.contenidos={},be.rcFamiliar={},be.roboMenaje={},be.dinero={},be.objetosPersonales={},be.electrodomesticos={},be.gastosAsalto={},be.gastosFinales={},be.gastosExtras={},be.remocionEscombros={},be.cristales={},be.asistenciaInformatica={},be.asistenciaLegal={},be.asistenciaViajes={},be.extensionViajes={},T(),function(){r.getCatalogInsuranceRiskType(1,1).then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.areaCode,text:e.description})}),be.listRiskType=t)}).catch(function(e){})}(),function(){r.getCatalogWallType().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.wallTypeID,text:e.wallType})}),be.listStructure=t)}).catch(function(e){})}(),be.datepicker_opts={minDate:new Date,isInvalidDate:function(e){return 0===e.day()||6===e.day()}};var De,Me,Ae;n.onClicSendEmailNotificationCotizationHogar=function(){var e="";try{"1"===be.personType.toString()&&(e=be.apePaterno+"  "+be.apeMaterno+" "+be.nombres),"2"===be.personType.toString()&&(e=be.nombreCliente),n.obJsonMail={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|17",emailSubject:"Envío de cotización seguro de hogar Actinver "+e.toUpperCase()+"("+be.datosCotizacion.numeroCotizacion+")",mailTo:[be.emailUser],mailCC:[""],ldrEdificio:"",ldrIncendioAdicionalesEdificio:"",ldrExplosionEdificio:"",ldrHuelAlbPopEdificio:"",ldrNavAreaVehiHumoEdificio:"",ldrFenHidroEdificio:"",ldrTerrErupVolcEdificio:"",ldrTodoRiesIncAdicEdificio:"",ldrContenido:"",ldrIncendioAdicionalesCont:"",ldrExplosionCont:"",ldrHuelAlbPopCont:"",ldrNavAereaVehiHumoCont:"",ldrFenHidroCont:"",ldrTerrErupVolcCont:"",ldrTodoRiesIncAdicCont:"",ldrRemocionEscombros:"",ldrIncendioRemocion:"",ldrFenHidroRemocion:"",ldrTerrErupVolcRemocion:"",ldrGasExtraCasaHabitacion:"",ldrIncendioGastExtras:"",ldrFenHidroGatExtras:"",ldrTerrErupVolcGastExtras:"",ldrRCFamiliar:"",ldrRCArrendatario:"",ldrRCTrabDomestico:"",ldrRoboDeMenaje:"",ldrRoboConViolencia:"",ldrRoboPorAsalto:"",ldrJoyasArtValor:"",ldrGtosMedAsaltDomicilio:"",ldrDineroValores:"",ldrCristales:"",ldrObjPersonales:"",lbrEqElectro:"",ldrAsistHogarViajes:"",ldrExtGarEnViajesNalEInt:"",ldrAsistLegal:"",ldrServDeAsistInformatica:"",dataHouseEntityRisk:be.cmd.dataHouseEntityRisk.type.text,dataHouseMunicipalityRisk:be.cmd.dataHouseMunicipalityRisk.type.text,dataHousePostalCodeRisk:be.cmd.dataHousePostalCodeRisk.type.text,kindPaid:be.cmd.kindPaid.type.text,currency:be.cmd.currency.type.text,calle:be.calle,kindRisk:be.cmd.kindRisk.type.text,kindStructure:be.cmd.kindStructure.type.text,kindRoof:be.cmd.kindRoof.type.text,securityActions:be.cmd.securityActions.type.text,primaTotalAnual:be.datosCotizacion.primaTotal,insurancePolicyDate:be.insurancePolicyDate,netPremium:be.datosCotizados.primaNeta,surcharge:be.datosCotizados.recargos,entitlement:be.datosCotizados.derechosPoliza,vat:be.datosCotizados.iva,adjoiningHomeFlag:be.cmd.borderWall.type.id},angular.forEach(be.datosCotizacion.coberturas.coverageInformation,function(e){"3000"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrEdificio="":n.obJsonMail.ldrEdificio=e.insuredSum),"3001"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioAdicionalesEdificio="AMPARADA":n.obJsonMail.ldrIncendioAdicionalesEdificio=e.insuredSum),"3002"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrExplosionEdificio="AMPARADA":n.obJsonMail.ldrExplosionEdificio=e.insuredSum),"3003"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrHuelAlbPopEdificio="AMPARADA":n.obJsonMail.ldrHuelAlbPopEdificio=e.insuredSum),"3004"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrNavAereaVehiHumoEdificio="AMPARADA":n.obJsonMail.ldrNavAereaVehiHumoEdificio=e.insuredSum),
"3020"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroEdificio="AMPARADA":n.obJsonMail.ldrFenHidroEdificio=e.insuredSum),"3021"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcEdificio="AMPARADA":n.obJsonMail.ldrTerrErupVolcEdificio=e.insuredSum),"3030"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTodoRiesIncAdicEdificio="AMPARADA":n.obJsonMail.ldrTodoRiesIncAdicEdificio=e.insuredSum),"3050"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrContenido="":n.obJsonMail.ldrContenido=e.insuredSum),"3051"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioAdicionalesCont="AMPARADA":n.obJsonMail.ldrIncendioAdicionalesCont=e.insuredSum),"3052"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrExplosionCont="AMPARADA":n.obJsonMail.ldrExplosionCont=e.insuredSum),"3053"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrHuelAlbPopCont="AMPARADA":n.obJsonMail.ldrHuelAlbPopCont=e.insuredSum),"3054"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrNavAereaVehiHumoCont="AMPARADA":n.obJsonMail.ldrNavAereaVehiHumoCont=e.insuredSum),"3070"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroCont="AMPARADA":n.obJsonMail.ldrFenHidroCont=e.insuredSum),"3071"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcCont="AMPARADA":n.obJsonMail.ldrTerrErupVolcCont=e.insuredSum),"3080"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTodoRiesIncAdicCont="AMPARADA":n.obJsonMail.ldrTodoRiesIncAdicCont=e.insuredSum),"3210"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrRemocionEscombros="":n.obJsonMail.ldrRemocionEscombros=e.insuredSum),"3211"===e.code.toString()&&""!==n.obJsonMail.ldrRemocionEscombros.toString()&&(n.obJsonMail.ldrRemocionEscombros.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioRemocion="AMPARADA":n.obJsonMail.ldrIncendioRemocion=e.insuredSum),"3212"===e.code.toString()&&""!==n.obJsonMail.ldrRemocionEscombros.toString()&&(n.obJsonMail.ldrRemocionEscombros.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroRemocion="AMPARADA":n.obJsonMail.ldrFenHidroRemocion=e.insuredSum),"3213"===e.code.toString()&&""!==n.obJsonMail.ldrRemocionEscombros.toString()&&(n.obJsonMail.ldrRemocionEscombros.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcRemocion="AMPARADA":n.obJsonMail.ldrTerrErupVolcRemocion=e.insuredSum),"3220"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrGasExtraCasaHabitacion="":n.obJsonMail.ldrGasExtraCasaHabitacion=e.insuredSum),"3221"===e.code.toString()&&""!==n.obJsonMail.ldrGasExtraCasaHabitacion.toString()&&(n.obJsonMail.ldrGasExtraCasaHabitacion.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioGastExtras="AMPARADA":n.obJsonMail.ldrIncendioGastExtras=e.insuredSum),"3222"===e.code.toString()&&""!==n.obJsonMail.ldrGasExtraCasaHabitacion.toString()&&(n.obJsonMail.ldrGasExtraCasaHabitacion.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroGatExtras="AMPARADA":n.obJsonMail.ldrFenHidroGatExtras=e.insuredSum),"3223"===e.code.toString()&&""!==n.obJsonMail.ldrGasExtraCasaHabitacion.toString()&&(n.obJsonMail.ldrGasExtraCasaHabitacion.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcGastExtras="AMPARADA":n.obJsonMail.ldrTerrErupVolcGastExtras=e.insuredSum),"3401"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrRCFamiliar="":n.obJsonMail.ldrRCFamiliar=e.insuredSum),"3442"===e.code.toString()&&""!==n.obJsonMail.ldrRCFamiliar.toString()&&(n.obJsonMail.ldrRCFamiliar.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRCArrendamiento="AMPARADA":n.obJsonMail.ldrRCArrendamiento=e.insuredSum),"3441"===e.code.toString()&&""!==n.obJsonMail.ldrRCFamiliar.toString()&&(n.obJsonMail.ldrRCFamiliar.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRCTrabDomestico="AMPARADA":n.obJsonMail.ldrRCTrabDomestico=e.insuredSum),"3500"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrRoboDeMenaje="":n.obJsonMail.ldrRoboDeMenaje=e.insuredSum),"3501"===e.code.toString()&&""!==n.obJsonMail.ldrRoboDeMenaje.toString()&&(n.obJsonMail.ldrRoboDeMenaje.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRoboConViolencia="AMPARADA":n.obJsonMail.ldrRoboConViolencia=e.insuredSum),"3502"===e.code.toString()&&""!==n.obJsonMail.ldrRoboDeMenaje.toString()&&(n.obJsonMail.ldrRoboDeMenaje.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRoboPorAsalto="AMPARADA":n.obJsonMail.ldrRoboPorAsalto=e.insuredSum),"3503"===e.code.toString()&&""!==n.obJsonMail.ldrRoboDeMenaje.toString()&&(n.obJsonMail.ldrRoboDeMenaje.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrJoyasArtValor="AMPARADA":n.obJsonMail.ldrJoyasArtValor=e.insuredSum),"3504"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrGtosMedAsaltDomicilio="":n.obJsonMail.ldrGtosMedAsaltDomicilio=e.insuredSum),"3520"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrDineroValores="":n.obJsonMail.ldrDineroValores=e.insuredSum),"3530"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrCristales="":n.obJsonMail.ldrCristales=e.insuredSum),"3550"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrObjPersonales="":n.obJsonMail.ldrObjPersonales=e.insuredSum),"3660"===e.code.toString()&&""!==n.obJsonMail.ldrObjPersonales.toString()&&(n.obJsonMail.ldrObjPersonales.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.lbrEqElectro="AMPARADA":n.obJsonMail.lbrEqElectro=e.insuredSum),"3910"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrAsistHogarViajes="AMPARADA":n.obJsonMail.ldrAsistHogarViajes=e.insuredSum)),"3911"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrExtGarEnViajesNalEInt="AMPARADA":n.obJsonMail.ldrExtGarEnViajesNalEInt=e.insuredSum)),"3920"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrAsistLegal="AMPARADA":n.obJsonMail.ldrAsistLegal=e.insuredSum)),"3921"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrServDeAsistInformatica="AMPARADA":n.obJsonMail.ldrServDeAsistInformatica=e.insuredSum))});var t=n.obJsonMail;r.sendEmailNotificationCotizationHome(t).then(function(e){e.success&&a.done("Correo Enviado")})}catch(e){}},n.onClicSendEmailNotificationCompraSeguro=function(){var e=-1!==window.location.href.indexOf("asesoria.actinver.com/asesoria")?"https://negocios.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+be.numPoliza+"&Endoso=0":"https://negociosuat.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+be.numPoliza+"&Endoso=0",t="1"===be.personType.toString()?be.apePaterno+"  "+be.apeMaterno+" "+be.nombres:be.nombreCliente,o=void 0===be.emailUser?"":be.emailUser,i=void 0===be.calle?"":be.calle,s=void 0===be.cmd.dataHouseEntityRisk?"":be.cmd.dataHouseEntityRisk.type.text,c=void 0===be.cmd.dataHouseMunicipalityRisk?"":be.cmd.dataHouseMunicipalityRisk.type.text,u=void 0===be.cmd.dataHousePostalCodeRisk?"":be.cmd.dataHousePostalCodeRisk.type.text,l=void 0===be.cmd.kindPaid?"":be.cmd.kindPaid.type.text,d=void 0===be.cmd.currency?"":be.cmd.currency.type.text,m=void 0===be.cmd.kindRisk?"":be.cmd.kindRisk.type.text,p=void 0===be.cmd.kindStructure?"":be.cmd.kindStructure.type.text,f=void 0===be.cmd.kindRoof?"":be.cmd.kindRoof.type.text,g=void 0===be.cmd.securityActions?"":be.cmd.securityActions.type.text,h=!!be.cotizacionSeleccionada,v=h?JSON.parse(be.cotizacionSeleccionada.quotationJsonIni):null;if(v&&v.catalogosCotizacion){var y=v.catalogosCotizacion;o=be.cotizacionSeleccionada.emailCliente,i=v.Street,s=y.dataHouseEntityRisk.type.text,c=y.dataHouseMunicipalityRisk.type.text,u=y.dataHousePostalCodeRisk.type.text,l=y.kindPaid.type.text,d=y.currency.type.text,m=y.kindRisk.type.text,p=y.kindStructure.type.text,f=y.kindRoof.type.text,g=y.securityActions.type.text}n.obJsonMail={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|18",emailSubject:"Póliza emitida seguro de hogar  "+t+" "+be.numPoliza,mailTo:o,mailCC:"",polizaSeguro:void 0===be.numPoliza?"":be.numPoliza,fechaInicioVigencia:void 0===be.insurancePolicyDate?"":moment(be.insurancePolicyDate).format("DD/MM/YYYY"),fechaFinVigencia:void 0===be.policyMaturityDate?"":moment(be.policyMaturityDate).format("DD/MM/YYYY"),fechaLimitePago:void 0===be.emission.payment.dateAprox?moment(new Date).format("DD/MM/YYYY"):moment(be.emission.payment.dateAprox).format("DD/MM/YYYY"),dataHouseEntityRisk:s,dataHouseMunicipalityRisk:c,dataHousePostalCodeRisk:u,kindPaid:l,currency:d,calle:i,kindRisk:m,kindStructure:p,kindRoof:f,securityActions:g,urlPolizaImpresion:e},""!==s?r.sendEmailNotificationEmisionHome(n.obJsonMail).then(function(e){e.success?a.done("Correo Enviado."):a.error("El correo no fue enviado.")}):a.error("El correo no fue enviado.")},n.updateSelection=function(e,t,n,o){var a=t.cotizacion;o.currentTarget.checked?(be.cotizacionSeleccionada=t,be.botonContratar="Contratar"):(be.cotizacionSeleccionada=void 0,be.botonContratar="Cotizar"),angular.forEach(n,function(e,t){a!==n[t].cotizacion&&(e.checked=!1)})}}e.$inject=["$state","$stateParams","$scope","$window","CommonModalsSrv","insuranceHousesSrv","insuranceCarSrv"],angular.module("actinver.controllers").controller("insuranceHousesCtrl",e)}(),function(){function e(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/[^0-9]/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t})}}}function t(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/[^a-zA-Z0-9 ]/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t})}}}function n(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/([a-zA-Z])\1{2,}/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t})}}}angular.module("actinver.controllers").directive("numbersOnly",e).directive("alphaNumeric",t).directive("repeatedLetter",n)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getCatalogPostalCode=function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogPostalCodeQuery+o,params:{language:"SPA",MunicipalityID:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outPostalCodeQuery.postalCodeList,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogInsuranceRiskType=function(o,a){return t(function(t,r){n({method:"GET",url:e.getCatalogInsuranceRiskTypeQuery+o+"/"+a,params:{language:"SPA",BusinessActivity:o,BusinessActivitySubtype:a}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceRiskTypeQuery.riskTypeList.riskTypeDetail,t({success:!0,info:n})):r({success:!1,info:e.data.outCommonHeader.result})},function(){r({success:!1,type:"not-found"})})})},o.prototype.getCatalogWallType=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogWallTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outWallTypeQuery.wallTypeList.wallTypeDetail,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogRoofType=function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogRoofTypeQuery+o,params:{language:"SPA",WallTypeID:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outRoofTypeQuery.roofTypeList.roofTypeDetail,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogStreetTypeQuery=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogStreetTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outStreetTypeQuery.streetTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogCardTypeQuery=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogCardTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceCardTypeQuery.cardTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogPaymentTypeQuery=function(){return console.log("hiola desde houses svr "),t(function(t,o){n({method:"GET",url:e.getCatalogPaymentTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outPaymentTypeQuery.paymentTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getListQuotations=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationSearch,params:o}).then(function(e){if(1===e.data.return.status){var n=e.data.return.data.listInsuranceQuotationRs;t({success:!0,info:n})}else t({success:!1,info:"not-found"})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getServiceCotizacionHome=function(o){return t(function(t,a){n({method:"POST",url:e.getServiceCotizacionHome,params:o}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outHomeInsuranceQuotation,t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getServiceEmisionHome=function(o){return t(function(t,a){n({method:"POST",url:e.getServiceEmisionHome,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outHomeInsurancePolicyRegistration,t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.updateQuotation=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationUpdate,params:o}).then(function(e){console.log("response update",e);var n;1===e.data.return.status?(n=e.data.return.data.listInsuranceQuotationRs[0],t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})},function e(){console.log("response update",e),a({success:!1,type:"not-found"})})})},o.prototype.getCoverage=function(){return t(function(t,o){n({method:"POST",url:e.getCoverage+"?language=SPA"}).then(function(e){if(console.log("Original:"),console.log(e),1===e.data.return.status){var n=e.data.return.data.listInsuranceCoverageRs;console.log("Lista de Coberturas: "+n),t({success:!0,info:n})}else t({success:!1,info:"not-found"})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCotizationAdd=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationAdd,params:o}).then(function(e){if(console.log("respuesta"),console.log(e),1===e.data.return.status){var n=e.data.return.data.listInsuranceQuotationRs;t({success:!0,info:n})}else t({success:!1,info:"not-found"})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCotizationUpdate=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationUpdate,params:o}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outHomeInsurancePolicyRegistration,t({success:!0,info:n})):t({success:!1,info:e.messages})},function(){a({success:!1,type:"not-found"})})})},o.prototype.sendEmailNotificationCotizationHome=function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationCotizationHome,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.sendEmailNotificationEmisionHome=function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationEmisionHome,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("insuranceHousesSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(e){var t=e.keyCode;if(t>=97&&t<=122&&!e.ctrlKey&&!e.metaKey&&!e.altKey){var n=t-32,o=e.target.selectionStart,a=e.target.selectionEnd;e.target.value=e.target.value.substring(0,o)+String.fromCharCode(n)+e.target.value.substring(a),e.target.setSelectionRange(o+1,o+1),e.preventDefault()}}function u(){window.open(q.urlPoliza,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function l(){window.open("img/pdfs/aviso-seguro.pdf","_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function d(){window.open("img/pdfs/condiciones-generales-mapfre.pdf","_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function m(){q=null,q=this,n.validatePerson=!1,n.nombreCompleto="",n.emailUser="",n.ListEntidades=[],n.ListMarks=[],n.ListModels=[],n.ListYears=[],n.ListPoblaciones=[],n.ListBanks=[],q.yearExpirationList=[],q.monthExpirationList=[],q.accLen=16,q.cvvLen=3,q.client="",q.person={},q.contract="",q.personType="1",q.contractUser=0,q.soloNumero=j,q.numberSecuential=z,q.charrepeatText=V,q.soloTextAndNum=Y,q.selectTypeCard=H,q.soloText=$,q.forceKeyPressUppercase=c,q.pagina1=p,q.pagina2=f,q.valCotizar=T,q.cotizar=k,q.cotizarDos=R,q.cotizarDosB=x,q.cotizarTres=N,q.cotizarTresB=w,q.cotizarCuatro=O,q.cotizarCinco=B,q.emisionPoliza=P,q.imprimirPoliza=u,q.imprimirAviso=l,q.imprimirCondiciones=d,q.datosCliente=[],q.mostrarDatos=!1,q.nombreCliente="",q.nombres="",q.apePaterno="",q.apeMaterno="",q.sexo="1",q.numeroCliente="",q.emailUser="",q.tipoVehiculo="",q.marcaVehiculo="",q.modeloVehiculo="",q.anioVehiculo="",q.estado="",q.poblacion="",q.codigoPostal="",q.uso="",q.intUser="",q.autoSustituto=!1,q.garantiaSobreRuedas=!1,q.catastrofica=!1,q.charrepeat=_,q.typeCobertura="",q.formaPago="",q.cmd={},q.formaPagoUser="",q.activaBoton=!1,q.poliza="",q.placasVehiculo="",q.fechaNacimiento="",q.birthDay="",q.phoneUser="",q.mobileUser="",q.PrimaTotal=0,q.PrimaTotalRecibo=0,q.Recibossubcuentes=0,q.PrimaTotalReciboSubcuentes=0,q.InstitucionText="",q.NumeroTarjeta="",q.errorMessagePerMoral="Por el momento no se puede cotizar a personas Morales",q.errorMessageAsociado="El cliente solicitado no está asociado al Asesor",q.mostrarFactura=!1,q.mostrarFacturaDos=!1,q.validaFechaFactura=h,q.validaFormaCotizacion=v,q.validaFormaFactura=!1,q.fechaFactura="",q.numeroFactura="",q.importeFactura="",q.buscar=!0,q.tipoPersonalidad=!1,q.seleccionaPersonalidad=F,q.formaPagoUser="",q.contract="",q.placasVehiculo="",q.motorVehiculo="",q.serieVehiculo="",q.garantiaSobreRuedas="",q.autoSustituto="",q.cmd=[],q.formaPago="",q.nombreCard="",q.nombres="",q.apellidoPCard="",q.apePaterno="",q.apellidoMCard="",q.apeMaterno="",q.email1="",q.nombres="",q.apePaterno="",q.apeMaterno="",q.emailUser="",q.typeAcount="",q.acount="",q.typeCard="",q.cvv="",q.codigoPostal="",q.calleUser="",q.extUser="",q.intUser="",q.colonia="",q.numeroCliente="",q.birthDay="",q.fechaNacimiento="",q.mobileUser="",q.phoneUser="",q.nacionality="",q.profesion="",q.identificacion="",q.identificationNumber="",e.go("insurance.main",{model:null})}function p(){var e=t.model;n.validatePerson=!1,n.nombreCompleto="",n.emailUser="",n.ListEntidades=[],n.ListMarks=[],n.ListModels=[],n.ListYears=[],n.ListPoblaciones=[],n.ListBanks=[],q.personType=e.personType,q.mostrarDatos=e.mostrarDatos,q.nombreCliente=e.nombreCliente,q.nombres=e.nombres,q.apePaterno=e.apePaterno,q.apeMaterno=e.apeMaterno,q.sexo="1",q.numeroCliente=e.numeroCliente,q.emailUser=e.emailUser,q.tipoVehiculo=e.tipoVehiculo,q.marcaVehiculo="",q.modeloVehiculo="",q.anioVehiculo="",q.estado="",q.poblacion="",q.codigoPostal="",q.uso="",q.intUser="",q.autoSustituto=!1,q.garantiaSobreRuedas=!1,q.catastrofica=!1,q.typeCobertura="",q.formaPago="",q.cmd={},q.formaPagoUser="",q.activaBoton=!1,q.poliza="",q.placasVehiculo="",q.birthDay=e.birthDay,q.fechaNacimiento="",q.phoneUser="",q.mostrarFactura=!1,q.mostrarFacturaDos=!1,q.validaFechaFactura=h,q.validaFormaCotizacion=v,q.validaFormaFactura=!1,q.fechaFactura="",q.numeroFactura="",q.importeFactura="",q.buscar=!0,q.tipoPersonalidad=!1,q.seleccionaPersonalidad=F,q.validatePoup=e.validatePopup,q.client=e.client,q.person=e.person,q.contract=e.contract,q.datosCliente=e.datosCliente,q.fiscalIDNumber=e.fiscalIDNumber,q.disabledRFC=e.disabledRFC,q.stepForm={step:3,stepA:!1,stepB:!1,stepC:!0,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!1},T()}function f(){q.stepForm={step:2,stepA:!1,stepB:!0,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!1};var t={numeroCliente:q.numeroCliente,emailUser:q.emailUser,tipoVehiculo:q.tipoVehiculo,personType:q.personType,datosCliente:q.datosCliente,nombres:q.nombres,apePaterno:q.apePaterno,apeMaterno:q.apeMaterno,contract:q.contract,fiscalIDNumber:q.fiscalIDNumber,disabledRFC:q.disabledRFC,mostrarDatos:q.mostrarDatos,contract:q.contract,nombreCliente:q.nombreCliente,birthDay:q.birthDay,client:q.client,person:q.person,validatePopup:q.validatePoup};e.go("insurance.main",{model:t})}function g(){q.stepForm={step:4,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!0,stepE:!1,stepF:!1,stepG:!1,stepH:!1}}function h(){moment(q.fechaFactura),moment(new Date)}function v(){"true"===q.cotizacionFactura?(q.mostrarFacturaDos=!0,q.validaFormaFactura=!0):(q.mostrarFacturaDos=!1,q.validaFormaFactura=!1)}function y(e){var t=e.mode,n=e.date,o=new Date;o.setTime(n);var a=o.getTime()>=K&&o.getTime()<=J;return"day"===t&&!a}function b(){for(var e=[],t=(new Date).getFullYear(),n=0;n<9;n++)e.push({id:t+n,text:t+n});return e}function C(){for(var e,t=[],n=1;n<=12;n++)e=n<10?"0"+n:n,t.push({id:e,text:e});return t}function S(){var e=[],t=new Date,n=new Date(t.getFullYear(),t.getMonth()+12,0),o=n.getFullYear(),a=0;for(a=0;a<40;a++)e.push({id:o-a,text:o-a});return e}function D(){var e=[];return s.getCatalogEntityFederative().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.federalEntityID,text:t.federalEntityDescription})})}),e}function M(){var e=[];return s.getCatalogBanksCars().then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.bankID,text:t.bankName})}),e.sort(function(e,t){return e.text.toLowerCase()<t.text.toLowerCase()?-1:e.text.toLowerCase()>t.text.toLowerCase()?1:0}))}),e}function A(e){q.PrimaTotalRecibo=0,q.Recibossubcuentes=0,q.PrimaTotalReciboSubcuentes=0;var t=e.split("</Recibo>"),n="",o=0,a=t.length-1;q.Recibossubcuentes=a-1;for(o=0;o<a;o++)n=t[o],0===o?q.PrimaTotalRecibo=n.substring(n.indexOf("<PrimaTotal>")+12,n.indexOf("</PrimaTotal>")):1===o&&(q.PrimaTotalReciboSubcuentes=n.substring(n.indexOf("<PrimaTotal>")+12,n.indexOf("</PrimaTotal>")))}function P(){var e={language:"SPA",agentID:n.$parent.agentSelected.id};e=E(e),s.getServiceEmision(e).then(function(e){if(e.success){var t=e.info,n=t.indexOf("<Poliza>"),o=t.toString();if(-1===n){var a="",r=t.indexOf("<error>");-1!==r&&(a=o.substring(o.indexOf("<error>")+7,o.indexOf("</error>"))),r=t.indexOf('<poliza error="true" NUM_POLIZA="">'),-1!==r&&(a=o.substring(o.indexOf('<poliza error="true" NUM_POLIZA="">')+35,o.indexOf("</poliza>"))),i.error("Error en la Emision CODE: "+a)}else{var s=o.substring(o.indexOf("<Recibos>")+9,o.indexOf("</Recibos>"));q.poliza=o.substring(o.indexOf("<Poliza>")+8,o.indexOf("</Poliza>")),q.PrimaTotal=o.substring(o.indexOf("<PrimaTotal>")+12,o.indexOf("</PrimaTotal>")),q.urlPoliza=-1!==window.location.href.indexOf("asesoria.actinver.com/asesoria")?"https://negocios.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+q.poliza+"&Endoso=0":"https://negociosuat.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+q.poliza+"&Endoso=0",A(s);var c=void 0!==q.cmd.dataCarsAccountIdBanks?q.cmd.dataCarsAccountIdBanks.text:"",u=void 0!==q.acount?q.acount:"";""!==c&&(q.InstitucionText=c,q.NumeroTarjeta=u),i.done("Emisión Exitosa. Número de póliza: "+q.poliza),q.stepForm={step:8,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!0}}}else i.error("Error en la Emision.")})}function E(e){var t=void 0!==q.cmd.dataCarsMarks?q.cmd.dataCarsMarks.id:null,n=void 0!==q.cmd.dataCarsModels?q.cmd.dataCarsModels.id:null,o=void 0!==q.cmd.dataCarsYears?q.cmd.dataCarsYears.type.id:null,a=void 0!==q.catastrofica?q.catastrofica?1:0:null,r=void 0!==q.cotizacionFactura&&q.cotizacionFactura;return e.cobertura=q.typeCobertura,e.SumAssured=1===a?3e6:0,e.instruPago=q.formaPagoUser,e.InsurancePolicyDate=moment(q.fechaAprox).format("DD/MM/YYYY"),e.contrato=q.contract,e.BrandID=t,e.ModelID=n,e.placa=q.placasVehiculo,e.numMotor=q.motorVehiculo,e.numSerie=q.serieVehiculo,e.Year=o,e.garRueda=void 0!==q.garantiaSobreRuedas?q.garantiaSobreRuedas?1:0:null,e.garCatastr=a,e.garAutoSus=void 0!==q.autoSustituto?q.autoSustituto?1:0:null,e.bancoId=void 0!==q.cmd.dataCarsAccountIdBanks?q.cmd.dataCarsAccountIdBanks.id:0,e.fraccPago=void 0!==q.formaPago?q.formaPago:0,e.DelegationMunicipalityID=void 0!==q.cmd.dataCarsMunicipality?q.cmd.dataCarsMunicipality.id:null,e.nomCard=void 0!==q.nombreCard?q.nombreCard:q.nombres,e.ape1Card=void 0!==q.apellidoPCard?q.apellidoPCard:q.apePaterno,e.ape2TCard=void 0!==q.apellidoMCard?q.apellidoMCard:q.apeMaterno,e.emailCard=void 0!==q.email1?q.email1:"",e.emailTercero=void 0!==q.email1?q.email1:q.emailUser,"domCredito"===q.formaPagoUser?q.typeAcount="TA":"domDebito"===q.formaPagoUser&&(q.typeAcount="BA"),"1"===q.personType?(e.MCA_FISICO="S",e.nomTercero=q.nombres,e.ape1Tercero=q.apePaterno,e.ape2Tercero=q.apeMaterno):"2"===q.personType&&(e.MCA_FISICO="N",e.nomTercero=q.nombreCliente,e.ape1Tercero=null,e.ape2Tercero=null),e.MCA_SEXO=q.sexo,e.tipoPago=void 0!==q.typeAcount?q.typeAcount:null,e.numTarj=void 0!==q.acount?q.acount:null,e.tipoTarj=void 0!==q.typeCard?q.typeCard:null,e.fechVencTarj=void 0!==q.comboYearExpiration&&void 0!==q.comboMonthExpiration?["01",q.comboMonthExpiration.id,q.comboYearExpiration.id].join("/"):null,e.codTarj=void 0!==q.cvv?q.cvv:null,e.codPostal=q.codigoPostal,e.calleNumeros=q.calleUser+" "+q.extUser+" "+q.intUser,e.colonia=q.colonia,e.StateID=void 0!==q.cmd.dataCarsEntity.id?q.cmd.dataCarsEntity.id:null,e.DES_VIP=q.numeroCliente,e.COD_DOCUM=q.fiscalIDNumber,e.FEC_NACIMIENTO=void 0!==q.birthDay&&""!==q.birthDay?q.birthDay:moment(q.fechaNacimiento).format("DD/MM/YYYY"),e.TLF_MOVIL=q.mobileUser,e.TLF_NUMERO=q.phoneUser,e.InvoiceFlag=r,r?(e.NUM_FACTURA=q.numeroFactura,e.VAL_FACTURA=q.importeFactura,e.FEC_FACTURA=moment(q.fechaFactura).format("DDMMYYYY")):(e.NUM_FACTURA=null,e.VAL_FACTURA=null,e.FEC_FACTURA=null),e}function I(){var e={},t=void 0!==q.cmd.dataCarsEntity.id?q.cmd.dataCarsEntity.id:null,o=void 0!==q.cmd.dataCarsMunicipality?q.cmd.dataCarsMunicipality.id:null,a=void 0!==q.cmd.dataCarsMarks?q.cmd.dataCarsMarks.id:null,r=void 0!==q.cmd.dataCarsModels?q.cmd.dataCarsModels.id:null,i=void 0!==q.cotizacionFactura&&q.cotizacionFactura;return e.BrandID=null!==a?a:"3",e.DelegationMunicipalityID=null!==o?o:"9001",e.ModelID=null!==r?r:"517",e.StateID=null!==t?t:"9",e.InvoiceFlag=i,i?(e.InvoiceNumber=q.numeroFactura,e.InvoiceValue=q.importeFactura,e.InvoiceDate=moment(q.fechaFactura).format("YYYY-MM-DD")):(e.InvoiceNumber=null,e.InvoiceValue=null,e.InvoiceDate=null),e.SubstituteCarCoverageFlag=q.autoSustituto,e.WarrantyCoverageFlag=q.garantiaSobreRuedas,e.CatastrophicCoverageFlag=q.catastrofica,q.catastrofica?e.SumAssured=3e6:e.SumAssured=0,e.PaymentType="AG",e.PaymentMethod=q.formaPago,e.Year=q.cmd.dataCarsYears.type.id,e.planType=q.typeCobertura,e.idCliente=""!==q.numeroCliente?q.numeroCliente:"0",e.agentID=n.$parent.agentSelected.id,e}function T(){n.ListYears=S(),n.ListBanks=M(),n.ListEntidades=D(),q.yearExpirationList=b(),q.monthExpirationList=C(),""!==q.nombreCliente&&!1===q.validatePoup?i.confirm("¿"+q.nombreCliente+" es el asegurado titular de la cuenta?").result.then(function(){void 0!==q.datosCliente.email?k(!0,q.nombreCliente,q.datosCliente.email[0].email):k(!1,"",""),q.validatePoup=!0}).catch(function(e){"cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e||(q.client="",q.person={},q.contract="",q.datosCliente=[],q.fiscalIDNumber="",q.disabledRFC=!1,q.nombreCliente="",q.nombres="",q.apePaterno="",q.apeMaterno="",q.contract="",q.validatePoup=!0,q.mostrarDatos=!1,k(!1,"",""))}):k(!1,"","")}function k(e,t,n){q.stepForm={step:3,stepA:!1,stepB:!1,stepC:!0,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!1},q.validatePerson=e,!0===q.validatePerson&&(q.emailUser=n)}function R(){q.nombreCliente=q.nombres+" "+q.apePaterno+" "+q.apeMaterno,q.stepForm={step:4,stepA:!1,stepB:!1,stepC:!1,stepD:!0,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!1}}function x(){try{if(void 0!==q.cotizacionFactura&&q.mostrarFacturaDos&&"true"===q.cotizacionFactura&&""===q.fechaFactura)return i.error("Favor de Capturar el campo de Fecha de Factura"),!1;window.scrollTo(0,angular.element("cotizacion").offsetTop),q.datosCotizacion={};var e=I();s.getServiceCotizacion(e).then(function(e){e.success?(q.datosCotizacion=e.info,g()):i.error("Error en el Servicio, no se encuentra disponible - code: "+e.info.transactionID)})}catch(e){i.error("Error en el Servicio, no se encuentra disponible - faltaron llenar datos en las paginas Anteriores ")}}function N(){window.scrollTo(0,angular.element("pantallaCinco").offsetTop),""===q.numeroCliente||"0"===q.numeroCliente?i.error("Para el proceso de contratación, el interesado debe ser cliente Actinver"):q.stepForm={step:5,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!0,stepF:!1,stepG:!1,stepH:!1}}function w(){q.yearExpirationList=b(),
q.monthExpirationList=C(),"sinDom"===q.formaPagoUser?N():(window.scrollTo(0,angular.element("pantallaSeis").offsetTop),""===q.numeroCliente||"0"===q.numeroCliente?i.error("Para el proceso de contratación, el interesado debe ser cliente Actinver"):q.stepForm={step:6,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!0,stepG:!1,stepH:!1})}function O(){if(q.disabledRFC)q.bnd=!0;else{if(""===q.fechaNacimiento)return"1"===q.personType?void i.error("Favor de Capturar el campo de Fecha de Nacimiento"):void i.error("Favor de Capturar el campo de Fecha Constitutiva");Q()}q.bnd&&(q.email1=q.emailUser,"sinDom"===q.formaPagoUser?B():q.stepForm={step:6,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!0,stepG:!1,stepH:!1})}function B(){q.stepForm={step:7,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!0,stepH:!1}}function L(){q.datosCliente="",q.fiscalIDNumber="",q.disabledRFC=!1,q.nombreCliente="",q.nombres="",q.apePaterno="",q.apeMaterno="",q.contract="",q.mostrarDatos=!1,q.numeroCliente="9999",q.birthDay="",q.fechaNacimiento="",q.buscar=!1,q.tipoPersonalidad=!0}function F(e){q.personType=e,f()}function j(e){var t=new RegExp("^[0-9]+$"),n=void 0!==event.charCode?event.charCode:event.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==event.charCode)return event.preventDefault(),!1}function $(e){var t=new RegExp("^[ña-zA-Z ]+$"),n=void 0!==event.charCode?event.charCode:event.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==event.charCode)return event.preventDefault(),!1}function Y(e,t){var n=t?new RegExp("^[a-zA-Z0-9 ]+$"):new RegExp("^[a-zA-Z0-9]+$"),o=void 0!==event.charCode?event.charCode:event.which,a=String.fromCharCode(o);return 241===event.which||209===event.which||225===event.which||233===event.which||237===event.which||243===event.which||250===event.which||193===event.which||201===event.which||205===event.which||211===event.which||218===event.which||(n.test(a)||0===event.charCode?void 0:(event.preventDefault(),!1))}function H(){if(q.acount)switch(q.acount.toString().substr(0,1)){case"3":q.typeCard="3";break;case"4":q.typeCard="1";break;case"5":q.typeCard="2"}}function _(e,t){var n=void 0!==event.charCode?event.charCode:event.which,o=void 0!==t?t.toUpperCase():String.fromCharCode(n).toUpperCase();if(o.length>2){var a=o.substring(o.length-3,o.length);if(U(a)){if(W=a.substring(0,1),X=a.substring(1,2),Z=a.substring(2,3),W.toString()===X.toString()&&X.toString()===Z.toString())return event.preventDefault(),!1}else if(W=a.substring(0,1),X=a.substring(1,2),Z=a.substring(2,3),parseInt(X)===parseInt(Z)-1&&parseInt(W)===parseInt(X)-1)return event.preventDefault(),!1}return!1}function U(e){return/^[1-9]+[0-9]*]*$/.test(e),!0}function z(e,t){var n=angular.element("#"+t).val();return n=void 0===n?"":n,"01"!==n.toString()&&"001"!==n.toString()?!(n.toString().length>5&&"01234567890000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999".includes(n.toString())&&(e.preventDefault(),1)):(e.preventDefault(),!1)}function V(e,t){var n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n).toUpperCase(),a=angular.element("#"+t).val().toString().toUpperCase();if(a=void 0===a?"":a,a.substring(a.length-1,a.length)===o&&a.substring(a.length-2,a.length-1)===o)return e.preventDefault(),!1}function Q(){q.bnd=!1;var e=q.fechaNacimiento;e=moment(e).format("DD/MM/YYYY");var t=q.fiscalIDNumber,n="",o=e.split("/");n+=o[2].substring(2,4),n+=o[1],n+=o[0],"1"===q.personType?n===t.substring(4,10)?q.bnd=!0:i.error("La fecha de nacimiento no coincide con la fecha del RFC"):"2"===q.personType&&(n===t.substring(3,9)?q.bnd=!0:i.error("La fecha constitutiva no coincide con la fecha del RFC"))}var q=this,G=a.matchMedia("(max-width: 767px)");if(G.onchange=function(e){q.txtClass=e.target.matches?"text-left":"text-right"},!t.model)return e.go("insurance.main"),"";n.validatePerson=!1,n.nombreCompleto="",n.emailUser="",n.ListEntidades=[],n.ListMarks=[],n.ListModels=[],n.ListYears=[],n.ListPoblaciones=[],n.ListBanks=[],q.yearExpirationList=[],q.monthExpirationList=[],q.cvvLen=3,q.accLen=16,q.txtClass=G.matches?"text-left":"text-right",q.validatePoup=!1,q.client="",q.person={},q.contract="",q.personType="1",q.contractUser=0,q.reinicia=m,q.cotizarNoCliente=L,q.soloNumero=j,q.numberSecuential=z,q.charrepeatText=V,q.soloTextAndNum=Y,q.selectTypeCard=H,q.soloText=$,q.forceKeyPressUppercase=c,q.pagina1=p,q.pagina2=f,q.valCotizar=T,q.cotizar=k,q.cotizarDos=R,q.cotizarDosB=x,q.cotizarTres=N,q.cotizarTresB=w,q.cotizarCuatro=O,q.cotizarCinco=B,q.emisionPoliza=P,q.imprimirPoliza=u,q.imprimirAviso=l,q.imprimirCondiciones=d,q.datosCliente=[],q.fiscalIDNumber="",q.disabledRFC=!1,q.bnd=!1,q.mostrarDatos=!1,q.nombreCliente="",q.nombres="",q.apePaterno="",q.apeMaterno="",q.sexo="1",q.numeroCliente="",q.emailUser="",q.tipoVehiculo="",q.marcaVehiculo="",q.modeloVehiculo="",q.anioVehiculo="",q.estado="",q.poblacion="",q.codigoPostal="",q.uso="",q.intUser="",q.autoSustituto=!1,q.garantiaSobreRuedas=!1,q.catastrofica=!1,q.charrepeat=_,q.typeCobertura="",q.formaPago="",q.cmd={},q.formaPagoUser="",q.activaBoton=!1,q.poliza="",q.placasVehiculo="",q.fechaNacimiento="",q.birthDay="",q.phoneUser="",q.mobileUser="",q.PrimaTotal=0,q.PrimaTotalRecibo=0,q.Recibossubcuentes=0,q.PrimaTotalReciboSubcuentes=0,q.InstitucionText="",q.NumeroTarjeta="",q.errorMessagePerMoral="Por el momento no se puede cotizar a personas Morales",q.errorMessageAsociado="El cliente solicitado no está asociado al Asesor",q.mostrarFactura=!1,q.mostrarFacturaDos=!1,q.validaFechaFactura=h,q.validaFormaCotizacion=v,q.validaFormaFactura=!1,q.fechaFactura="",q.numeroFactura="",q.importeFactura="",q.buscar=!0,q.tipoPersonalidad=!1,q.seleccionaPersonalidad=F,p();var J=moment(),K=moment().subtract(60,"days");q.optionsFechaFactura={initDate:o.getTodayDate,showWeeks:!1,formatMonth:"MMM",yearColumns:3,minDate:K,dateDisabled:y},n.onChangeListMarks=function(e,t){if(n.ListMarks=[],t){n.years=t.id,q.anioVehiculo=t.text;var o=(new Date).getFullYear();q.anioVehiculo>=o-1?(q.mostrarFactura=!0,q.mostrarFacturaDos=!1):(q.mostrarFactura=!1,q.mostrarFacturaDos=!1,q.cotizacionFactura=void 0),s.getCatalogMarksCars(n.years).then(function(e){e.success&&angular.forEach(e.info,function(e){n.ListMarks.push({id:e.brandID,text:e.brand})})})}},n.onChangeModels=function(){n.ListModels=[],void 0!==q.cmd.dataCarsModels&&(q.cmd.dataCarsModels=[]),q.cmd.dataCarsMarks&&n.years&&(n.marks=q.cmd.dataCarsMarks.id,q.marcaVehiculo=q.cmd.dataCarsMarks.text,s.getCatalogModelsCars(n.years,q.cmd.dataCarsMarks.id).then(function(e){e.success&&angular.forEach(e.info,function(e){n.ListModels.push({id:e.modelID,text:e.model})})}))},n.selectModelsCar=function(e,t){n.models=t.id,q.modeloVehiculo=t.text},n.onChangeListEntity=function(){n.ListPoblaciones=[],q.cmd.dataCarsEntity&&(q.estado=q.cmd.dataCarsEntity.text,n.entityId=q.cmd.dataCarsEntity.id,s.getCatalogMunicipalityCars(q.cmd.dataCarsEntity.id).then(function(e){e.success&&angular.forEach(e.info,function(e){n.ListPoblaciones.push({id:e.municipalityID,text:e.delegationOrMunicipality})})}))},n.selectPoblacion=function(){q.cmd.dataCarsMunicipality&&(n.poblacionId=q.cmd.dataCarsMunicipality.id,q.poblacion=q.cmd.dataCarsMunicipality.text)},n.selectBankId=function(){q.cvv="",q.acount="",n.bankID=q.cmd.dataCarsAccountIdBanks.id,q.cmd.dataCarsAccountIdBanks.text.toString().toUpperCase().startsWith("AMERICAN EXPRESS")?(q.accLen=15,q.cvvLen=4,q.typeCard="3"):(q.accLen=16,q.cvvLen=3,q.typeCard="")},q.datepicker_opts={minDate:new Date,isInvalidDate:function(e){return 0===e.day()||6===e.day()}},q.optionsdpx={minDate:moment((new Date).setYear((new Date).getFullYear()-150)).format("DD/MM/YYYY"),maxDate:moment((new Date).setYear((new Date).getFullYear()-18)).format("DD/MM/YYYY")},q.optionsdpxPM={maxDate:moment((new Date).setYear((new Date).getFullYear())).format("DD/MM/YYYY")},q.Banks=void 0!==q.cmd.dataCarsAccountIdBanks?q.cmd.dataCarsAccountIdBanks.text:null,q.datosCotizacion={},n.onValidateDuplicateTel=function(e,t){var n=0,o=0;if("c"===t){if(n=void 0!==q.phoneUser?q.phoneUser:0,o=void 0!==e?e:0,n===o&&0!==n&&0!==o)return i.error("Favor de Capturar un Celular Diferente"),!1}else if("f"===t&&(n=void 0!==e?e:0,o=void 0!==q.mobileUser?q.mobileUser:0,n===o&&0!==n&&0!==o))return i.error("Favor de Capturar un Telefono Diferente"),!1},n.onClicSendEmailNotificationCotization=function(){var e=void 0===q.cotizacionFactura?"false":q.cotizacionFactura;try{n.obJsonMail={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|9",emailSubject:"Envío de cotización seguro de auto Actinver "+q.nombreCliente,mailTo:[q.emailUser],mailCC:[""],fCotizacion:e,packageType:q.typeCobertura,ldrDanosMateriales:"",ldrRoboTotal:"",deducibleDanosMateriales:"",ldrRespCivilBienes:"",ldrRespCivilPersonas:"",ldrGastosMedicosOcup:"",ldrAsistenciaCompleta:"",ldrDefensaJuridica:"",ldrRoboParcial:"",ldrDevPrimaDeducible:"",ldrCoberIntegralExtranjero:"",ldrAutoSustituto:"",ldrGarantiaSobreRuedas:"",ldrRCCatastroficaMuerteAccidental:"",deducibleRoboTotal:"",deducibleRespCivilBienes:"",deducibleRespCivilPersonas:"",deducibleGastMedicOcupantes:"",deducibleAsistenciaCompleta:"",deducibleDefensaJuridica:"",deducibleRoboParcial:"",deducibleDevPrimaDeducible:"",deducibleCoberIntegralExtranjero:"",deducibleAutoSustituto:"",deducibleGarantiaSobreRuedas:"",deducibleRCCatastroficaMuerteAccidental:"",primaTotalAnual:q.datosCotizacion.insurancePaymentData.totalPayments,tipoVehiculo:q.tipoVehiculo,marcaVehiculo:q.marcaVehiculo,modeloVehiculo:q.modeloVehiculo,anioVehiculo:q.anioVehiculo},angular.forEach(q.datosCotizacion.coverageList.coverageInformation,function(e){"4000"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrDanosMateriales="AMPARADA":n.obJsonMail.ldrDanosMateriales=e.sumAssured,n.obJsonMail.deducibleDanosMateriales=e.deductible),"4001"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrRoboTotal="AMPARADA":n.obJsonMail.ldrRoboTotal=e.sumAssured,n.obJsonMail.deducibleRoboTotal=e.deductible),"4003"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrAsistenciaCompleta="AMPARADA":n.obJsonMail.ldrAsistenciaCompleta=e.sumAssured,n.obJsonMail.deducibleAsistenciaCompleta=e.deductible),"4004"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrDefensaJuridica="AMPARADA":n.obJsonMail.ldrDefensaJuridica=e.sumAssured,n.obJsonMail.deducibleDefensaJuridica=e.deductible),"4006"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrGastosMedicosOcup="AMPARADA":n.obJsonMail.ldrGastosMedicosOcup=e.sumAssured,n.obJsonMail.deducibleGastMedicOcupantes=e.deductible),"4010"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrRespCivilBienes="AMPARADA":n.obJsonMail.ldrRespCivilBienes=e.sumAssured,n.obJsonMail.deducibleRespCivilBienes=e.deductible),"4011"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrRespCivilPersonas="AMPARADA":n.obJsonMail.ldrRespCivilPersonas=e.sumAssured,n.obJsonMail.deducibleRespCivilPersonas=e.deductible),"4014"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrDevPrimaDeducible="AMPARADA":n.obJsonMail.ldrDevPrimaDeducible=e.sumAssured,n.obJsonMail.deducibleDevPrimaDeducible=e.deductible),"4022"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrRoboParcial="AMPARADA":n.obJsonMail.ldrRoboParcial=e.sumAssured,n.obJsonMail.deducibleRoboParcial=e.deductible),"4024"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrAutoSustituto="AMPARADA":n.obJsonMail.ldrAutoSustituto=e.sumAssured,n.obJsonMail.deducibleAutoSustituto=e.deductible),"4048"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrCoberIntegralExtranjero="AMPARADA":n.obJsonMail.ldrCoberIntegralExtranjero=e.sumAssured,n.obJsonMail.deducibleCoberIntegralExtranjero=e.deductible),"4053"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrGarantiaSobreRuedas="AMPARADA":n.obJsonMail.ldrGarantiaSobreRuedas=e.sumAssured,n.obJsonMail.deducibleGarantiaSobreRuedas=e.deductible),"4068"===e.code.toString()&&("1"===e.sumAssured?n.obJsonMail.ldrRCCatastroficaMuerteAccidental="AMPARADA":n.obJsonMail.ldrRCCatastroficaMuerteAccidental=e.sumAssured,n.obJsonMail.deducibleRCCatastroficaMuerteAccidental=e.deductible)});var t=n.obJsonMail;s.sendEmailNotificationCotizationCars(t).then(function(e){e.success?i.done("Correo Enviado"):i.error("Error al enviar el correo. "+e.info)})}catch(e){}},n.onClicSendEmailNotificationCompraSeguro=function(){n.obJsonMail={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|10",emailSubject:"Póliza emitida seguro de auto Actinver "+q.nombreCliente+" "+q.poliza,mailTo:[q.emailUser],mailCC:"",polizaSeguro:q.poliza,anioVigencia:q.cmd.dataCarsYears.type.id,pagoPolizaFecha:moment(q.fechaAprox).format("DD/MM/YYYY"),marcaVehiculo:q.marcaVehiculo,modeloVehiculo:q.modeloVehiculo,serieVehiculo:q.serieVehiculo,urlPolizaImpresion:q.urlPoliza},s.sendEmailNotificationCompraSeguroCars(n.obJsonMail).then(function(e){e.success?i.done("Correo Enviado"):i.error("Error al enviar el correo. "+e.info)})},q.sclient=r.sclient?r.sclient:{},q.showSystemError=i.systemError,q.getSelectedClient=function(t,n){localStorage.setItem("contractSelected",JSON.stringify(n)),void 0!==q.sclient.data&&(q.show_instructions=!1,e.go(t))},q.type_contract={id:0},q.search_types=s.search_types,q.contract_type=s.type_contract,q.person_type=s.type_person,q.contracts_search={finish:!1,sent:!1},q.clean=function(){q.client="",q.person={}},q.cleanForm=function(){q.contract=null,q.client=null,q.person=null},q.contractSelection=function(t,n){localStorage.setItem("contractSelected",JSON.stringify(t));var o;o="999"===t.bankingArea&&"MC"===n?"CM":n,localStorage.setItem("_marketType",JSON.stringify(o)),e.go("investment.funds")};var W,X,Z;q.emailFormat=/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/}e.$inject=["$state","$stateParams","$scope","$rootScope","$window","$sessionStorage","CommonModalsSrv","insuranceCarSrv"],angular.module("actinver.controllers").controller("insuranceCarsCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(e){return"<div class='operations-account-tp'><span>"+e.month+"</span><div>"+e.id+": "+o("currency")(e.amount)+"</div></div>"}function r(){for(var e=[],t=new Date,n=t.getMonth()+1,o=t.getFullYear()-1,a=1;a<=13;a++)e.push({paymentPeriod:n<10?o+"0"+n:o+""+n,amount:null}),n<12?n++:(n=1,o+=1);return e}var i={type_contract:[{id:999,text:"Banco"},{id:998,text:"Casa"}],type_person:[{text:"Física"},{text:"Moral"}],search_types:[{id:1,text:"Número de cliente único",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"10"}},{id:2,text:"Número de contrato",validation:{pattern:new RegExp("^[0-9]*$"),maxlength:"10"}},{id:3,text:"Nombre de cliente único",typeahead:!0,validation:{pattern:"",maxlength:"60"}}],getClientName:function(o){return t(function(t,a){n({method:"GET",url:e.getClientName,params:{language:"SPA",lastName:o.lastName?o.lastName.toUpperCase():" ",surname:(o.surname,""),name:o.name?o.name.toUpperCase():" ",companyName:o.companyName,personType:o.name?1:2,tIN:o.fiscalIDNumber}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outClientInfoQuery.clientList.client,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getContracts:function(o,a){return t(function(t,r){n({method:"GET",url:e.getContracts,params:{language:"SPA",bankingArea:a||999,clientID:o}}).then(function(e){void 0!==e&&e.data.outContractsBalancesByPortfolioQuery?t({success:!0,contracts:e.data.outContractsBalancesByPortfolioQuery.contractInformation}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})},getContractHistorical:function(o){return t(function(t,a){n({method:"GET",url:e.getContractHistorical,params:{language:"SPA",contractNumber:'[{"idContrato":"'+o+'"}]'}}).then(function(e){if(1===e.data.outCommonHeader.result.result){var n=e.data.outBrokerMonthlyBalanceQuery.clients.client[0],o=!0,a=[];a=r(),angular.forEach(n.historicalInfo,function(e){o&&0!==e.amount&&(o=!1);for(var t=0;t<a.length;t++)a[t].paymentPeriod===e.paymentPeriod&&(a[t].amount=parseFloat(e.amount),t=a.length)}),n.historicalInfo=a,t({success:!0,historical:n,empty:o})}else t({success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getBrokerHistoricalBalanceQuery:function(o,a){return t(function(t,i){n({method:"GET",url:e.getBrokerHistoricalBalanceQuery+"/"+o+"/"+a,params:{language:"SPA"}}).then(function(e){if(1===e.data.outCommonHeader.result.result){var n,o=e.data.outBrokerHistoricalBalanceQuery.balanceFound,a=!0,i=[],s={};i=r(),angular.forEach(o,function(e){a&&0!==e.contractBalance&&(a=!1);for(var t=0;t<i.length;t++)i[t].paymentPeriod===e.period&&(i[t].amount=parseFloat(e.contractBalance),t=i.length);n=e.contractNumber}),s={contractNumber:n,historicalInfo:i},t({success:!0,historical:s,empty:a})}else t({success:!1,data:e.data.outCommonHeader.result})},function(){i({success:!1})})})},getBankContractBalance:function(o){return t(function(t,a){n({method:"GET",url:e.bankPortfolioQuery+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result&&null!==e.data.outBankPortfolioQuery.bankPortfolio?{success:!0,contractNumber:o,totalBalance:e.data.outBankPortfolioQuery.bankPortfolio.bankPortfolioElement[10].actualValue}:{success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getPortfolioGlobalDetailQuery:function(o){return t(function(t,a){n({method:"GET",url:e.getPortfolioGlobalDetailQuery+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,contractNumber:o,totalBalance:e.data.outPortfolioGlobalDetailQuery.totalValuation}:{success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},setInfo:function(e){for(var t=[],n=e[0].historicalInfo,r=0;r<=n.length;r++)if(0===r)t[r]=["Mes"];else{var s=n[r-1].paymentPeriod,c=parseInt(s.substr(0,4)),u=parseInt(s.substr(4,2)),l=new Date(c,u-1);t[r]=[o("date")(l,"MMM").toUpperCase()+"."+o("date")(l,"yy")]}for(var d=0;d<e.length;d++){t[0].push(e[d].contractNumber),t[0].push(tooltip_set);for(var m=0;m<e[d].historicalInfo.length;m++){var p={id:e[d].contractNumber,month:t[m+1][0],amount:e[d].historicalInfo[m].amount};t[m+1].push(p.amount),t[m+1].push(a(p))}}return i.displayChart(t)},getContractInfoDetail:function(o){return t(function(t,a){n({method:"GET",url:e.getContractInfoDetail+o.contractNumber+"/"+o.bankingArea,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t(e.data.outSimplifiedBankContractQuery.contract):a(e.data.outCommonHeader.result)},function(e){a(e)})})},getBankContractsByClientQuery:function(o,a,r){return t(function(t,i){n({method:"GET",url:e.getBankContractsByClientQuery+o+"/1/Modulo Asesor/"+a+"/"+r,params:{language:"SPA"}}).then(function(e){var n={success:!0,data:null,msg:e.data.outCommonHeader.result.messages[0].responseMessage};void 0!==e&&1===e.data.outCommonHeader.result.result?(n.data=e.data.outBankContractsByClientQuery,t(n)):(n.success=!1,t(n))},function(){i({success:!1,data:null,msg:"Error Interno"})})})},getCatalogEntityFederative:function(){return t(function(t,o){n({method:"GET",url:e.getCatalogEntityFederal,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outFederalEntityQuery.federalEntityCatalogData.federalEntity,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getCatalogMarksCars:function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogMarksCars+o,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCarBrandQuery.carBrandDataList.carBrandData,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getCatalogModelsCars:function(o,a){return t(function(t,r){n({method:"GET",url:e.getCatalogModelsCars+a+"/"+o,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCarModelQuery.carModelDataList.carModelData,t({success:!0,info:n})):r({success:!1,info:e.data.outCommonHeader.result})},function(){r({success:!1,type:"not-found"})})})},getCatalogMunicipalityCars:function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogMunicipalityCars+o,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMunicipalityQuery.municipalityCatalogData.municipality,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getCatalogBanksCars:function(){return t(function(t,o){n({method:"GET",url:e.getCatalogBanksCars,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceBanksQuery.insuranceBanksCatalogData.bank,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getServiceEmision:function(o){return t(function(t,a){n({method:"POST",url:e.getServiceEmision,data:$.param(o)}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outCarInsurancePolicyRegistration.xmldata,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.outCarInsurancePolicyRegistration.xmldata})},function(){a({success:!1,type:"not-found"})})})},getServiceCotizacion:function(o){return t(function(t,a){n({method:"POST",url:e.getServiceCotizacion,params:{language:"SPA",agentID:o.agentID,BrandID:o.BrandID,DelegationMunicipalityID:o.DelegationMunicipalityID,InsurancePolicyDate:o.InsurancePolicyDate,InvoiceFlag:o.InvoiceFlag,InvoiceNumber:o.InvoiceNumber,InvoiceValue:o.InvoiceValue,InvoiceDate:o.InvoiceDate,ModelID:o.ModelID,SubstituteCarCoverageFlag:o.SubstituteCarCoverageFlag,WarrantyCoverageFlag:o.WarrantyCoverageFlag,CatastrophicCoverageFlag:o.CatastrophicCoverageFlag,SumAssured:o.SumAssured,PaymentType:o.PaymentType,PaymentMethod:o.PaymentMethod,StateID:o.StateID,Year:o.Year,planType:o.planType,idCliente:o.idCliente}}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outCarInsuranceQuotation,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},sendEmailNotificationCotizationCars:function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationCotization,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,info:"not-found"})})})},sendEmailNotificationCompraSeguroCars:function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationCompraSeguro,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})}};return i}e.$inject=["URLS","$q","$http","$filter"],angular.module("actinver.controllers").service("insuranceCarSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){function c(e){return e.split("@")[1]}function u(e){if(""!=e&&null!=e&&void 0!=e)return"actinver.com.mx"!=c(e.toLowerCase())||(s.info("Por regulación no esta permitido ingresar un correo electrónico de Actinver"),!1)}function l(e){switch(e){case 0:ae.pageNotFound=!1,ae.actualPage=e;break;case 1:re[e]||(b(),ae.ListOcupacionA=C(),re[e]=!0),ae.actualPage=e;break;case 2:d(e);break;case 3:2==ae.actualPage?p()&&(re[e]||(ae.ListaSumAsegurada=Y(),re[e]=!0),ae.actualPage=e):ae.actualPage=e;break;case 4:re[e]||(re[e]=!0,ae.ListParentesco=A(),ae.ListBeneficiary=P()),ae.actualPage=e;break;case 5:ae.ListaBeneficiarios.length>0&&ae.listaPorcentajeTotal.every(function(e){return 100==e.total})?(re[e]||(re[e]=!0,ae.ListBanks=E(),ae.ListCardType=R(),ae.ListPaymentType=I(),ae.monthExpirationList=J(),ae.yearExpirationList=G()),ae.actualPage=e):s.error("La suma del porcentaje por cada tipo de beneficiario debe ser igual al 100%.");break;case 6:s.info("Hago constar que el cliente actúa en nombre y cuenta propia o con las facultades suficientes otorgadas por su representada(do); y que los recursos utilizados en la o las operaciones provienen de actividades lícitas."),ae.fechaVigencia=moment(ae.fechaVigencia).format("DD/MM/YYYY"),re[e]=!0,ae.actualPage=e;break;default:ae.pageNotFound=!0,ae.actualPage=e,s.error("No se encontró la página")}}function d(e){i.getInsuranceLifeHighRiskJobValidation(ae.cmd.dataOcupacion.id).then(function(t){if(t.success){if("true"===t.info||ae.kgs/(ae.mts*ae.mts)>29.99||!ae.estatusCuestionario.every(function(e){return e}))return void s.info("Estimado Asesor lamento informarle que al ingresar los datos a nuestro sistema automático de suscripción, no nos permitió ofrecer ésta protección de manera inmediata, por lo que te invitamos a revisar con el área de seguros esta solicitud para evaluación.");re[e]||(m(),re[e]=!0),ae.actualPage=e}else s.error("Ocurrió un error al validar la ocupación")})}function m(){var e=a.model.datosCliente,t=a.model.validatePopup;D(),ae.ListEstadoCivil=S(),ae.ListEntidades=M(),ae.personType=a.model.personType,ae.nombreCliente=a.model.nombreCliente,ae.nombres=a.model.nombres,ae.apePaterno=a.model.apePaterno,ae.apeMaterno=a.model.apeMaterno,ae.fiscalIDNumber=a.model.fiscalIDNumber,ae.CURP=a.model.curp,ae.disabledRFC=a.model.disabledRFC,ae.numeroCliente=a.model.numeroCliente,""!==ae.nombreCliente&&!1===t?s.confirm("¿"+ae.nombreCliente+" es el asegurado titular de la cuenta?").result.then(function(){ae.emailUser=void 0===e.email?"":e.email[0].email,ae.titular=!0,t=!0,ae.fechaNacimiento=a.model.birthDay}).catch(function(n){"cancel"!==n&&"escape key press"!==n&&"backdrop click"!==n||(e=[],ae.fiscalIDNumber="",ae.CURP="",ae.fechaNacimiento=!1,ae.disabledRFC=!1,ae.nombreCliente="",ae.nombres="",ae.apePaterno="",ae.apeMaterno="",t=!0,l(0))}):ae.emailUser=""}function p(){return ae.fechaNacimiento?(ae.edad=g(moment(ae.fechaNacimiento,"DD/MM/YYYY")),!!u(ae.emailUser)&&("1"===ae.personType&&(ae.edad<18||ae.edad>64)?(s.error("La edad de contratación debe ser mayor a 18 años y menor a 64 años 11 meses"),!1):ae.edadAsegurado!=ae.edadAseguradoFake?(s.error("La fecha de nacimiento no corresponde con la edad capturada en el paso anterior"),!1):9999!=ae.numeroCliente||f())):("1"===ae.personType?s.error("Favor de Capturar el campo de Fecha de Nacimiento"):s.error("Favor de Capturar el campo de Fecha Constitutiva"),!1)}function f(){var e=[],t="",n="",o=moment(ae.fechaNacimiento).format("DD/MM/YYYY"),a=moment(ae.fechaNacimientoAsegurado).format("DD/MM/YYYY"),r="1"==ae.personType?ae.fiscalIDNumber.substring(4,10):ae.fiscalIDNumber.substring(3,9);return e=o.split("/"),t+=e[2].substring(2,4),t+=e[1],t+=e[0],e=a.split("/"),n+=e[2].substring(2,4),n+=e[1],n+=e[0],t===r&&n===ae.rfcAsegurado.substring(4,10)?"1"!=ae.personType||(t===ae.CURP.substring(4,10)||(s.error("La fecha de nacimiento no coincide con el CURP"),!1)):(s.error("La fecha de nacimiento"+("2"==ae.personType?" y/o la fecha constitutiva":"")+" no coincide"+("2"==ae.personType?"n":"")+" con el RFC"),!1)}function g(e){return moment().diff(e,"years")}function h(){ae.edadAsegurado=ae.fechaNacimientoAsegurado?g(ae.fechaNacimientoAsegurado):0}function v(){ae.fechaVigencia&&(ae.fechaFinVigencia=moment(new Date(ae.fechaVigencia)).add(1,"years").format("DD/MM/YYYY"))}function y(e){ae.personType=e,ae.actualPage=2}function b(){i.getCuestionario().then(function(e){ae.cuestionario=e.info,ae.estatusCuestionario=ae.cuestionario.map(function(e){return!0})})}function C(){var e=[];return i.getCatalogExpenseJob().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.jobID,text:t.jobDescription})})}),e}function S(){var e=[];return i.getInsuranceMaritalStatusQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.maritalStatusID,text:t.maritalStatus})})}),e}function D(){i.getLifeinsuranceNationalityQuery().then(function(e){e.success&&(angular.forEach(e.info.data.outInsuranceCountryQuery.insuranceCountry,function(e){ae.ListPais.push({id:e.countryISO,text:e.country})}),ae.nacionalidad=ae.ListPais.find(function(e){return e.text.toUpperCase().startsWith("MEX")}),ae.paisAsegurado=ae.nacionalidad,ae.cmd.dataLifeContry=ae.nacionalidad)})}function M(){var e=[];return i.getLifeInsuranceStateQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.federalEntityID,text:t.federalEntityDescription})})}),e}function A(){var e=[];return i.getLifeInsuranceRelationshipQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){"TITULAR"!==t.expenseRelationshipDescription&&e.push({id:t.expenseRelationshipID,text:t.expenseRelationshipDescription})})}),e}function P(){var e=[];return i.getServiceInsuranceBeneficiaryTypeQuery().then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.insuranceBeneficiaryTypeID,text:t.insuranceBeneficiaryType})}),ae.tipoBeneficiario=e.find(function(e){return e.text.toUpperCase().startsWith("PRINCIPAL")}))}),e}function E(){var e=[];return i.getCatalogBanks().then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.bankID,text:t.bankName})}),e.sort(function(e,t){return e.text.toLowerCase()<t.text.toLowerCase()?-1:e.text.toLowerCase()>t.text.toLowerCase()?1:0}))}),e}function I(){var e=[];return i.getCatalogPaymentTypeQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){"AGENTE"!==t.paymentManagerName&&e.push({id:t.paymentManagerID,text:t.paymentManagerName})})}),e}function T(){ae.cmd.cardType=void 0===ae.cmd.cardType?"":ae.cmd.cardType,ae.cmd.dataCarsAccountIdBanks.text.toString().toUpperCase().startsWith("AMERICAN")?(ae.accLen=15,ae.cvvLen=4,ae.cmd.cardType=ae.ListCardType.find(function(e){return e.text.toUpperCase().startsWith("AMERICAN")})):(ae.accLen=16,ae.cvvLen=3)}function k(){if(ae.account)switch(ae.cmd.cardType=void 0===ae.cmd.cardType?"":ae.cmd.cardType,ae.validCard=!0,ae.account.toString().substr(0,1)){case"3":ae.cmd.cardType=ae.ListCardType.find(function(e){return e.text.toUpperCase().startsWith("AMERICAN")});break;case"4":ae.cmd.cardType=ae.ListCardType.find(function(e){return e.text.toUpperCase().startsWith("VISA")});break;case"5":ae.cmd.cardType=ae.ListCardType.find(function(e){return e.text.toUpperCase().startsWith("MASTER")});break;default:ae.validCard=!1,ae.cmd.cardType=[]}}function R(){i.getCatalogCardTypeQuery().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.cardID,text:e.cardType})}),ae.ListCardType=t)})}function x(){ae.isContratanteAsegurado?(ae.ListPoblacionesAsegurado=ae.ListPoblaciones,ae.ListCodPostalAsegurado=ae.ListPostalCodeLife,ae.nombreAsegurado=ae.nombres,ae.apePaternoAsegurado=ae.apePaterno,ae.apeMaternoAsegurado=ae.apeMaterno,ae.generoAsegurado=ae.sexoCliente,ae.rfcAsegurado=ae.fiscalIDNumber,ae.fechaNacimientoAsegurado=ae.fechaNacimiento,ae.calleAsegurado=ae.calleUser,ae.numeroExteriorAsegurado=ae.extUser,ae.coloniaAsegurado=ae.colonia,ae.edadAsegurado=g(moment(ae.fechaNacimiento,"DD/MM/YYYY")),ae.phoneAsegurado=ae.phoneUser,ae.estadoCivilAsegurado=ae.cmd.dataLifeMarital,ae.estadoAsegurado=ae.cmd.dataLifeEntity,ae.municipioAsegurado=ae.cmd.dataLifeMunicipality,ae.codigoPostalAsegurado=ae.cmd.dataLifePostalCode,ae.paisAsegurado=ae.cmd.dataLifeContry):(ae.nombreAsegurado="",ae.apePaternoAsegurado="",ae.apeMaternoAsegurado="",ae.rfcAsegurado="",ae.fechaNacimientoAsegurado=!1,ae.calleAsegurado="",ae.numeroExteriorAsegurado="",ae.coloniaAsegurado="",ae.estadoCivilAsegurado="",ae.estadoAsegurado="",ae.municipioAsegurado="",ae.codigoPostalAsegurado="",ae.paisAsegurado="",ae.phoneAsegurado="",ae.edadAsegurado="")}function N(){
if(u(ae.emailB))if(L(ae.tipoBeneficiario.text,ae.porcentajeB))s.error("El porcentaje total para el tipo de beneficiario "+ae.tipoBeneficiario.text+" no se encuentra dentro de los límites permitidos (1 - 100)");else{var e={tipoBeneficiario:ae.tipoBeneficiario,parentescoB:ae.parentescoB,nombreB:ae.nombreB,apePaternoB:ae.apePaternoB,apeMaternoB:ae.apeMaternoB,porcentajeB:ae.porcentajeB,fechaNacB:ae.fechaNacB,telefonoB:ae.telefonoB,emailB:ae.emailB,sexoB:ae.sexoB};ae.ListaBeneficiarios.push(e),ae.tipoBeneficiario="",ae.parentescoB="",ae.nombreB="",ae.apePaternoB="",ae.apeMaternoB="",ae.porcentajeB="",ae.fechaNacB=!1,ae.telefonoB="",ae.emailB="",ae.sexoB=""}}function w(e){ae.tipoBeneficiario=ae.ListaBeneficiarios[e].tipoBeneficiario,ae.parentescoB=ae.ListaBeneficiarios[e].parentescoB,ae.nombreB=ae.ListaBeneficiarios[e].nombreB,ae.apePaternoB=ae.ListaBeneficiarios[e].apePaternoB,ae.apeMaternoB=ae.ListaBeneficiarios[e].apeMaternoB,ae.porcentajeB=ae.ListaBeneficiarios[e].porcentajeB,ae.porcentajeBAnterior=ae.ListaBeneficiarios[e].porcentajeB,ae.fechaNacB=ae.ListaBeneficiarios[e].fechaNacB,ae.telefonoB=ae.ListaBeneficiarios[e].telefonoB,ae.emailB=ae.ListaBeneficiarios[e].emailB,ae.sexoB=ae.ListaBeneficiarios[e].sexoB,ae.indexUser=e,ae.updateFlag=!0}function O(){F(ae.tipoBeneficiario.text,ae.porcentajeB,ae.indexUser)?s.error("El porcentaje total para el tipo de beneficiario "+ae.tipoBeneficiario.text+" no se encuentra dentro de los límites permitidos (1 - 100)"):(ae.ListaBeneficiarios[ae.indexUser].tipoBeneficiario=ae.tipoBeneficiario,ae.ListaBeneficiarios[ae.indexUser].parentescoB=ae.parentescoB,ae.ListaBeneficiarios[ae.indexUser].nombreB=ae.nombreB,ae.ListaBeneficiarios[ae.indexUser].apePaternoB=ae.apePaternoB,ae.ListaBeneficiarios[ae.indexUser].apeMaternoB=ae.apeMaternoB,ae.ListaBeneficiarios[ae.indexUser].porcentajeB=ae.porcentajeB,ae.ListaBeneficiarios[ae.indexUser].fechaNacB=ae.fechaNacB,ae.ListaBeneficiarios[ae.indexUser].telefonoB=ae.telefonoB,ae.ListaBeneficiarios[ae.indexUser].emailB=ae.emailB,ae.ListaBeneficiarios[ae.indexUser].sexoB=ae.sexoB,ae.updateFlag=!1,ae.tipoBeneficiario="",ae.parentescoB="",ae.nombreB="",ae.apePaternoB="",ae.apeMaternoB="",ae.porcentajeB="",ae.fechaNacB=!1,ae.telefonoB="",ae.emailB="",ae.sexoB="",ae.indexUser="",ae.porcentajeBAnterior="")}function B(e){j(ae.ListaBeneficiarios[e].tipoBeneficiario.text,ae.ListaBeneficiarios[e].porcentajeB)&&(ae.ListaBeneficiarios.splice(e,1),ae.tipoBeneficiario="",ae.parentescoB="",ae.nombreB="",ae.apePaternoB="",ae.apeMaternoB="",ae.porcentajeB="",ae.fechaNacB=!1,ae.telefonoB="",ae.emailB="",ae.emailB="",ae.indexUser="",ae.porcentajeBAnterior="")}function L(e,t){if(t>100||t<=0)return!0;var n=ae.listaPorcentajeTotal.find(function(t){return t.tipoBeneficiario==e});return void 0===n?(n={tipoBeneficiario:e,total:parseInt(t,10)},ae.listaPorcentajeTotal.push(n),!1):!(parseInt(n.total,10)+parseInt(t,10)<=100)||(n.total=parseInt(n.total,10)+parseInt(t,10),!1)}function F(e,t,n){if(t>100||t<=0)return!0;var o=0,a=0;for(a=0;a<ae.ListaBeneficiarios.length;a++)a!=n&&(o+=e==ae.ListaBeneficiarios[a].tipoBeneficiario.text?parseInt(ae.ListaBeneficiarios[a].porcentajeB,10):0);if(o+parseInt(t,10)<=100){var r=ae.listaPorcentajeTotal.find(function(t){return t.tipoBeneficiario==e});return r?(r.total=parseInt(o,10)+parseInt(t,10),!1):(s.error("Ocurrió un error al actualizar el registro"),!0)}return!0}function j(e,t){var n=ae.listaPorcentajeTotal.find(function(t){return t.tipoBeneficiario==e});if(n){if(parseInt(n.total,10)-parseInt(t,10)>=0)return n.total=parseInt(n.total,10)-parseInt(t,10),!0;s.error("Ocurrió un error al eliminar el registro")}else s.error("Ocurrió un error al eliminar el registro");return!1}function $(){var e=[];return i.getInsuranceLifeHighRiskJobValidation().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.TotalBalance,text:t.OperationResult})})}),e}function Y(){var e=[];return i.getSumaryQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){(se.includes("SEGUROS")||se.includes("ASESOR")&&t.insuredSum>=55e4)&&e.push({id:t.insuredSumID,text:n("currency")(t.insuredSum,"$",2)})})}),e}function H(e){var t=e.keyCode;if(t>=97&&t<=122&&!e.ctrlKey&&!e.metaKey&&!e.altKey){var n=t-32,o=e.target.selectionStart,a=e.target.selectionEnd;e.target.value=e.target.value.substring(0,o)+String.fromCharCode(n)+e.target.value.substring(a),e.target.setSelectionRange(o+1,o+1),e.preventDefault()}}function _(e){var t=new RegExp("^[0-9]+$"),n=void 0!==event.charCode?event.charCode:event.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==event.charCode)return event.preventDefault(),!1}function U(e){var t=new RegExp("^[ña-zA-Z]+$"),n=void 0!==event.charCode?event.charCode:event.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==event.charCode)return event.preventDefault(),!1}function z(e,t){var n=t?new RegExp("^[a-zA-Z0-9 ]+$"):new RegExp("^[a-zA-Z0-9]+$"),o=void 0!==event.charCode?event.charCode:event.which,a=String.fromCharCode(o);return 241===event.which||209===event.which||225===event.which||233===event.which||237===event.which||243===event.which||250===event.which||193===event.which||201===event.which||205===event.which||211===event.which||218===event.which||(n.test(a)||0===event.charCode?void 0:(event.preventDefault(),!1))}function V(e,t){var n,o,a,r=void 0!==event.charCode?event.charCode:event.which,i=void 0!==t?t.toUpperCase():String.fromCharCode(r).toUpperCase();if(i.length>2){var s=i.substring(i.length-3,i.length);if(Q(s)){if(n=s.substring(0,1),o=s.substring(1,2),a=s.substring(2,3),n.toString()===o.toString()&&o.toString()===a.toString())return event.preventDefault(),!1}else if(n=s.substring(0,1),o=s.substring(1,2),a=s.substring(2,3),parseInt(o)===parseInt(a)-1&&parseInt(n)===parseInt(o)-1)return event.preventDefault(),!1}return!1}function Q(e){return/^[1-9]+[0-9]*]*$/.test(e),!0}function q(e,t){var n=angular.element("#"+t).val();return n=void 0===n?"":n,"01"!==n.toString()&&"001"!==n.toString()?!(n.toString().length>5&&"01234567890000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999".includes(n.toString())&&(e.preventDefault(),1)):(e.preventDefault(),!1)}function G(){for(var e=[],t=(new Date).getFullYear(),n=0;n<7;n++)e.push({id:t+n,text:t+n});return e}function J(){for(var e,t=[],n=1;n<=12;n++)e=n<10?"0"+n:n,t.push({id:e,text:e});return t}function K(){var e={};e.language="SPA",e.insurancePolicyDate=moment(new Date).format("YYYY-MM-DD"),e.policyMaturityDate=moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD"),e.agentCode=ie+"",e.paymentManagerID="1",e.smokerFlag=ae.fuma,e.clientNumber=ae.numeroCliente,e.adviserID="67890",e.contractingData={name:ae.nombreAsegurado.toUpperCase(),lastName:ae.apePaternoAsegurado.toUpperCase(),secondLastName:ae.apeMaternoAsegurado.toUpperCase(),fiscalIDNumber:ae.rfcAsegurado,street:ae.calleAsegurado,outdoorNumber:ae.numeroExteriorAsegurado,neighborhood:ae.coloniaAsegurado,postalCode:ae.codigoPostalAsegurado.id+"",federalEntityID:parseInt(ae.estadoAsegurado.id),delegationMunicipalityID:parseInt(ae.municipioAsegurado.id),countryID:ae.paisAsegurado.id,phoneNumber:ae.phoneAsegurado,birthDate:moment(ae.fechaNacimientoAsegurado,"DD-MM-YYYY").format("YYYY-MM-DD"),gender:ae.generoAsegurado,maritalStatusID:ae.estadoCivilAsegurado.id,nacionality:ae.paisAsegurado.id,personType:"1"===ae.personType?"F":"M",email:ae.emailUser,insuranceBeneficiaryTypeID:"6",professionID:ae.cmd.dataOcupacion.id,jobID:ae.cmd.dataOcupacion.id,height:ae.mts,weight:ae.kgs,age:parseInt(ae.edadAsegurado)},e.basicCoverage={insuredSum:ae.insuredSum},e.accidentalDeathCoverage={insuredSum:ae.insuredSum},i.getServiceLifeInsuranceQuotation(e).then(function(e){e.success?(ae.pBasica=e.info.coverageList.coverageInformation[0].totalPremium,ae.pMa=e.info.coverageList.coverageInformation[1].totalPremium,ae.totalSum=ae.pBasica+ae.pMa,ae.btnContinuarSAQuot=!0):(s.error("No se pudo realizar la cotización de su seguro, favor de comunicarse con el área de soporte. TX_ID: "+e.info.transactionID),ae.btnContinuarSAQuot=!1)})}function W(){if(u(ae.email1)){if(!ae.validCard)return void s.error("Número de Tarjeta Inválido.");ae.AdviserID="67890",ae.edad=g(moment(ae.fechaNacimiento,"DD/MM/YYYY"));for(var e,t={},o="2"==ae.cmd.paymentType.type.id&&"1"===ae.cmd.ListTypeCLABE.type.id?ae.cmd.ListTypeCLABE.type.text:"TC",a=1;a<7&&(e=moment().add(a,"days").format("YYYY-MM-DD"),!(moment(e).isoWeekday()<6));a++);t.language="SPA",t.agentCode=ie+"",t.clientNumber=ae.numeroCliente,t.insurancePolicyDate=moment(ae.fechaVigencia).format("YYYY-MM-DD"),t.policyMaturityDate=moment(new Date(ae.fechaVigencia)).add(1,"years").format("YYYY-MM-DD"),t.paymentManagerID="1",t.smokerFlag=ae.fuma,t.adviserID=ae.AdviserID,t.chargeManager="2"===ae.cmd.paymentType.type.id?"BA":"TA",t.contractingData={name:"1"===ae.personType?ae.nombres.toUpperCase():ae.nombreAsegurado.toUpperCase(),lastName:"1"===ae.personType?ae.apePaterno.toUpperCase():ae.apePaternoAsegurado.toUpperCase(),secondLastName:"1"===ae.personType?ae.apeMaterno.toUpperCase():ae.apeMaternoAsegurado.toUpperCase(),fiscalIDNumber:"1"===ae.personType?ae.fiscalIDNumber.toUpperCase():ae.rfcAsegurado.toUpperCase(),street:"1"===ae.personType?ae.calleUser.toUpperCase():ae.calleAsegurado.toUpperCase(),outdoorNumber:"1"===ae.personType?ae.extUser:ae.numeroExteriorAsegurado,neighborhood:"1"===ae.personType?ae.colonia.toUpperCase():ae.coloniaAsegurado.toUpperCase(),postalCode:"1"===ae.personType?ae.cmd.dataLifePostalCode.text:ae.codigoPostalAsegurado.id+"",federalEntityID:"1"===ae.personType?parseInt(ae.cmd.dataLifeEntity.id):parseInt(ae.estadoAsegurado.id),delegationMunicipalityID:"1"===ae.personType?parseInt(ae.cmd.dataLifeMunicipality.id):parseInt(ae.municipioAsegurado.id),countryID:"1"===ae.personType?ae.cmd.dataLifeContry.id:ae.paisAsegurado.id,phoneNumber:"1"===ae.personType?ae.phoneUser:ae.phoneAsegurado,birthDate:moment(ae.fechaNacimiento,"DD/MM/YYYY").format("YYYY-MM-DD"),gender:ae.sexoCliente,maritalStatusID:"1"===ae.personType?ae.cmd.dataLifeMarital.id:"0",nacionality:ae.nacionalidad.id,personType:"1"===ae.personType?"F":"M",email:n("lowercase")(ae.emailUser),insuranceBeneficiaryTypeID:"6",professionID:ae.cmd.dataOcupacion.id+"",jobID:ae.cmd.dataOcupacion.id+"",height:parseFloat(ae.mts),weight:parseFloat(ae.kgs),age:"1"===ae.personType?parseInt(ae.edad):parseInt(ae.edadAsegurado)},t.insuredData={name:ae.nombreAsegurado.toUpperCase()+"",lastName:ae.apePaternoAsegurado.toUpperCase()+"",secondLastName:ae.apeMaternoAsegurado.toUpperCase()+"",fiscalIDNumber:ae.rfcAsegurado.toUpperCase()+"",street:ae.calleAsegurado.toUpperCase()+"",outdoorNumber:ae.numeroExteriorAsegurado+"",neighborhood:ae.coloniaAsegurado.toUpperCase()+"",postalCode:ae.codigoPostalAsegurado.id+"",federalEntityID:parseInt(ae.estadoAsegurado.id),delegationMunicipalityID:parseInt(ae.municipioAsegurado.id),countryID:ae.paisAsegurado.id+"",phoneNumber:ae.phoneAsegurado+"",birthDate:moment(ae.fechaNacimientoAsegurado,"DD/MM/YYYY").format("YYYY-MM-DD"),gender:ae.generoAsegurado,maritalStatusID:ae.estadoCivilAsegurado.id+"",personType:"1"===ae.personType?"F":"M",insuranceBeneficiaryTypeID:"6",jobID:ae.cmd.dataOcupacion.id+"",height:parseFloat(ae.mts),weight:parseFloat(ae.kgs),age:parseInt(ae.edadAsegurado)},t.beneficiaryDataList=[],angular.forEach(ae.ListaBeneficiarios,function(e){var n={name:e.nombreB.toUpperCase()+"",lastName:e.apePaternoB.toUpperCase()+"",secondLastName:e.apeMaternoB.toUpperCase()+"",personType:"1"===ae.personType?"F":"M",jobID:"0",insuranceBeneficiaryTypeID:e.tipoBeneficiario.id,participationPercentage:parseInt(e.porcentajeB),birthDate:moment(e.fechaNacB).format("YYYY-MM-DD"),age:parseInt(g(e.fechaNacB)),relationshipID:e.parentescoB.id};t.beneficiaryDataList.push(n)}),t.basicCoverage={insuredSum:ae.insuredSum},t.accidentalDeathCoverage={insuredSum:ae.insuredSum},t.bankingData={paymentMethod:o,name:ae.nombreCard.toUpperCase(),lastName:ae.apellidoPCard.toUpperCase(),secondLastName:ae.apellidoMCard.toUpperCase(),email:n("lowercase")(ae.email1),bankID:ae.cmd.dataCarsAccountIdBanks.id,expirationDate:"CLABE"===o?"2024-01-01":moment(ae.comboYearExpiration.text+"-"+ae.comboMonthExpiration.text+"-01").format("YYYY-MM-DD"),cardVerificationValue:"CLABE"===o?"":parseInt(ae.cvv),cardNumber:"CLABE"===o?"":ae.account,cardID:"CLABE"===o?"":ae.cmd.cardType.id+"",CLABE:"CLABE"===o?ae.clabeInter:"",cutoffDate:e},i.getServiceLifeInsurancePolicyRegistration(t).then(function(e){e.success?(ae.numeroPoliza=e.info.policyNumber,ae.urlCondiciones=ce?"https://zonaliados.mapfre.com.mx/zonaaliadosextra/vida/pdf/Plan%20de%20Vida%20Individual.pdf":"https://10.184.62.77/zonaaliadosextra/vida/pdf/Plan%20de%20Vida%20Individual.pdf",ae.urlSolicitud=ce?"https://zonaliados.mapfre.com.mx/impresionSeGA/TWImpSolicitudMarco.aspx?noPoliza="+ae.numeroPoliza+"&sector=1&usuario=actinver&agente="+ie+"&eMail=&btnPoliza=N&RelSol=MEXICO|"+("false"===ae.fuma?"NO":"SI")+"|"+ae.cmd.dataOcupacion.text+"|TEMPORAL 1 AÑO|"+ae.kgs+"|"+ae.mts+"|"+("1"===ae.personType?ae.edad:ae.edadAsegurado)+"|X|X|X|X|":"https://10.184.62.77/impresionSeGA/TWImpSolicitudMarco.aspx?noPoliza="+ae.numeroPoliza+"&sector=1&usuario=actinver&agente="+ie+"&eMail=&btnPoliza=N&RelSol=MEXICO|"+("false"===ae.fuma?"NO":"SI")+"|"+ae.cmd.dataOcupacion.text+"|TEMPORAL 1 AÑO|"+ae.kgs+"|"+ae.mts+"|"+("1"===ae.personType?ae.edad:ae.edadAsegurado)+"|X|X|X|X|",ae.urlPoliza=ce?"https://zonaliados.mapfre.com.mx/impresionSeGA/TWImpPolizaMarco.aspx?noPoliza="+ae.numeroPoliza+"&sector=1&simpol=n&usuario=actinver&agente="+ie:"https://10.184.62.77/impresionSeGA/TWImpPolizaMarco.aspx?noPoliza="+ae.numeroPoliza+"&sector=1&simpol=n&usuario=actinver&agente="+ie,l(6)):s.error("Estimado usuario su póliza no fue emitida, favor de comunicarse con el área de soporte. TX_ID: "+e.info.transactionID)})}}function X(){if("2"!=ae.personType){ae.activarCheck=!0,ae.banderasCheckAsCoArr[0]=!0,""==!ae.nombres?ae.banderasCheckAsCoArr[0]=!0:ae.banderasCheckAsCoArr[0]=!1,""==!ae.apePaterno?ae.banderasCheckAsCoArr[1]=!0:ae.banderasCheckAsCoArr[1]=!1,""==!ae.apeMaterno?ae.banderasCheckAsCoArr[2]=!0:ae.banderasCheckAsCoArr[2]=!1,""==!ae.fiscalIDNumber?ae.banderasCheckAsCoArr[3]=!0:ae.banderasCheckAsCoArr[3]=!1,""==!ae.CURP?ae.banderasCheckAsCoArr[4]=!0:ae.banderasCheckAsCoArr[4]=!1,""==!ae.phoneUser?ae.banderasCheckAsCoArr[5]=!0:ae.banderasCheckAsCoArr[5]=!1,""==!ae.emailUser?ae.banderasCheckAsCoArr[6]=!0:ae.banderasCheckAsCoArr[6]=!1,""==!ae.calleUser?ae.banderasCheckAsCoArr[7]=!0:ae.banderasCheckAsCoArr[7]=!1,""==!ae.extUser?ae.banderasCheckAsCoArr[8]=!0:ae.banderasCheckAsCoArr[8]=!1,""==!ae.colonia?ae.banderasCheckAsCoArr[9]=!0:ae.banderasCheckAsCoArr[9]=!1,""==!ae.fechaNacimiento?ae.banderasCheckAsCoArr[10]=!0:ae.banderasCheckAsCoArr[10]=!1;for(var e=0;e<ae.banderasCheckAsCoArr.length;e++)ae.activarCheck=ae.activarCheck&&ae.banderasCheckAsCoArr[e];ae.activarCheck?document.getElementById("checkContAse").disabled=!1:document.getElementById("checkContAse").disabled=!0}}function Z(){var e=moment(ae.fechaVigencia).format("YYYY-MM-DD"),t=moment(new Date(ae.fechaVigencia)).add(1,"years").format("YYYY-MM-DD"),n="1"===ae.personType?ae.nombres.toUpperCase()+" "+ae.apePaterno.toUpperCase()+" "+ae.apeMaterno.toUpperCase():ae.nombreCliente.toUpperCase();i.ServiceEmailSendingAsesoriaPolizaLista(ae.emailUser,n,ae.numeroPoliza,e,t,ae.urlPoliza,ae.urlSolicitud,ae.urlCondiciones).then(function(e){"EXITO"===e.info.responseMessage?s.info("Estimado usuario el correo ha sido enviado correctamente."):s.error("Estimado usuario no se ha podido enviar el correo, favor de comunicarse con el área de soporte.")})}function ee(){window.open(ae.urlCondiciones,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function te(){window.open(ae.urlSolicitud,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function ne(){window.open(ae.urlPoliza,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function oe(){ae=null,e.go("insurance.main")}var ae=this,re=[],ie=t.$parent.agentSelected.id,se=JSON.parse(r.user).roles,ce=-1!==window.location.href.indexOf("asesoria.actinver.com/asesoria"),ue=o.matchMedia("(max-width: 767px)");ue.onchange=function(e){ae.txtClass=e.target.matches?"text-left":"text-right"},a.model||e.go("insurance.main"),ae.cmd={},ae.indexUser="",ae.actualPage=0,ae.personType="1",ae.numeroCliente="",ae.disabledRFC=!1,ae.txtClass=ue.matches?"text-left":"text-right",ae.mailRegex=/^[a-zA-Z._\-0-9]{4,}@[a-zA-Z_\-0-9]{2,}.[a-zA-Z]{2,5}([.a-zA-Z]+)?$/,ae.nombres="",ae.apePaterno="",ae.apeMaterno="",ae.nombreCliente="",ae.numeroPoliza="",ae.CURP="",ae.extUser="",ae.intUser="",ae.colonia="",ae.calleUser="",ae.emailUser="",ae.phoneUser="",ae.sexoCliente="",ae.fiscalIDNumber="",ae.fechaNacimiento=!1,ae.nacionalidad="",ae.ListPais=[],ae.ListEntidades=[],ae.ListEstadoCivil=[],ae.ListPoblaciones=[],ae.ListPostalCodeLife=[],ae.ListaBeneficiarios=[],ae.listaPorcentajeTotal=[],ae.nombreAsegurado="",ae.apePaternoAsegurado="",ae.apeMaternoAsegurado="",ae.fechaNacimientoAsegurado=!1,ae.rfcAsegurado="",ae.edadAsegurado="",ae.generoAsegurado="",ae.phoneAsegurado="",ae.calleAsegurado="",ae.estadoAsegurado="",ae.coloniaAsegurado="",ae.municipioAsegurado="",ae.codigoPostalAsegurado="",ae.numeroExteriorAsegurado="",ae.paisAsegurado="",ae.estadoCivilAsegurado="",ae.ListPoblacionesAsegurado=[],ae.kgs="",ae.mts="",ae.fuma=null,ae.cuestionario=[],ae.ListOcupacionA=[],ae.estatusCuestionario=[],ae.fechaVigencia=!1,ae.fechaFinVigencia="",ae.ListaSumAsegurada=[],ae.insuredSum=0,ae.pBasica={},ae.pMa={},ae.updateFlag=!1,ae.tipoBeneficiario="",ae.parentescoB="",ae.ListParentesco=[],ae.ListBeneficiary=[],ae.nombreB="",ae.apePaternoB="",ae.apeMaternoB="",ae.porcentajeB="",ae.fechaNacB=!1,ae.telefonoB="",ae.emailB="",ae.sexoB="",ae.nombreCard="",ae.apellidoPCard="",ae.apellidoMCard="",ae.account="",ae.clabeInter="",ae.ListPaymentType=[],ae.ListBanks=[],ae.ListCardType=[],ae.yearExpirationList=[],ae.monthExpirationList=[],ae.comboMonthExpiration="",ae.comboYearExpiration="",ae.cvvLen=3,ae.accLen=16,ae.ListTypeCLABE=[{id:"1",text:"CLABE"},{id:"2",text:"DEBITO"}],ae.contractDatePickOp={minDate:moment((new Date).setYear((new Date).getFullYear()-64)).format("DD/MM/YYYY"),maxDate:moment((new Date).setYear((new Date).getFullYear()-18)).format("DD/MM/YYYY")},ae.beneficiaryDatePickOp={minDate:moment((new Date).setYear((new Date).getFullYear()-110)).format("DD/MM/YYYY"),maxDate:moment(new Date).format("DD/MM/YYYY")},ae.vigenciaDatePickOp={minDate:moment(new Date).format("DD/MM/YYYY"),maxDate:moment((new Date).setMonth((new Date).getMonth()+1)).format("DD/MM/YYYY")},ae.payDatePickOp={minDate:new Date,maxDate:moment((new Date).setMonth((new Date).getMonth()+1)).format("DD/MM/YYYY"),isInvalidDate:function(e){return 0===e.day()||6===e.day()}},ae.go2page=l,ae.sumaanio=v,ae.regresoMain=oe,ae.selectBankId=T,ae.selectTypeCard=k,ae.AseContratante=x,ae.activarCheckAseCon=X,ae.saveBeneficiario=N,ae.editBeneficiario=w,ae.updateBeneficiario=O,ae.deleteBeneficiario=B,ae.calculaEdadAsegurado=h,ae.forceKeyPressUppercase=H,ae.numberSecuential=q,ae.soloTextAndNum=z,ae.soloNumero=_,ae.charrepeat=V,ae.soloText=U,ae.imprimirPolizaLife=ne,ae.imprimirCondiciones=ee,ae.imprimirSolicitudLife=te,ae.seleccionaPersonalidad=y,ae.ServiceEmailLifePolizaLista=Z,ae.getInsuranceLifeHkJValidation=$,ae.ServiceLifeInsurancePolicyRegistration=W,ae.validateActinverEmail=u,l(1),ae.vaciaTarjeta=function(e,t){"CLABE"===t.text?(ae.account="",ae.cmd.cardType="",ae.comboMonthExpiration="",ae.comboYearExpiration="",ae.cvv="",ae.validCard=!0):ae.clabeInter=""},ae.changeMunicipality=function(e){var t=[];i.getLifeInsuranceMunicipalityQuery(e?ae.estadoAsegurado.id:ae.cmd.dataLifeEntity.id).then(function(n){n.success&&(angular.forEach(n.info,function(e){t.push({id:e.municipalityID,text:e.delegationOrMunicipality})}),e?(ae.ListPoblacionesAsegurado=t,ae.municipioAsegurado="",ae.codigoPostalAsegurado=""):(ae.ListPoblaciones=t,ae.cmd.dataLifeMunicipality="",ae.cmd.dataLifePostalCode=""))})},ae.changePostalCode=function(e){var t=[];i.getCatalogPostalCode(e?ae.municipioAsegurado.id:ae.cmd.dataLifeMunicipality.id).then(function(n){n.success&&(angular.forEach(n.info.postalCode,function(e){t.push({id:e,text:e})}),e?(ae.ListCodPostalAsegurado=t,ae.codigoPostalAsegurado=""):(ae.ListPostalCodeLife=t,ae.cmd.dataLifePostalCode=""))})},ae.onAccumulateValidation=function(e,t){ae.insuredSum=parseFloat(t.id),K();var n={};n.riskValidation={edad:(ae.personType,parseInt(ae.edadAsegurado)),nombre:"1"===ae.personType?ae.nombres:ae.nombreAsegurado,apePaterno:"1"===ae.personType?ae.apePaterno:ae.apePaternoAsegurado,apeMaterno:"1"===ae.personType?ae.apeMaterno:ae.apeMaternoAsegurado,birthDate:moment(ae.fechaNacimientoAsegurado,"DD/MM/YYYY").format("YYYY-MM-DD")};var o=parseFloat(ae.insuredSum)/1.1;i.getAccumulatedRisksValidation(parseInt(o),n).then(function(e){if("N"!=e.info.operationResult)return ae.btnContinuarSA=!0,ae.primaTotal=e.info.totalBalance,ae.primaTotal;s.info("Estimado Asesor lamento informarle que al ingresar sus datos a nuestro sistema automático de suscripción, no nos permitió ofrecerle ésta protección de manera inmediata, por lo que lo invitamos a enviar a las oficinas de MAPFRE su solicitud para su evaluación."),ae.btnContinuarSA=!1})},ae.banderasCheckAsCoArr=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]}e.$inject=["$state","$scope","$filter","$window","$stateParams","$sessionStorage","insuranceLifeSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("insuranceLifeCtrl",e)}(),function(){"use strict";function e(e,t,n,o){return{getLifeInsuranceStateQuery:function(){return t(function(t,o){n({method:"GET",url:e.getCatalogEntityFederal,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outFederalEntityQuery.federalEntityCatalogData.federalEntity,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getInsuranceLifeHighRiskJobValidation:function(o){return t(function(t,a){n({method:"GET",url:e.getinsuranceLifeHighRiskJobValidation,params:{language:"SPA",jobID:o,insuranceTypeID:"100"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceLifeHighRiskJobValidation.operationResult,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getAccumulatedRisksValidation:function(o,a){return t(function(t,r){n({method:"GET",url:e.getinsuranceAccumulatedRisksValidation,params:{insuranceTypeID:"100",packageCode:"10011",currencyID:"1",age:a.riskValidation.edad,name:a.riskValidation.nombre,lastName:a.riskValidation.apePaterno,secondLastName:a.riskValidation.apeMaterno,birthDate:a.riskValidation.birthDate,insuredSum:o,validityDate:moment().format("YYYY-MM-DD"),language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceAccumulatedRisksValidation,t({success:!0,info:n})):r({success:!1,info:e.data.outCommonHeader.result})},function(){r({success:!1,type:"not-found"})})})},getCatalogPostalCode:function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogPostalCodeQuery+o,params:{language:"SPA",MunicipalityID:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outPostalCodeQuery.postalCodeList,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getCuestionario:function(){return t(function(t,o){n({method:"GET",url:e.getLifeInsuranceQuestionnaireQuery,params:{insuranceTypeID:"100",language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outLifeInsuranceQuestionnaireQuery.condition,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getSumaryQuery:function(){return t(function(t,o){n({method:"GET",url:e.getInsuranceInsuredSumQuery,params:{language:"SPA",insuranceTypeID:"100",currencyID:"1",validityDate:"2019-09-09"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceInsuredSumQuery.insuranceInsuredSumQueryEntity,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getLifeinsuranceNationalityQuery:function(){return t(function(t,o){n({method:"GET",url:e.getInsuranceCountryQuery,params:{language:"SPA",insuranceTypeID:"100"}}).then(function(e){var n;n=e,t({success:!0,info:n}),1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceCountryQuery.insuranceCountry,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getInsuranceMaritalStatusQuery:function(){return t(function(t,o){n({method:"GET",url:e.getInsuranceMaritalStatusQuery,params:{insuranceTypeID:"100",language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceMaritalStatusQuery.insuranceMaritalStatus,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getCatalogExpenseJob:function(){return t(function(t,o){n({method:"GET",url:e.getLifeInsuranceExpenseJobQuery,params:{language:"SPA",insuranceTypeID:100}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outLifeInsuranceJobQuery.ocupationList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},getLifeInsuranceRelationshipQuery:function(){return t(function(t,o){n({method:"GET",url:e.getLifeInsuranceRelationshipQuery,params:{language:"SPA",insuranceTypeID:"100"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outLifeInsuranceRelationshipQuery.relationships,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},getCatalogPaymentTypeQuery:function(){return t(function(t,o){n({method:"GET",url:e.getCatalogPaymentTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outPaymentTypeQuery.paymentTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getCatalogBanks:function(){return t(function(t,o){n({method:"GET",url:e.getCatalogBanks,params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t({success:!0,info:e.data.outInsuranceBanksQuery.insuranceBanksCatalogData.bank}):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getLifeInsuranceMunicipalityQuery:function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogMunicipalityCars+o,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMunicipalityQuery.municipalityCatalogData.municipality,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getCatalogCardTypeQuery:function(){return t(function(t,o){n({method:"GET",url:e.getCatalogCardTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceCardTypeQuery.cardTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},getServiceLifeInsuranceQuotation:function(o){return t(function(t,a){n({method:"POST",url:e.getLifeInsuranceQuotation,params:{language:o.language,insurancePolicyDate:o.insurancePolicyDate,policyMaturityDate:o.policyMaturityDate,agentCode:o.agentCode,paymentManagerID:o.paymentManagerID,smokerFlag:o.smokerFlag,clientNumber:o.clientNumber,adviserID:o.adviserID,contractingData:JSON.stringify({name:o.contractingData.name,lastName:o.contractingData.lastName,secondLastName:o.contractingData.secondLastName,fiscalIDNumber:o.contractingData.fiscalIDNumber,street:o.contractingData.street,outdoorNumber:o.contractingData.outdoorNumber,neighborhood:o.contractingData.neighborhood,postalCode:o.contractingData.postalCode,federalEntityID:o.contractingData.federalEntityID,delegationMunicipalityID:o.contractingData.delegationMunicipalityID,countryID:o.contractingData.countryID,phoneNumber:o.contractingData.phoneNumber,birthDate:o.contractingData.birthDate,gender:o.contractingData.gender,maritalStatusID:o.contractingData.maritalStatusID,nacionality:o.contractingData.nacionality,personType:o.contractingData.personType,email:o.contractingData.email,insuranceBeneficiaryTypeID:o.contractingData.insuranceBeneficiaryTypeID,professionID:o.contractingData.professionID,jobID:o.contractingData.jobID,height:o.contractingData.height,weight:o.contractingData.weight,age:o.contractingData.age}),basicCoverage:JSON.stringify({insuredSum:o.accidentalDeathCoverage.insuredSum}),accidentalDeathCoverage:JSON.stringify({insuredSum:o.accidentalDeathCoverage.insuredSum})}}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outLifeInsuranceQuotation,t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})})})},getServiceLifeInsurancePolicyRegistration:function(o){return t(function(t,a){n({method:"POST",url:e.getLifeInsurancePolicyRegistration,params:{language:o.language,insurancePolicyDate:o.insurancePolicyDate,policyMaturityDate:o.policyMaturityDate,agentCode:o.agentCode,paymentManagerID:o.paymentManagerID,smokerFlag:o.smokerFlag,clientNumber:o.clientNumber,adviserID:o.adviserID,chargeManager:o.chargeManager,contractingData:JSON.stringify(o.contractingData),insuredData:JSON.stringify(o.insuredData),beneficiaryDataList:JSON.stringify(o.beneficiaryDataList),basicCoverage:JSON.stringify(o.basicCoverage),accidentalDeathCoverage:JSON.stringify(o.accidentalDeathCoverage),bankingData:JSON.stringify(o.bankingData)}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outLifeInsurancePolicyRegistration,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},getServiceInsuranceBeneficiaryTypeQuery:function(){return t(function(t,o){n({method:"GET",url:e.getInsuranceBeneficiaryTypeQuery,params:{language:"SPA",insuranceTypeID:"100"}}).then(function(e){1===e.data.outCommonHeader.result.result?t({success:!0,info:e.data.outInsuranceBeneficiaryTypeQuery.beneficiary}):o({success:!1,info:e.data.outCommonHeader.result})})})},ServiceEmailSendingAsesoriaSolicitudUsuario:function(o,a,r,i,s,c,u,l,d,m){var p="https://zonaliados.mapfre.com.mx/impresionSeGA/TWImpSolicitudMarco.aspx?noPoliza="+r+"&sector=1&usuario=actinver&agente="+i+"&eMail=&btnPoliza=N&RelSol=MEXICO|"+("false"===s?"NO":"SI")+"|"+c+"|TEMPORAL 1 AÑO|"+u+"|"+l+"|"+d+"|X|X|X|X|",f="https://10.184.62.77/impresionSeGA/TWImpSolicitudMarco.aspx?noPoliza="+r+"&sector=1&usuario=actinver&agente="+i+"&eMail=&btnPoliza=N&RelSol=MEXICO|"+("false"===s?"NO":"SI")+"|"+c+"|TEMPORAL 1 AÑO|"+u+"|"+l+"|"+d+"|X|X|X|X|";return t(function(t,i){n({method:"POST",url:e.sendCustomizedEmailNotificationSending,params:{language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|26",emailSubject:"Estas a un paso de obtener tu Seguro de Vida Inversión Actinver.",mailTo:[o],mailCC:[""],nombre:a,noPoliza:r,urlSolicitud:"PRO"===m?p:f}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result.messages[0],t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},ServiceEmailSendingAsesoriaNotificacionAsesor:function(o,a){return t(function(t,r){n({method:"POST",url:e.sendCustomizedEmailNotificationSending,params:{language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|27",emailSubject:"La póliza "+a+" esta lista en el módulo.",mailTo:[o],mailCC:[""],noPoliza:a}}).then(function(e){var n
;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result.messages[0],t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},ServiceEmailSendingAsesoriaPolizaLista:function(o,a,r,i,s,c,u,l){return t(function(t,d){n({method:"POST",url:e.sendCustomizedEmailNotificationSending,params:{language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|26",emailSubject:"Póliza emitida seguro de vida inversión Actinver "+r,mailTo:[o],mailCC:[""],nombre:a,noPoliza:r,inicioVigencia:i,finVigencia:s,urlPoliza:c,urlSolicitud:u,urlCondiciones:l}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result.messages[0],t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},ListaPolizasVida:function(o){return t(function(t,a){n({method:"GET",url:e.getPolizasVida,params:{language:"SPA",employeeRole:o}}).then(function(e){var n;1===e.data.return.status?(n=e.data.return.data.polizaVidaListRs,t({success:!0,info:n})):a({success:!1,info:e.data.return})})})},ListaPolizasVidaUp:function(o,a){return t(function(t,r){n({method:"GET",url:e.PolizaVidaUp,params:{language:"SPA",policyId:o,policyStatus:a}}).then(function(e){t({success:!0,info:e})})})},ListaPolizasVidaAdd:function(o,a,r,i,s,c,u,l,d,m,p){return t(function(t,f){n({method:"GET",url:e.PolizaVidaAdd,params:{language:"SPA",policyId:o,policyDate:a,policyDateEnd:r,policyAmount:i,policyStauts:s,clientName:c,clientLastname:u,clientSecondname:l,clientEmail:d,idAgente:m,agentEmail:p}}).then(function(e){var n;1===e.data.return.status?(n=e.data.return,t({success:!0,info:n})):f({success:!1,info:e.data.return})})})}}}e.$inject=["URLS","$q","$http","$filter"],angular.module("actinver.controllers").service("insuranceLifeSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u,l,d){function m(){x.contract=null,x.client=null,x.person=null}function p(){x.stepForm={step:0,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!1}}function f(){x.numeroCliente="",x.emailUser="",x.personType="1",x.datosCliente=[],x.nombres="",x.apePaterno="",x.apeMaterno="",x.contract="",x.fiscalIDNumber="",x.curp="",x.disabledRFC=!1,x.mostrarDatos=!1,x.nombreCliente="",x.birthDay="",x.client="",x.person={},x.validatePerson=!1,x.validatePopup=!1,x.tipoVehiculo="",o=null}function g(){x.contract="",x.validatePopup=!1,x.cleanForm(),x.stepForm.step=1,x.stepForm.stepA=!0,x.buscar=!0,x.tipoPersonalidad=!1}function h(){r.$parent.agentDisabled=!1,o.model&&(w=o.model,x.numeroCliente=w.numeroCliente,x.emailUser=w.emailUser,x.tipoVehiculo=w.tipoVehiculo,x.personType=w.personType,x.datosCliente=w.datosCliente,x.nombres=w.nombres,x.apePaterno=w.apePaterno,x.apeMaterno=w.apeMaterno,x.contract=w.contract,x.fiscalIDNumber=w.fiscalIDNumber,x.curp=w.curp,x.disabledRFC=w.disabledRFC,x.mostrarDatos=w.mostrarDatos,x.nombreCliente=w.nombreCliente,x.birthDay=w.birthDay,x.client=w.client,x.person=w.person,x.validatePopup=w.validatePopup,x.validatePerson=w.validatePerson,x.roles=w.roles,""!==w.numeroCliente&&(v(),R()))}function v(){x.cleanForm(),x.stepForm.step=2,x.stepForm.stepB=!0}function y(){x.cleanForm(),x.stepForm.step=3,x.stepForm.stepB=!0}function b(e){x.personType=e,v()}function C(){x.datosCliente="",x.fiscalIDNumber="",x.curp="",x.disabledRFC=!1,x.nombreCliente="",x.nombres="",x.apePaterno="",x.apeMaterno="",x.contract="",x.mostrarDatos=!1,x.numeroCliente="9999",x.birthDay="",x.fechaNacimiento="",x.buscar=!1,x.tipoPersonalidad=!0}function S(){return{numeroCliente:x.numeroCliente,emailUser:x.emailUser,tipoVehiculo:x.tipoVehiculo,personType:x.personType,datosCliente:x.datosCliente,nombres:x.nombres,apePaterno:x.apePaterno,apeMaterno:x.apeMaterno,contract:x.contract,fiscalIDNumber:x.fiscalIDNumber,curp:x.curp,disabledRFC:x.disabledRFC,mostrarDatos:x.mostrarDatos,nombreCliente:x.nombreCliente,birthDay:x.birthDay,client:x.client,person:x.person,validatePopup:x.validatePopup,validatePerson:x.validatePerson,roles:x.roles,phoneUser:x.phoneUser}}function D(){var e=S();r.$parent.agentDisabled=!0,n.go("insurance.cars",{model:e})}function M(){var e=S();r.$parent.agentDisabled=!0,n.go("insurance.life",{model:e})}function A(){if(r.$parent.agentLength<=0&&c.warning("Estimado usuario, te informamos que aún no estas registrado en esta plataforma, por favor ponte en contacto con el equipo de seguros en la extensión 4444 para solicitar tu acceso."),""!==x.nombreCliente&&!1===x.validatePopup)c.confirm("¿"+x.nombreCliente+" es el asegurado titular de la cuenta?").result.then(function(){void 0!==x.datosCliente.email?I(!0,x.nombreCliente,x.datosCliente.email[0].email):I(!1,"",""),x.validatePopup=!0;var e=S();r.$parent.agentDisabled=!0,n.go("insurance.pyme",{model:e})}).catch(function(e){if("cancel"===e||"escape key press"===e||"backdrop click"===e){x.client="",x.person={},x.contract="",x.datosCliente=[],x.fiscalIDNumber="",x.curp="",x.disabledRFC=!1,x.nombreCliente="",x.nombres="",x.apePaterno="",x.apeMaterno="",x.contract="",x.validatePopup=!0,x.mostrarDatos=!1,I(!1,"","");var t=S();r.$parent.agentDisabled=!0,n.go("insurance.pyme",{model:t})}});else{var e=S();r.$parent.agentDisabled=!0,n.go("insurance.pyme",{model:e})}}function P(){if(r.$parent.agentLength<=0&&c.warning("Estimado usuario, te informamos que aún no estas registrado en esta plataforma, por favor ponte en contacto con el equipo de seguros en la extensión 4444 para solicitar tu acceso."),""!==x.nombreCliente&&!1===x.validatePopup)c.confirm("¿"+x.nombreCliente+" es el asegurado titular de la cuenta?").result.then(function(){void 0!==x.datosCliente.email?I(!0,x.nombreCliente,x.datosCliente.email[0].email):I(!1,"",""),x.validatePopup=!0;var e=S();e.flujo=1,r.$parent.agentDisabled=!0,n.go("insurance.houses",{model:e})}).catch(function(e){if("cancel"===e||"escape key press"===e||"backdrop click"===e){x.client="",x.person={},x.contract="",x.datosCliente=[],x.fiscalIDNumber="",x.curp="",x.disabledRFC=!1,x.nombreCliente="",x.nombres="",x.apePaterno="",x.apeMaterno="",x.contract="",x.validatePopup=!0,x.mostrarDatos=!1,I(!1,"","");var t=S();t.flujo=1,r.$parent.agentDisabled=!0,n.go("insurance.houses",{model:t})}});else{var e=S();e.flujo=1,r.$parent.agentDisabled=!0,n.go("insurance.houses",{model:e})}}function E(e){var t=moment(new Date).format("YY"),n=e.substring(3,9),o=n.substring(0,2),a=n.substring(2,4),r=n.substring(4,6);return o=o>t?"19"+o:"20"+o,n=r+"/"+a+"/"+o}function I(e,t,n){x.validatePerson=e,!0===x.validatePerson&&(x.emailUser=n)}function T(e){var t=new Number(void 0===e.phoneNumber?0:e.phoneNumber),n=new Number(void 0===e.areaCode?0:e.areaCode);x.phoneUser=n.toString()+t.toString()}function k(){x.datosCliente&&(x.datosCliente.email?I(!0,x.nombreCliente,x.datosCliente.email[0].email):I(!1,"",""),x.datosCliente.telephoneData&&T(x.datosCliente.telephoneData[0])),r.$parent.agentDisabled=!0;var e=S();n.go("insurance.medical",{model:e})}function R(){if(x.client)e.getContractByAdviser(x.client).then(function(e){if(e.success){x.personType=e.data.client[0].personType,x.datosCliente=e.data.client[0],x.nombres=e.data.client[0].name,x.apePaterno=e.data.client[0].lastName,x.apeMaterno=e.data.client[0].secondLastName,x.contract=e.data.client[0].contractNumber,x.fiscalIDNumber=e.data.client[0].fiscalIDNumber,x.curp=e.data.client[0].curp,x.disabledRFC=!0,x.mostrarDatos=!0,x.numeroCliente=x.client,T(x.datosCliente.telephoneData[0]);try{x.contract=e.data.contract[0].contractNumber}catch(e){x.contract=""}"1"===x.personType?(x.nombreCliente=e.data.client[0].name+" "+e.data.client[0].lastName+" "+e.data.client[0].secondLastName,x.birthDay=moment(e.data.client[0].birthDate).format("DD/MM/YYYY")):(x.nombreCliente=e.data.client[0].companyName,x.birthDay=E(x.fiscalIDNumber)),v()}else c.error(e.msg),C()},function(e){"not-found"===e.type?(r.operations.showSystemError(),C()):(c.error(d.createError(e.messages)),C())});else if(x.contract)e.getClientInfo(x.contract,x.contract,999).then(function(e){x.personType=e.info[0].personType,x.datosCliente=e.info[0],x.nombres=e.info[0].name,x.apePaterno=e.info[0].lastName,x.apeMaterno=e.info[0].secondLastName,x.fiscalIDNumber=e.info[0].fiscalIDNumber,x.curp=e.info[0].curp,x.disabledRFC=!0,x.mostrarDatos=!0,x.numeroCliente=e.clientId,T(x.datosCliente.telephoneData[0]),"1"===x.personType?(x.nombreCliente=e.info[0].name+" "+e.info[0].lastName+" "+e.info[0].secondLastName,x.birthDay=moment(e.info[0].birthDate).format("DD/MM/YYYY")):(x.nombreCliente=e.info[0].companyName,x.birthDay=E(x.fiscalIDNumber)),v()},function(t){e.getClientInfo(x.contract,x.contract,998).then(function(e){x.personType=e.info[0].personType,x.datosCliente=e.info[0],x.nombres=e.info[0].name,x.apePaterno=e.info[0].lastName,x.apeMaterno=e.info[0].secondLastName,x.fiscalIDNumber=e.info[0].fiscalIDNumber,x.curp=e.info[0].curp,x.disabledRFC=!0,x.mostrarDatos=!0,x.numeroCliente=e.clientId,T(x.datosCliente.telephoneData[0]),"1"===x.personType?(x.nombreCliente=e.info[0].name+" "+e.info[0].lastName+" "+e.info[0].secondLastName,x.birthDay=moment(e.info[0].birthDate).format("DD/MM/YYYY")):(x.nombreCliente=e.info[0].companyName,x.birthDay=E(x.fiscalIDNumber)),v()},function(){c.error(t.info.error.responseMessage),C()})});else if(x.person){var t;if(x.person.name){var n=x.person.name?x.person.name.toUpperCase():"";u.detail({list:[],wordToSearch:n,personType:"1"}).result.then(function(){e.getContractByAdviser(l.selectedClient.uniqueClientNumber).then(function(e){if(e.success){x.personType=e.data.client[0].personType,x.datosCliente=e.data.client[0],x.nombres=e.data.client[0].name,x.apePaterno=e.data.client[0].lastName,x.apeMaterno=e.data.client[0].secondLastName,x.fiscalIDNumber=e.data.client[0].fiscalIDNumber,x.curp=e.data.client[0].fiscalIDNumber,x.numeroCliente=e.data.client[0].clientNumber,x.disabledRFC=!0;try{x.contract=e.data.contract[0].contractNumber}catch(e){x.contract=""}x.mostrarDatos=!0,"1"===x.personType?(x.nombreCliente=e.data.client[0].name+" "+e.data.client[0].lastName+" "+e.data.client[0].secondLastName,x.birthDay=moment(e.data.client[0].birthDate).format("DD/MM/YYYY")):(x.nombreCliente=e.data.client[0].companyName,x.birthDay=E(x.fiscalIDNumber)),v()}else c.error(e.msg),C()},function(e){var t;"not-found"===e.type?(r.operations.showSystemError(),C()):(t=e.info.error.responseMessage?e.info.error.responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",c.error(t),C())})})}else x.person.fiscalIDNumber?e.getClientName(x.person).then(function(n){n.info[0]?u.detail({list:n.info,wordToSearch:"",personType:"2"}).result.then(function(){e.getContractByAdviser(l.selectedClient.clientNumber).then(function(e){if(e.success){x.datosCliente=e.data.client[0],x.nombreCliente=e.data.client[0].name+" "+e.data.client[0].lastName+" "+e.data.client[0].secondLastName,x.nombres=e.data.client[0].name,x.apePaterno=e.data.client[0].lastName,x.apeMaterno=e.data.client[0].secondLastName,x.fiscalIDNumber=e.data.client[0].fiscalIDNumber,x.curp=e.data.client[0].curp,x.disabledRFC=!0;try{x.contract=e.data.contract[0].contractNumber}catch(e){x.contract=""}x.mostrarDatos=!0,v()}else c.error(e.msg),C()},function(e){var t;"not-found"===e.type?(r.operations.showSystemError(),C()):(t=e.info.error.responseMessage?e.info.error.responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",c.error(t),C())})}):(t="No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",c.error(t),C())},function(e){"not-found"===e.type?(r.operations.showSystemError(),C()):(t=e.info.messages?e.info.messages[0].responseMessage:"No se han encontrado los datos con el criterio seleccionado.<br />Te pedimos vuelvas a intentar.",c.error(t),C())}):(c.info("Se cotizará a un no cliente"),C())}v()}var x=this;x.cleanForm=p,x.clean=m,x.seleccionaPersonalidad=b,x.buscar=!0,x.mostrarDatos=!1,x.nombreCliente="",x.personType="1",x.datosCliente=[],x.client="",x.person={},x.contract="",x.personType="1",x.contractUser=0,x.fiscalIDNumber="",x.curp="",x.disabledRFC=!1;var N=JSON.parse(JSON.parse(sessionStorage["ngStorage-user"]));x.roles=N.roles,x.validatePopup=!1,x.reinicia=f,x.pagina1=g,x.pagina2=v,x.pagina2regreso=h,x.pagina3=y,x.submitSearch=R,x.cotizar=I,x.valCotizar=D,x.valCotizarVida=M,x.valCotizarCasas=P,x.cotizarNoCliente=C,x.ValCotizarPyme=A;var w;x.valCotizarProteccionMedica=k,x.stepForm={step:0,stepA:!1,stepB:!1,stepC:!1,stepD:!1,stepDB:!1,stepE:!1,stepF:!1,stepG:!1,stepH:!1},g(),h()}e.$inject=["insuranceMainSrv","$uibModal","$state","$stateParams","pResumeSrv","$scope","$q","$sessionStorage","CommonModalsSrv","accountModalSrv","$rootScope","ErrorMessage"],angular.module("actinver.controllers").controller("insuranceMainCtrl",e)}(),function(){"use strict";function e(e,t,n,o){return{getContractByAdviser:function(o){return t(function(t,a){n({method:"GET",url:e.getContractByAdviser+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,data:e.data.result,msg:e.data.outCommonHeader.result.messages[0].responseMessage}:{success:!1,data:[],msg:e.data.outCommonHeader.result.messages[0].responseMessage})},function(){a({success:!1,type:"not-found",data:[],msg:"Ha ocurrido un error Interno"})})})},getClientInfo:function(o,a,r){return t(function(t,i){n({method:"GET",url:e.getClientInfo,params:{descripcion:a,typeQuery:o,language:"SPA",titularFlag:!0,bankingArea:r,contractNumber:1===o?"":a,clientNumber:1===o?a:""}}).then(function(e){var n,o;void 0!==e&&"ERROR"!==e.data.outCommonHeader.result.messages[0].responseCategory?(n=e.data.outClientOrContractClientInfoQuery.client,o=e.data.outClientOrContractClientInfoQuery.client[0].clientNumber,t({success:!0,info:n,clientId:o})):(e.data={error:{responseMessage:e.data.outCommonHeader.result.messages[0].responseMessage}},i({success:!1,info:e.data,type:"empty"}))},function(){i({success:!1,type:"not-found"})})})},getClientName:function(o){return t(function(t,a){n({method:"GET",url:e.getClientName,params:{language:"SPA",lastName:o.lastName?o.lastName.toUpperCase():" ",surname:(o.surname,""),name:o.name?o.name.toUpperCase():" ",companyName:o.companyName,personType:o.name?1:2,tIN:o.fiscalIDNumber}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outClientInfoQuery.clientList.client,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},getContracts:function(o,a){return t(function(t,r){n({method:"GET",url:e.getContracts,params:{language:"SPA",bankingArea:a||999,clientID:o}}).then(function(e){void 0!==e&&e.data.outContractsBalancesByPortfolioQuery?t({success:!0,contracts:e.data.outContractsBalancesByPortfolioQuery.contractInformation}):r({success:!1,data:e.data,type:"empty"})},function(){r({success:!1,type:"not-found"})})})},getContractHistorical:function(o){return t(function(t,a){n({method:"GET",url:e.getContractHistorical,params:{language:"SPA",contractNumber:'[{"idContrato":"'+o+'"}]'}}).then(function(e){if(1===e.data.outCommonHeader.result.result){var n=e.data.outBrokerMonthlyBalanceQuery.clients.client[0],o=!0,a=[];a=getMonthsYears(),angular.forEach(n.historicalInfo,function(e){o&&0!==e.amount&&(o=!1);for(var t=0;t<a.length;t++)a[t].paymentPeriod===e.paymentPeriod&&(a[t].amount=parseFloat(e.amount),t=a.length)}),n.historicalInfo=a,t({success:!0,historical:n,empty:o})}else t({success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getBrokerHistoricalBalanceQuery:function(o,a){return t(function(t,r){n({method:"GET",url:e.getBrokerHistoricalBalanceQuery+"/"+o+"/"+a,params:{language:"SPA"}}).then(function(e){if(1===e.data.outCommonHeader.result.result){var n,o=e.data.outBrokerHistoricalBalanceQuery.balanceFound,a=!0,r=[],i={};r=getMonthsYears(),angular.forEach(o,function(e){a&&0!==e.contractBalance&&(a=!1);for(var t=0;t<r.length;t++)r[t].paymentPeriod===e.period&&(r[t].amount=parseFloat(e.contractBalance),t=r.length);n=e.contractNumber}),i={contractNumber:n,historicalInfo:r},t({success:!0,historical:i,empty:a})}else t({success:!1,data:e.data.outCommonHeader.result})},function(){r({success:!1})})})},getBankContractBalance:function(o){return t(function(t,a){n({method:"GET",url:e.bankPortfolioQuery+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result&&null!==e.data.outBankPortfolioQuery.bankPortfolio?{success:!0,contractNumber:o,totalBalance:e.data.outBankPortfolioQuery.bankPortfolio.bankPortfolioElement[10].actualValue}:{success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getPortfolioGlobalDetailQuery:function(o){return t(function(t,a){n({method:"GET",url:e.getPortfolioGlobalDetailQuery+o,params:{language:"SPA"}}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,contractNumber:o,totalBalance:e.data.outPortfolioGlobalDetailQuery.totalValuation}:{success:!1,data:e.data.outCommonHeader.result})},function(){a({success:!1})})})},getContractInfoDetail:function(o){return t(function(t,a){n({method:"GET",url:e.getContractInfoDetail+o.contractNumber+"/"+o.bankingArea,params:{language:"SPA"}}).then(function(e){void 0!==e&&1===e.data.outCommonHeader.result.result?t(e.data.outSimplifiedBankContractQuery.contract):a(e.data.outCommonHeader.result)},function(e){a(e)})})},getBankContractsByClientQuery:function(o,a,r){return t(function(t,i){n({method:"GET",url:e.getBankContractsByClientQuery+o+"/1/Modulo Asesor/"+a+"/"+r,params:{language:"SPA"}}).then(function(e){var n={success:!0,data:null,msg:e.data.outCommonHeader.result.messages[0].responseMessage};void 0!==e&&1===e.data.outCommonHeader.result.result?(n.data=e.data.outBankContractsByClientQuery,t(n)):(n.success=!1,t(n))},function(){i({success:!1,data:null,msg:"Error Interno"})})})}}}e.$inject=["URLS","$q","$http","$filter"],angular.module("actinver.controllers").service("insuranceMainSrv",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u){function l(){function e(e){Bt.flechasCollapse[e]=!Bt.flechasCollapse[e]}Bt.flechasCollapse=[];for(var t=0;t<Bt.grupos.length;t++)Bt.flechasCollapse.push(!1);Bt.toggleColapse=e}function d(){Bt.collapseQuotationDetail="plus"===Bt.collapseQuotationDetail?"minus":"plus"}function m(){r.go("insurance.main")}function p(){Bt.steps.search=!1,Bt.steps.entrega=!1,Bt.steps.cotizacion=!0,Bt.flujoCompleto=!0,Bt.collapseInClassDatosRiesgo=!0,Bt.dependientes=[],Bt.cmd&&(Bt.cmd.estado=void 0,Bt.cmd.municipio=void 0),Bt.clienteEsTitularAsegurado="2",Bt.dataNumAseguradosList&&(Bt.dataNumAseguradosList.type=void 0),Bt.dataParentescoList&&(Bt.dataParentescoList.type=Bt.ListMedicalParentescos[0])}function f(){Bt.steps.emision=!1,Bt.steps.entrega=!1,Bt.flujoCompleto?(Bt.steps.cotizacion=!0,Bt.steps.recotizacion=!0):(Bt.steps.recotizacion=!1,Bt.steps.cotizacion=!1,Ct(),Bt.flujoCompleto=!0),Bt.pestCotiza=!0,Bt.pestEmision=!1,Bt.trianguloAzul="triangulo",Bt.trianguloBorde="trianguloBlanco"}function g(){J()}function h(){Bt.recotizacionDisabled=!0,Bt.emailDisabled=!0,ht()}function v(){Bt.ListGiroMercantil=ot(),Bt.ListNacionalidad=tt(),nt(),Bt.getCuestionarioEmision=ut()}function y(){Bt.ListMedicalLocacion=[],Ue(),Bt.steps.cotizacion=!1,Bt.steps.recotizacion=!1,Bt.steps.emision=!0,Bt.steps.entrega=!1,Bt.trianguloAzul="trianguloBlanco",Bt.trianguloBorde="triangulo",Bt.pestCotiza=!1,Bt.pestEmision=!0,St(Bt.jsonCotizacion.quotationNumber),xt(),v()}function b(){if(!Pt())return u.error("Debe completar los datos requeridos del Contratante"),!1;for(var e=0;e<Bt.emitDependientes.length;e++)if(!Et(e))return u.error("Debe completar los datos requeridos de "+Bt.emitDependientes[e].relationship),!1;Bt.firmasjuntas=document.getElementById("firmasJuntas"),Bt.steps.search=!1,Bt.steps.cotizacion=!1,Bt.steps.recotizacion=!1,console.log("go entrega"),Bt.fileB64&&Fe(),mt()}function C(){html2canvas(Bt.firmasjuntas,{onrendered:function(e){Bt.firmasEnBase64=e.toDataURL("image/jpeg"),rt()}})}function S(t){return e.formatCurrency(t)}function D(t,n){return e.charrepeatText(t,n)}function M(t,n){return e.soloNumAndPunto(t,n)}function A(t,n,o){return e.soloText(t,n,o)}function P(t){return e.soloNum(t)}function E(t){e.cambiaN(t)}function I(t,n){return e.soloTextAndNum(t,n)}function T(t,n){return e.calcularEdadRfc(t,n)}function k(e,t){var n=0,o=0;if("c"===t){if(n=void 0!==Bt.emitContratante.telefono?Bt.emitContratante.telefono:0,o=void 0!==e?e:0,n===o&&0!==n&&0!==o)return u.error("Favor de Capturar un Celular Diferente"),!1}else if("f"===t&&(n=void 0!==e?e:0,o=void 0!==Bt.emitContratante.celular?Bt.emitContratante.celular:0,n===o&&0!==n&&0!==o))return u.error("Favor de Capturar un Teléfono Diferente"),!1}function R(e,t,n,o){G(t,n,o)}function x(){angular.forEach(Bt.dependientes,function(e){"TITULAR"===e.relationship&&(Bt.comparaTitularD=!1)})}function N(){z()}function w(){0!==Bt.dependientes.length&&(Bt.dataParentescoList.type=void 0),Bt.dependientes&&0!==Bt.dependientes.length||(Bt.dataParentescoList.type=Bt.ListMedicalParentescos[0]),0===Bt.dependientes.length&&"2"!==Bt.clienteEsTitularAsegurado||(Bt.nombresCliente="",Bt.primerApellidoCliente="",Bt.segundoApellidoCliente="",Bt.fechaNacimientoCliente=moment(),Bt.edadCliente="",Bt.rfcCliente=""),Bt.sexoCliente="Masculino",Bt.dataOcupacionList.type=void 0,Bt.dataDeporteList.type=void 0,Bt.deporteCliente="",Bt.isClienteBanco=!1,Bt.editandoCliente=!1,Bt.buttonNameClientData=Bt.nombreBotonAgregar,Bt.buttonNameCleanData=Bt.nombreBotonLimpiar}function O(e){Bt.banderaPrimerMayor18=!0,"TITULAR"===Bt.dependientes[e].relationship&&(angular.forEach(Bt.dependientes,function(e){Bt.banderaPrimerMayor18&&e.age>=18&&1!==e.relationshipID&&(e.relationshipID=1,e.relationship="TITULAR",Bt.banderaPrimerMayor18=!1)}),Bt.clienteEsTitularAsegurado="2"),Bt.dependientes.splice(e,1),Bt.editandoCliente=!1,w(),0!==Bt.dependientes.length&&Bt.dependientes||(Bt.dataParentescoList.type=Bt.ListMedicalParentescos[0])}function B(e){Bt.dataParentescoList.type={id:Bt.dependientes[e].relationshipID,text:Bt.dependientes[e].relationship},Bt.nombresCliente=Bt.dependientes[e].name,Bt.primerApellidoCliente=Bt.dependientes[e].lastName,Bt.segundoApellidoCliente=Bt.dependientes[e].secondLastName,Bt.fechaNacimientoCliente=moment(Bt.dependientes[e].birthDate,"YYYY-MM-DD"),Bt.edadCliente=Bt.dependientes[e].age,Bt.rfcCliente=Bt.dependientes[e].fiscalIDNumber,Bt.sexoCliente=Bt.dependientes[e].genderDesc,Bt.dataOcupacionList.type={id:Bt.dependientes[e].jobID,text:Bt.dependientes[e].jobDescription},Bt.dataDeporteList.type={id:Bt.dependientes[e].sportID,text:Bt.dependientes[e].sport},Bt.indexTitular=e,Bt.editandoCliente=!0,Bt.buttonNameClientData=Bt.nombreBotonModificar,Bt.buttonNameCleanData=Bt.nombreBotonCancelar,"1"===Bt.clienteEsTitularAsegurado&&Bt.rfcCliente===Bt.fiscalIDNumber&&(Bt.isClienteBanco=!0)}function L(e){Bt.dependientes[e].relationshipID=Bt.dataParentescoList.type.id,Bt.dependientes[e].relationship=Bt.dataParentescoList.type.text,Bt.dependientes[e].name=Bt.nombresCliente,Bt.dependientes[e].lastName=Bt.primerApellidoCliente,Bt.dependientes[e].secondLastName=Bt.segundoApellidoCliente,Bt.dependientes[e].birthDate=moment(Bt.fechaNacimientoCliente).format("YYYY-MM-DD"),Bt.dependientes[e].age=Y(Bt.fechaNacimientoCliente),Bt.dependientes[e].fiscalIDNumber=Bt.rfcCliente,Bt.dependientes[e].gender="Masculino"===Bt.sexoCliente?1:0,Bt.dependientes[e].genderDesc=Bt.sexoCliente,Bt.dependientes[e].jobID=Bt.edadCliente>=18&&void 0!==Bt.dataOcupacionList.type?Bt.dataOcupacionList.type.id:"",Bt.dependientes[e].jobDescription=Bt.edadCliente>=18&&void 0!==Bt.dataOcupacionList.type?Bt.dataOcupacionList.type.text:"",Bt.dependientes[e].sportID="1"===Bt.dataDeporteList.type.id||void 0===Bt.dataDeporteList.type?"":Bt.dataDeporteList.type.id,Bt.dependientes[e].sport="NINGUNO"===Bt.dataDeporteList.type.text||void 0===Bt.dataDeporteList.type?"":Bt.dataDeporteList.type.text,Bt.isClienteBanco=!1}function F(){Bt.nombresCliente=Bt.nombres,Bt.primerApellidoCliente=Bt.primerApellido,Bt.segundoApellidoCliente=Bt.segundoApellido,Bt.rfcCliente=Bt.fiscalIDNumber,Bt.fechaNacimientoCliente=moment(Bt.fechaNacimiento,"DD/MM/YYYY"),Bt.edadCliente=Y(Bt.fechaNacimientoCliente),Bt.isClienteBanco=!0}function j(e){Bt.fechaNacimientoCliente&&"cliente"===e&&(Bt.edadCliente=Y(Bt.fechaNacimientoCliente)),Bt.emitContratante.fechaNacimiento&&"contratante"===e&&(Bt.emitContratante.edad=Y(Bt.emitContratante.fechaNacimiento))}function Y(e){return moment().diff(e,"years")}function H(){if(Bt.emitContratante.nombres&&Bt.emitContratante.primerApellido&&Bt.emitContratante.segundoApellido&&Bt.emitContratante.fechaNacimiento){U(Bt.emitContratante.nombres.replace(/Ñ/g,"N").replace(/ñ/g,"n"),Bt.emitContratante.primerApellido.replace(/Ñ/g,"N").replace(/ñ/g,"n"),Bt.emitContratante.segundoApellido.replace(/Ñ/g,"N").replace(/ñ/g,"n"),moment(Bt.emitContratante.fechaNacimiento).format("YYYY-MM-DD"),"contratante")}}function _(){if(Bt.nombresCliente&&Bt.primerApellidoCliente&&Bt.segundoApellidoCliente&&Bt.fechaNacimientoCliente){U(Bt.nombresCliente.replace(/Ñ/g,"N").replace(/ñ/g,"n"),Bt.primerApellidoCliente.replace(/Ñ/g,"N").replace(/ñ/g,"n"),Bt.segundoApellidoCliente.replace(/Ñ/g,"N").replace(/ñ/g,"n"),moment(Bt.fechaNacimientoCliente).format("YYYY-MM-DD"),"cliente")}}function U(e,n,o,a,r){var i={language:"SPA",name:e,lastName:n,secondLastName:o,birthDate:a};t.getMedicalInsuranceFiscalIDNumber(i).then(function(e){e.success&&("cliente"===r&&(Bt.rfcCliente=e.info.fiscalIDNumber,Bt.homoclaveRFCCliente=e.info.fiscalSingleKey),"contratante"===r&&(Bt.emitContratante.rfc=e.info.fiscalIDNumber,Bt.homoclaveRFCContratante=e.info.fiscalSingleKey),Bt.emitDependientes&&Dt())})}function z(){if(Bt.nombresCliente&&Bt.primerApellidoCliente&&Bt.segundoApellidoCliente&&Bt.fechaNacimientoCliente){var e=Bt.nombresCliente.replace(/Ñ/g,"N").replace(/ñ/g,"n"),n=Bt.primerApellidoCliente.replace(/Ñ/g,"N").replace(/ñ/g,"n"),o=Bt.segundoApellidoCliente.replace(/Ñ/g,"N").replace(/ñ/g,"n"),a={language:"SPA",name:e,lastName:n,secondLastName:o,birthDate:moment(Bt.fechaNacimientoCliente).format("YYYY-MM-DD")};t.getMedicalInsuranceFiscalIDNumber(a).then(function(e){if(e.success)if(Bt.rfcCliente=e.info.fiscalIDNumber,Bt.homoclaveRFCCliente=e.info.fiscalSingleKey,Bt.editandoCliente)L(Bt.indexTitular),w();else if(parseInt(Bt.dataNumAseguradosList.type.text)>Bt.dependientes.length)if(0===Bt.dependientes.length&&"1"===Bt.clienteEsTitularAsegurado&&(Bt.sexo=Bt.sexoCliente),Bt.comparaTitularD=!0,"TITULAR"===Bt.dataParentescoList.type.text&&x(),Bt.comparaTitularD){var t=Bt.dependientes.length+1;Bt.edadCliente=Y(Bt.fechaNacimientoCliente),Bt.dependientes.push({riskNumber:t,relationshipID:Bt.dataParentescoList.type.id,relationship:Bt.dataParentescoList.type.text,name:Bt.nombresCliente,lastName:Bt.primerApellidoCliente,secondLastName:Bt.segundoApellidoCliente,birthDate:moment(Bt.fechaNacimientoCliente).format("YYYY-MM-DD"),age:Bt.edadCliente,fiscalIDNumber:Bt.rfcCliente,curp:"",gender:"Masculino"===Bt.sexoCliente?1:0,genderDesc:Bt.sexoCliente,jobID:Bt.edadCliente>=18&&void 0!==Bt.dataOcupacionList.type?Bt.dataOcupacionList.type.id:"",jobDescription:Bt.edadCliente>=18&&void 0!==Bt.dataOcupacionList.type?Bt.dataOcupacionList.type.text:"",sport:void 0===Bt.dataDeporteList.type||"NINGUNO"===Bt.dataDeporteList.type.text?"":Bt.dataDeporteList.type.text,sportID:void 0===Bt.dataDeporteList.type||"NINGUNO"===Bt.dataDeporteList.type.text?"":Bt.dataDeporteList.type.id}),w(),Bt.faltaTitular=!1}else u.error("Solo puede existir un solo TITULAR");else u.error("El límite de dependientes económicos es "+Bt.dataNumAseguradosList.type.text)})}}function V(){j("cliente"),_()}function Q(){j("contratante"),H()}function q(){if(Bt.cont=0,Bt.cotizarDisabled=!0,void 0===s.$parent.agentSelected||null===s.$parent.agentSelected)return u.error("Favor de seleccionar un Agente para continuar."),void(Bt.cotizarDisabled=!1);angular.forEach(Bt.dependientes,function(e){"TITULAR"===e.relationship&&Bt.cont++}),Bt.dependientes.length===parseInt(Bt.dataNumAseguradosList.type.text)?1===Bt.cont?g():(0===Bt.cont?u.error("Favor de agregar un Titular."):u.error("Solo puede haber un asegurado Titular."),Bt.cotizarDisabled=!1):(u.error("El número de dependientes registrados es distinto al número de asegurados seleccionados. Favor de actualizar los dependientes registrados."),Bt.cotizarDisabled=!1)}function G(e,t,n){Bt.indexFormaPago=e,Bt.indexPaquete=t,Bt.indexPago=n;var o=Bt.jsonCotizacion.ofertaComercial.formasPago.formaPago,a=se();st(Bt.paquetes[Bt.indexPaquete].nom_paquete,Bt.paquetes[Bt.indexPaquete].cod_paquete,Bt.jsonCotizacion.quotationNumber),it(Bt.paquetes[Bt.indexPaquete].cod_paquete,o[Bt.indexFormaPago].pagoID,Bt.jsonCotizacion.quotationNumber),Bt.cajasMontos=new Array(o.length);for(var r=0;r<o.length;r++){Bt.cajasMontos[r]=new Array(a.length);for(var i=0;i<a.length;i++)if(Array.isArray(o[r].pagos.pago)){Bt.cajasMontos[r][i]=new Array(o[r].pagos.pago.length);for(var s=0;s<o[r].pagos.pago.length;s++)Bt.cajasMontos[r][i][s]=!1}else Bt.cajasMontos[r][i]=!1}Array.isArray(o[e].pagos.pago)?Bt.cajasMontos[e][t][n]=!0:Bt.cajasMontos[e][t]=!0,Z(Bt.oferta)}function J(){Bt.collapseInClassDatosRiesgo=!0;var e=0;angular.forEach(Bt.dependientes,function(t){t.riskNumber=++e}),Bt.emission.fechaInicioVigCotizacion=moment().format("DD/MM/YYYY"),Bt.emission.fechaFinVigCotizacion=moment().add(1,"years").format("DD/MM/YYYY");var n={insurancePolicyDate:moment(Bt.emission.fechaInicioVigCotizacion,"DD/MM/YYYY").format("YYYY-MM-DD"),policyMaturityDate:moment(Bt.emission.fechaFinVigCotizacion,"DD/MM/YYYY").format("YYYY-MM-DD"),customizeInsuranceQuotationFlag:0,businessPackage:"N",insuredPersonsQuantity:Bt.dependientes.length,discountCampaignValue:0,dependientes:JSON.stringify(Bt.dependientes),commissionCessionFlag:0,federalEntityID:Bt.cmd.estado.id,federalEntity:Bt.cmd.estado.text,delegationMunicipalityID:Bt.cmd.municipio.id,delegationOrMunicipality:Bt.cmd.municipio.text,agentCode:s.$parent.agentSelected.id,clientNumber:Bt.numeroCliente,adviserID:"951753"};t.getCotizacionSrv(n).then(function(e){e.success?(Bt.jsonCotizacion=e.info,Bt.oferta=Bt.jsonCotizacion.ofertaComercial.asegurados.asegurado,G(0,0,0),Z(Bt.oferta),W(),re(),l(),me(Bt.jsonCotizacion.ofertaComercial.formasPago.formaPago),Bt.primaN=Bt.formasPago[Bt.indexFormaPago].pagos[Bt.indexPago].montos[Bt.indexPaquete].primaneta,Bt.trianguloAzul="triangulo",Bt.trianguloBorde="trianguloBorde",Bt.pestCotiza=!0,Bt.pestEmision=!1,vt()):Bt.cotizarDisabled=!1}).catch(function(e){console.log(e),u.error("El servicio de cotización no está disponible por el momento."),Bt.cotizarDisabled=!1})}function K(e){t.getDetalleCotizacion(e).then(function(e){e.success?(Bt.jsonCotizacion=e.info,Bt.oferta=Bt.jsonCotizacion.ofertaComercial.asegurados.asegurado,Z(Bt.oferta),Nt(),v()):(u.error("Error al cargar esta Cotizacion."),f())}).catch(function(){u.error("Error al cargar esta Cotizacion."),f()})}function W(){for(var e=0;e<Bt.jsonCotizacion.xmlCoberturas.agrupado.grupo.length;e++)for(var t=0;t<Bt.jsonCotizacion.xmlCoberturas.agrupado.grupo[e].coberturas.cobertura.length;t++){var n=Bt.jsonCotizacion.xmlCoberturas.agrupado.grupo[e].coberturas.cobertura[t].intervalos;angular.forEach(n,function(o,a){if(7!==e&&(5!==e||4!==t))switch(a){case"sa":n.sa&&(n.sa.name="Suma asegurada");break;case"deducible":n.deducible&&(n.deducible.name="Deducible");break;case"coaseguro":n.coaseguro&&(n.coaseguro.name="Coaseguro");break;case"topecoaseguro":n.topecoaseguro&&(n.topecoaseguro.name="Tope de Coaseguro");break;case"deduciblePad":n.deduciblePad&&(n.deduciblePad.name="Deducible Pad.");break;case"tabulador":n.tabulador&&(n.tabulador.name="Tabulador");break;case"redHosp":n.redHosp&&(n.redHosp.name="Red hosp.");break;case"planDental":n.planDental&&(n.planDental.name="Plan Dental");break;case"planVision":n.planVision&&(n.planVision.name="Plan Visión");break;case"diaCarencia":
n.diaCarencia&&(n.diaCarencia.name="Días de carencia");break;case"saCarencia":n.saCarencia&&(n.saCarencia.name="Renta Diaria")}if(o&&o.intervalo){if(o.listIntervalo=X(o.intervalo),"23"===Bt.cmd.estado.id&&"redHosp"===a&&0===e)switch(Bt.cmd.municipio.id){case"23001":case"23003":case"23005":case"23008":Ot=o.listIntervalo.pop()}angular.forEach(o.listIntervalo,function(e){e.id===o.valDef&&(o.intervaloSelected=e)})}})}angular.forEach(n,function(e){e&&e.intervalo&&(e.listIntervalo=X(e.intervalo))})}function X(e){var t=[];return Array.isArray(e)?(angular.forEach(e,function(e){t.push({id:e.key,text:e.value})}),Bt.listaQuinta=t,t):""===e?0:(angular.forEach(pe(e),function(e){t.push({id:e.key,text:e.value})}),t)}function Z(e){var t=[],n=e;return Array.isArray(n)?angular.forEach(n,function(e,n){t.push(ee(e))}):t.push(ee(n)),Bt.asegurados=t,Bt.asegurados}function ee(e){var t=ne(e);return{edad:e.edad,nombre:e.nombre,num_riesgo:e.numRiesgo,ocupacion:e.ocupacion,parentesco:e.parentesco,sexo:e.sexo,suma_asegu:e.sumaAseg,paquete:t[Bt.indexPaquete].nomPaquete,formaPago:t[Bt.indexPaquete].formasPago.formaPago[Bt.indexFormaPago].nomForma,prima:t[Bt.indexPaquete].formasPago.formaPago[Bt.indexFormaPago].prima}}function te(e){return{codPaquete:e.codPaquete,nomPaquete:e.nomPaquete,formasPago:e.formasPago}}function ne(e){var t=[],n=e.paquetes.paquete;return Array.isArray(n)?angular.forEach(n,function(e){t.push(te(e))}):t.push(te(n)),t}function oe(e){return{cod_paquete:e.codPaquete,mca_opc:e.mcaOpc,mod_chk:e.modChk}}function ae(e){var t=[],n=e.paquetes.paquete;return Array.isArray(n)?angular.forEach(n,function(e){t.push(oe(e))}):t.push(oe(n)),t}function re(){Bt.grupos=[];for(var e=Bt.jsonCotizacion.xmlCoberturas.agrupado.grupo,t=0;t<e.length;t++){for(var n={grupo_desc:e[t].grupoDesc,grupo_id:e[t].grupoId},o=[],a=e[t].coberturas.cobertura,r=0;r<a.length;r++)o.push({cod_cob:a[r].codCob,intervalos:a[r].intervalos,nom_cob:a[r].nomCob,paquetes:ae(a[r]),sa_def:a[r].saDef,sa_des:a[r].saDes,tool_tip:a[r].toolTip});n.coberturas=o,Bt.grupos.push(n)}return Bt.grupos}function ie(e){return{cod_paquete:e.codPaquete,nom_paquete:e.nomPaquete}}function se(){var e=[],t=Bt.jsonCotizacion.ofertaComercial.paquetes.paquete;return Array.isArray(t)?angular.forEach(t,function(t){e.push(ie(t))}):e.push(ie(t)),Bt.paquetes=e,e}function ce(e){var t=[];return Array.isArray(e)?angular.forEach(e,function(e){t.push(ue(e))}):t.push(ue(e)),t}function ue(e){return{montos:le(e.montospaquetes.montos),numPagos:e.numPagos}}function le(e){var t=[];return Array.isArray(e)?angular.forEach(e,function(e){t.push(de(e))}):t.push(de(e)),t}function de(e){return{cod_paquete:e.codPaquete,derechos:e.derechos,impuestos:e.impuestos,monto:e.monto,primaneta:e.primaneta,primatotal:e.primatotal,recargos:e.recargos}}function me(e){Bt.formasPago=[];for(var t=e,n=0;n<t.length;n++)Bt.formasPago.push({pagoDesc:t[n].pagoDesc,pagoID:t[n].pagoID,pagos:ce(t[n].pagos.pago)});return Bt.formasPago}function pe(e){var t=[];return t.push(e),t}function fe(){var e=Bt.emitContratante;return Bt.emitContratante.edad>=18?!(e.tipoIdentificacion&&e.estado&&e.municipio&&e.profesion):!(e.tipoIdentificacion&&e.estado&&e.municipio)}function ge(e){if(0===e)return fe();var t=e-1;return Bt.emitDependientes[t].age>=18?!Bt.emitDependientes[t].businessID||!Bt.emitDependientes[t].professionID:!Bt.emitDependientes[t].businessID}function he(e,t,n,o,a,r){var i="",s="";"deducible"===a&&0===n&&(Bt.grupos[n].coberturas[0].intervalos.deduciblePad.intervaloSelected.text="PADECIMIENTO",Bt.grupos[n].coberturas[0].intervalos.deduciblePad.intervaloSelected.id="1",i=Bt.grupos[0].coberturas[0].intervalos.deduciblePad.nomDv,s=ve(i),Bt.jsonCotizacion.ofertaComercial.datosVarCob[s]=Bt.grupos[n].coberturas[0].intervalos.deduciblePad.intervaloSelected.id,Xe(t.id),We(t.id),Ze(t.id)),"sa"===a&&0===n&&(Bt.grupos[n].coberturas[0].intervalos.topecoaseguro.intervaloSelected.text="SIN LÍMITE",Bt.grupos[n].coberturas[0].intervalos.topecoaseguro.intervaloSelected.id="1",i=Bt.grupos[0].coberturas[0].intervalos.topecoaseguro.nomDv,s=ve(i),Bt.jsonCotizacion.ofertaComercial.datosVarCob[s]=Bt.grupos[n].coberturas[0].intervalos.topecoaseguro.intervaloSelected.id,et(t.id)),"23"===Bt.cmd.estado.id&&0===n&&"tabulador"===a&&("23001"!==Bt.cmd.municipio.id&&"23003"!==Bt.cmd.municipio.id&&"23005"!==Bt.cmd.municipio.id&&"23008"!==Bt.cmd.municipio.id||c(function(){null!==Ot||"A"!==r.intervaloSelected.text&&"B"!==r.intervaloSelected.text&&"C"!==r.intervaloSelected.text?null===Ot||"D"!==r.intervaloSelected.text&&"E"!==r.intervaloSelected.text&&"F"!==r.intervaloSelected.text||(Bt.grupos[0].coberturas[0].intervalos.redHosp.listIntervalo.push(Ot),Bt.grupos[0].coberturas[0].intervalos.redHosp.intervaloSelected=Bt.grupos[0].coberturas[0].intervalos.redHosp.listIntervalo[0],Ot=null):(Ot=Bt.grupos[0].coberturas[0].intervalos.redHosp.listIntervalo.pop(),Bt.grupos[0].coberturas[0].intervalos.redHosp.intervaloSelected=Bt.grupos[0].coberturas[0].intervalos.redHosp.listIntervalo[0])},100)),"planDental"===a?(Bt.grupos[n].coberturas[1].intervalos.planVision.intervaloSelected=t,i=Bt.grupos[n].coberturas[1].intervalos.planVision.nomDv,s=ve(i),Bt.jsonCotizacion.ofertaComercial.datosVarCob[s]=t.id):"planVision"===a&&(Bt.grupos[n].coberturas[0].intervalos.planDental.intervaloSelected=t,i=Bt.grupos[n].coberturas[0].intervalos.planDental.nomDv,s=ve(i),Bt.jsonCotizacion.ofertaComercial.datosVarCob[s]=t.id),Bt.recotizacionDisabled=!1,Bt.emailDisabled=!0,s=ve(r.nomDv),Bt.jsonCotizacion.ofertaComercial.datosVarCob[s]=t.id}function ve(e){for(var t=e.split("_"),n=1;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join("")}function ye(){Bt.recotizacionDisabled=!1,Bt.emailDisabled=!0}function be(e,t,n){5===e&&0===t?Bt.grupos[e].coberturas[1].paquetes[n].mod_chk=Bt.grupos[e].coberturas[t].paquetes[n].mod_chk:5===e&&1===t?Bt.grupos[e].coberturas[0].paquetes[n].mod_chk=Bt.grupos[e].coberturas[t].paquetes[n].mod_chk:1===e&&0===t?Bt.grupos[e].coberturas[1].paquetes[n].mod_chk=Bt.grupos[e].coberturas[t].paquetes[n].mod_chk:1===e&&1===t&&(Bt.grupos[e].coberturas[0].paquetes[n].mod_chk=Bt.grupos[e].coberturas[t].paquetes[n].mod_chk)}function Ce(){Bt.firmaDibujadaServicioTitular=!0,Bt.pintarLineaTitular=!0,Bt.lineasTitular.push([])}function Se(e){e.preventDefault(),Bt.pintarLineaTitular&&(Bt.ctxTitular.lineJoin=Bt.ctxTitular.lineCap="round",Bt.ctxTitular.lineWidth=2,Bt.ctxTitular.strokeStyle="black",Bt.nuevaPosicionXTitular=0,Bt.nuevaPosicionYTitular=0,void 0===e.changedTouches?(Bt.nuevaPosicionXTitular=e.offsetX,Bt.nuevaPosicionYTitular=e.offsetY):(Bt.nuevaPosicionXTitular=e.changedTouches[0].pageX-Bt.correccionXTitular,Bt.nuevaPosicionYTitular=e.changedTouches[0].pageY-Bt.correccionYTitular),Bt.lineasTitular[Bt.lineasTitular.length-1].push({x:Bt.nuevaPosicionXTitular,y:Bt.nuevaPosicionYTitular}),Bt.ctxTitular.beginPath(),Bt.lineasTitular.forEach(function(e){Bt.ctxTitular.moveTo(e[0].x,e[0].y),e.forEach(function(e){Bt.ctxTitular.lineTo(e.x,e.y)})}),Bt.ctxTitular.stroke())}function De(){Bt.pintarLineaTitular=!1}function Me(){Bt.steps.emision&&(Bt.canvasTitular=document.querySelector("#canvasFirmaTitular"),Bt.ctxTitular=Bt.canvasTitular.getContext("2d"),Bt.lineasTitular=[],Bt.correccionXTitular=0,Bt.correccionYTitular=0,Bt.pintarLineaTitular=!1,Bt.posicionTitular=Bt.canvasTitular.getBoundingClientRect(),Bt.correccionXTitular=Bt.posicionTitular.x,Bt.correccionYTitular=Bt.posicionTitular.y,Bt.canvasTitular.width=500,Bt.canvasTitular.height=200)}function Ae(){Bt.firmaDibujadaServicioContratante=!0,Bt.pintarLineaContratante=!0,Bt.lineasContratante.push([])}function Pe(e){e.preventDefault(),Bt.pintarLineaContratante&&(Bt.ctxContratante.lineJoin=Bt.ctxContratante.lineCap="round",Bt.ctxContratante.lineWidth=2,Bt.ctxContratante.strokeStyle="black",Bt.nuevaPosicionXContratante=0,Bt.nuevaPosicionYContratante=0,void 0===e.changedTouches?(Bt.nuevaPosicionXContratante=e.offsetX,Bt.nuevaPosicionYContratante=e.offsetY):(Bt.nuevaPosicionXContratante=e.changedTouches[0].pageX-Bt.correccionXContratante,Bt.nuevaPosicionYContratante=e.changedTouches[0].pageY-Bt.correccionYContratante),Bt.lineasContratante[Bt.lineasContratante.length-1].push({x:Bt.nuevaPosicionXContratante,y:Bt.nuevaPosicionYContratante}),Bt.ctxContratante.beginPath(),Bt.lineasContratante.forEach(function(e){Bt.ctxContratante.moveTo(e[0].x,e[0].y),e.forEach(function(e){Bt.ctxContratante.lineTo(e.x,e.y)})}),Bt.ctxContratante.stroke())}function Ee(){Bt.pintarLineaContratante=!1}function Ie(){Bt.steps.emision&&(Bt.canvasContratante=document.querySelector("#canvasFirmaContratante"),Bt.ctxContratante=Bt.canvasContratante.getContext("2d"),Bt.ctxContratante.fillStyle="#fff",Bt.ctxContratante.fillRect(0,0,Bt.canvasContratante.width,Bt.canvasContratante.height),Bt.lineasContratante=[],Bt.correccionXContratante=0,Bt.correccionYContratante=0,Bt.pintarLineaContratante=!1,Bt.posicionContratante=Bt.canvasContratante.getBoundingClientRect(),Bt.correccionXContratante=Bt.posicionContratante.x,Bt.correccionYContratante=Bt.posicionContratante.y,Bt.canvasContratante.width=500,Bt.canvasContratante.height=200)}function Te(){Bt.firmaDibujadaServicioAgente=!0,Bt.lineasAgente.push([]),Bt.pintarLineaAgente=!0}function ke(e){e.preventDefault(),Bt.pintarLineaAgente&&(Bt.ctxAgente.lineJoin=Bt.ctxAgente.lineCap="round",Bt.ctxAgente.lineWidth=2,Bt.ctxAgente.strokeStyle="black",Bt.nuevaPosicionXAgente=0,Bt.nuevaPosicionYAgente=0,void 0===e.changedTouches?(Bt.nuevaPosicionXAgente=e.offsetX,Bt.nuevaPosicionYAgente=e.offsetY):(Bt.nuevaPosicionXAgente=e.changedTouches[0].pageX-Bt.correccionXAgente,Bt.nuevaPosicionYAgente=e.changedTouches[0].pageY-Bt.correccionYAgente),Bt.lineasAgente[Bt.lineasAgente.length-1].push({x:Bt.nuevaPosicionXAgente,y:Bt.nuevaPosicionYAgente}),Bt.lineasAgente&&Bt.ctxAgente.beginPath(),Bt.lineasAgente.forEach(function(e){Bt.ctxAgente.moveTo(e[0].x,e[0].y),e.forEach(function(e){Bt.ctxAgente.lineTo(e.x,e.y)})}),Bt.ctxAgente.stroke())}function Re(){Bt.pintarLineaAgente=!1}function xe(){Bt.steps.emision&&(Bt.canvasAgente=document.querySelector("#canvasFirmaAgente"),Bt.ctxAgente=Bt.canvasAgente.getContext("2d"),Bt.ctxAgente.fillStyle="#fff",Bt.ctxAgente.fillRect(0,0,Bt.canvasAgente.width,Bt.canvasAgente.height),Bt.lineasAgente=[],Bt.correccionXAgente=0,Bt.correccionYAgente=0,Bt.pintarLineaAgente=!1,Bt.posicionAgente=Bt.canvasAgente.getBoundingClientRect(),Bt.correccionXAgente=Bt.posicionAgente.x,Bt.correccionYAgente=Bt.posicionAgente.y,Bt.canvasAgente.width=500,Bt.canvasAgente.height=200)}function Ne(){Bt.ctxContratante.clearRect(0,0,Bt.canvasContratante.width,Bt.canvasContratante.height),Bt.lineasContratante=[],Bt.correccionXContratante=0,Bt.correccionYContratante=0,Bt.pintarLineaContratante=!1,Bt.firmaDibujadaServicioContratante=!1}function we(e){if("1"===Bt.jsonCuestionario[0].answerDataList.answerSelected[e].id){for(var t=0;t<Bt.jsonCuestionario[0].subquestionDataList.subquestionData.length;t++)Bt.jsonCuestionario[0].subquestionDataList.subquestionData[t].answerDataList.answerSelected[e]=Bt.jsonCuestionario[0].subquestionDataList.subquestionData[t].answerDataList.answerList[0];return!0}return!1}function Oe(){for(var e=[],t=0;t<Bt.asegurados.length;t++)e[t]="";return e}function Be(){Bt.ctxAgente.clearRect(0,0,Bt.canvasAgente.width,Bt.canvasAgente.height),Bt.lineasAgente=[],Bt.correccionXAgente=0,Bt.correccionYAgente=0,Bt.pintarLineaAgente=!1,Bt.firmaDibujadaServicioAgente=!1}function Le(){Bt.ctxTitular.clearRect(0,0,Bt.canvasTitular.width,Bt.canvasTitular.height),Bt.lineasTitular=[],Bt.correccionXTitular=0,Bt.correccionYTitular=0,Bt.pintarLineaTitular=!1,Bt.firmaDibujadaServicioTitular=!1}function Fe(){var e={language:"SPA",usuario:Bt.emitContratante.nombres,nombreUsuario:Bt.emitContratante.nombres,apellidoUsuario:Bt.emitContratante.primerApellido,fecNacimiento:moment(Bt.emitContratante.fechaNacimiento).format("DD/MM/YYYY"),nacionalidad:"MEXICANA",rfc:Bt.emitContratante.rfc,nombre:Bt.fileName,contenido:Bt.fileB64};n.setMedicalExpenseDocsRegistration(e).then(function(e){e.success&&console.log("setMedicalExpenseDocsRegistration correcto")}).catch(function(e){console.log("error carga de documento: ",e)})}function je(){var e=[];return t.getCatalogExpenseJob().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.jobID,text:t.jobDescription})}),Bt.listaCatalagoOcupaciones=e}),e}function $e(){var e=[];return t.getCatalogExpenseSports().then(function(t){t.success&&(e.push({id:"1",text:"NINGUNO"}),angular.forEach(t.info,function(t){e.push({id:t.sportID,text:t.sport})}))}),e}function Ye(){var e=[];return t.getCatalogPolicyNumber().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.policyHolderID,text:t.policyHolderDescription})})}),e}function He(){Bt.emitContratante.municipio?Bt.validaMunEmission=!1:Bt.validaMunEmission=!0}function _e(){Bt.cmd.municipio?Bt.validaMun=!1:Bt.validaMun=!0}function Ue(){var e=[];return t.getCatalogMedicalState().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.stateID,text:t.stateDescription})})}),Bt.entidadesEmision=e,Bt.entidadesEmision}function ze(){var e=[];return t.getCatalogMedicalState().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.stateID,text:t.stateDescription})})}),e}function Ve(e,t,n,o,a,r){null!==o&&""!==o?Bt.jsonCuestionario[a].answerDataList.answerSelected[n]=Bt.jsonCuestionario[a].answerDataList.answerList[r]:Bt.jsonCuestionario[a].subquestionDataList.subquestionData[o].answerDataList.answerSelected[n]=Bt.jsonCuestionario[a].subquestionDataList.subquestionData[o].answerDataList.answerList[r]}function Qe(e,t){Bt.showCollapseDatosCliente=!0,Bt.collapseInClassDatosCliente=!0,parseInt(t.text)<Bt.dependientes.length&&u.error("El número de dependientes registrados es mayor al número de asegurados seleccionados. Favor de actualizar los dependientes registrados.")}function qe(e){var n=[];return t.getCatalogMedicalLocation(e.id).then(function(e){e.success&&angular.forEach(e.info,function(e){n.push({id:e.locationID,text:e.locationDescription})}),Bt.emitContratante||(Bt.emitContratante={}),Bt.emitContratante.municipio=null,Bt.ListMedicalLocacionEmission=n,He()}),Bt.ListMedicalLocacionEmission}function Ge(e){var n=[];return t.getCatalogMedicalLocation(e.id).then(function(e){e.success&&angular.forEach(e.info,function(e){n.push({id:e.locationID,text:e.locationDescription})}),Bt.cmd||(Bt.cmd={}),Bt.cmd.municipio=null,Bt.ListMedicalLocacion=n,_e()}),Bt.ListMedicalLocacion}function Je(){var e=[];return t.getMedicalExpenseRelationship().then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.expenseRelationshipID,text:t.expenseRelationshipDescription})}),Bt.dataParentescoList={},Bt.dataParentescoList.type=e[0])}),e}function Ke(){var e=[];return t.getCatalogExpenseProfessions().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.professionID,text:t.profession})})}),e}function We(e){var n=[];t.getMedicalExpenseDeductible(e).then(function(e){e.success&&(angular.forEach(e.info,function(e){n.push({id:e.deductibleID,text:e.deductibleDescription})}),Bt.listaDeduciblePad=n,Bt.grupos[0].coberturas[0].intervalos.deduciblePad.listIntervalo=Bt.listaDeduciblePad)})}function Xe(e){var n=[];t.getMedicalExpenseCoinsurance(e).then(function(e){e.success&&(angular.forEach(e.info,function(e){n.push({id:e.coinsuranceID,text:e.coinsuranceDescription})}),Bt.listaCoaseguro=n,Bt.grupos[0].coberturas[0].intervalos.coaseguro.listIntervalo=Bt.listaCoaseguro)})}function Ze(e){var n=[];t.getMedicalExpenseDeductibleRed(e).then(function(e){e.success&&(angular.forEach(e.info,function(e){n.push({id:e.deductibleRedID,text:e.deductibleRedDescription})}),Bt.listaDeducibleRed=n,5===Bt.grupos.length?Bt.grupos[1].coberturas[4].intervalos.sa.listIntervalo=Bt.listaDeducibleRed:Bt.grupos[5].coberturas[4].intervalos.sa.listIntervalo=Bt.listaDeducibleRed)})}function et(e){var n=[];t.getMedicalExpenseMaxCoinsurance(e).then(function(e){e.success&&(angular.forEach(e.info,function(e){n.push({id:e.maxCoinsuranceID,text:e.maxCoinsuranceDescription})}),Bt.listaTopeCoaseguro=n,Bt.grupos[0].coberturas[0].intervalos.topecoaseguro.listIntervalo=Bt.listaTopeCoaseguro)})}function tt(){var e=[],n={language:"SPA"};return t.getInsuranceCountryQuery(n).then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.countryISO,text:t.country})})}),e}function nt(){Bt.emitContratante||(Bt.emitContratante={}),Bt.emitContratante.paisNacimiento={type:{id:"MEX",text:"MEXICO"}},Bt.emitContratante.nacionalidad={type:{id:"MEX",text:"MEXICO"}};for(var e=0;e<Bt.emitDependientes.length;e++)Bt.comboDependientes[e]||(Bt.comboDependientes[e]={}),Bt.comboDependientes[e].pais={id:"MEX",text:"MEXICO"},Bt.comboDependientes[e].nacionalidad={id:"MEX",text:"MEXICO"},Bt.emitDependientes[e].nacionality="MEX",Bt.emitDependientes[e].countryISO="MEX"}function ot(){var e=[];return t.getInsuranceBusinessActivityQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.businessID,text:t.businessName})})}),e}function at(){var e=[];return t.getInsuranceIdentificationTypeQuery().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.identificationTypeID,text:t.identificationType})})}),e}function rt(){var e={language:"SPA",usuario:Bt.emitContratante.nombres,nombreUsuario:Bt.emitContratante.nombres,apellidoUsuario:Bt.emitContratante.primerApellido,fecNacimiento:moment(Bt.emitContratante.fechaNacimiento).format("DD/MM/YYYY"),nacionalidad:"MEXICANA",rfc:Bt.emitContratante.rfc,nomArchivo:"FIRMA"+Bt.emission.policyNumber+".jpg",base64:Bt.firmasEnBase64};n.servicioFirmas(e).then(function(e){e.success})}function it(e,t,o){var a={language:"SPA",quotationNumber:o,packageCode:e,paymentMethod:t};n.saveSelection(a).then(function(e){e.success})}function st(e,t,o){var a={language:"SPA",quotationNumber:o,_package:e,packageCode:t};n.updateRequest(a).then(function(e){e.success})}function ct(){console.log("comienza a emitir"),Bt.clientData={name:Bt.emitContratante.nombres,lastName:Bt.emitContratante.primerApellido,secondLastName:Bt.emitContratante.segundoApellido,birthDate:moment(Bt.emitContratante.fechaNacimiento,"DD/MM/YYYY").format("YYYY-MM-DD"),age:Bt.emitContratante.edad?Bt.emitContratante.edad:"",gender:"masculino"===Bt.emitContratante.sexContract?"1":"0",curp:Bt.emitContratante.curp?Bt.emitContratante.curp.toUpperCase():"",fiscalIDNumber:Bt.emitContratante.rfc,renewalNumber:"0",imcAttemps:"0",countryISO:Bt.emitContratante.paisNacimiento?Bt.emitContratante.paisNacimiento.type.id:"",nacionality:Bt.emitContratante.nacionalidad.type.id,professionID:Bt.emitContratante.profesion?Bt.emitContratante.profesion.type.id:""},Bt.notificationMeansData={email:Bt.emitContratante.email?Bt.emitContratante.email:"",cellPhone:Bt.emitContratante.celular?Bt.emitContratante.celular:"",phoneNumber:Bt.emitContratante.telefono?Bt.emitContratante.telefono:""},Bt.addressData={street:Bt.emitContratante.calle,outdoorNumber:Bt.emitContratante.numeroExterior,interiorNumber:Bt.emitContratante.numeroInterior?Bt.emitContratante.numeroInterior:"",postalCode:Bt.emitContratante.codigoPostal,federalEntityID:Bt.emitContratante.estado.id,delegationMunicipalityID:Bt.emitContratante.municipio.id,neighborhood:Bt.emitContratante.colonia};var e={language:"SPA",clientData:JSON.stringify(Bt.clientData),notificationMeansData:JSON.stringify(Bt.notificationMeansData),addressData:JSON.stringify(Bt.addressData),dependentDataList:JSON.stringify(Bt.emitDependientes),accidentalDeathFlag:!1,insurancePolicyDate:moment().format("YYYY-MM-DD"),policyMaturityDate:moment().add(1,"years").format("YYYY-MM-DD"),quotationNumber:Bt.emission.quotationNumber,quotationName:"",agentCode:s.$parent.agentSelected.id,personType:Bt.tipoPersona="F",companyName:"",establishmentDate:"1996-08-10",businessID:0,identificationTypeID:Bt.emitContratante.tipoIdentificacion.type.id,numberID:64464654654546,clientNumber:Bt.numeroCliente,adviserID:"951753"};n.getMedExpInsurancePolicyRegistration(e).then(function(t){t.success?(console.log("éxito al emitir",t.info),Bt.jsonEmision=t.info,Bt.emission.policyNumber=Bt.jsonEmision.policyNumber,Bt.firmaDibujadaServicioTitular&&Bt.firmaDibujadaServicioAgente&&Bt.firmaDibujadaServicioContratante&&Bt.firmaLabel&&C(),ft(e,t)):(2===t.info.result&&t.info.messages&&t.info.messages.length>0&&t.info.messages[0].responseMessage.includes("LA FECHA DE NACIMIENTO ES DIFERENTE A LA FECHA CONTENIDA EN EL RFC")?u.error("No se ha podido realizar la emisión. La fecha de nacimiento es diferente a la fecha contenida en el RFC."):u.error("No se ha podido realizar la emisión. Intente más tarde. Error 1"),Bt.emitirDisabled=!1)}).catch(function(e){console.log("error emision: ",e),u.error("No se ha podido realizar la emisión. Intente más tarde. Error 2"),Bt.emitirDisabled=!1})}function ut(){n.getMedExpInsuranceQuestionnaireQuery().then(function(e){e.success&&(Bt.jsonCuestionario=e.info.questionData,angular.forEach(Bt.jsonCuestionario,function(e){e.freeTextFlag&&(e.answerDataList.answerInput=Oe()),void 0!==e.answerDataList.answerData&&0!==e.answerDataList.answerData.length&&(e.answerDataList.answerList=dt(e.answerDataList.answerData),angular.forEach(e.answerDataList.answerData,function(t){e.value===t.key&&(e.answerDataList.answerSelected=lt(t))})),angular.forEach(e.subquestionDataList.subquestionData,function(e){void 0!==e.answerDataList.answerData&&0!==e.answerDataList.answerData.length&&(e.answerDataList.answerList=dt(e.answerDataList.answerData),angular.forEach(e.answerDataList.answerData,function(t){e.value===t.key&&(e.answerDataList.answerSelected=lt(t))}))})}),console.log(Bt.jsonCuestionario))})}function lt(e){for(var t=[],n=0;n<Bt.asegurados.length;n++)t[n]={id:e.key,text:e.value};return t}function dt(e){var t=[];return Array.isArray(e)?(angular.forEach(e,function(e){t.push({id:e.key,text:e.value})}),t):""===e?0:(angular.forEach(pe(e),function(e){t.push({id:e.key,text:e.value})}),t)}function mt(){Bt.emitirDisabled=!0,Bt.answer={answerDataList:[]},angular.forEach(Bt.jsonCuestionario,function(e){var t=[];angular.forEach(e.answerDataList.answerSelected,function(n,o){var a={riskNumber:Bt.asegurados[o].num_riesgo,answer:n.id};e.freeTextFlag&&(console.log("value.freeTextFlag ",e.freeTextFlag,e.questionID),"2"===n.id&&(a.freeText=e.answerDataList.answerInput[o])),t.push({dependentData:a})}),t.length>0&&Bt.answer.answerDataList.push({answerData:{questionID:e.questionID,dependentDataList:t}}),e.subquestionDataList&&e.subquestionDataList.subquestionData&&e.subquestionDataList.subquestionData.length>0&&angular.forEach(e.subquestionDataList.subquestionData,function(e){var t=[];e.answerDataList.answerSelected&&(angular.forEach(e.answerDataList.answerSelected,function(e,n){t.push({dependentData:{riskNumber:Bt.asegurados[n].num_riesgo,answer:e.id}})}),t.length>0&&Bt.answer.answerDataList.push({answerData:{questionID:e.questionID,dependentDataList:t}}))})}),console.log("vm.answer, ",Bt.answer);var e={language:"SPA",quotationNumber:Bt.emission.quotationNumber,answerDataList:JSON.stringify(Bt.answer)};n.getMedExpInsuranceQuestRegistration(e).then(function(e){e.success?(console.log("éxito al mandar cuestionario 1"),pt(),console.log("éxito al mandar cuestionario 2")):Bt.emitirDisabled=!1}).catch(function(e){console.log("error registro cuestionario: ",e),Bt.emitirDisabled=!1})}function pt(){var e={language:"SPA",numSolicitud:Bt.emission.quotationNumber};n.getMedExpInsuranceQuestValidation(e).then(function(e){if(console.log("validar cuestionario",e),e.success){console.log("éxito al validar cuestionario",e.info),Bt.jsonValidacionC=e.info;var t=!1,n="";angular.forEach(Bt.jsonValidacionC,function(e){""===e.padExcl&&""===e.padPunt&&""===e.padRechazo||(t=!0,n+=e.nomRiesgo+", ")}),t?(u.error("Debido a que no cumple con los parámetros aceptados de suscripción, no es posible asegurar a "+n+" por lo cual se procederá a la cancelación de la cotización."),bt(),r.go("insurance.main")):ct()}else u.error("No se ha podido realizar la emisión de la póliza. Inténtelo más tarde."),Bt.emitirDisabled=!1}).catch(function(e){console.log("error validacion: ",e),u.error("No es posible realizar la emisión de la póliza en este momento. Inténtelo más tarde."),Bt.emitirDisabled=!1})}function ft(e,t){var o={language:"SPA",codSecc:"2",ntSegCAcceso:"99687",wfSisCDocu:"1",codAgente:s.$parent.agentSelected.id,contratante:"0",complementarios:"0",rfcAsegStr:Bt.titular.fiscalIDNumber,nomTercero:Bt.titular.name,apePaterno:Bt.titular.lastName,apeMaterno:Bt.titular.secondLastName,domicilio:Bt.emitContratante.calle+" "+Bt.emitContratante.numeroExterior+" "+Bt.emitContratante.numeroInterior,codPostal:Bt.emitContratante.codigoPostal,colonia:Bt.emitContratante.colonia,fechaNacimiento:moment(Bt.titular.birthDate,"YYYY-MM-DD").format("DD-MM-YYYY"),pTipoPersona:"F",pNacionalidad:Bt.emitContratante.nacionalidad.type.id,fecIniVig:moment().format("DD-MM-YYYY"),fecFinVig:moment().add(1,"years").format("DD-MM-YYYY"),productoAeInt:"34",planAeInt:"3401",codRamo:"288",contrato:"28801",observaciones:"SE EMITE LA PÓLIZA: "+Bt.emission.policyNumber+" FAVOR DE LIBERAR EN CASO DE QUE LA INFORMACIÓN SEA CORRECTA, SALUDOS Y GRACIAS.",numPoliza:Bt.emission.policyNumber,movimientoPoli:"0"};n.setMedicalExpenseProcessingRequest(o).then(function(e){e.success?(console.log("apertura correcta ",e),Bt.emission.numeroTramite=e.info.wfOtMOt,yt()):(u.error("No se ha podido realizar la apertura del trámite. Inténtelo más tarde. Error 1"),Bt.emitirDisabled=!1)}).catch(function(e){console.log("error tramite: ",e),u.error("No se ha podido realizar la apertura del trámite. Inténtelo más tarde. Error 2"),Bt.emitirDisabled=!1})}function gt(){Bt.coverageDataList=[],angular.forEach(Bt.grupos,function(e){angular.forEach(e.coberturas,function(e){var t="1";e.intervalos.sa&&(t=e.intervalos.sa.intervaloSelected.id);var n=[];angular.forEach(e.paquetes,function(e){var t=!1;("S"===e.mca_opc&&"1"===e.mod_chk||"N"===e.mca_opc)&&(t=!0),n.push({packageCode:parseInt(e.cod_paquete),contractedPackageFlag:t})}),Bt.coverageDataList.push({coverageCode:parseInt(e.cod_cob),insuredSum:parseInt(t),packageDataList:n})})})}function ht(){gt();var e={language:"SPA",dependentDataList:JSON.stringify(Bt.dependientes),coverageDataList:JSON.stringify(Bt.coverageDataList),datosVarCob:JSON.stringify(Bt.jsonCotizacion.ofertaComercial.datosVarCob),quotationNumber:Bt.jsonCotizacion.quotationNumber,insurancePolicyDate:moment().format("YYYY-MM-DD"),policyMaturityDate:moment().add(1,"years").format("YYYY-MM-DD"),customizeInsuranceQuotationFlag:0,businessPackage:"N",insuredPersonsQuantity:Bt.dependientes.length,_package:Bt.paquetes[Bt.indexPaquete].nom_paquete,discountCode:"",discountCampaignID:"",discountCampaignValue:0,commissionCessionFlag:0,federalEntityID:Bt.cmd.estado.id,federalEntity:Bt.cmd.estado.text,delegationMunicipalityID:Bt.cmd.municipio.id,delegationOrMunicipality:Bt.cmd.municipio.text,agentCode:s.$parent.agentSelected.id};t.getMedicalExpenseInsuranceRequotation(e).then(function(e){e.success?(Bt.jsonRecotizacion=e.info,Bt.formasPago=me(Bt.jsonRecotizacion.ofertaComercial.formasPago.formaPago),Bt.oferta=Bt.jsonRecotizacion.ofertaComercial.asegurados.asegurado,Z(Bt.oferta),Bt.emailDisabled=!1,Bt.recotizacionDisabled=!0):(Bt.recotizacionDisabled=!1,u.error("El servicio de recotización  no está disponible por el momento."))})}function vt(){Bt.titular={},angular.forEach(Bt.dependientes,function(e){"TITULAR"===e.relationship&&(Bt.titular=e)});var e=Bt.tipoPersona;e="1"===Bt.tipoPersona||"F"===Bt.tipoPersona?"1":"2";var t={language:"SPA",idCliente:Bt.numeroCliente,idCotizacion:Bt.jsonCotizacion.quotationNumber,idPoliza:0,fechaCotizacion:moment(new Date).format("YYYY-MM-DD"),vigenciaCotizacion:moment(new Date,"YYYY-MM-DD").add(15,"days").format("YYYY-MM-DD"),monto:0,tipoCliente:e,isCliente:"9999"===Bt.numeroCliente?"0":"1",nombreCliente:"1"===e?Bt.datosCliente?Bt.datosCliente.name:Bt.titular.name.toUpperCase():Bt.datosCliente?Bt.datosCliente.companyName.toUpperCase():Bt.titular.name.toUpperCase(),apellidoPaternoCliente:"1"===e?Bt.datosCliente?Bt.datosCliente.lastName:Bt.titular.lastName.toUpperCase():Bt.datosCliente?"":Bt.titular.lastName.toUpperCase(),apellidoMaternoCliente:"1"===e?Bt.datosCliente?Bt.datosCliente.secondLastName:Bt.titular.secondLastName.toUpperCase():Bt.datosCliente?"":Bt.titular.secondLastName.toUpperCase(),fechaNacimiento:Bt.datosCliente?moment(Bt.fechaNacimiento,"DD/MM/YYYY").format("YYYY-MM-DD"):Bt.titular.birthDate,rfcCliente:Bt.datosCliente?Bt.datosCliente.fiscalIDNumber:Bt.titular.fiscalIDNumber,sexoCliente:Bt.datosCliente?"1":1===Bt.titular.gender?"1":"2",mailCliente:Bt.datosCliente?Bt.email:"email@email.com",telefonoCliente:Bt.datosCliente?Bt.telefono:"5555555555",quotationJsonInit:{},quotationJsonEnd:{},productKey:"PMM"};a.getCotizationAdd(t).then(function(e){e.success?(Bt.steps.recotizacion=!0,Bt.collapseInClassDatosRiesgo=!1,Bt.collapseInClassRequotationDetail=!0,Bt.recotizacionDisabled=!0,Bt.emailDisabled=!1,u.done("Envío de Cotización exitosa Número de Cotización: "+Bt.jsonCotizacion.quotationNumber)):u.error("Envío de Cotización no fue exitoso."),Bt.cotizarDisabled=!1}).catch(function(){Bt.cotizarDisabled=!1})}function yt(){var e={language:"SPA",idCotizacion:Bt.emission.quotationNumber,idPoliza:Bt.emission.policyNumber,quotationJsonInit:{},quotationJsonEnd:{},numberAuthorizer:Bt.emission.numeroTramite};n.procedureQuotation(e).then(function(e){e.success?(u.done("Proceso Exitoso. Número de trámite asignado: "+Bt.emission.numeroTramite),Bt.steps.emision=!1,Bt.steps.entrega=!0):u.error("El servicio de emisión no está disponible por el momento. Error 1"),Bt.emitirDisabled=!1}).catch(function(e){console.log("error actualizar: ",e),u.error("El servicio de emisión no está disponible por el momento. Error 2"),Bt.emitirDisabled=!1})}function bt(){var e={language:"SPA",idCotizacion:Bt.emission.quotationNumber,idPoliza:Bt.emission.quotationNumber,quotationJsonInit:{},quotationJsonEnd:{},numberAuthorizer:"0"};n.cancelQuotation(e).then(function(e){e.success?console.log("cancelacion exitosa"):console.log("cancelacion no exitosa 1")}).catch(function(){console.log("cancelacion no exitosa 2")})}function Ct(){var e=Lt,t={language:"SPA",estado:"VIGENTE",idCliente:e.numeroCliente,productKey:"PMM"};a.getListQuotations(t).then(function(e){"not-found"!==e.info&&e.info.length>0?(Bt.steps.search=!0,angular.forEach(e.info,function(t,n){e.info[n].fechaCotizacion=moment(new Date(t.fechaCotizacion)).format("DD/MM/YYYY"),e.info[n].vigenciaCotizacion=moment(new Date(t.vigenciaCotizacion)).format("DD/MM/YYYY"),t.apellidoPaternoCliente||(t.apellidoPaternoCliente=""),t.apellidoMaternoCliente||(t.apellidoMaternoCliente=""),e.info[n].nombreCompleto=t.nombreCliente+" "+t.apellidoPaternoCliente+" "+t.apellidoMaternoCliente}),Bt.responseAvailableQuotation=e.info):p()})}function St(e){Bt.emission.quotationNumber=e}function Dt(){var e;if(Bt.dependientes.length>0){for(e=0;e<Bt.dependientes.length;e++)if(Bt.emitContratante.rfc===Bt.dependientes[e].fiscalIDNumber&&Bt.emitContratante.sexContract.toLowerCase()!==Bt.dependientes[e].genderDesc.toLowerCase())return u.error("El sexo del contratante no es igual al del asegurado "+Bt.dependientes[e].relationship),!0}else if(0===Bt.dependientes.length)for(e=0;e<Bt.emitDependientes.length;e++)if(Bt.emitContratante.rfc===Bt.emitDependientes[e].fiscalIDNumber&&Bt.emitContratante.sexContract.toLowerCase()!==Bt.emitDependientes[e].genderDesc.toLowerCase())return u.error("El sexo del contratante no es igual al del asegurado "+Bt.emitDependientes[e].relationship),!0}function Mt(){var e;if(Bt.dependientes.length>0){
for(e=0;e<Bt.dependientes.length;e++)if(Bt.emitDependientes[e].fiscalIDNumber===Bt.emitContratante.rfc&&Bt.emitDependientes[e].genderDesc.toLowerCase()!==Bt.emitContratante.sexContract.toLowerCase())return u.error("El sexo del asegurado "+Bt.emitDependientes[e].relationship+" no es igual al del contratante"),!0}else if(0===Bt.dependientes.length)for(e=0;e<Bt.emitDependientes.length;e++)if(Bt.emitDependientes[e].fiscalIDNumber===Bt.emitContratante.rfc&&Bt.emitDependientes[e].genderDesc.toLowerCase()!==Bt.emitContratante.sexContract.toLowerCase())return u.error("El sexo del asegurado "+Bt.emitDependientes[e].relationship+" no es igual al del contratante"),!0}function At(e){Bt.emitDependientes[e].weight&&Bt.emitDependientes[e].height&&(Bt.Imc[e]=Bt.emitDependientes[e].weight/Math.pow(Bt.emitDependientes[e].height,2),Bt.Imc[e]>=35&&(u.error("Índice de masa corporal. No es posible asegurar, debido a que no cumple con los parámetros aceptados de peso y estatura"),Bt.emitDependientes[e].weight=void 0,Bt.emitDependientes[e].height=void 0)),Bt.emitDependientes[e].imc=Bt.Imc[e]}function Pt(){return!angular.element(document.getElementById("collapseDatosdelContratante")).scope().formEmitContractor.$invalid&&!fe()}function Et(e){return!angular.element(document.getElementById("accordion_"+e)).scope()["formEmitDependent_"+e].$invalid&&!ge(e+1)}function It(e){var t=!1,n="";if(Dt(),0===e)t=angular.element(document.getElementById("collapseDatosdelContratante")).scope().formEmitContractor.$invalid,n="Contratante";else{var o=e-1;t=angular.element(document.getElementById("accordion_"+o)).scope()["formEmitDependent_"+o].$invalid,n=Bt.emitDependientes[o].relationship}var a="collapseDatos_"+e;return t||ge(e)||Dt()?($("#"+a).on("show.bs.collapse",function(e){e.preventDefault()}),Bt.colapseEmision2[e]=!1,u.error('Es necesario completar los datos requeridos de la sección "Datos de '+n+'"'),!1):(Bt.emitDependientes[e].age>=18?Bt.emitDependientes[e].asteriscoRequerido="*":Bt.emitDependientes[e].asteriscoRequerido="",$("#"+a).unbind("show.bs.collapse"),!0)}function Tt(){Mt();var e=Bt.emitDependientes.length-1,t=Bt.emitDependientes[e].relationship;return angular.element(document.getElementById("accordion_"+e)).scope()["formEmitDependent_"+e].$invalid||ge(Bt.emitDependientes.length)||Mt()||Dt()?($("#collapseCuestionarioMedico").on("show.bs.collapse",function(e){e.preventDefault()}),Bt.colapseEmision3=!1,u.error('Es necesario completar los datos requeridos de la sección "Datos de '+t+'"'),!1):($("#collapseCuestionarioMedico").unbind("show.bs.collapse"),Bt.esValidoFirmar=!0,!0)}function kt(){angular.element(document.getElementById("collapseCuestionarioMedico")).scope().formEmitSurvey.$invalid?($("#collapseFirmaElectronica").on("show.bs.collapse",function(e){e.preventDefault()}),Bt.colapseEmision4=!1,u.error("Favor de Completar sus respuestas para continuar")):($("#collapseFirmaElectronica").on("show.bs.collapse",function(e){e.preventDefault()}),Bt.colapseEmision4=!1,u.warning("Este seguro no cubre ningún padecimiento o enfermedad preexistente, entendiendo como tal, aquella enfermedad, lesión o defecto congénito y/o físico y/o mental que hayan sido diagnosticados o sea aparente a la vista, que se presuma se hayan originado con anterioridad a la fecha de la contratación del seguro. Favor de confirmar que no cuenta con ningún padecimiento preexistente.").result.then(function(){Bt.esValidoFirmar&&($("#collapseFirmaElectronica").unbind("show.bs.collapse"),Bt.colapseEmision4=!0)}).catch(function(){}))}function Rt(e,t,n){switch(t){case"nacionalidad":Bt.emitDependientes[n].nacionality=e.id;break;case"profesion":Bt.emitDependientes[n].professionID=e.id?e.id:"";break;case"pais":Bt.emitDependientes[n].countryISO=e.id?e.id:"";break;case"giro":Bt.emitDependientes[n].businessID=e.id}}function xt(){Bt.emitDependientes=[],angular.forEach(Bt.dependientes,function(e){Bt.emitDependientes.push({age:void 0!==e.age?e.age:"",birthDate:e.birthDate,fiscalIDNumber:e.fiscalIDNumber,gender:1===e.gender?"1":"0",genderDesc:1===e.gender?"Masculino":"Femenino",jobDescription:e.jobDescription?e.jobDescription:"",jobID:e.jobID?e.jobID:"",lastName:e.lastName,name:e.name,relationship:e.relationship,relationshipID:e.relationshipID,riskNumber:e.riskNumber,secondLastName:e.secondLastName,sport:e.sport?e.sport:"",sportID:e.sportID?e.sportID:"",handlesMachineryFlag:"0",renewalNumber:"0",imcAttemps:"0",excludedFlag:"0"})})}function Nt(){Bt.emitDependientes=[],angular.forEach(Bt.jsonCotizacion.cotizar.datosVar.dependientes.dependiente,function(e){console.log("fecha ",e.fechaNac);var t=e.fechaNac.toString();t.length<8&&(t="0"+t),console.log("fecha1 ",t),Bt.emitDependientes.push({age:void 0!==e.edad?e.edad:"",birthDate:moment(t,"DDMMYYYY").format("YYYY-MM-DD"),fiscalIDNumber:e.rfc,gender:e.sexo,genderDesc:e.sexoDesc,jobDescription:void 0!==e.ocupacionDesc&&null!==e.ocupacionDesc&&"null"!==e.ocupacionDesc?e.ocupacionDesc:"",jobID:void 0!==e.idOcupacion&&null!==e.idOcupacion&&"null"!==e.idOcupacion?e.idOcupacion:"",lastName:e.apllPat,name:e.nombre,relationship:e.parentescoDesc,relationshipID:e.idParentesco,riskNumber:e.numRiesgo,secondLastName:e.apllMat,sport:void 0!==e.deporteDesc&&null!==e.deporteDesc&&"null"!==e.deporteDesc?e.deporteDesc:"",sportID:void 0!==e.idDeporte&&null!==e.idDeporte&&"null"!==e.idDeporte?e.idDeporte:"",handlesMachineryFlag:"0",renewalNumber:e.numRenovacion,imcAttemps:"0",excludedFlag:"0"})}),Bt.titular={},angular.forEach(Bt.emitDependientes,function(e){"TITULAR"===e.relationship&&(Bt.titular=e)})}function wt(e){if(e.target.files.length>0){console.log("event fileSelector: ",e);var t=e.target.files[0],n=new FileReader;n.onload=function(){return function(e){var t=e.target.result,n=window.btoa(t);Bt.fileB64=n}}(),Bt.fileName=t.name,n.readAsBinaryString(t)}}var Ot,Bt=this,Lt=i.model;Bt.numeroCliente=Lt?Lt.numeroCliente:"",Bt.contrato=Lt?Lt.contract:"",Bt.cliente=Lt?Lt.client:"",Bt.person=Lt?Lt.person:{},Bt.primaN="",Bt.flujoCompleto=!0,Bt.datosCliente=Lt?Lt.datosCliente:void 0,Bt.nombres=Lt?Lt.nombres:"",Bt.primerApellido=Lt?Lt.apePaterno:"",Bt.segundoApellido=Lt?Lt.apeMaterno:"",Bt.nombreCliente=Lt?Lt.nombreCliente:"",Bt.fechaNacimiento=Lt?Lt.birthDay:"",Bt.fiscalIDNumber=Lt?Lt.fiscalIDNumber:"",Bt.email=Lt?Lt.emailUser:"",Bt.tipoPersona=Lt?Lt.personType:"1",Bt.telefono=Lt?Lt.phoneUser:"",Bt.disabledRFC=!!Lt&&Lt.disabledRFC,Bt.mostrarDatos=!!Lt&&Lt.mostrarDatos,Bt.validatePopup=!!Lt&&Lt.validatePopup,Bt.validatePerson=!!Lt&&Lt.validatePerson,Bt.roles=Lt?Lt.roles:[],Bt.sexo=void 0,Bt.sexoCliente="Masculino",Bt.checkDisabled=!0,Bt.fechaNacimientoCliente=moment(),Bt.clienteEsTitularAsegurado="2",Bt.typePeopleContract="1",Bt.emitContratante={sexContract:"masculino",fechaNacimiento:moment().subtract(18,"years")},Bt.faltaTitular=!0,Bt.primaNeta=3698,Bt.emission={},Bt.indexFormaPago=0,Bt.indexPaquete=0,Bt.indexPago=0,Bt.dependientes=[],Bt.dependientesFront=[],Bt.paquetes=[],Bt.asegurados=[],Bt.mensajeN=!1,Bt.toggleCoberturaText="OCULTAR",Bt.ListOcupacion=je(),Bt.ListNumAsegurados=Ye(),Bt.ListMedicalEstados=ze(),Bt.ListMedicalParentescos=Je(),Bt.ListMedicalDeportes=$e(),Bt.ListMedicalProfesiones=Ke(),Bt.ListMedicalIdentificacion=at(),Bt.ListMedicalLocacion,Bt.ListMedicalLocacionEmission,Bt.ListMunicipios=[],Bt.validaMun=!0,Bt.validaMunEmission=!0,Bt.margenInferior="Inferior",Bt.bandera=void 0,Bt.comboDependientes=[],Bt.dataParentescoList={},Bt.dataOcupacionList={},Bt.dataDeporteList={},Bt.nombreBotonAgregar="AGREGAR",Bt.nombreBotonModificar="MODIFICAR",Bt.nombreBotonLimpiar="LIMPIAR",Bt.nombreBotonCancelar="CANCELAR",Bt.editandoCliente=!1,Bt.buttonNameClientData=Bt.nombreBotonAgregar,Bt.buttonNameCleanData=Bt.nombreBotonLimpiar,Bt.esValidoFirmar=!1,Bt.contractProfesion=null,Bt.ListProfesionContract=[{id:"1",text:"PROGRAMADOR"},{id:"2",text:"ABOGADO"},{id:"3",text:"PROJECT MANAGER"},{id:"4",text:"CONTADOR"}],Bt.Imc=[],Bt.colorCollapsables="colorCollapsables",Bt.colapse1=!1,Bt.colapse2=!1,Bt.colapse3=!1,Bt.colapse4=!1,Bt.colapse5=!1,Bt.colapse6=!1,Bt.colapse7=!1,Bt.colapse8=!1,Bt.colapse9=!1,Bt.colapseEmision1=!1,Bt.colapseEmision2=[],Bt.colapseEmision3=!1,Bt.colapseEmision4=!1,Bt.pestCotiza=!0,Bt.pestEmision=!1,Bt.pestEntrega=!1,Bt.trianguloAzul="triangulo",Bt.trianguloBlanco="trianguloBlanco",Bt.trianguloBorde="trianguloBorde",Ct(),Bt.optionsdpx={autoApply:!0,showDropdowns:!0,minDate:moment().subtract(65,"years"),maxDate:moment(),singleDatePicker:!0,locale:{format:"DD/MM/YYYY",daysOfWeek:["DO","LU","MA","MI","JU","VI","SA"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:0},eventHandlers:{"apply.daterangepicker":function(){j("cliente"),_()}}},Bt.optionsdpxContract={autoApply:!0,showDropdowns:!0,minDate:moment().subtract(100,"years"),maxDate:moment().subtract(18,"years"),singleDatePicker:!0,locale:{format:"DD/MM/YYYY",daysOfWeek:["DO","LU","MA","MI","JU","VI","SA"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:0},eventHandlers:{"apply.daterangepicker":function(){j("contratante"),H()}}},s.sendEmailEmission=function(){var e={nombre:Bt.emitContratante.nombres.toUpperCase()+" "+Bt.emitContratante.primerApellido.toUpperCase()+" "+Bt.emitContratante.segundoApellido.toUpperCase(),numTramite:Bt.emission.numeroTramite,language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|24",emailSubject:"Solicitud de póliza Gastos Médicos Folio "+Bt.emission.numeroTramite,mailTo:Bt.email,mailCC:""};o.sendEmailEmision(e)},s.sendEmail=function(e){var t={},n="",a="",r="",i="",s="",c="",u="",l="",d="",m="",p="",f="",g="",h="",v="",y="",b="",C="",S="",D="",M="",A="",P="",E="",I="",T="",k="",R="",x="",N="",w="",O="",B="",L="",F="",j="",$="",Y="",H="",_="",U="",z="",V=0,Q=0,q=0,G=0,J=0,K=0,W=0,X=[];K=Bt.paquetes[Bt.indexPaquete],W=Bt.formasPago[Bt.indexFormaPago].pagos[Bt.indexPago],W.montos.forEach(function(e){e.cod_paquete===K.cod_paquete&&(V=e.primatotal,q=e.impuestos,G=e.derechos,Q=e.primaneta,J=e.recargos)}),Bt.grupos.forEach(function(e){"GCE"===e.grupo_id&&e.coberturas.forEach(function(e){"1"===e.cod_cob&&(n=e.intervalos.sa.intervaloSelected.id,a=e.intervalos.redHosp.intervaloSelected.text,r=e.intervalos.tabulador.intervaloSelected.text,i=e.intervalos.deducible.intervaloSelected.id),"2"===e.cod_cob&&"Amparada"===e.sa_def&&(s="AMPARADA"),"3"===e.cod_cob&&"Amparada"===e.sa_def&&(c="AMPARADA"),"4"===e.cod_cob&&"Amparada"===e.sa_def&&(u="AMPARADA"),"5"===e.cod_cob&&"Amparada"===e.sa_def&&(l="AMPARADA"),"6"===e.cod_cob&&"Amparada"===e.sa_def&&(d="AMPARADA"),"10"===e.cod_cob&&"Amparada"===e.sa_def&&(m="AMPARADA"),"11"===e.cod_cob&&"Amparada"===e.sa_def&&(p="AMPARADA")}),"GCH"===e.grupo_id&&e.coberturas.forEach(function(e){"12"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(f="1"===e.mod_chk?"AMPARADA":"")}),"13"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(g="1"===e.mod_chk?"AMPARADA":"")}),"14"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(h="1"===e.mod_chk?"AMPARADA":"")}),"15"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(v="1"===e.mod_chk?"AMPARADA":"")})}),"GC2"===e.grupo_id&&e.coberturas.forEach(function(e){"16"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(y="1"===e.mod_chk?"AMPARADA":"")}),"17"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(b="1"===e.mod_chk?"AMPARADA":"")}),"18"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(C="1"===e.mod_chk?"AMPARADA":"")}),"19"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(S="1"===e.mod_chk?"AMPARADA":"")})}),"GEA"===e.grupo_id&&e.coberturas.forEach(function(e){"20"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(D="1"===e.mod_chk?"AMPARADA":"")}),"21"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(M="1"===e.mod_chk?"AMPARADA":"")})}),"GIE"===e.grupo_id&&e.coberturas.forEach(function(e){"22"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(A="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"23"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(P="1"===e.mod_chk?"AMPARADA":"")}),"24"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(E="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")})}),"GCO"===e.grupo_id&&e.coberturas.forEach(function(e){"25"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(I="1"===t.mod_chk?e.intervalos.planDental.intervaloSelected.text:"")}),"26"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(T="1"===t.mod_chk?e.intervalos.planVision.intervaloSelected.text:"")}),"28"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(H="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"29"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(k="1"===e.mod_chk?"AMPARADA":"")}),"30"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(R="1"===e.mod_chk?"AMPARADA":"")}),"31"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(x="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")})}),"GAA"===e.grupo_id&&e.coberturas.forEach(function(e){"34"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(N="1"===e.mod_chk?"AMPARADA":"")}),"36"===e.cod_cob&&e.paquetes.forEach(function(e){e.cod_paquete===K.cod_paquete&&(w="1"===e.mod_chk?"AMPARADA":"")})}),"GTE"===e.grupo_id&&e.coberturas.forEach(function(e){"40"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(O="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"41"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(B="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"42"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(_="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"43"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(L="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"44"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(U="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"45"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(F="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"47"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(j="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")}),"48"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&($="1"===t.mod_chk?e.intervalos.sa.intervaloSelected.id:"")})}),"GAE"===e.grupo_id&&e.coberturas.forEach(function(e){"50"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(Y="1"===t.mod_chk?e.intervalos.saCarencia.intervaloSelected.id:"")}),"51"===e.cod_cob&&e.paquetes.forEach(function(t){t.cod_paquete===K.cod_paquete&&(z="1"===t.mod_chk?e.intervalos.saCarencia.intervaloSelected.id:"")})})}),t={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|22",emailSubject:"Num de Cotización "+Bt.jsonCotizacion.quotationNumber,mailTo:Bt.email,mailCC:"",elemental:n,redHospitalaria:a,tabulador:r,deducible:i,gastosHospitalarios:s,honorariosMedicos:c,auxiliaresDeDiagnostico:u,medicamentos:l,ambulancia:d,asistenciaTelefonica:m,asistenciaEnViaje:p,protesisYAparatosOrtopedicos:f,rehabilitaciones:g,tratamientosDentales:h,tratamientosReconstructivosYEsteticos:v,complicacionesDeGastosNoCubiertos:y,procedimientosDeVanguardia:b,padecimientosPreexistentesDeclarados:C,padecimientosPreexistentesNoDeclarados:S,homeopatiaQuiropracticaYAcupuntura:D,psiquiatraYPsicologo:M,emergenciaEnElExtranjero:A,enfermedadesCatastroficasEnElExtranjero:P,internacional:E,dental:I,vision:T,prevision:k,atencionNacionalTotal:R,reduccionDeDeduciblePorAccidente:x,hogar:N,funeraria:w,enfermedadesFrecuentes:O,enfermedadesCatastroficas:B,hombre:L,cancer:F,muerteAccidental:j,perdidasOrganicas:$,hospitalizacion:Y,incapacidad:z,iva:q,maternidad:H,coverageData:JSON.stringify(X),mujer:_,infantil:U,gastosEspedicion:G,primaNeta:Q,recargos:J,primaTotalAnual:V},"cotizacion"===e&&o.sendEmailQuotation(t)},Bt.steps={search:!1,cotizacion:!1,recotizacion:!1,emision:!1,entrega:!1},Bt.showCollapseDatosCliente=!1,Bt.collapseInClassDatosCliente=!1,Bt.collapseInClassDatosRiesgo=!0,Bt.collapseDatosCliente="desc",Bt.collapseQuotationDetail="plus",Bt.setArrows=l,Bt.collQuotationDetail=d,Bt.goRegresarMain=m,Bt.goDatosRiesgo=p,Bt.btnVolver=f,Bt.goCotizacion=g,Bt.goRecotizacion=h,Bt.createEmisionAmbiente=v,Bt.goEmision=y,Bt.goEntrega=b,Bt.dibujarFirmasJuntas=C,Bt.formatCurrency=S,Bt.charrepeatText=D,Bt.soloNumAndPunto=M,Bt.soloText=A,Bt.soloNum=P,Bt.cambiaN=E,Bt.soloTextAndNum=I,Bt.calcularEdadRfc=T,Bt.onValidateDuplicateTel=k,Bt.colorTablaMontos=R,Bt.comparaTitularD=!0,Bt.agregarFamiliar=N,Bt.limpiarDependiente=w,Bt.borrarDependientes=O,Bt.editarDependientes=B,Bt.agregarEditados=L,Bt.agregarTitularAsegurado=F,Bt.calcularEdadCliente=j,Bt.calculaEdad=Y,Bt.calcularRFCContratante=H,Bt.calcularRFCCliente=_,Bt.calcularRFC=U,Bt.agregarDependiente=z,Bt.onChangeNombre=V,Bt.onChangeNombreContrc=Q,Bt.validaAseg=q,Bt.colorMontos=G,Bt.getJsonCotizacion=J,Bt.getJsonDetalleCotizacion=K,Bt.getIntervalos=W,Bt.createListCotizacionCmd=X,Bt.getResumenCotizacion=Z,Bt.getAsegurado=ee,Bt.getPaqueteAsegurado=te,Bt.getPaquetesAsegurado=ne,Bt.getPaqueteCobertura=oe,Bt.getPaquetesCoberturas=ae,Bt.getGrupos=re,Bt.getPaquete=ie,Bt.getPaquetes=se,Bt.getPagos=ce,Bt.getPago=ue,Bt.getMontos=le,Bt.getMonto=de,Bt.getFormasPago=me,Bt.createListObject=pe,Bt.revisaCombosContratante=fe,Bt.revisaCombosDependientes=ge,Bt.onChangeList=he,Bt.clickCheckBox=ye,Bt.validarCheckbox=be,Bt.firmaDibujadaServicioTitular=!1,Bt.firmaDibujadaServicioContratante=!1,Bt.firmaDibujadaServicioAgente=!1,Bt.empezarDibujoTitular=Ce,Bt.dibujarLineaTitular=Se,Bt.pararDibujarTitular=De,Bt.activarVariablesFirmaTitular=Me,Bt.empezarDibujoContratante=Ae,Bt.dibujarLineaContratante=Pe,Bt.pararDibujarContratante=Ee,Bt.activarVariablesFirmaContratante=Ie,Bt.empezarDibujoAgente=Te,Bt.dibujarLineaAgente=ke,Bt.pararDibujarAgente=Re,Bt.activarVariablesFirmaAgente=xe,Bt.limpiarFirmaContratante=Ne,Bt.esFumador=we,Bt.limpiarFirmaAgente=Be,Bt.limpiarFirmaTitular=Le,Bt.cargaDocumento=Fe,Bt.getCatalagoOcupaciones=je,Bt.getCatalagoDeportes=$e,Bt.getCatalogoNumAsegurados=Ye,Bt.validaMuniciEmission=He,Bt.validaMunici=_e,Bt.getCatalogoMedicalEntidadesEmision=Ue,Bt.getCatalogoMedicalEntidades=ze,Bt.selectRadio=Ve,Bt.onChangeNumAsegurados=Qe,Bt.onChangeListEntityEmission=qe,Bt.onChangeListEntity=Ge,Bt.getCatalogoMedicalParentescos=Je,Bt.getCatalogoMedicalProfesiones=Ke,Bt.getCatalogoMedicalDeducible=We,Bt.getCatalogoMedicalCoaseguro=Xe,Bt.getCatalogoMedicalDeducibleRed=Ze,Bt.getCatalogoMedicalTopeCoaseguro=et,Bt.getMedicalNacionalidad=tt;Bt.asignaNacionalidadDefault=nt,Bt.getCatalogoGiroMercantil=ot,Bt.getCatalogoIdentificacion=at,Bt.servicioEnvioDeFirmas=rt,Bt.guardarSeleccion=it,Bt.actualizarSolicitud=st,Bt.getJsonEmision=ct,Bt.getCuestionarioEmision=ut,Bt.registroCuestionario=mt,Bt.validaCuestionario=pt,Bt.setAperturaTramite=ft,Bt.createCoverageDataList=gt,Bt.datosVarCob={codDeducible2800:"1",codPlanDental2824:"1",codPlanVision2825:"1",codRedHosp2800:"1",codTabulador2800:"1",codZonaInt:"",codZonaInt2821:"",fecAntigMat:"",impDeducible2800:"15000",impDeducible2821:"",impDeducible2823:"2000",impGtosRecienNac:"",numDiasCar2848:"0",numDiasCar2850:"0",pctCoaseguro2800:"10",pctCoaseguro2821:"0",pctCoaseguro2823:"10",pctTopeCoaseguro2800:"1",pctTopeCoaseguro2823:"6",sumaAseg2800:"40000000",sumaAseg2821:"25000",sumaAseg2823:"1000000",sumaAseg2826:"",sumaAseg2827:"",sumaAseg2830:"4000",sumaAseg2839:"10000",sumaAseg2840:"10000",sumaAseg2841:"",sumaAseg2842:"10000",sumaAseg2843:"",sumaAseg2844:"10000",sumaAseg2845:"",sumaAseg2846:"50000",sumaAseg2847:"50000",sumaAseg2849:"",sumaAseg2851:"",sumaAseg2852:"",sumaAseg2853:"",sumaAsegCar2848:"250",sumaAsegCar2850:"250"},Bt.getJsonRecotizacion=ht,Bt.guardarCotizacionBD=vt,Bt.actualizarCotizacionBD=yt,Bt.cancelarCotizacionBD=bt,Bt.emitFromQuotation=function(e){localStorage.setItem("__quotation",JSON.stringify(e)),Bt.steps.search=!1,Bt.steps.cotizacion=!1,Bt.steps.recotizacion=!1,Bt.steps.emision=!0,Bt.trianguloAzul="trianguloBlanco",Bt.trianguloBorde="triangulo",Bt.pestCotiza=!1,Bt.pestEmision=!0,Ue(),Bt.flujoCompleto=!1,St(e.idCotizacion),K(e.idCotizacion)},Bt.validaRfcContratanteAsegurados=Dt,Bt.validaRfcAseguradoContratante=Mt,Bt.calcularImc=At,Bt.validaContratante=Pt,Bt.validaDependiente=Et,Bt.validaSiDependiente=It,Bt.validaSiCuestionario=Tt,Bt.validaSiFirmaElectronica=kt,Bt.getValoresEmision=Rt,Bt.createEmisionDependientes=xt,Bt.createEmisionDependientesFromDetail=Nt,Bt.handleFileSelect=wt}e.$inject=["validateIn","insuranceMedicalSrv","insuranceMedicalEmission","insuranceMedicalQuotation","insuranceHousesSrv","$state","$stateParams","$scope","$timeout","CommonModalsSrv"],angular.module("actinver.controllers").controller("insuranceMedicalCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.setMedicalExpenseDocsRegistration=function(o){return t(function(t,a){n({method:"POST",url:e.setMedicalExpenseDocsRegistration,data:$.param(o)}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedExpInsuranceQuestionnaireQuery=function(){return t(function(t,o){n({method:"GET",url:e.getMedExpInsuranceQuestionnaireQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedExpInsuranceQuestionnaireQuery.questionDataList,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedExpInsuranceQuestRegistration=function(o){return t(function(t,a){n({method:"POST",url:e.getMedExpInsuranceQuestRegistration,data:$.param(o)}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedExpInsuranceQuestRegistration,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedExpInsuranceQuestValidation=function(o){return t(function(t,a){n({method:"POST",url:e.getMedicalExpenseQuestValidation,params:o}).then(function(e){console.log("respQuest: ",e);var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseQuestValidation.questValidationResponse,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.setMedicalExpenseProcessingRequest=function(o){return t(function(t,a){n({method:"POST",url:e.setMedicalExpenseProcessingRequest,params:o}).then(function(e){console.log("setMedicalExpenseProcessingRequest: ",e);var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseProcessingRequest.processingRequestResponse,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedExpInsurancePolicyRegistration=function(o){return t(function(t,a){n({method:"POST",url:e.getMedExpInsurancePolicyRegistration,data:$.param(o)}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedExpInsurancePolicyRegistration,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.procedureQuotation=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationProcedure,params:o}).then(function(e){console.log("response procedure",e);var n;1===e.data.return.status?(n=e.data,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})},function(){console.log("response procedure error"),a({success:!1,type:"not-found"})})})},o.prototype.cancelQuotation=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationCancel,params:o}).then(function(e){console.log("response cancel",e);var n;1===e.data.return.status?(n=e.data,t({success:!0,info:n})):t({success:!1,info:e.data.outCommonHeader.result})},function(){console.log("response cancel error"),a({success:!1,type:"not-found"})})})},o.prototype.servicioFirmas=function(o){return t(function(t,a){n({method:"POST",url:e.getMedicalExpenseSignRegistration,data:$.param(o)}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,info:void 0,response:e.data}:{success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.saveSelection=function(o){return t(function(t,a){n({method:"POST",url:e.getMedicalExpensePackageRegistration,params:o}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,info:void 0,response:e.data}:{success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.updateRequest=function(o){return t(function(t,a){n({method:"POST",url:e.getMedicalExpensePackageUpdate,params:o}).then(function(e){t(1===e.data.outCommonHeader.result.result?{success:!0,info:void 0,response:e.data}:{success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("insuranceMedicalEmission",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){}return i.prototype.sendEmailQuotation=function(e){try{var t=e;a.sendEmailNotificationCotizationPMM(t).then(function(e){e.success&&r.done("Correo Enviado")})}catch(e){}},i.prototype.sendEmailEmision=function(e){try{var t=e;a.sendEmailNotificationEmisionPMM(t).then(function(e){e.success&&r.done("Correo Enviado")})}catch(e){}},new i}e.$inject=["URLS","$q","$http","$filter","insuranceMedicalSrv","CommonModalsSrv"],angular.module("actinver.controllers").service("insuranceMedicalQuotation",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getCotizacionSrv=function(o){return t(function(t,a){o.language="SPA",n({method:"POST",url:e.getMedicalExpenseInsuranceQuotation,data:$.param(o)}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseInsuranceQuotation,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getDetalleCotizacion=function(o){return t(function(t,a){n({method:"POST",url:e.getMedExpInsuranceDetailQuotationQuery,params:{language:"SPA",quotationNumber:o}}).then(function(e){var n;console.log(e),1===e.data.outCommonHeader.result.result?(n=e.data.outMedExpInsuranceDetailQuotationQuery,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.sendEmailNotificationEmisionPMM=function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationEmisionPMM,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.sendEmailNotificationCotizationPMM=function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationCotizationPMM,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogExpenseJob=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseJobQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseJobQuery.medicalExpenseJob,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogProfesiones=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseJobQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseJobQuery.medicalExpenseJob,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogPolicyNumber=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpensePolicyHolderNumQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpensePolicyHolderNumQuery.medicalExpensePolicyHolderNum,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogMedicalState=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseStateQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseStateQuery.medicalExpenseState,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogMedicalLocation=function(o){return t(function(t,a){n({method:"GET",url:e.getMedicalExpenseLocationQuery,params:{language:"SPA",stateID:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseLocationQuery.medicalExpenseLocation,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedicalExpenseRelationship=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseRelationshipQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseRelationshipQuery.medicalExpenseRelationship,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogExpenseSports=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseSportsQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseSportsQuery.medicalExpenseSport,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogExpenseProfessions=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseProfessionsQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseProfessionsQuery.medicalExpenseProfession,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getCatalogExpenseProfessions=function(){return t(function(t,o){n({method:"GET",url:e.getMedicalExpenseProfessionsQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseProfessionsQuery.medicalExpenseProfession,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedicalExpenseDeductible=function(o){return t(function(t,a){n({method:"GET",url:e.getMedicalExpenseDeductibleQuery,params:{language:"SPA",deductibleDesc:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseDeductibleQuery.medicalExpenseDeductible,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedicalExpenseCoinsurance=function(o){return t(function(t,a){n({method:"GET",url:e.getMedicalExpenseCoinsuranceQuery,params:{language:"SPA",deductibleDesc:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseCoinsuranceQuery.medicalExpenseCoinsurance,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedicalExpenseDeductibleRed=function(o){return t(function(t,a){n({method:"GET",url:e.getMedicalExpenseDeductibleRedQuery,params:{language:"SPA",deductibleDesc:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseDeductibleRedQuery.medicalExpenseDeductibleRed,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},
o.prototype.getMedicalExpenseMaxCoinsurance=function(o){return t(function(t,a){n({method:"GET",url:e.getMedicalExpenseMaxCoinsuranceQuery,params:{language:"SPA",deductibleDesc:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseMaxCoinsuranceQuery.medicalExpenseMaxCoinsurance,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedicalInsuranceFiscalIDNumber=function(o){return t(function(t,a){n({method:"GET",url:e.getMedicalInsuranceFiscalIDNumberQuery,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceFiscalIDNumberQuery,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getMedicalExpenseInsuranceRequotation=function(o){return o.language="SPA",t(function(t,a){n({method:"POST",url:e.getMedicalExpenseInsuranceRequotationQuery,data:$.param(o)}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMedicalExpenseInsuranceRequotation,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getInsuranceCountryQuery=function(o){return t(function(t,a){n({method:"GET",url:e.getInsuranceCountryQuery,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceCountryQuery.insuranceCountry,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getInsuranceBusinessActivityQuery=function(){return t(function(t,o){n({method:"GET",url:e.getInsuranceBusinessActivityQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceBusinessActivityQuery.businessActivityData,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},o.prototype.getInsuranceIdentificationTypeQuery=function(){return t(function(t,o){n({method:"GET",url:e.getInsuranceIdentificationTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceIdentificationTypeQuery.identificationTypeData,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("insuranceMedicalSrv",e)}(),function(){"use strict";function e(){function e(){}return e.prototype.formatCurrency=function(e){var t=2;if(e+="",e=parseFloat(e.replace(/[^0-9\.]/g,"")),t=t||0,isNaN(e)||0===e)return parseFloat(0).toFixed(t);e=""+e.toFixed(t);for(var n=e.split("."),o=/(\d+)(\d{3})/;o.test(n[0]);)n[0]=n[0].replace(o,"$1,$2");return n.join(".")},e.prototype.calcularEdadRfc=function(e,t){var n=moment(new Date).format("YY"),o="1"===t?e.substring(4,10):e.substring(3,9),a=o.substring(0,2),r=o.substring(2,4),i=o.substring(4,6);return a=a>n?"19"+a:"20"+a,o=i+"/"+r+"/"+a},e.prototype.charrepeatText=function(e,t){var n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n).toUpperCase(),a=angular.element("#"+t).val().toString().toUpperCase();if(a=void 0===a?"":a,a.substring(a.length-1,a.length)===o&&a.substring(a.length-2,a.length-1)===o)return e.preventDefault(),!1},e.prototype.soloNumAndPunto=function(e,t){var n=new RegExp("^[0-9.]+$"),o=void 0!==e.charCode?e.charCode:e.which,a=String.fromCharCode(o);return 241===e.which||209===e.which||225===e.which||233===e.which||237===e.which||243===e.which||250===e.which||193===e.which||201===e.which||205===e.which||211===e.which||218===e.which||32===e.which||(n.test(a)||0===e.charCode?void 0:(e.preventDefault(),!1))},e.prototype.soloText=function(e,t){var n=new RegExp("^[a-zA-Z]+$"),o=void 0!==e.charCode?e.charCode:e.which,a=String.fromCharCode(o);return 241===e.which||209===e.which||225===e.which||233===e.which||237===e.which||243===e.which||250===e.which||193===e.which||201===e.which||205===e.which||211===e.which||218===e.which||32===e.which||(n.test(a)||0===e.charCode?void 0:(e.preventDefault(),!1))},e.prototype.soloTextAndNum=function(e,t){var n=t?new RegExp("^[a-zA-Z0-9 ]+$"):new RegExp("^[a-zA-Z0-9]+$"),o=void 0!==event.charCode?event.charCode:event.which,a=String.fromCharCode(o);return 241===event.which||209===event.which||225===event.which||233===event.which||237===event.which||243===event.which||250===event.which||193===event.which||201===event.which||205===event.which||211===event.which||218===event.which||(n.test(a)||0===event.charCode?void 0:(event.preventDefault(),!1))},e.prototype.soloNum=function(){var e=new RegExp("^[0-9]+$"),t=void 0!==event.charCode?event.charCode:event.which,n=String.fromCharCode(t);return 241===event.which||209===event.which||225===event.which||233===event.which||237===event.which||243===event.which||250===event.which||193===event.which||201===event.which||205===event.which||211===event.which||218===event.which||(e.test(n)||0===event.charCode?void 0:(event.preventDefault(),!1))},e.prototype.forceKeyPressUppercase=function(e){var t=e.keyCode;if(t>=97&&t<=122&&!e.ctrlKey&&!e.metaKey&&!e.altKey){var n=t-32,o=e.target.selectionStart,a=e.target.selectionEnd;e.target.value=e.target.value.substring(0,o)+String.fromCharCode(n)+e.target.value.substring(a),e.target.setSelectionRange(o+1,o+1),e.preventDefault()}},e.prototype.cambiaN=function(e){e.target.value=e.target.value.replace(/Ñ/g,"N").replace(/ñ/g,"n")},new e}angular.module("actinver.controllers").service("validateIn",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){r.getCatalogStreetTypeQuery().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.typeID,text:e.street})}),ye.listStreetType=t)}).catch(function(e){})}function s(){r.getCatalogCardTypeQuery().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.cardID,text:e.cardType})}),ye.ListCardType=t)}).catch(function(e){})}function c(){var e=!!ye.cotizacionSeleccionada,t=e?JSON.parse(ye.cotizacionSeleccionada.quotationJsonIni):null;r.getCatalogPaymentTypeQuery().then(function(n){var o=[],a=[];n.success&&(angular.forEach(n.info,function(e){"2"!==e.paymentManagerID&&"8"!==e.paymentManagerID||a.push({id:e.paymentManagerID,text:e.paymentManagerName}),o.push({id:e.paymentManagerID,text:"1"===e.paymentManagerID?"PAGO REFERENCIADO":e.paymentManagerName})}),ye.ListPaymentTypeAll=o,ye.ListPaymentTypeSinAgentes=a,e?1==t.catalogosCotizacion.kindPaid.type.id||2==t.catalogosCotizacion.kindPaid.type.id?ye.ListPaymentType=o:ye.ListPaymentType=a:1==ye.cmd.kindPaid.type.id||2==ye.cmd.kindPaid.type.id?ye.ListPaymentType=o:ye.ListPaymentType=a)}).catch(function(e){})}function u(e,t){r.getCatalogRoofType(t.id).then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.roofTypeID,text:e.roofType})}),ye.cmd.kindRoof={},ye.listRoof=t)}).catch(function(e){})}function l(e,t){var n=[];r.getCatalogMunicipalityPyme(e.id).then(function(e){if(e.success)switch(angular.forEach(e.info,function(e){n.push({id:e.municipalityID,text:e.delegationOrMunicipality})}),t){case"fiscal":ye.ListEntityFiscal=n;break;case"contractor":ye.cmd.emission.contract.entityContractor={},ye.cmd.emission.contract.pcContractor={},ye.ListEntityContractor=n;break;case"beneficiary":ye.cmd.emission.beneficiary.entityBeneficiary={},ye.cmd.emission.beneficiary.pcBeneficiary={},ye.ListEntityBeneficiary=n}})}function d(){ye.cmd.emission.sameAddress?L():B()}function m(e,t){var n=[];r.getCatalogPostalCode(e.id).then(function(e){if(e.success)switch(angular.forEach(e.info.postalCode,function(e){n.push({id:e,text:e})}),t){case"fiscal":ye.ListPCFiscal=n;break;case"contractor":ye.cmd.emission.contract.pcContractor={},ye.ListPCContractor=n;break;case"beneficiary":ye.cmd.emission.beneficiary.pcBeneficiary={},ye.ListPCBeneficiary=n}})}function p(){var e=[];ye.cmd.dataHouseEntityRisk.type&&r.getCatalogMunicipalityCars(ye.cmd.dataHouseEntityRisk.type.id).then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.municipalityID,text:t.delegationOrMunicipality})}),ye.cmd.dataHouseMunicipalityRisk={},ye.cmd.dataHousePostalCodeRisk={},ye.ListPostalCodeHouse=[],ye.ListMunicipalityHouse=e)})}function f(){var e=[];ye.cmd.dataHouseMunicipalityRisk.type&&r.getCatalogPostalCode(ye.cmd.dataHouseMunicipalityRisk.type.id).then(function(t){t.success&&(angular.forEach(t.info.postalCode,function(t){e.push({id:t,text:t})}),ye.cmd.dataHousePostalCodeRisk={},ye.ListPostalCodeHouse=e)})}function g(){for(var e=[],t=(new Date).getFullYear(),n=0;n<7;n++)e.push({id:t+n,text:t+n});return e}function h(){for(var e,t=[],n=1;n<=12;n++)e=n<10?"0"+n:n,t.push({id:e,text:e});return t}function v(){ye.cmd.cardType=void 0===ye.cmd.cardType?{}:ye.cmd.cardType,ye.cmd.dataBanks.type.text.toString().toUpperCase().startsWith("AMERICAN EXPRESS")?(ye.accLen=15,ye.cvvLen=4,ye.cmd.cardType.type=ye.ListCardType[b("AMERICAN")]):(ye.accLen=16,ye.cvvLen=3,ye.cmd.cardType.type=[])}function y(){if(ye.emission.payment.accountNumber)switch(ye.emission.payment.accountNumber.toString().substr(0,1)){case"3":ye.cmd.cardType.type=ye.ListCardType[b("AMERICAN")];break;case"4":ye.cmd.cardType.type=ye.ListCardType[b("VISA")];break;case"5":ye.cmd.cardType.type=ye.ListCardType[b("MASTER")]}}function b(e){for(var t=0;t<ye.ListCardType.length;t++)if(ye.ListCardType[t].text.toString().toUpperCase().startsWith(e))return t}function C(){ye.stepForm={step:0,stepA:!1,stepB:!1,stepC:!1,stepD:!1}}function S(){e.go("insurance.main",{model:t.model})}function D(){if(ye.ListCotizaciones.length>1)A();else{var n=t.model;e.go("insurance.main",{model:n})}}function M(){ye.isClienteObt=!1,ye.cotizacionSeleccionada?E():P()}function A(){C(),ye.stepForm.step=1,ye.stepForm.stepA=!0}function P(){C(),ye.stepForm.step=2,ye.stepForm.stepB=!0,ce()}function E(){C(),i(),s(),c(),ye.yearExpirationList=g(),ye.monthExpirationList=h(),ye.emission.payment={},ye.emission.payment.email=ye.emailUser,ye.emissionPersonType="1"===Ce.personType?"F":"M",ye.cotizacionSeleccionada&&(ye.emissionPersonType=1===ye.cotizacionSeleccionada.tipoCliente?"F":"M",ye.jsonQuotation=JSON.parse(ye.cotizacionSeleccionada.quotationJsonFin).outHomeInsuranceQuotation.insurancePaymentData,ye.cmd.kindPaid.type=JSON.parse(ye.cotizacionSeleccionada.quotationJsonIni).catalogosCotizacion.kindPaid.type),ye.stepForm.step=3,ye.stepForm.stepC=!0,window.scrollTo(0,angular.element("contratacion").offsetTop)}function I(){ye.tieneCotizaciones=!1,ye.ListCotizaciones=T()}function T(){var e=[],t={language:"SPA",estado:"VIGENTE",idCliente:ye.numeroCliente,tipoCliente:ye.personType,productKey:"PYME"};return r.getListQuotations(t).then(function(t){t.success?(angular.forEach(t.info,function(t){var n="1"===ye.personType?t.apellidoPaternoCliente:"",o="1"===ye.personType?t.apellidoMaternoCliente:"",a=t.nombreCliente+" "+n+" "+o;e.push({cotizacion:t.idCotizacion,poliza:t.idPoliza,nombre:t.nombreCliente,primerApellido:n,segundoApellido:o,nombreCompleto:a,fecha:moment((new Date).setTime(t.fechaCotizacion)).format("DD-MM-YYYY"),vigencia:moment((new Date).setTime(t.vigenciaCotizacion)).format("DD-MM-YYYY"),prima:t.monto,estadoPoliza:t.estado,numeroCliente:t.idCliente,tipoCliente:t.tipoCliente,isCliente:t.isCliente,fechaNacimiento:"1"===ye.personType?moment((new Date).setTime(t.fechaNacimiento)).format("DD-MM-YYYY"):t.fechaNacimiento,rfcCliente:t.rfcCliente,sexoCliente:t.sexoCliente,emailCliente:t.mailCliente,telefonoCliente:t.telefonoCliente,quotationJsonIni:t.quotationJsonIni,quotationJsonFin:t.quotationJsonFin,emisionJsonIni:t.emisionJsonIni,emisionJsonFin:t.emisionJsonFin,status:t.vstatus})}),t.info.length>0?(ye.tieneCotizaciones=!0,A()):P()):P()}),e}function k(e){ye.jsonCotizacion.catalogosCotizacion=ye.cmd;var t="";t=ye.validatePerson?moment(ye.birthDay,"DD/MM/YYYY").format("YYYY-MM-DD"):moment(ye.fechaNacimiento).format("YYYY-MM-DD");var n={language:"SPA",idCliente:ye.numeroCliente,idCotizacion:ye.datosCotizados.numeroCotizacion,idPoliza:0,fechaCotizacion:moment(new Date).format("YYYY-MM-DD"),vigenciaCotizacion:moment(new Date,"YYYY-MM-DD").add(15,"days").format("YYYY-MM-DD"),monto:Math.ceil(ye.datosCotizados.primaTotal),tipoCliente:ye.personType,isCliente:"9999"===ye.numeroCliente?"0":"1",nombreCliente:"1"===ye.personType.toString()?ye.nombres.toUpperCase():ye.nombreCliente.toUpperCase(),fechaNacimiento:t,rfcCliente:ye.fiscalIDNumber,sexoCliente:"masculino"===ye.sexo?"1":"2",mailCliente:ye.emailUser,telefonoCliente:ye.phoneUser,quotationJsonInit:ye.jsonCotizacion,quotationJsonEnd:e,productKey:"PYME"};"1"===ye.personType.toString()&&(n.apellidoPaternoCliente=ye.apePaterno.toUpperCase(),n.apellidoMaternoCliente=ye.apeMaterno.toUpperCase()),r.getCotizationAdd(n).then(function(t){t.success?(ye.datosCotizacion=ye.datosCotizados,a.done("Envío de Cotización exitosa Número de Cotización: "+ye.datosCotizacion.numeroCotizacion),ye.jsonQuotation=e.outHomeInsuranceQuotation.insurancePaymentData):a.error("Envío de Cotización no fue exitoso."),ye.cargandoCotizacion=!1})}function R(){var e=JSON.parse(JSON.parse(sessionStorage["ngStorage-user"]));if(ye.roles=e.roles,angular.isDefined(ye.roles)&&angular.isArray(ye.roles)){if(1===ye.roles.length)return ye.roles[0];if(ye.roles.length>1){for(var t=999,n=0;n<ye.roles.length;n++)"SEGUROS"===ye.roles[n]&&t>1&&(t=1),"ASESOR"===ye.roles[n]&&t>2&&(t=2);switch(t){case 1:return ye.rol="SEGUROS","SEGUROS";case 2:return ye.rol="ASESOR","ASESOR"}}}}function x(){var e=moment(ye.fechaNacimiento).format("DD/MM/YYYY")+"",t=ye.fechaConstitutiva+"",n=ye.rfc,o=n.replace(/^([A-ZÑ\x26]{3,4})(([0-9]{2})(0[1-9]|1[0-2])(0[1-9]|1[0-9]|2[0-9]|3[0-1]))(((([A-Z]|[a-z]|[0-9]){3}))?)$/,"$2")+"";e=e.replace(/^([0-9]{2})(\/)([0-9]{2})(\/)([0-9]{2})([0-9]{2})$/,"$6$3$1")+"",null!==e&&""!==e&&null!==o&&""!==o&&o!==e&&ye.personType+""=="1"&&a.error("La fecha de nacimiento no coincide con la fecha del RFC"),null!==e&&""!==e&&null!==t&&""!==t&&t!==e&&2===ye.personType&&a.error("La fecha constitutiva no coincide con la fecha del RFC")}function N(e){for(var t=document.getElementById(e),n=(t.value+"").split(""),o="",a=0;a<n.length;a++)(n[a]+"").match(/^[a-zA-ZÁÉÍÓÚÑáéíóúñ ]+$/)&&(o+=n[a]);t.value=o+""}function w(){if(!ye.disabledRFC&&!ye.validatePerson&&""===ye.fechaNacimiento)return"1"===ye.personType?(a.error("Favor de Capturar el campo de Fecha de Nacimiento"),!1):(a.error("Favor de Capturar el campo de Fecha de Constitución"),!1);ye.disabledRFC?ye.bnd=!0:Q(),ye.bnd&&O()}function O(){ye.cargandoCotizacion=!0;var e,t,o,i,s,c=ye.jsonCoberturas.coberturas.edificio.monto,u=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.monto,l=void 0===ye.cmd.securityActions?"":ye.cmd.securityActions.type.id,d=void 0===ye.cmd.borderWall?"false":ye.cmd.borderWall.type.id;ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes&&(e=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto,t=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limTerminado.monto,o=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limDesocupado.monto,i=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limConstruccion.monto,s=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limFija.monto);var m=ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.terremotoEdificio.monto;ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes&&(ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked,ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limTerminado.checked,ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limDesocupado.checked,ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limConstruccion.checked,ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes.hidroEdificio.coberturasIntegrantes.limFija.checked);var p=ye.jsonCoberturas.coberturas.contenidos.monto,f=ye.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.monto;ye.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.coberturasIntegrantes&&(ye.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.coberturasIntegrantes.bienesContenidos.monto,ye.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.hidroContenidos.coberturasIntegrantes.limContenidos.monto);var g,h=ye.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes.terremotoContenidos.monto,v=ye.jsonCoberturas.coberturas.remocionEscombros.monto,y=ye.jsonCoberturas.coberturas.rcFamiliar.monto,b=ye.jsonCoberturas.coberturas.rcFamiliar.coberturasIntegrantes.rcArrendatario.monto,C=ye.jsonCoberturas.coberturas.rcFamiliar.coberturasIntegrantes.rcArrendatario.checked,S=ye.jsonCoberturas.coberturas.cristales.monto,D=ye.jsonCoberturas.coberturas.cristales.checked,M=ye.jsonCoberturas.coberturas.roboMenaje.monto,A=ye.jsonCoberturas.coberturas.roboMenaje.coberturasIntegrantes.joyas.monto,P=ye.jsonCoberturas.coberturas.gastosAsalto.monto,E=ye.jsonCoberturas.coberturas.dinero.monto,I=ye.jsonCoberturas.coberturas.dinero.coberturasIntegrantes.usoTarjetasDinero.monto,T=ye.jsonCoberturas.coberturas.dinero.coberturasIntegrantes.usoTarjetasDinero.checked,R=ye.jsonCoberturas.coberturas.objetosPersonales.monto;ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos&&(g=ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos.monto);var x=ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.bicicletasObjetos.monto;ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos&&ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos.checked;var N,w=ye.jsonCoberturas.coberturas.electrodomesticos.monto,O=ye.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.monto,B=ye.jsonCoberturas.coberturas.electrodomesticos.checked,L=ye.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.checked,F=ye.jsonCoberturas.coberturas.asistenciaViajes.monto;ye.jsonCoberturas.coberturas.extensionViajes&&(N=ye.jsonCoberturas.coberturas.extensionViajes.monto);var j;if(ye.jsonCoberturas.coberturas.asistenciaLegal&&(j=ye.jsonCoberturas.coberturas.asistenciaLegal.monto),$=void 0,ye.jsonCoberturas.coberturas.asistenciaInformatica)var $=ye.jsonCoberturas.coberturas.asistenciaInformatica.monto;var Y,H=ye.jsonCoberturas.coberturas.gastosFinales.monto,_=ye.jsonCoberturas.coberturas.gastosExtras.monto,U=ye.jsonCoberturas.coberturas.asistenciaViajes.checked;ye.jsonCoberturas.coberturas.extensionViajes&&(Y=ye.jsonCoberturas.coberturas.extensionViajes.checked);var z;ye.jsonCoberturas.coberturas.asistenciaLegal&&(z=ye.jsonCoberturas.coberturas.asistenciaLegal.checked);var V;ye.jsonCoberturas.coberturas.asistenciaInformatica&&(V=ye.jsonCoberturas.coberturas.asistenciaInformatica.checked);var Q=ye.jsonCoberturas.coberturas.gastosFinales.checked,q=f?"true":"false",G=h?"true":"false",J=u?"true":"false",K=m?"true":"false",W=c?"true":"false",X="AMPARADO"===P?"true":"false",Z="AMPARADO"===F?"true":"false",ee="AMPARADO"===N?"true":"false",te="AMPARADO"===j?"true":"false",ne="AMPARADO"===$?"true":"false",oe="AMPARADO"===H?"true":"false";f=f||0,h=h||0,u=u||0,m=m||0,e=e||0,t=t||0,o=o||0,i=i||0,s=s||0,c=c||0,p=p||0,v=v||0,y=y||0,b="AMPARADO"===b?y:0,S=S||0,M=M||0,A=A||0,E=E||0,I=I||0,R=R||0,g=g||0,x=x||0,w=w||0,O=O||0,_=_||0,v=v||0;var ae="true"===q?2:1,re={};switch(re.language="SPA",re.agentID=n.$parent.agentSelected.id,re.ClientNumber=ye.numeroCliente,re.InsurancePolicyDate=moment(new Date).format("YYYY-MM-DD"),re.PolicyMaturityDate=moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD"),ye.cmd.currency.type.id){case 1:re.Currency="MXN";break;case 2:re.Currency="USD"}re.PaymentMethod=ye.cmd.kindPaid.type.id,re.FederalEntityID=ye.cmd.dataHouseEntityRisk.type.id,re.DelegationMunicipalityID=ye.cmd.dataHouseMunicipalityRisk.type.id,re.PostalCode=ye.cmd.dataHousePostalCodeRisk.type.id,re.Street=ye.calle,re.WallTypeID=ye.cmd.kindStructure.type.id,re.RoofTypeID=ye.cmd.kindRoof.type.id,re.RiskTypeDetailAreaCode=ye.cmd.kindRisk.type.id,re.BeachFrontCode=ae,re.ContInsuredSum=p,re.ContHydromPhenomCoverageFlag=q,re.ContHydromPhenomCoverageInsuredSum=f,re.ContHydromPhenomCoverageStoredItemsInsuredSum=e,re.ContEarthquakeEruptCoverageFlag=G,re.ContEarthquakeEruptCoverageInsuredSum=h,re.ExtExpHomeInsuredSum=_,re.ExtExpHomeHydromPhenomCoverageFlag=q,re.ExtExpHomeHydromPhenomInsuredSum="0",re.ExtExpHomeEarthquakeEruptCoverageFlag=G,re.ExtExpHomeEarthquakeEruptInsuredSum="0",re.DebRemInsuredSum=v,re.DebRemHydromPhenomCoverageFlag=q,re.DebRemHydromPhenomInsuredSum="0",re.DebRemEarthquakeEruptCoverageFlag=G,re.DebRemEarthquakeEruptInsuredSum="0",re.FamCivLiaInsuredSum=y,C&&(re.FamCivLiaTenCivLiaInsuredSum=b),re.BuilCoverageFlag=W,re.BuilInsuredSum=c,re.BuilHydromPhenomCoverageFlag=J,re.BuilHydromPhenomInsuredSum=u,re.BuilHydromPhenomFinishedBuildingInsuredSum=t,re.BuilHydromPhenomVacatedBuildingInsuredSum=o,re.BuilHydromPhenomConstructionBuildingInsuredSum=i,re.BuilHydromPhenomFixedAdaptationsInsuredSum=s,re.BuilEarthquakeEruptCoverageFlag=K,re.BuilEarthquakeEruptInsuredSum=m,D&&(re.CrystalsInsuredSum=S),re.HouseholdEquipmentTheftInsuredSum=M,re.JewelryAndValuablesInsuredSum=A,re.MedicalExpensesCoverage=X,re.CashSecInsuredSum=E,T&&(re.CashSecCreditCardFraudInsuredSum=I),re.PerItemsInsuredSum=R,re.PerItemsPersonalItemsInsuredSum=g,re.PerItemsBicycleInsuredSum=x,re.SecurityMeasuresCode=l,re.AdjoiningHomeFlag=d,B&&(re.ElecEquipInsuredSum=w),L&&(re.ElecEquipMobileInsuredSum=O),U&&(re.HomeAssistanceCoverageFlag=Z),Y&&(re.TravelsCoverageFlag=ee),z&&(re.LegalAssistanceCoverageFlag=te),V&&(re.CompAssistServCoverageFlag=ne),Q&&(re.FinalExpensesCoverageFlag=oe),ye.jsonCotizacion.Street=re.Street,r.getServiceCotizacionPyme(re).then(function(e){if(e.success){ye.datosCotizados={primaNeta:e.info.insurancePaymentData.netPremium,derechosPoliza:e.info.insurancePaymentData.entitlement,recargos:e.info.insurancePaymentData.surcharge,iva:e.info.insurancePaymentData.vat,primaTotal:e.info.insurancePaymentData.totalPremium,numeroCotizacion:e.info.quotationNumber,coberturas:e.info.coverageList};var t=e.response;ye.primatotalImpresion=e.info.insurancePaymentData.totalPremium,t.outCommonHeader={},k(t)}else a.error("Error en el Servicio, no se encuentra disponible - code: "+e.info.transactionID),ye.cargandoCotizacion=!1})}function B(){ye.isClienteObt=!1,ye.emission.contract={gender:"1",name:"",lastName:"",secondLastName:"",birthdate:moment(new Date).format("YYYY-MM-DD"),fiscalIDNumber:"",email:"",phone:"",street:"",numberExt:"",numberInt:"",neighboarhood:"",stateContractor:{type:{}},entityContractor:{type:{}},pcContractor:{type:{}}},ye.cmd.emission.contract={stateContractor:{type:null},entityContractor:{type:null},pcContractor:{type:null}}}function L(){var e="",t="",n=!!ye.cotizacionSeleccionada,o=n?JSON.parse(ye.cotizacionSeleccionada.quotationJsonIni):null;switch(ye.flagSameAddressCheckBox=!!ye.cotizacionSeleccionada,ye.isClienteObt=!0,"9999"===ye.numeroCliente?"string"==typeof ye.fechaNacimiento?e=ye.fechaNacimiento:void 0!==(e=moment(ye.fechaNacimiento).format("DD/MM/YYYY"))&&"Invalid date"!==e||(e=moment(ye.fechaNacimiento,"DD/MM/YYYY"),e=moment(e).format("DD/MM/YYYY")):"string"==typeof ye.birthDay?e=ye.birthDay:void 0!==(e=moment(ye.birthDay).format("DD/MM/YYYY"))&&"Invalid date"!==e||(e=moment(ye.birthDay,"DD/MM/YYYY"),e=moment(e).format("DD/MM/YYYY")),ye.isClienteObt=!0,ye.emissionPersonType){case"F":e=F(n?ye.cotizacionSeleccionada.rfcCliente:ye.fiscalIDNumber,"1"),ye.emission.contract={gender:n?"1"===ye.cotizacionSeleccionada.sexoCliente?"1":"2":"masculino"===ye.sexo?"1":"2",name:n?ye.cotizacionSeleccionada.nombre:ye.nombres,lastName:n?ye.cotizacionSeleccionada.primerApellido:ye.apePaterno,secondLastName:n?ye.cotizacionSeleccionada.segundoApellido:ye.apeMaterno,birthdate:e,fiscalIDNumber:n?ye.cotizacionSeleccionada.rfcCliente:ye.fiscalIDNumber,email:n?ye.cotizacionSeleccionada.emailCliente:ye.emailUser,phone:n?ye.cotizacionSeleccionada.telefonoCliente:ye.phoneUser,street:n?o.Street:ye.calle,numberExt:ye.emission.riskNumberExt,numberInt:ye.emission.riskInterior,neighboarhood:ye.emission.riskNeighborhood,stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:ye.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:ye.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:ye.cmd.dataHousePostalCodeRisk.type}},ye.cmd.emission.contract={stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:ye.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:ye.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:ye.cmd.dataHousePostalCodeRisk.type}};break;case"M":n&&(1===ye.cotizacionSeleccionada.isCliente?"string"==typeof ye.cotizacionSeleccionada.fechaNacimiento?t=ye.cotizacionSeleccionada.fechaNacimiento:void 0!==(t=moment(ye.cotizacionSeleccionada.fechaNacimiento).format("DD/MM/YYYY"))&&"Invalid date"!==t||(t=moment(ye.cotizacionSeleccionada.fechaNacimiento,"DD/MM/YYYY"),t=moment(t).format("DD/MM/YYYY")):"string"==typeof ye.cotizacionSeleccionada.fechaNacimiento?t=ye.cotizacionSeleccionada.fechaNacimiento:void 0!==(t=moment(ye.cotizacionSeleccionada.fechaNacimiento).format("DD/MM/YYYY"))&&"Invalid date"!==t||(t=moment(ye.cotizacionSeleccionada.fechaNacimiento,"DD/MM/YYYY"),t=moment(e).format("DD/MM/YYYY"))),t=F(n?ye.cotizacionSeleccionada.rfcCliente:ye.fiscalIDNumber,"2"),ye.emission.contract={gender:"1",name:n?ye.cotizacionSeleccionada.nombre:ye.nombreCliente,lastName:"",secondLastName:"",birthdate:t,fiscalIDNumber:n?ye.cotizacionSeleccionada.rfcCliente:ye.fiscalIDNumber,email:n?ye.cotizacionSeleccionada.emailCliente:ye.emailUser,phone:n?ye.cotizacionSeleccionada.telefonoCliente:ye.phoneUser,street:n?o.Street:ye.calle,numberExt:ye.emission.riskNumberExt,numberInt:ye.emission.riskInterior,neighboarhood:ye.emission.riskNeighborhood,stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:ye.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:ye.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:ye.cmd.dataHousePostalCodeRisk.type}},ye.cmd.emission.contract={stateContractor:{type:n?o.catalogosCotizacion.dataHouseEntityRisk.type:ye.cmd.dataHouseEntityRisk.type},entityContractor:{type:n?o.catalogosCotizacion.dataHouseMunicipalityRisk.type:ye.cmd.dataHouseMunicipalityRisk.type},pcContractor:{type:n?o.catalogosCotizacion.dataHousePostalCodeRisk.type:ye.cmd.dataHousePostalCodeRisk.type}}}}function F(e,t){var n=moment(new Date).format("YY"),o="1"===t?e.substring(4,10):e.substring(3,9),a=o.substring(0,2),r=o.substring(2,4),i=o.substring(4,6);return a=a>n?"19"+a:"20"+a,o=i+"/"+r+"/"+a}function j(){var e=void 0===ye.comboYearExpiration?"":ye.comboYearExpiration.id,t=void 0===ye.comboMonthExpiration?"":ye.comboMonthExpiration.id,n=void 0===ye.cmd.ListTypeCLABE?"":ye.cmd.ListTypeCLABE.type.text,o=void 0===ye.emission.payment.dateAprox?moment(new Date).format("YYYY-MM-DD"):moment(ye.emission.payment.dateAprox).format("YYYY-MM-DD"),i=void 0===ye.emission.payment.accountNumber?"":ye.emission.payment.accountNumber,s=void 0===ye.emission.payment.cvv?"":ye.emission.payment.cvv,c=void 0===ye.emission.payment.clabe?"":ye.emission.payment.clabe,u="",l="",d="";d="string"==typeof ye.emission.contract.birthdate?ye.emission.contract.birthdate.split("/").reverse().join("-"):moment(new Date(ye.emission.contract.birthdate)).format("YYYY-MM-DD"),"8"!==ye.cmd.paymentType.type.id&&"2"!==ye.cmd.paymentType.type.id||(u=e+"-"+t+"-01",l=o),"2"===ye.cmd.paymentType.type.id&&"CLABE"===n&&(u=o,l=o);var m={QuotationNumber:ye.datosCotizacion.numeroCotizacion||ye.cotizacionSeleccionada.cotizacion,InsuInsurancePolicyDate:moment(new Date).format("YYYY-MM-DD"),InsuPolicyMaturityDate:moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD"),InsuNumberOfFloors:ye.emission.floors,InsuNumberOfBasements:ye.emission.basements,InsuPaymentManagerID:ye.cmd.paymentType.type.id,RiskStreetTypeID:ye.cmd.emission.streetType.type.id,RiskStreet:ye.emission.riskStreet,RiskInteriorNumber:ye.emission.riskInterior,RiskOutdoorNumber:ye.emission.riskNumberExt,RiskNeighborhood:ye.emission.riskNeighborhood,RiskSameAddressContractingPartyFlag:!0===ye.cmd.emission.sameAddress?"1":"0",ContractPersonType:ye.emissionPersonType,ContractFiscalIDNumber:ye.emission.contract.fiscalIDNumber,ContractName:ye.emission.contract.name,ContractLastName:ye.emission.contract.lastName,ContractSecondLastName:ye.emission.contract.secondLastName,ContractBirthDate:d,ContractGender:"F"===ye.emissionPersonType?ye.emission.contract.gender:"1",ContractPhoneNumber:ye.emission.contract.phone,ContractEmail:ye.emission.contract.email,ContractStreet:ye.emission.contract.street,ContractNeighborhood:ye.emission.contract.neighboarhood,ContractFederalEntityID:ye.cmd.emission.contract.stateContractor.type.id,ContractDelegationMunicipalityID:ye.cmd.emission.contract.entityContractor.type.id,ContractPostalCode:ye.cmd.emission.contract.pcContractor.type.id,CheckBeneficiary:ye.checkBeneficiary?"true":"false",BeneficiaryPersonType:ye.checkBeneficiary?ye.emission.beneficiary.type:"",BeneficiaryFiscalIDNumber:ye.checkBeneficiary?ye.emission.beneficiary.rfc:"",BeneficiaryName:ye.checkBeneficiary?"F"===ye.emission.beneficiary.type?ye.emission.beneficiary.name:ye.emission.beneficiary.social:"",BeneficiaryLastName:ye.checkBeneficiary?ye.emission.beneficiary.lastName:"",BeneficiarySecondLastName:ye.checkBeneficiary?ye.emission.beneficiary.secondLastName:"",BeneficiaryStreet:ye.checkBeneficiary?ye.emission.beneficiary.street:"",BeneficiaryNeighborhood:ye.checkBeneficiary?ye.emission.beneficiary.neighboarhood:"",BeneficiaryFederalEntityID:ye.checkBeneficiary?ye.cmd.emission.beneficiary.stateBeneficiary.type.id:"",BeneficiaryDelegationMunicipalityID:ye.checkBeneficiary?ye.cmd.emission.beneficiary.entityBeneficiary.type.id:"",BeneficiaryPostalCode:ye.checkBeneficiary?ye.cmd.emission.beneficiary.pcBeneficiary.type.id:"",TitularPersonType:ye.emissionPersonType,TitularFiscalIDNumber:ye.emission.contract.fiscalIDNumber,TitularName:ye.emission.contract.name,TitularLastName:ye.emission.contract.lastName,TitularSecondLastName:ye.emission.contract.secondLastName,TitularBirthDate:d,TitularGender:"F"===ye.emissionPersonType?ye.emission.contract.gender:"1",TitularPhoneNumber:ye.emission.contract.phone,TitularEmail:ye.emission.contract.email,TitularStreet:ye.emission.contract.street,TitularNeighborhood:ye.emission.contract.neighboarhood,TitularFederalEntityID:ye.cmd.emission.contract.stateContractor.type.id,TitularDelegationMunicipalityID:ye.cmd.emission.contract.entityContractor.type.id,TitularPostalCode:ye.cmd.emission.contract.pcContractor.type.id,BankingPaymentMethod:"8"===ye.cmd.paymentType.type.id?"TC":"1"===ye.cmd.paymentType.type.id?"":ye.cmd.ListTypeCLABE.type.text,BankingBankID:"8"!==ye.cmd.paymentType.type.id&&"2"!==ye.cmd.paymentType.type.id||void 0===ye.cmd.dataBanks.type?"":ye.cmd.dataBanks.type.id,BankingName:ye.emission.payment.name,BankingLastName:ye.emission.payment.lastName,BankingSecondLastName:ye.emission.payment.secondLastName,BankingEmail:ye.emission.payment.email,BankingAccountNumber:i,BankingCardVerificationValue:s,BankingExpirationDate:u,
BankingCardID:"8"!==ye.cmd.paymentType.type.id&&"2"!==ye.cmd.paymentType.type.id||void 0===ye.cmd.cardType.type?"":ye.cmd.cardType.type.id,BankingCLABE:c,BankingPaymentDate:l,TypeCardByClabe:void 0===ye.cmd.ListTypeCLABE?"":ye.cmd.ListTypeCLABE.type.text,language:"SPA"};r.getServiceEmisionPyme(m).then(function(e){if(e.success){ye.datosCotizacion=e.info,ye.numPoliza=e.info.policyNumber,ye.stepForm.stepD=!1,ye.stepForm.stepE=!0;var t={language:"SPA",idCotizacion:m.QuotationNumber,idPoliza:ye.numPoliza,quotationJsonInit:JSON.stringify(m),quotationJsonEnd:JSON.stringify(e.response),numberAuthorizer:0};r.updateQuotation(t).then(function(e){a.done("Emisión Exitosa. Número de póliza: "+ye.numPoliza)}).catch()}else a.error("Error en el Servicio, no se encuentra disponible - code: "+e.info.transactionID)})}function $(){var e=-1!==window.location.href.indexOf("asesoria.actinver.com/asesoria")?"https://negocios.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+ye.numPoliza+"&Endoso=0":"https://negociosuat.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+ye.numPoliza+"&Endoso=0";window.open(e,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function Y(){var e;e="img/pdfs/actinver-condiciones-generales-mapfre-hogar30052019.pdf",window.open(e,"_blank","width="+screen.width+"px,height="+screen.height+"px,resizable=0")}function H(){e.go("insurance.main",{model:null})}function _(){if(Number(ye.emission.floors)<=0)return void a.error("El número de PISOS debe ser MAYOR a CERO");z()&&(ye.stepForm.stepC=!1,ye.stepForm.stepD=!0)}function U(){ye.stepForm.stepC=!0,ye.stepForm.stepD=!1}function z(){if(!V(moment(ye.emission.contract.birthdate).format("DD/MM/YYYY"),ye.emission.contract.fiscalIDNumber,ye.personType,"Contratante"))return!1;if(ye.checkBeneficiary){var e="";if("F"===ye.emission.beneficiary.type?personaBeneficiario="1":"M"===ye.emission.beneficiary.type&&(personaBeneficiario="2"),"1"===personaBeneficiario?ye.emission.beneficiary.dateF?e=ye.emission.beneficiary.dateF:a.error("Favor de Capturar el campo de Fecha de Nacimiento del Beneficiario"):"2"===personaBeneficiario&&(ye.emission.beneficiary.dateM?e=ye.emission.beneficiary.dateM:a.error("Favor de Capturar el campo de Fecha de Constitución del Beneficiario")),e=moment(e).format("DD/MM/YYYY"),!V(e,ye.emission.beneficiary.rfc,personaBeneficiario,"Beneficiario"))return!1}return!0}function V(e,t,n,o){if(ye.isClienteObt)return!0;var r="",i=e.split("/");if(r+=i[2].substring(2,4),r+=i[1],r+=i[0],"1"===n){if(r!==t.substring(4,10))return a.error("La fecha de nacimiento del "+o+" no coincide con la fecha del RFC."),!1;ye.bnd=!0}else if("2"===n){if(r!==t.substring(3,9))return t.length>12&&"2"===n?(a.error("El RFC del "+o+" no cumple con la longitud correcta. "),!1):(a.error("La fecha constitutiva del "+o+" no coincide con la fecha del RFC."),!1);ye.bnd=!0}return!0}function Q(){if(ye.bnd=!1,ye.isClienteObt)ye.bnd=!0;else{var e=ye.disabledRFC?ye.birthDay:ye.fechaNacimiento;e="string"==typeof e?e:moment(e).format("DD/MM/YYYY");var t=ye.fiscalIDNumber,n="",o=e.split("/");n+=o[2].substring(2,4),n+=o[1],n+=o[0],"1"===ye.personType?n===t.substring(4,10)?ye.bnd=!0:a.error("La fecha de nacimiento no coincide con la fecha del RFC."):"2"===ye.personType&&(n===t.substring(3,9)?ye.bnd=!0:t.length>12&&"2"===ye.personType?a.error("El RFC no cumple con la longitud correcta. "):a.error("La fecha constitutiva no coincide con la fecha del RFC."))}}function q(e){for(var t=document.getElementById(e),n=(t.value+"").split(""),o="",a=0;a<n.length;a++)(n[a]+"").match(/^[0-9a-zA-ZÁÉÍÓÚÑáéíóúñ ]+$/)&&(o+=n[a]);t.value=o+""}function G(e){for(var t=document.getElementById(e),n=(t.value+"").split(""),o="",a=0;a<n.length;a++)(n[a]+"").match(/^[0-9]+$/)&&(o+=n[a]);t.value=o+""}function J(e){var t=new RegExp("^[0-9]+$"),n=void 0!==event.charCode?event.charCode:event.which,o=String.fromCharCode(n);if(!t.test(o)&&0!==event.charCode)return event.preventDefault(),!1}function K(e){return/^[1-9]+[0-9]*]*$/.test(e),!0}function W(e,t){var n=void 0!==event.charCode?event.charCode:event.which,o=void 0!==t?t.toUpperCase():String.fromCharCode(n).toUpperCase();if(o.length>2){var a=o.substring(o.length-3,o.length);if(K(a)){if(Se=a.substring(0,1),De=a.substring(1,2),Me=a.substring(2,3),Se.toString()===De.toString()&&De.toString()===Me.toString())return event.preventDefault(),!1}else if(Se=a.substring(0,1),De=a.substring(1,2),Me=a.substring(2,3),parseInt(De)===parseInt(Me)-1&&parseInt(Se)===parseInt(De)-1)return event.preventDefault(),!1}return!1}function X(e,t){var n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n).toUpperCase(),a=angular.element("#"+t).val().toString().toUpperCase();if(a=void 0===a?"":a,a.substring(a.length-1,a.length)===o&&a.substring(a.length-2,a.length-1)===o)return e.preventDefault(),!1}function Z(e,t){var n=void 0!==e.charCode?e.charCode:e.which,o=String.fromCharCode(n).toUpperCase(),a=angular.element("#"+t).val().toString().toUpperCase();if(a=void 0===a?"":a,a.substring(a.length-1,a.length)===o&&a.substring(a.length-2,a.length-1)===o&&a.substring(a.length-3,a.length-2)===o)return e.preventDefault(),!1}function ee(e,t){var n=t?new RegExp("^[a-zA-Z0-9 ]+$"):new RegExp("^[a-zA-Z0-9]+$"),o=void 0!==event.charCode?event.charCode:event.which,a=String.fromCharCode(o);return 241===event.which||209===event.which||225===event.which||233===event.which||237===event.which||243===event.which||250===event.which||193===event.which||201===event.which||205===event.which||211===event.which||218===event.which||(n.test(a)||0===event.charCode?void 0:(event.preventDefault(),!1))}function te(e,t,n){var o=new RegExp("^[a-zA-Z]+$"),a=void 0!==e.charCode?e.charCode:e.which,r=String.fromCharCode(a);return 241===e.which||209===e.which||225===e.which||233===e.which||237===e.which||243===e.which||250===e.which||193===e.which||201===e.which||205===e.which||211===e.which||218===e.which||32===e.which||(o.test(r)||0===e.charCode?void 0:(e.preventDefault(),!1))}function ne(e,t){var n=angular.element("#"+t).val();return n=void 0===n?"":n,"01"!==n.toString()&&"001"!==n.toString()?!(n.toString().length>5&&"01234567890000000000111111111122222222223333333333444444444455555555556666666666777777777788888888889999999999".includes(n.toString())&&(e.preventDefault(),1)):(e.preventDefault(),!1)}function oe(e){var t=e.keyCode;if(t>=97&&t<=122&&!e.ctrlKey&&!e.metaKey&&!e.altKey){var n=t-32,o=e.target.selectionStart,a=e.target.selectionEnd;e.target.value=e.target.value.substring(0,o)+String.fromCharCode(n)+e.target.value.substring(a),e.target.setSelectionRange(o+1,o+1),e.preventDefault()}}function ae(){var e=1*ye.importeEdificio;ye.sumaGastosExtras=e+.1*e+"",document.getElementById("sumaGastosExtras").disabled="true"}function re(){var e=1*ye.importeEdificio;ye.sumaRemEsco=e+.1*e+"",document.getElementById("sumaRemEsco").disabled="true"}function ie(e){ye.tipoRiesgo=e,se()}function se(){"2"===ye.tipoRiesgo.id?(ye.roboMenaje.c.checked=!1,ye.roboMenaje.ci.joyas.checked=!1,ye.dinero.c.checked=!1,ye.dinero.ci.usoTarjetasDinero.checked=!1,"SEGUROS"===ye.rol&&(ye.roboMenaje.c.montoDisabled=!0,ye.roboMenaje.c.obligatorio=!0,ye.dinero.c.montoDisabled=!0,ye.dinero.c.obligatorio=!0)):"ASESOR"===ye.rol?(ye.roboMenaje.c.checked=!0,ye.dinero.c.checked=!0,ye.roboMenaje.ci.joyas.checked=!0):"SEGUROS"===ye.rol&&(ye.roboMenaje.c.montoDisabled=!1,ye.roboMenaje.c.obligatorio=!1,ye.dinero.c.montoDisabled=!1,ye.dinero.c.obligatorio=!1),me()}function ce(e){var t=[];r.getCoverage().then(function(n){angular.forEach(n.info,function(e){var n={};try{n=JSON.parse(ve(e.json))}catch(t){try{n=JSON.parse(e.json)}catch(e){a.error("No fue posible obtener las coberturas.")}}t.push({id:e.idCobertura,isCliente:e.isCliente,json:n,moneda:e.moneda,rollUsuario:e.rollUsuario,status:e.status,tipoCliente:e.tipoCliente})});for(var o=0;o<t.length;o++)"ASESOR"===t[o].rollUsuario&&"MXN"===t[o].moneda&&(ye.jsonCoberturasAsesorMXN=t[o].json),"ASESOR"===t[o].rollUsuario&&"USD"===t[o].moneda&&(ye.jsonCoberturasAsesorUSD=t[o].json),"SEGUROS"===t[o].rollUsuario&&"MXN"===t[o].moneda&&(ye.jsonCoberturasSegurosMXN=t[o].json),"SEGUROS"===t[o].rollUsuario&&"USD"===t[o].moneda&&(ye.jsonCoberturasSegurosUSD=t[o].json);ue(e)})}function ue(e){var t=1;if(e&&(t=e.id),"ASESOR"===ye.rol)switch(t){case 1:ye.jsonCoberturas=ye.jsonCoberturasAsesorMXN;break;case 2:ye.jsonCoberturas=ye.jsonCoberturasAsesorUSD}if("SEGUROS"===ye.rol)switch(t){case 1:ye.jsonCoberturas=ye.jsonCoberturasSegurosMXN;break;case 2:ye.jsonCoberturas=ye.jsonCoberturasSegurosUSD}ye.limiteMaximoEquipoMovil=ye.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.limiteMaximo,ye.limiteMaximoCristales=ye.jsonCoberturas.coberturas.cristales.limiteMaximo,ye.limiteMaximoRoboMenaje=ye.jsonCoberturas.coberturas.roboMenaje.limiteMaximo,ye.limiteMaximoRcFamiliar=ye.jsonCoberturas.coberturas.rcFamiliar.limiteMaximo,ye.dineroMontoInicial=ye.jsonCoberturas.coberturas.dinero.monto,ye.limiteMaximoUsoTarjetas=ye.jsonCoberturas.coberturas.dinero.coberturasIntegrantes.usoTarjetasDinero.limiteMaximo,ye.bicicletasMontoInicial=ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.bicicletasObjetos.monto,ye.objetosObjetosMontoInicial=ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes.objetosObjetos.monto,ye.objetosMontoInicial=ye.jsonCoberturas.coberturas.objetosPersonales.monto,ye.equipoMovilMontoInicial=ye.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes.equipoMovil.monto,ye.edificio={c:ye.jsonCoberturas.coberturas.edificio,ci:ye.jsonCoberturas.coberturas.edificio.coberturasIntegrantes},ye.contenidos={c:ye.jsonCoberturas.coberturas.contenidos,ci:ye.jsonCoberturas.coberturas.contenidos.coberturasIntegrantes},ye.rcFamiliar={c:ye.jsonCoberturas.coberturas.rcFamiliar,ci:ye.jsonCoberturas.coberturas.rcFamiliar.coberturasIntegrantes},ye.roboMenaje={c:ye.jsonCoberturas.coberturas.roboMenaje,ci:ye.jsonCoberturas.coberturas.roboMenaje.coberturasIntegrantes},ye.dinero={c:ye.jsonCoberturas.coberturas.dinero,ci:ye.jsonCoberturas.coberturas.dinero.coberturasIntegrantes},ye.objetosPersonales={c:ye.jsonCoberturas.coberturas.objetosPersonales,ci:ye.jsonCoberturas.coberturas.objetosPersonales.coberturasIntegrantes},ye.electrodomesticos={c:ye.jsonCoberturas.coberturas.electrodomesticos,ci:ye.jsonCoberturas.coberturas.electrodomesticos.coberturasIntegrantes},ye.remocionEscombros={c:ye.jsonCoberturas.coberturas.remocionEscombros,ci:ye.jsonCoberturas.coberturas.remocionEscombros.coberturasIntegrantes},ye.gastosAsalto={c:ye.jsonCoberturas.coberturas.gastosAsalto,ci:ye.jsonCoberturas.coberturas.gastosAsalto.coberturasIntegrantes},ye.gastosFinales={c:ye.jsonCoberturas.coberturas.gastosFinales,ci:ye.jsonCoberturas.coberturas.gastosFinales.coberturasIntegrantes},ye.gastosExtras={c:ye.jsonCoberturas.coberturas.gastosExtras,ci:ye.jsonCoberturas.coberturas.gastosExtras.coberturasIntegrantes},ye.cristales={c:ye.jsonCoberturas.coberturas.cristales,ci:ye.jsonCoberturas.coberturas.cristales.coberturasIntegrantes},ye.jsonCoberturas.coberturas.asistenciaInformatica&&(ye.asistenciaInformatica={c:ye.jsonCoberturas.coberturas.asistenciaInformatica,ci:ye.jsonCoberturas.coberturas.asistenciaInformatica.coberturasIntegrantes}),ye.jsonCoberturas.coberturas.asistenciaLegal&&(ye.asistenciaLegal={c:ye.jsonCoberturas.coberturas.asistenciaLegal,ci:ye.jsonCoberturas.coberturas.asistenciaLegal.coberturasIntegrantes}),ye.asistenciaViajes={c:ye.jsonCoberturas.coberturas.asistenciaViajes,ci:ye.jsonCoberturas.coberturas.asistenciaViajes.coberturasIntegrantes},ye.jsonCoberturas.coberturas.extensionViajes&&(ye.extensionViajes={c:ye.jsonCoberturas.coberturas.extensionViajes,ci:ye.jsonCoberturas.coberturas.extensionViajes.coberturasIntegrantes}),se(),me()}function le(e){return isNaN(e)?"NA"===e?"":void 0:"$"+ge(e)}function de(e){var t=e.currentTarget;"edificio1"===t.id&&(t.checked?(ye.edificio.c.monto=ye.edificio.c.limiteMinimo,ye.edificio.c.montoDisabled=!1,ye.edificio.ci.incendioEdificio.checked=!0,ye.contenidos.ci.hidroContenidos.checked&&(ye.edificio.ci.hidroEdificio.checked=!0),ye.contenidos.ci.terremotoContenidos.checked&&(ye.edificio.ci.terremotoEdificio.checked=!0),ye.rcFamiliar.ci.rcArrendatario.checked=!1,ye.rcFamiliar.ci.rcArrendatario.monto=void 0,ye.rcFamiliar.ci.rcArrendatario.montoDisabled=!0):(ye.edificio.c.monto=void 0,ye.edificio.c.montoDisabled=!0,ye.edificio.ci.incendioEdificio.checked=!1,ye.edificio.ci.incendioEdificio.monto=void 0,ye.edificio.ci.incendioEdificio.montoDisabled=!0,ye.edificio.ci.hidroEdificio.checked=!1,ye.edificio.ci.hidroEdificio.monto=void 0,ye.edificio.ci.hidroEdificio.montoDisabled=!0,ye.edificio.ci.terremotoEdificio.checked=!1,ye.edificio.ci.terremotoEdificio.monto=void 0,ye.edificio.ci.terremotoEdificio.montoDisabled=!0,ye.rcFamiliar.ci.rcArrendatario.checked=!0,ye.rcFamiliar.ci.rcArrendatario.obligatorio=!0,ye.rcFamiliar.ci.rcArrendatario.monto="AMPARADO")),"hidroEdificio1"===t.id&&ye.edificio.c.checked&&(t.checked?ye.contenidos.ci.hidroContenidos.checked=!0:(ye.edificio.ci.hidroEdificio.monto=void 0,ye.contenidos.ci.hidroContenidos.checked=!1,ye.contenidos.ci.hidroContenidos.monto=void 0)),ye.edificio.ci.hidroEdificio.coberturasIntegrantes&&(ye.edificio.ci.hidroEdificio.checked||(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked=!1,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.montoDisabled=!0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.checked=!1,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.montoDisabled=!0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.checked=!1,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.montoDisabled=!0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.checked=!1,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.montoDisabled=!0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.checked=!1,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.montoDisabled=!0)),"hidroContenidos1"===t.id&&(t.checked?ye.edificio.c.checked&&(ye.edificio.ci.hidroEdificio.checked=!0):(ye.contenidos.ci.hidroContenidos.monto=void 0,ye.edificio.ci.hidroEdificio.checked=!1,ye.edificio.ci.hidroEdificio.monto=void 0,void 0!==ye.contenidos.ci.hidroContenidos.coberturasIntegrantes&&(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.checked=!1,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.monto=void 0,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.montoDisabled=!0,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.checked=!1,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.monto=void 0,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.montoDisabled=!0))),ye.edificio.ci.hidroEdificio.coberturasIntegrantes&&(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked=!1),"limConstruccion1"===t.id&&(t.checked?ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.montoDisabled=!1:(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.montoDisabled=!0)),"limDesocupado1"===t.id&&(t.checked?ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.montoDisabled=!1:(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.montoDisabled=!0)),"limFija1"===t.id&&(t.checked?ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.montoDisabled=!1:(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.montoDisabled=!0)),"limTerminado1"===t.id&&(t.checked?ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.montoDisabled=!1:(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.monto=void 0,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.montoDisabled=!0)),ye.edificio.ci.hidroEdificio.coberturasIntegrantes&&(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.checked||ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.checked||ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.checked||ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.checked)&&(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.checked=!0),"bienesContenidos1"===t.id&&(t.checked?ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.montoDisabled=!1:(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.monto=void 0,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.montoDisabled=!0)),"limContenidos1"===t.id&&(t.checked?ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.montoDisabled=!1:(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.monto=void 0,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.montoDisabled=!0)),"terremotoEdificio1"===t.id&&ye.edificio.c.checked&&(t.checked?ye.contenidos.ci.terremotoContenidos.checked=!0:(ye.edificio.ci.terremotoEdificio.monto=void 0,ye.contenidos.ci.terremotoContenidos.checked=!1,ye.contenidos.ci.terremotoContenidos.monto=void 0)),"terremotoContenidos1"===t.id&&(t.checked?ye.edificio.c.checked&&(ye.edificio.ci.terremotoEdificio.checked=!0):(ye.contenidos.ci.terremotoContenidos.monto=void 0,ye.edificio.ci.terremotoEdificio.checked=!1,ye.edificio.ci.terremotoEdificio.monto=void 0)),"cristales1"===t.id&&(t.checked?ye.cristales.c.montoDisabled=!1:(ye.cristales.c.monto=void 0,ye.cristales.c.montoDisabled=!0)),"roboMenaje1"===t.id&&(t.checked?"SEGUROS"===ye.rol&&(ye.roboMenaje.c.montoDisabled=!1):("SEGUROS"===ye.rol&&(ye.roboMenaje.c.montoDisabled=!0),ye.roboMenaje.c.monto=void 0,ye.roboMenaje.ci.joyas.checked=!1)),"joyas1"===t.id&&(t.checked?"SEGUROS"===ye.rol&&(ye.roboMenaje.ci.joyas.montoDisabled=!1):("SEGUROS"===ye.rol&&(ye.roboMenaje.ci.joyas.montoDisabled=!0),ye.roboMenaje.ci.joyas.monto=void 0)),"dinero1"===t.id&&(t.checked?ye.dinero.c.montoDisabled=!1:(ye.dinero.c.monto=void 0,ye.dinero.c.montoDisabled=!0,ye.dinero.ci.usoTarjetasDinero.checked=!1)),"usoTarjetasDinero1"===t.id&&(t.checked?ye.dinero.ci.usoTarjetasDinero.montoDisabled=!1:(ye.dinero.ci.usoTarjetasDinero.monto=void 0,ye.dinero.ci.usoTarjetasDinero.montoDisabled=!0)),"objetosPersonales1"===t.id&&(t.checked||(ye.objetosPersonales.c.monto=void 0,ye.objetosPersonales.ci.objetosObjetos.checked=!1,ye.objetosPersonales.ci.objetosObjetos.monto=void 0,ye.objetosPersonales.ci.objetosObjetos.montoDisabled=!0,ye.objetosPersonales.ci.bicicletasObjetos.checked=!1,ye.objetosPersonales.ci.bicicletasObjetos.monto=void 0,ye.objetosPersonales.ci.bicicletasObjetos.montoDisabled=!0)),"objetosObjetos1"===t.id&&(t.checked?ye.objetosPersonales.ci.objetosObjetos.montoDisabled=!1:(ye.objetosPersonales.ci.objetosObjetos.monto=void 0,ye.objetosPersonales.ci.objetosObjetos.montoDisabled=!0)),"bicicletasObjetos1"===t.id&&(t.checked?"SEGUROS"===ye.rol&&(ye.objetosPersonales.ci.bicicletasObjetos.montoDisabled=!1):"SEGUROS"===ye.rol&&(ye.objetosPersonales.ci.bicicletasObjetos.montoDisabled=!0)),"electrodomesticos1"===t.id&&(t.checked?ye.electrodomesticos.c.montoDisabled=!1:(ye.electrodomesticos.c.monto=void 0,ye.electrodomesticos.c.montoDisabled=!0,ye.electrodomesticos.ci.equipoMovil.checked=!1,ye.electrodomesticos.ci.equipoMovil.monto=void 0,ye.electrodomesticos.ci.equipoMovil.montoDisabled=!0)),"equipoMovil1"===t.id&&(t.checked?"SEGUROS"===ye.rol&&(ye.electrodomesticos.ci.equipoMovil.montoDisabled=!1):("SEGUROS"===ye.rol&&(ye.electrodomesticos.ci.equipoMovil.montoDisabled=!0),ye.electrodomesticos.ci.equipoMovil.monto=void 0)),"asistenciaViajes1"===t.id&&(t.checked||ye.jsonCoberturas.coberturas.extensionViajes&&(ye.extensionViajes.c.checked=!1)),"extensionViajes1"===t.id&&t.checked&&(ye.asistenciaViajes.c.checked=!0),me()}function me(){var e=ye.edificio.c.monto?ye.edificio.c.monto:0,t=ye.contenidos.c.monto?ye.contenidos.c.monto:0,n=.1*(parseFloat(e)+parseFloat(t));ye.gastosExtras.c.monto=n,ye.remocionEscombros.c.monto=n,ye.edificio.ci.incendioEdificio.checked&&(ye.edificio.ci.incendioEdificio.monto=e),ye.edificio.ci.hidroEdificio.checked&&(ye.edificio.ci.hidroEdificio.monto=e),ye.edificio.ci.terremotoEdificio.checked&&(ye.edificio.ci.terremotoEdificio.monto=e),ye.contenidos.ci.incendioContenidos.checked&&(ye.contenidos.ci.incendioContenidos.monto=ye.contenidos.c.monto),ye.contenidos.ci.hidroContenidos.checked&&(ye.contenidos.ci.hidroContenidos.monto=ye.contenidos.c.monto),ye.contenidos.ci.terremotoContenidos.checked&&(ye.contenidos.ci.terremotoContenidos.monto=ye.contenidos.c.monto);var o=.3*e;if(ye.edificio.ci.hidroEdificio.coberturasIntegrantes&&(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.limiteMaximo=o,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.limiteMaximo=o,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.limiteMaximo=o,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.limiteMaximo=o,ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.limiteMaximo=o),ye.edificio.ci.hidroEdificio.coberturasIntegrantes)if(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion.checked||ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado.checked||ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija.checked||ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado.checked){var a=ye.edificio.ci.hidroEdificio.coberturasIntegrantes,r=a.limConstruccion.monto?a.limConstruccion.monto:0,i=a.limDesocupado.monto?a.limDesocupado.monto:0,s=a.limFija.monto?a.limFija.monto:0,c=a.limTerminado.monto?a.limTerminado.monto:0;ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto=r+i+s+c}else ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio.monto=void 0;var o=.3*t;if(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes&&(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos.limiteMaximo=o,ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos.limiteMaximo=o),o=.15*parseFloat(t),o<ye.limiteMaximoCristales?ye.cristales.c.limiteMaximo=o:ye.cristales.c.limiteMaximo=ye.limiteMaximoCristales,o=.8*parseFloat(t),o<ye.limiteMaximoRoboMenaje?ye.roboMenaje.c.limiteMaximo=o:ye.roboMenaje.c.limiteMaximo=ye.limiteMaximoRoboMenaje,"2"===ye.tipoRiesgo.id?ye.roboMenaje.c.monto=void 0:"ASESOR"===ye.rol&&(ye.roboMenaje.c.montoDisabled=!0,o=.5*parseFloat(t),o<ye.limiteMaximoRoboMenaje?ye.roboMenaje.c.monto=o:ye.roboMenaje.c.monto=ye.limiteMaximoRoboMenaje),o=.5*parseFloat(ye.roboMenaje.c.monto),ye.roboMenaje.ci.joyas.limiteMaximo=o,"ASESOR"===ye.rol&&(ye.roboMenaje.ci.joyas.monto=.5*ye.roboMenaje.c.monto),ye.roboMenaje.c.monto||(ye.roboMenaje.ci.joyas.checked=!1,ye.roboMenaje.ci.joyas.monto=void 0,ye.roboMenaje.ci.joyas.montoDisabled=!0),"2"===ye.tipoRiesgo.id?ye.dinero.c.monto=void 0:"ASESOR"===ye.rol&&(ye.dinero.c.monto=ye.dineroMontoInicial),ye.dinero.c.monto&&(ye.dinero.c.monto<ye.limiteMaximoUsoTarjetas?ye.dinero.ci.usoTarjetasDinero.limiteMaximo=ye.dinero.c.monto:ye.dinero.ci.usoTarjetasDinero.limiteMaximo=ye.limiteMaximoUsoTarjetas),ye.dinero.c.monto||(ye.dinero.ci.usoTarjetasDinero.checked=!1,ye.dinero.ci.usoTarjetasDinero.monto=void 0,ye.dinero.ci.usoTarjetasDinero.montoDisabled=!0),"ASESOR"===ye.rol&&(ye.objetosPersonales.ci.bicicletasObjetos.checked?ye.objetosPersonales.ci.bicicletasObjetos.monto=ye.bicicletasMontoInicial:ye.objetosPersonales.ci.bicicletasObjetos.monto=void 0),"ASESOR"===ye.rol&&(ye.objetosPersonales.ci.objetosObjetos.checked?ye.objetosPersonales.ci.objetosObjetos.monto=ye.objetosObjetosMontoInicial:ye.objetosPersonales.ci.objetosObjetos.monto=void 0),ye.objetosPersonales.c.checked){var u=ye.objetosPersonales.ci,r=u.objetosObjetos.monto?u.objetosObjetos.monto:0,i=u.bicicletasObjetos.monto?u.bicicletasObjetos.monto:0;ye.objetosPersonales.c.monto=r+i}o=.5*parseFloat(t),ye.electrodomesticos.c.limiteMaximo=o;var l=.3*parseFloat(ye.electrodomesticos.c.monto);"SEGUROS"===ye.rol&&(l<ye.limiteMaximoEquipoMovil?ye.electrodomesticos.ci.equipoMovil.limiteMaximo=l:ye.electrodomesticos.ci.equipoMovil.limiteMaximo=ye.limiteMaximoEquipoMovil,ye.electrodomesticos.c.monto||(ye.electrodomesticos.ci.equipoMovil.checked=!1,ye.electrodomesticos.ci.equipoMovil.monto=void 0,ye.electrodomesticos.ci.equipoMovil.montoDisabled=!0)),"ASESOR"===ye.rol&&(ye.electrodomesticos.ci.equipoMovil.checked?l<ye.equipoMovilMontoInicial?ye.electrodomesticos.ci.equipoMovil.monto=l:ye.electrodomesticos.ci.equipoMovil.monto=ye.equipoMovilMontoInicial:ye.electrodomesticos.ci.equipoMovil.monto=void 0),ye.gastosAsalto.c.monto=void 0,ye.asistenciaViajes.c.monto=void 0,ye.gastosFinales.c.monto=void 0,ye.extensionViajes.c&&(ye.extensionViajes.c.monto=void 0),ye.asistenciaInformatica.c&&(ye.asistenciaInformatica.c.monto=void 0),ye.asistenciaLegal.c&&(ye.asistenciaLegal.c.monto=void 0),ye.gastosAsalto.c.checked&&(ye.gastosAsalto.c.monto="AMPARADO"),ye.asistenciaViajes.c.checked&&(ye.asistenciaViajes.c.monto="AMPARADO"),ye.extensionViajes.c&&ye.extensionViajes.c.checked&&(ye.extensionViajes.c.monto="AMPARADO"),ye.asistenciaInformatica.c&&ye.asistenciaInformatica.c.checked&&(ye.asistenciaInformatica.c.monto="AMPARADO"),ye.asistenciaLegal.c&&ye.asistenciaLegal.c.checked&&(ye.asistenciaLegal.c.monto="AMPARADO"),ye.gastosFinales.c.checked&&(ye.gastosFinales.c.monto="AMPARADO")}function pe(){if(fe(ye.edificio.c))return!0;if(ye.edificio.ci.hidroEdificio.coberturasIntegrantes){if(fe(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.bienesEdificio))return!0;if(fe(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limTerminado))return!0;if(fe(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limDesocupado))return!0;if(fe(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limConstruccion))return!0;if(fe(ye.edificio.ci.hidroEdificio.coberturasIntegrantes.limFija))return!0}if(fe(ye.contenidos.c))return!0;if(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes){if(fe(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.bienesContenidos))return!0;if(fe(ye.contenidos.ci.hidroContenidos.coberturasIntegrantes.limContenidos))return!0}return!!fe(ye.rcFamiliar.c)||(!!fe(ye.cristales.c)||(!!fe(ye.roboMenaje.c)||(!!fe(ye.roboMenaje.ci.joyas)||(!!fe(ye.dinero.c)||(!!fe(ye.dinero.ci.usoTarjetasDinero)||(!(!ye.objetosPersonales.ci.objetosObjetos||!fe(ye.objetosPersonales.ci.objetosObjetos))||(!!fe(ye.objetosPersonales.ci.bicicletasObjetos)||(!!fe(ye.electrodomesticos.c)||!!fe(ye.electrodomesticos.ci.equipoMovil)))))))))}function fe(e){return!(!e.checked||!(e.monto<e.limiteMinimo||e.monto>e.limiteMaximo||""===e.monto||void 0===e.monto))}function ge(e){var t=2;if(e+="",e=parseFloat(e.replace(/[^0-9\.]/g,"")),t=t||0,isNaN(e)||0===e)return parseFloat(0).toFixed(t);e=""+e.toFixed(t);for(var n=e.split("."),o=/(\d+)(\d{3})/;o.test(n[0]);)n[0]=n[0].replace(o,"$1,$2");return n.join(".")}function he(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t}function ve(e){for(var t="",n=0,o=0,a=0;n<e.length;)if((o=e.charCodeAt(n))<128)t+=String.fromCharCode(o),n++;else if(o>191&&o<224)a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2;else{a=e.charCodeAt(n+1);var r=e.charCodeAt(n+2);t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&r),n+=3}return t}var ye=this,be=o.matchMedia("(max-width: 767px)");be.onchange=function(e){ye.txtClass=e.target.matches?"text-left":"text-right"},ye.pagina1=A,ye.pagina2=P,ye.pagina3=E,ye.cleanForm=C,ye.regresarMain=S,ye.regresarPaginaCotizacion=D,ye.cotizarContratar=M,ye.validateBirthdateRFC=x,ye.justAlphabet=N,ye.justAlphanumeric=q,ye.justNumeric=G,ye.soloNumero=J,ye.charrepeat=W,ye.charrepeatText=X,ye.charrepeatTextTres=Z,ye.soloTextAndNum=ee,ye.numberSecuential=ne,ye.forceKeyPressUppercase=oe,ye.calculaRFC=Q,ye.validarDatosACotizar=w,ye.cotizarSeguroPyme=O,ye.setValueGastosExtrasCasaHabitacion=ae,ye.setRemocionEscombros=re,ye.emisionSeguroHogar=_,ye.changeSameAddress=d,ye.imprimirCondiciones=Y,ye.printPolicy=$,ye.endEmission=H,ye.isClienteObt=!1,ye.getListaCotizaciones=T,ye.getRolUsuario=R,ye.backToEmission=U,ye.yearExpirationList=[],ye.monthExpirationList=[],ye.cvvLen=3,ye.accLen=16,ye.txtClass=be.matches?"text-left":"text-right",ye.selectBankId=v,ye.selectTypeCard=y,ye.emissionFunction=j,ye.numPoliza="",ye.jsonCotizacion={},ye.primatotalImpresion="",ye.emission={},ye.cmd={kindPaid:{type:null}},ye.cmd.emission={contract:null},ye.stepForm={step:0,stepA:!1,stepB:!1,stepC:!1,stepD:!1},ye.insurancePolicyDate=moment(new Date).format("YYYY-MM-DD"),ye.policyMaturityDate=moment(new Date,"YYYY-MM-DD").add(1,"years").format("YYYY-MM-DD");var Ce=t.model;ye.numeroCliente=Ce?Ce.numeroCliente:"",ye.contract=Ce?Ce.contract:"",ye.client=Ce?Ce.client:"",ye.person=Ce?Ce.person:{},ye.datosCliente=Ce?Ce.datosCliente:[],ye.nombres=Ce?Ce.nombres:"",ye.apePaterno=Ce?Ce.apePaterno:"",ye.apeMaterno=Ce?Ce.apeMaterno:"",ye.nombreCliente=Ce?Ce.nombreCliente:"",ye.birthDay=Ce?Ce.birthDay:"",ye.fiscalIDNumber=Ce?Ce.fiscalIDNumber:"",ye.emailUser=Ce?Ce.emailUser:"",ye.personType=Ce?Ce.personType:"1",ye.phoneUser=Ce?Ce.phoneUser:"",ye.importeEdificio="",ye.limiteMaximoEquipoMovil=0,ye.limiteMaximoCristales=0,ye.limiteMaximoRoboMenaje=0,ye.limiteMaximoRcFamiliar=0,ye.limiteMaximoUsoTarjetas=0,ye.dineroMontoInicial=0,ye.bicicletasMontoInicial=0,ye.objetosMontoInicial=0,ye.equipoMovilMontoInicial=0,ye.botonContratar="Cotizar",ye.cotizacionSeleccionada=void 0,ye.soloText=te,ye.pageSize=3,ye.currentPage=1,ye.disabledRFC=!!Ce&&Ce.disabledRFC,ye.mostrarDatos=!!Ce&&Ce.mostrarDatos,ye.validatePopup=!!Ce&&Ce.validatePopup,ye.validatePerson=!!Ce&&Ce.validatePerson,ye.roles=Ce?Ce.roles:[],ye.rol=R(),ye.revisaCotizaciones=I,ye.tieneCotizaciones=!1,ye.cargandoCotizacion=!1,ye.datosCotizacion={},ye.datosCotizados={},ye.fechaNacimiento="",ye.email="",ye.rfc="",ye.sexo="masculino",ye.telefono="",ye.fechaConstitutiva="",ye.ContInsuredSum="",ye.ExtExpHomeInsuredSum="",ye.DebRemInsuredSum="",ye.FamCivLiaInsuredSum="",ye.ListCotizaciones=[],ye.ListEntityFederativeHouse=function(){var e=[];return r.getCatalogEntityFederativePyme().then(function(t){t.success&&angular.forEach(t.info,function(t){e.push({id:t.federalEntityID,text:t.federalEntityDescription})})}),e}(),ye.ListMunicipalityHouse=[],ye.ListBanksHouse=[],ye.ListPostalCodeHouse=[],ye.ListTypeCLABE=[{id:"1",text:"CLABE"},{id:"2",text:"DEBITO"}],ye.optionsdpx={minDate:moment((new Date).setYear((new Date).getFullYear()-150)).format("DD/MM/YYYY"),maxDate:moment((new Date).setYear((new Date).getFullYear()-18)).format("DD/MM/YYYY")},ye.optionsdpxPM={maxDate:moment((new Date).setYear((new Date).getFullYear())).format("DD/MM/YYYY")},ye.ListCurrency=function(){return[{id:1,text:"PESOS"},{id:2,text:"DOLARES"}]}(),ye.ListSecurityMeasurements=function(){return[{id:1,text:"VIGILANCIA"},{id:2,text:"ALARMA LOCAL/CENTRAL"},{id:3,text:"VIGILANCIA Y ALARMA LOCAL/CENTRAL"},{id:99999,text:"SIN MEDIDAS DE SEGURIDAD"}]}(),ye.ListPaymentMethods=function(){return[{id:1,text:"CONTADO"},{id:2,text:"SEMESTRAL"},{id:3,text:"TRIMESTRAL"},{id:4,text:"MENSUAL"}]}(),ye.ListBorderWall=function(){
return[{id:"true",text:"SI"},{id:"false",text:"NO"}]}(),ye.ListBanks=function(){var e=[];return console.log(),r.getCatalogBanksPyme().then(function(t){t.success&&(angular.forEach(t.info,function(t){e.push({id:t.bankID,text:t.bankName})}),e.sort(function(e,t){return e.text.toLowerCase()<t.text.toLowerCase()?-1:e.text.toLowerCase()>t.text.toLowerCase()?1:0}))}),e}(),ye.jsonCoberturas="{}",ye.tipoRiesgo="",ye.getCatalogRoof=u,ye.getCatalogEntity=l,ye.getCatalogCodes=m,ye.getJsonCoberturas=ue,ye.getJsonCoberturasService=ce,ye.onChangeTipoDeRiesgo=ie,ye.cambiaJoyasTipoDeRiesgo=se,ye.getCantidadLimite=le,ye.realizaOperaciones=me,ye.validarTabla=pe,ye.validarSiCumple=fe,ye.formatCurrency=ge,ye.validaRFCFecha=z,ye.validaFechaConRFC=V,ye.onChangeListMunicipality=f,ye.onChangeListEntity=p,ye.encode=he,ye.decode=ve,ye.eventClickCheckbox=de,ye.event="",ye.edificio={},ye.contenidos={},ye.rcFamiliar={},ye.roboMenaje={},ye.dinero={},ye.objetosPersonales={},ye.electrodomesticos={},ye.gastosAsalto={},ye.gastosFinales={},ye.gastosExtras={},ye.remocionEscombros={},ye.cristales={},ye.asistenciaInformatica={},ye.asistenciaLegal={},ye.asistenciaViajes={},ye.extensionViajes={},I(),function(){r.getCatalogInsuranceRiskType(1,1).then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.areaCode,text:e.description})}),ye.listRiskType=t)}).catch(function(e){})}(),function(){r.getCatalogWallType().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.wallTypeID,text:e.wallType})}),ye.listStructure=t)}).catch(function(e){})}(),function(){r.getCatalogClasificationQuery().then(function(e){var t=[];e.success&&(angular.forEach(e.info,function(e){t.push({id:e.typeID,text:e.street})}),ye.listClasification=t)}).catch(function(e){})}(),ye.datepicker_opts={minDate:new Date,isInvalidDate:function(e){return 0===e.day()||6===e.day()}};var Se,De,Me;n.onClicSendEmailNotificationCotizationHogar=function(){var e="";try{"1"===ye.personType.toString()&&(e=ye.apePaterno+"  "+ye.apeMaterno+" "+ye.nombres),"2"===ye.personType.toString()&&(e=ye.nombreCliente),n.obJsonMail={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|17",emailSubject:"Envío de cotización seguro de hogar Actinver "+e.toUpperCase()+"("+ye.datosCotizacion.numeroCotizacion+")",mailTo:[ye.emailUser],mailCC:[""],ldrEdificio:"",ldrIncendioAdicionalesEdificio:"",ldrExplosionEdificio:"",ldrHuelAlbPopEdificio:"",ldrNavAreaVehiHumoEdificio:"",ldrFenHidroEdificio:"",ldrTerrErupVolcEdificio:"",ldrTodoRiesIncAdicEdificio:"",ldrContenido:"",ldrIncendioAdicionalesCont:"",ldrExplosionCont:"",ldrHuelAlbPopCont:"",ldrNavAereaVehiHumoCont:"",ldrFenHidroCont:"",ldrTerrErupVolcCont:"",ldrTodoRiesIncAdicCont:"",ldrRemocionEscombros:"",ldrIncendioRemocion:"",ldrFenHidroRemocion:"",ldrTerrErupVolcRemocion:"",ldrGasExtraCasaHabitacion:"",ldrIncendioGastExtras:"",ldrFenHidroGatExtras:"",ldrTerrErupVolcGastExtras:"",ldrRCFamiliar:"",ldrRCArrendatario:"",ldrRCTrabDomestico:"",ldrRoboDeMenaje:"",ldrRoboConViolencia:"",ldrRoboPorAsalto:"",ldrJoyasArtValor:"",ldrGtosMedAsaltDomicilio:"",ldrDineroValores:"",ldrCristales:"",ldrObjPersonales:"",lbrEqElectro:"",ldrAsistHogarViajes:"",ldrExtGarEnViajesNalEInt:"",ldrAsistLegal:"",ldrServDeAsistInformatica:"",dataHouseEntityRisk:ye.cmd.dataHouseEntityRisk.type.text,dataHouseMunicipalityRisk:ye.cmd.dataHouseMunicipalityRisk.type.text,dataHousePostalCodeRisk:ye.cmd.dataHousePostalCodeRisk.type.text,kindPaid:ye.cmd.kindPaid.type.text,currency:ye.cmd.currency.type.text,calle:ye.calle,kindRisk:ye.cmd.kindRisk.type.text,kindClasification:ye.cmd.kindClasification.type.text,kindStructure:ye.cmd.kindStructure.type.text,kindRoof:ye.cmd.kindRoof.type.text,securityActions:ye.cmd.securityActions.type.text,primaTotalAnual:ye.datosCotizacion.primaTotal,insurancePolicyDate:ye.insurancePolicyDate,netPremium:ye.datosCotizados.primaNeta,surcharge:ye.datosCotizados.recargos,entitlement:ye.datosCotizados.derechosPoliza,vat:ye.datosCotizados.iva,adjoiningHomeFlag:ye.cmd.borderWall.type.id},angular.forEach(ye.datosCotizacion.coberturas.coverageInformation,function(e){"3000"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrEdificio="":n.obJsonMail.ldrEdificio=e.insuredSum),"3001"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioAdicionalesEdificio="AMPARADA":n.obJsonMail.ldrIncendioAdicionalesEdificio=e.insuredSum),"3002"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrExplosionEdificio="AMPARADA":n.obJsonMail.ldrExplosionEdificio=e.insuredSum),"3003"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrHuelAlbPopEdificio="AMPARADA":n.obJsonMail.ldrHuelAlbPopEdificio=e.insuredSum),"3004"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrNavAereaVehiHumoEdificio="AMPARADA":n.obJsonMail.ldrNavAereaVehiHumoEdificio=e.insuredSum),"3020"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroEdificio="AMPARADA":n.obJsonMail.ldrFenHidroEdificio=e.insuredSum),"3021"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcEdificio="AMPARADA":n.obJsonMail.ldrTerrErupVolcEdificio=e.insuredSum),"3030"===e.code.toString()&&""!==n.obJsonMail.ldrEdificio.toString()&&(n.obJsonMail.ldrEdificio.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTodoRiesIncAdicEdificio="AMPARADA":n.obJsonMail.ldrTodoRiesIncAdicEdificio=e.insuredSum),"3050"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrContenido="":n.obJsonMail.ldrContenido=e.insuredSum),"3051"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioAdicionalesCont="AMPARADA":n.obJsonMail.ldrIncendioAdicionalesCont=e.insuredSum),"3052"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrExplosionCont="AMPARADA":n.obJsonMail.ldrExplosionCont=e.insuredSum),"3053"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrHuelAlbPopCont="AMPARADA":n.obJsonMail.ldrHuelAlbPopCont=e.insuredSum),"3054"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrNavAereaVehiHumoCont="AMPARADA":n.obJsonMail.ldrNavAereaVehiHumoCont=e.insuredSum),"3070"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroCont="AMPARADA":n.obJsonMail.ldrFenHidroCont=e.insuredSum),"3071"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcCont="AMPARADA":n.obJsonMail.ldrTerrErupVolcCont=e.insuredSum),"3080"===e.code.toString()&&""!==n.obJsonMail.ldrContenido.toString()&&(n.obJsonMail.ldrContenido.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTodoRiesIncAdicCont="AMPARADA":n.obJsonMail.ldrTodoRiesIncAdicCont=e.insuredSum),"3210"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrRemocionEscombros="":n.obJsonMail.ldrRemocionEscombros=e.insuredSum),"3211"===e.code.toString()&&""!==n.obJsonMail.ldrRemocionEscombros.toString()&&(n.obJsonMail.ldrRemocionEscombros.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioRemocion="AMPARADA":n.obJsonMail.ldrIncendioRemocion=e.insuredSum),"3212"===e.code.toString()&&""!==n.obJsonMail.ldrRemocionEscombros.toString()&&(n.obJsonMail.ldrRemocionEscombros.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroRemocion="AMPARADA":n.obJsonMail.ldrFenHidroRemocion=e.insuredSum),"3213"===e.code.toString()&&""!==n.obJsonMail.ldrRemocionEscombros.toString()&&(n.obJsonMail.ldrRemocionEscombros.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcRemocion="AMPARADA":n.obJsonMail.ldrTerrErupVolcRemocion=e.insuredSum),"3220"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrGasExtraCasaHabitacion="":n.obJsonMail.ldrGasExtraCasaHabitacion=e.insuredSum),"3221"===e.code.toString()&&""!==n.obJsonMail.ldrGasExtraCasaHabitacion.toString()&&(n.obJsonMail.ldrGasExtraCasaHabitacion.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrIncendioGastExtras="AMPARADA":n.obJsonMail.ldrIncendioGastExtras=e.insuredSum),"3222"===e.code.toString()&&""!==n.obJsonMail.ldrGasExtraCasaHabitacion.toString()&&(n.obJsonMail.ldrGasExtraCasaHabitacion.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrFenHidroGatExtras="AMPARADA":n.obJsonMail.ldrFenHidroGatExtras=e.insuredSum),"3223"===e.code.toString()&&""!==n.obJsonMail.ldrGasExtraCasaHabitacion.toString()&&(n.obJsonMail.ldrGasExtraCasaHabitacion.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrTerrErupVolcGastExtras="AMPARADA":n.obJsonMail.ldrTerrErupVolcGastExtras=e.insuredSum),"3401"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrRCFamiliar="":n.obJsonMail.ldrRCFamiliar=e.insuredSum),"3442"===e.code.toString()&&""!==n.obJsonMail.ldrRCFamiliar.toString()&&(n.obJsonMail.ldrRCFamiliar.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRCArrendamiento="AMPARADA":n.obJsonMail.ldrRCArrendamiento=e.insuredSum),"3441"===e.code.toString()&&""!==n.obJsonMail.ldrRCFamiliar.toString()&&(n.obJsonMail.ldrRCFamiliar.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRCTrabDomestico="AMPARADA":n.obJsonMail.ldrRCTrabDomestico=e.insuredSum),"3500"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrRoboDeMenaje="":n.obJsonMail.ldrRoboDeMenaje=e.insuredSum),"3501"===e.code.toString()&&""!==n.obJsonMail.ldrRoboDeMenaje.toString()&&(n.obJsonMail.ldrRoboDeMenaje.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRoboConViolencia="AMPARADA":n.obJsonMail.ldrRoboConViolencia=e.insuredSum),"3502"===e.code.toString()&&""!==n.obJsonMail.ldrRoboDeMenaje.toString()&&(n.obJsonMail.ldrRoboDeMenaje.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrRoboPorAsalto="AMPARADA":n.obJsonMail.ldrRoboPorAsalto=e.insuredSum),"3503"===e.code.toString()&&""!==n.obJsonMail.ldrRoboDeMenaje.toString()&&(n.obJsonMail.ldrRoboDeMenaje.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.ldrJoyasArtValor="AMPARADA":n.obJsonMail.ldrJoyasArtValor=e.insuredSum),"3504"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrGtosMedAsaltDomicilio="":n.obJsonMail.ldrGtosMedAsaltDomicilio=e.insuredSum),"3520"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrDineroValores="":n.obJsonMail.ldrDineroValores=e.insuredSum),"3530"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrCristales="":n.obJsonMail.ldrCristales=e.insuredSum),"3550"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum?n.obJsonMail.ldrObjPersonales="":n.obJsonMail.ldrObjPersonales=e.insuredSum),"3660"===e.code.toString()&&""!==n.obJsonMail.ldrObjPersonales.toString()&&(n.obJsonMail.ldrObjPersonales.toString()===e.insuredSum.toString()||"1"===e.insuredSum.toString()?n.obJsonMail.lbrEqElectro="AMPARADA":n.obJsonMail.lbrEqElectro=e.insuredSum),"3910"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrAsistHogarViajes="AMPARADA":n.obJsonMail.ldrAsistHogarViajes=e.insuredSum)),"3911"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrExtGarEnViajesNalEInt="AMPARADA":n.obJsonMail.ldrExtGarEnViajesNalEInt=e.insuredSum)),"3920"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrAsistLegal="AMPARADA":n.obJsonMail.ldrAsistLegal=e.insuredSum)),"3921"===e.code.toString()&&(void 0===e.insuredSum||null===e.insuredSum||0===e.insuredSum||("1"===e.insuredSum.toString()?n.obJsonMail.ldrServDeAsistInformatica="AMPARADA":n.obJsonMail.ldrServDeAsistInformatica=e.insuredSum))});var t=n.obJsonMail;r.sendEmailNotificationCotizationPyme(t).then(function(e){e.success&&a.done("Correo Enviado")})}catch(e){}},n.onClicSendEmailNotificationCompraSeguro=function(){var e=-1!==window.location.href.indexOf("asesoria.actinver.com/asesoria")?"https://negocios.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+ye.numPoliza+"&Endoso=0":"https://negociosuat.mapfre.com.mx/VIPII/wImpresion/MarcoImpresion.aspx?Poliza="+ye.numPoliza+"&Endoso=0",t="1"===ye.personType.toString()?ye.apePaterno+"  "+ye.apeMaterno+" "+ye.nombres:ye.nombreCliente,o=void 0===ye.emailUser?"":ye.emailUser,i=void 0===ye.calle?"":ye.calle,s=void 0===ye.cmd.dataHouseEntityRisk?"":ye.cmd.dataHouseEntityRisk.type.text,c=void 0===ye.cmd.dataHouseMunicipalityRisk?"":ye.cmd.dataHouseMunicipalityRisk.type.text,u=void 0===ye.cmd.dataHousePostalCodeRisk?"":ye.cmd.dataHousePostalCodeRisk.type.text,l=void 0===ye.cmd.kindPaid?"":ye.cmd.kindPaid.type.text,d=void 0===ye.cmd.currency?"":ye.cmd.currency.type.text,m=void 0===ye.cmd.kindRisk?"":ye.cmd.kindRisk.type.text,p=void 0===ye.cmd.kindStructure?"":ye.cmd.kindStructure.type.text,f=void 0===ye.cmd.kindRoof?"":ye.cmd.kindRoof.type.text,g=void 0===ye.cmd.securityActions?"":ye.cmd.securityActions.type.text,h=!!ye.cotizacionSeleccionada,v=h?JSON.parse(ye.cotizacionSeleccionada.quotationJsonIni):null;if(v&&v.catalogosCotizacion){var y=v.catalogosCotizacion;o=ye.cotizacionSeleccionada.emailCliente,i=v.Street,s=y.dataHouseEntityRisk.type.text,c=y.dataHouseMunicipalityRisk.type.text,u=y.dataHousePostalCodeRisk.type.text,l=y.kindPaid.type.text,d=y.currency.type.text,m=y.kindRisk.type.text,p=y.kindStructure.type.text,f=y.kindRoof.type.text,g=y.securityActions.type.text}n.obJsonMail={language:"SPA",emailFrom:"seguros@actinver.com.mx",idTemplate:"buildDBTemplate|18",emailSubject:"Póliza emitida seguro de hogar  "+t+" "+ye.numPoliza,mailTo:o,mailCC:"",polizaSeguro:void 0===ye.numPoliza?"":ye.numPoliza,fechaInicioVigencia:void 0===ye.insurancePolicyDate?"":moment(ye.insurancePolicyDate).format("DD/MM/YYYY"),fechaFinVigencia:void 0===ye.policyMaturityDate?"":moment(ye.policyMaturityDate).format("DD/MM/YYYY"),fechaLimitePago:void 0===ye.emission.payment.dateAprox?moment(new Date).format("DD/MM/YYYY"):moment(ye.emission.payment.dateAprox).format("DD/MM/YYYY"),dataHouseEntityRisk:s,dataHouseMunicipalityRisk:c,dataHousePostalCodeRisk:u,kindPaid:l,currency:d,calle:i,kindRisk:m,kindStructure:p,kindRoof:f,securityActions:g,urlPolizaImpresion:e},""!==s?r.sendEmailNotificationEmisionPyme(n.obJsonMail).then(function(e){e.success?a.done("Correo Enviado."):a.error("El correo no fue enviado.")}):a.error("El correo no fue enviado.")},n.updateSelection=function(e,t,n,o){var a=t.cotizacion;o.currentTarget.checked?(ye.cotizacionSeleccionada=t,ye.botonContratar="Contratar"):(ye.cotizacionSeleccionada=void 0,ye.botonContratar="Cotizar"),angular.forEach(n,function(e,t){a!==n[t].cotizacion&&(e.checked=!1)})}}e.$inject=["$state","$stateParams","$scope","$window","CommonModalsSrv","insurancePymeSrv"],angular.module("actinver.controllers").controller("insurancePymeCtrl",e)}(),function(){function e(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/[^0-9]/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t})}}}function t(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/[^a-zA-Z0-9 ]/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t})}}}function n(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){if(void 0===e)return"";var t=e.replace(/([a-zA-Z])\1{2,}/g,"");return t!==e&&(o.$setViewValue(t),o.$render()),t})}}}angular.module("actinver.controllers").directive("numbersOnly",e).directive("alphaNumeric",t).directive("repeatedLetter",n)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getCatalogPostalCode=function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogPostalCodeQuery+o,params:{language:"SPA",MunicipalityID:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outPostalCodeQuery.postalCodeList,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogInsuranceRiskType=function(o,a){return t(function(t,r){n({method:"GET",url:e.getCatalogInsuranceRiskTypeQuery+o+"/"+a,params:{language:"SPA",BusinessActivity:o,BusinessActivitySubtype:a}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceRiskTypeQuery.riskTypeList.riskTypeDetail,t({success:!0,info:n})):r({success:!1,info:e.data.outCommonHeader.result})},function(){r({success:!1,type:"not-found"})})})},o.prototype.getCatalogWallType=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogWallTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outWallTypeQuery.wallTypeList.wallTypeDetail,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogRoofType=function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogRoofTypeQuery+o,params:{language:"SPA",WallTypeID:o}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outRoofTypeQuery.roofTypeList.roofTypeDetail,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogStreetTypeQuery=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogStreetTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outStreetTypeQuery.streetTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogCardTypeQuery=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogCardTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceCardTypeQuery.cardTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogPaymentTypeQuery=function(){return console.log("hiola desde houses svr "),t(function(t,o){n({method:"GET",url:e.getCatalogPaymentTypeQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outPaymentTypeQuery.paymentTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getListQuotations=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationSearch,params:o}).then(function(e){if(1===e.data.return.status){var n=e.data.return.data.listInsuranceQuotationRs;t({success:!0,info:n})}else t({success:!1,info:"not-found"})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getServiceCotizacionPyme=function(o){return t(function(t,a){n({method:"POST",url:e.getServiceCotizacionPyme,params:o}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outHomeInsuranceQuotation,t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getServiceEmisionPyme=function(o){return t(function(t,a){n({method:"POST",url:e.getServiceEmisionPyme,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outHomeInsurancePolicyRegistration,t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.updateQuotation=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationUpdate,params:o}).then(function(e){console.log("response update",e);var n;1===e.data.return.status?(n=e.data.return.data.listInsuranceQuotationRs[0],t({success:!0,info:n,response:e.data})):t({success:!1,info:e.data.outCommonHeader.result})},function e(){console.log("response update",e),a({success:!1,type:"not-found"})})})},o.prototype.getCoverage=function(){return t(function(t,o){n({method:"POST",url:e.getCoverage+"?language=SPA"}).then(function(e){if(console.log("Original:"),console.log(e),1===e.data.return.status){var n=e.data.return.data.listInsuranceCoverageRs;console.log("Lista de Coberturas: "+n),t({success:!0,info:n})}else t({success:!1,info:"not-found"})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCotizationAdd=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationAdd,params:o}).then(function(e){if(console.log("respuesta"),console.log(e),1===e.data.return.status){var n=e.data.return.data.listInsuranceQuotationRs;t({success:!0,info:n})}else t({success:!1,info:"not-found"})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCotizationUpdate=function(o){return t(function(t,a){n({method:"POST",url:e.getCotizationUpdate,params:o}).then(function(e){var n;"1"===e.data.outCommonHeader.result.result.toString()?(n=e.data.outHomeInsurancePolicyRegistration,t({success:!0,info:n})):t({success:!1,info:e.messages})},function(){a({success:!1,type:"not-found"})})})},o.prototype.sendEmailNotificationCotizationPyme=function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationCotizationPyme,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.sendEmailNotificationEmisionPyme=function(o){return t(function(t,a){n({method:"POST",url:e.sendEmailNotificationEmisionPyme,params:o}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outCommonHeader.result,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogEntityFederativePyme=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogEntityFederalPyme,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outFederalEntityQuery.federalEntityCatalogData.federalEntity,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogMunicipalityPyme=function(o){return t(function(t,a){n({method:"GET",url:e.getCatalogMunicipalityPyme+o,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outMunicipalityQuery.municipalityCatalogData.municipality,t({success:!0,info:n})):a({success:!1,info:e.data.outCommonHeader.result})},function(){a({success:!1,type:"not-found"})})})},o.prototype.getCatalogBanksPyme=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogBanksPyme,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outInsuranceBanksQuery.insuranceBanksCatalogData.bank,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},o.prototype.getCatalogClasificationQuery=function(){return t(function(t,o){n({method:"GET",url:e.getCatalogClasificationQuery,params:{language:"SPA"}}).then(function(e){var n;1===e.data.outCommonHeader.result.result?(n=e.data.outStreetTypeQuery.streetTypeList,t({success:!0,info:n})):o({success:!1,info:e.data.outCommonHeader.result})},function(){o({success:!1,type:"not-found"})})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.controllers").service("insurancePymeSrv",e)}(),function(){"use strict";function e(e,t,n){function o(e){return r.listNotification.findIndex(function(t){return t.adviserNotificationID===e})}function a(e){r.modal=e}var r=this;r.modal=!1,r.listNotification=[],r.getNotificacion=function(){t.getNotifications(sessionStorage.__username).then(function(t){r.listNotification=t.notificaciones,e.$emit("mensajesLuminaNoLeidos",t.totalNoLeido)}).catch(function(e){n(e.message),r.listNotification=[]})},r.showMessage=function(e){var t=o(e);t>-1&&(r.listNotification[t].readNotificationFlag?r.listNotification[t].accion=1:r.saveStateNotificaction(e))},r.hideMessage=function(e){var t=o(e);t>-1&&(r.listNotification[t].accion=0)},r.saveStateNotificaction=function(n){var i=-1;i=o(n),t.saveStateNotification({adviserNotificationID:n}).then(function(){i>-1&&(r.listNotification[i].readNotificationFlag=!0,e.$emit("mensajesLuminaNoLeidos",r.listNotification.filter(function(e){return!e.readNotificationFlag}).length),a(!1)),r.listNotification[i].accion=1}).catch(function(){a(!1),r.listNotification[i].accion=0})},function(){r.getNotificacion()}()}e.$inject=["$scope","notificationLuminaSrv","ErrorMessagesSrv"],angular.module("actinver.controllers").controller("luminaNotificationCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.saveStateNotification=function(a){return t(function(t,r){a.language="SPA",n({method:"POST",url:e.updateStatusLumina,data:$.param(a)}).then(function(e){t(e.data)}).catch(function(e){o("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),r({status:"failed",error:e})})})},a.prototype.getNotifications=function(){return t(function(t,o){n({method:"GET",url:e.getNotificationLumina,params:{language:"SPA"}}).then(function(e){if(void 0!==e&&1===e.data.outCommonHeader.result.result){var n=e.data.result,a=n.filter(function(e){return!e.readNotificationFlag}).length;t({success:!0,totalNoLeido:a,totalRegistro:n.length,notificaciones:n})}else o(void 0!==e&&2===e.outCommonHeader.result.result?{success:!1,totalNoLeido:0,totalRegistro:0,notificaciones:[],message:e.data.outCommonHeader.result.messages[0].responseMessage}:{success:!1,totalNoLeido:0,totalRegistro:0,notificaciones:[],message:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})}).catch(function(){o({success:!1,totalNoLeido:0,totalRegistro:0,notificaciones:[],message:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})})})},new a}e.$inject=["URLS","$q","$http","ErrorMessagesSrv"],angular.module("actinver.services").service("notificationLuminaSrv",e)}(),function(){"use strict";function e(e,t,n){function o(){i.date=new Date,i.openedCalendar=!1,i.dateOptions={minMode:"month"},i.showTable=!1,i.dropdownOptions=[],i.dropdownSelected={text:"Todos",id:0},i.showSpinner=!1}function a(e){i.showSpinner=!0,i.showTable=!1,t.getActivityOffice(i.date).then(function(t){i.showSpinner=!1,i.dropdownOptions=[];var n,o=t.financialCentersList;if(n=e?"Todos"===e?{text:e}:e:{text:"Todos"},"Todos"===n.text)i.dataInfoTabs=t;else{var a=i.dataInfoTabs.records&&i.dataInfoTabs.records.length<=t.records.length?t.records:i.dataInfoTabs.records,r=[];i.dataInfoTabs.totalLogins=0,i.dataInfoTabs.totalProposalReports=0,i.dataInfoTabs.totalTrackingAndProposalReports=0,i.dataInfoTabs.totalClientQueries=0,i.dataInfoTabs.totalTrackingReports=0,i.dataInfoTabs.totalFundSell=0,i.dataInfoTabs.totalTransferCash=0,i.tableParams=[],i.dataRowTableActivity=[];for(var s in a)a[s].financialCenter===n.text&&("Login"===a[s].component&&(i.dataInfoTabs.totalLogins+=1),"Reporte de Propuesta"===a[s].component&&(i.dataInfoTabs.totalProposalReports+=1),"Reporte de Propuesta con seguimiento"===a[s].component&&(i.dataInfoTabs.totalTrackingAndProposalReports+=1),"Consulta de cliente"===a[s].component&&(i.dataInfoTabs.totalClientQueries+=1),"Reporte de Seguimiento"===a[s].component&&(i.dataInfoTabs.totalTrackingReports+=1),"Venta de Fondos de Inversion"===a[s].component&&(i.dataInfoTabs.totalFundSell+=1),"Transferencia de Efectivo"===a[s].component&&(i.dataInfoTabs.totalTransferCash+=1),r.push(a[s]));i.dataInfoTabs.totalRecords=i.dataInfoTabs.totalLogins+i.dataInfoTabs.totalProposalReports+i.dataInfoTabs.totalClientQueries+i.dataInfoTabs.totalTrackingReports+i.dataInfoTabs.totalFundSell+i.dataInfoTabs.totalTransferCash,i.dataInfoTabs.records=r}for(var c in o)i.dropdownOptions.push({text:o[c].financialCenter,id:o[c].keyCenter});i.dropdownOptions.push({text:"Todos",id:0})},function(){n.error("Lo sentimos ocurrio un error."),i.showSpinner=!1})}function r(e,t){if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(e,t);else{var n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.click(),window.URL.revokeObjectURL(n.href)}}var i=this;i.getInfoTabs=function(e){a(e)},i.getMoreInfoTab=function(t){i.tabActive=t,i.dataRowTableActivity=[];var n=i.dataInfoTabs.records,o=null;if("tab1"===t)for(o in n)"Login"===n[o].component&&i.dataRowTableActivity.push(n[o]);else if("tab2"===t)for(o in n)"Reporte de Propuesta"===n[o].component&&i.dataRowTableActivity.push(n[o]);else if("tab3"===t)for(o in n)"Reporte de Propuesta con seguimiento"===n[o].component&&i.dataRowTableActivity.push(n[o]);else if("tab4"===t)for(o in n)"Consulta de cliente"===n[o].component&&i.dataRowTableActivity.push(n[o]);else if("tab5"===t)for(o in n)"Reporte de Seguimiento"===n[o].component&&i.dataRowTableActivity.push(n[o]);else if("tab6"===t)for(o in n)"Venta de Fondos de Inversion"===n[o].component&&i.dataRowTableActivity.push(n[o]);else if("tab7"===t)for(o in n)"Transferencia de Efectivo"===n[o].component&&i.dataRowTableActivity.push(n[o]);i.dataRowTableActivity&&(i.tableParams=new e({count:10},{dataset:i.dataRowTableActivity})),i.showTable=!0},i.generaExcel=function(){r(new Blob([document.getElementById("table-result").outerHTML],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),"Report.xls")},function(){o(),a("Todos")}()}e.$inject=["NgTableParams","proposalSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("activityCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){u.form={portfolio:[]},t.getIssuersInfo().then(function(e){u.issuers=e.data})}function r(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}function i(e){var t=[];return angular.forEach(e,function(e,n){angular.forEach(e,function(e){"invest"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,
descripcion:e.description?e.description:"",instrumento:"SOCIEDADES DE INVERSION"}):"actions"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,instrumento:"ACCIONES"}):"money"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,instrumento:"MERCADO DE DINERO"}):"reportos"===n?t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,instrumento:"REPORTOS"}):"derivatives"===n&&t.push({producto:e.issuer,monto:e.amount,porcentajeInversion:100*e.percentage,descripcion:e.description?e.description:"",instrumento:"DERIVADOS"})})}),t}function s(e){for(var t=0;t<u.issuers.length;t++)if(u.issuers[t].name.trim()===e.trim())return u.issuers[t].description;return""}function c(e,t){var n=[],o={},a={};return angular.forEach(e,function(e,r){"Fondo de Fondos"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:s(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Renta Variable"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:s(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Fibras"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:s(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Riesgo Cambiario"===r?angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:s(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})}):"Deuda"===r&&angular.forEach(e,function(e){angular.forEach(e,function(e){a={name:r,subGroups:[]},o={name:e.subGroup.name,instruments:[]},angular.forEach(e.productLimits,function(e){var n={percentage:e.percentage,issuer:e.product.issuer.name,amount:t*e.percentage/100,description:s(e.product.issuer.name)};o.instruments.push(n)}),a.subGroups.push(o),n.push(a)})})}),n}var u=this;u.resetForm=function(){a(),u.client_name=null,u.adviser_ext=null,u.adviser_mobile=null,u.adviser_phone=null,u.change_location=null},u.validateForm=function(t){var o=!1;t.name.$valid?t.ext.$valid?angular.forEach(u.form.portfolio,function(t){var n=0,a=t.value-t.totals;"manual"!==t.type||o||(Number(a.toFixed(2))<0?o="El valor del portafolio "+n+" es menor a la inversión.":0!==Number(a.toFixed(2))&&(o="Te falta invertir (<strong>"+e("currency")(Number(a.toFixed(2)))+"</strong>) para poder continuar.")),n++}):o="El número de extension es obligatorio, favor de revisarlo.":o="El nombre del cliente es obligatorio, favor de revisarlo.",o?n.error(o):u.submitForm()},u.submitForm=function(){var e=JSON.parse(o.user),a=0,s=0,l="",d="",m=0,p=0,f=0;a=u.form.portfolio[0].value,l=u.form.portfolio[0].comment,"model"===u.form.portfolio[0].type?(m=2,f=0):"manual"===u.form.portfolio[0].type&&(m=1,f=1,"Moral"===u.form.portfolio[0].client_type.description&&(f=2)),u.form.portfolio[1]&&(s=u.form.portfolio[1].value,d=u.form.portfolio[1].comment,"model"===u.form.portfolio[1].type?p=2:"manual"===u.form.portfolio[1].type&&(p=1));var g=[];u.form.products&&angular.forEach(u.form.products,function(e){e&&angular.forEach(e.subproducts,function(e,t){g.push({product:t,value:1})})});var h,v=[];"model"===u.form.portfolio[0].type?h=c(u.form.portfolio[0]?u.form.portfolio[0].strategyItems:[],u.form.portfolio[0].value):"manual"===u.form.portfolio[0].type&&(h=i(u.form.portfolio[0]?u.form.portfolio[0].invest:[])),u.form.portfolio[1]&&"model"===u.form.portfolio[1].type?v=c(u.form.portfolio[1]?u.form.portfolio[1].strategyItems:[],u.form.portfolio[1].value):u.form.portfolio[1]&&"manual"===u.form.portfolio[1].type&&(v=i(u.form.portfolio[1]?u.form.portfolio[1].invest:[]));var y={language:"SPA",data:0===h.length?0:window.btoa(unescape(encodeURIComponent(JSON.stringify(h)))),nameProposal:u.form.client_name,clientType:f,name:e.name,mail:e.mail,ext:u.form.adviser_ext,idEmployee:e.employeeID,portfolioType1:m,portfolioType2:p,mobile:u.form.adviser_mobile?u.form.adviser_mobile:0,phone:u.form.adviser_phone?u.form.adviser_phone:0,valorPortafolio:a,clientTypeFlag:0,comments:l,portfolio:v&&0===v.length?0:window.btoa(unescape(encodeURIComponent(JSON.stringify(v)))),valorPortafolio2:s,comments2:d,products:0===g.length?0:window.btoa(unescape(encodeURIComponent(JSON.stringify(g)))),createEnvironment:!0,createForecast:!0};t.generaReportePropuesta(y).then(function(e){try{if(/access/i.test(navigator.userAgent)){var t=btoa(r(new Uint8Array(e.data))),o=window.open("Propuesta","_blank","width=1000px,height=905px,resizable=0");o.document.open(),o.document.write('<html><head></head><body><iframe width="100%" height="100%" src="data:application/pdf;base64,'+t+'"></iframe></body></html>'),o.document.close()}else{var a=new Blob([e.data],{type:"application/pdf"}),i=URL.createObjectURL(a);window.open(i,"_blank","Reporte")}}catch(e){n.error(e)}}).catch(function(e){n.error("Estatus: "+e.status+" "+e.statusText)})},a()}e.$inject=["$filter","proposalsProposalSrv","CommonModalsSrv","$sessionStorage"],angular.module("actinver.controllers").controller("proposalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){s.tracing={form:{}},s.brief={form:{portfolio:[]}},s.products=[],s.adviser={},n.getIssuersInfo().then(function(e){s.issuers=e.data})}function i(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}var s=this;s.resetForm=function(){r()},s.validateForm=function(e){var n=!1;void 0===s.tracing.form.tir&&"CB"===s.tracing.form.scontract.origen?n="Los datos del periodo para calculo de TIR-1 son incorrectos o incompletos, favor de revisarlos":s.tracing.form.tir&&s.tracing.form.other_calculus&&void 0===s.tracing.form.tir2&&"CB"===s.tracing.form.scontract.origen?n="Los datos del periodo para calculo de TIR-2 son incorrectos o incompletos, favor de revisarlos":"CB"===s.tracing.form.scontract.origen&&s.tracing.form.tir&&s.tracing.form.tir.startDate._d.getDate()===s.tracing.form.tir.endDate._d.getDate()&&s.tracing.form.tir.startDate._d.getMonth()===s.tracing.form.tir.endDate._d.getMonth()&&s.tracing.form.tir.startDate._d.getFullYear()===s.tracing.form.tir.endDate._d.getFullYear()?n="Los datos del periodo para calculo de TIR-1 no pueden ser iguales, favor de revisarlos":e.ext.$valid?angular.forEach(s.brief.form.portfolio,function(e){var o=e.value-e.totals;"manual"!==e.type||n||(Number(o.toFixed(2))<0?n="El valor del portafolio es menor a la inversión.":0!==Number(o.toFixed(2))&&(n="Te falta invertir (<strong>"+t("currency")(Number(o.toFixed(2)))+"</strong>) para poder continuar."))}):n="El número de extension es obligatorio, favor de revisarlo.",n?a.error(n):s.submitForm()},s.submitForm=function(){var e={tracing:s.tracing,brief:s.brief,products:s.products,adviser:s.adviser,issuers:s.issuers};o.doProposalTracing(e).then(function(e){if(/access/i.test(navigator.userAgent)){var t=btoa(i(new Uint8Array(e.data))),n=window.open("Propuesta","_blank","width=1000px,height=905px,resizable=0");n.document.open(),n.document.write('<html><head></head><body><iframe width="100%" height="100%" src="data:application/pdf;base64,'+t+'"></iframe></body></html>'),n.document.close()}else{var o=new Blob([e.data],{type:"application/pdf"}),a=URL.createObjectURL(o);window.open(a,"_blank","Reporte")}}).catch(function(e){console.error("Error:",e)})},r()}e.$inject=["$scope","$filter","proposalsProposalSrv","proposalsPropTracingSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("propTracingCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){c.listContracts=[],c.input=""}function r(){c.type="contract",c.lengthInput=8,c.placeholderInput="Número de contrato",c.input="",c.listContracts=[],c.listSummaryContracts=[],c.showSpinner=!1,c.optionTypeContract.push({id:"1",text:"Casa"}),c.optionTypeContract.push({id:"2",text:"Banco"})}function i(e){var t={};return e.map(function(e){t[e.issuer]?(t[e.issuer].rows.push(e),t[e.issuer].total.position+=e.position,t[e.issuer].total.valuation+=e.valuation):t[e.issuer]={rows:[e],total:{position:e.position,valuation:e.valuation}}}),t}function s(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}var c=this;c.selectedInfo={},c.optionTypeContract=[],c.optionSelected={id:"1",text:"Casa"},c.sadviser=t.user,c.setType=function(e){c.type=e,c.placeholderInput="contract"===e?"Número de contrato":"Cliente único",c.input="",c.lengthInput=8,a()},c.getContract=function(){c.listContracts=[],c.listSummaryContracts=[],c.positionContract=!1,c.showSpinner=!0;var e={};e.type=c.type,e.optionTypeContract=c.optionSelected,e.employeeID=c.sadviser.employeeID,e.field=c.input,n.getContractIdClient(e).then(function(e){var t=null,a="",r=e,i="";if(2===r.outCommonHeader.result.result)return i=r.outCommonHeader.result.messages,angular.forEach(i,function(e){e.responseMessage&&(a+=e.responseMessage+"<br>")}),void o.error(a);if(t=r.outClientOrContractClientInfoQuery.client,0===t.length)return i=r.outCommonHeader.result.messages,angular.forEach(i,function(e){e.responseMessage&&(a+=e.responseMessage+"<br>")}),void o.error(a);var s=Number(t[0].clientNumber);c.cliente=t[0],c.clientName=t[0].name+" "+t[0].lastName+" "+t[0].secondLastName,c.clientId=t[0].clientNumber,n.getContractSummary(c.sadviser.employeeID,s).then(function(e){c.detailClient={brokerHouseValue:e.brokerHouseValue,bankValue:e.bankValue,totalValue:e.totalValue},c.listContracts=e.contractsList.outContractsBalancesByPortfolioQuery.contractInformation,0===e.contractsList.outContractsBalancesByPortfolioQuery.contractInformation.length&&o.error("No se encontraron contratos permitidos.")}).catch(function(){c.showSpinner=!1,o.error("Lo sentimos ocurrio un error.")}).finally()}).catch(function(){o.error("Lo sentimos ocurrio un error.")}).finally(function(){c.showSpinner=!1})},c.viewSummaryContract=function(e){var t=e.contractNumber;c.selectedInfo={tipo:e.companyName,isGeneral:!1},c.showSpinner=!0,c.listSummaryContracts=[],c.positionContract=!1,c.contractNumbers=[t];var a=null;for(var r in c.listContracts)if(c.listContracts[r].contractNumber===t){var i=c.listContracts[r].companyName;"Casa"===i?a="CB":"Banco"===i&&(a="B");break}n.getDetailedSummaryContract(t,a).then(function(e){var t=0,n=0,o=0,a=0,r=[],i={},s=0,u={};angular.forEach(e.result,function(e,r){u[r]=e,"moneyMarket"===r?o+=parseFloat(e):"capitalMarket"===r?a+=parseFloat(e):"debtFund"!==r&&"rentFund"!==r&&"coverFund"!==r||(n+=parseFloat(e)),"cashPesos"!==r&&"cashDollars"!==r&&"cashEuros"!==r||(s+=parseFloat(e)),"portfolioValue"!==r&&(t+=parseFloat(e))}),i=u,r.data=i,r.contractNumber=e.contractNumber,c.listSummaryContracts={listContracts:[r],portfolioValue:t,totalCasa:o,totalFounds:n,totalMC:a,totalCash:s},c.positionContract=!1}).catch(function(){c.showSpinner=!1,o.error("Lo sentimos ocurrio un error.")}).finally(function(){c.showSpinner=!1})},c.detailGeneral=function(){c.selectedInfo={tipo:null,isGeneral:!0},c.showSpinner=!0,c.listSummaryContracts.listContracts=[],c.listSummaryContracts.portfolioValue=0,c.listSummaryContracts.totalCasa=0,c.listSummaryContracts.totalFounds=0,c.listSummaryContracts.totalMC=0,c.listSummaryContracts.totalCash=0,c.positionContract=!1;var e=c.listContracts.map(function(e){return e.contractNumber});c.contractNumbers=e;for(var t=0;t<e.length;t++){var a=e[t],r=null;for(var i in c.listContracts)if(c.listContracts[i].contractNumber===a){var s=c.listContracts[i].companyName;"Casa"===s?r="CB":"Banco"===s&&(r="B");break}!function(e,t){n.getDetailedSummaryContract(e,t).then(function(e){var t=0,n=0,o=0,a=0,r=0,i={},s={},u={};angular.forEach(e.result,function(e,i){u[i]=e,"moneyMarket"===i?o+=parseFloat(e):"capitalMarket"===i?a+=parseFloat(e):"debtFund"!==i&&"rentFund"!==i&&"coverFund"!==i||(n+=parseFloat(e)),"cashPesos"!==i&&"cashDollars"!==i&&"cashEuros"!==i||(r+=parseFloat(e)),"portfolioValue"!==i&&(t+=parseFloat(e))}),s=u,i.data=s,i.contractNumber=e.contractNumber,c.listSummaryContracts.listContracts.push(i),c.listSummaryContracts.portfolioValue=t+c.listSummaryContracts.portfolioValue,c.listSummaryContracts.totalCash=r+c.listSummaryContracts.totalCash,c.listSummaryContracts.totalCasa=o+c.listSummaryContracts.totalCasa,c.listSummaryContracts.totalFounds=n+c.listSummaryContracts.totalFounds,c.listSummaryContracts.totalMC=a+c.listSummaryContracts.totalMC,c.positionContract=!1}).catch(function(){c.showSpinner=!1,o.error("Lo sentimos ocurrio un error.")}).finally(function(){c.showSpinner=!1})}(a,r)}},c.changePositionContract=function(){if(c.positionContract)if(c.showSpinner=!0,c.listPositionContracts=[],c.selectedInfo.isGeneral){for(var e=[],t=[],a=c.listSummaryContracts.listContracts,r=0;r<a.length;r++)for(var s=0;s<c.listContracts.length;s++)a[r].contractNumber===c.listContracts[s].contractNumber&&("Casa"===c.listContracts[s].companyName?t.push(a[r].contractNumber):e.push(a[r].contractNumber),s=c.listContracts.length);n.getPositionTypeBankAndHouse(t,e).then(function(e){c.listPositionContracts=i(e),c.showSpinner=!1}).catch(function(){c.showSpinner=!1,c.listPositionContracts=[]})}else"Casa"===c.selectedInfo.tipo?n.getPosition(c.contractNumbers).then(function(e){e&&(c.listPositionContracts=i(e)),c.showSpinner=!1}).catch(function(){c.showSpinner=!1,o.error("Lo sentimos ocurrio un error.")}):n.getPositionTypeBank(c.contractNumbers).then(function(e){e&&(c.listPositionContracts=i(e)),c.showSpinner=!1}).catch(function(e){c.showSpinner=!1,c.listPositionContracts=e})},c.generaReporte=function(){for(var e=Number(c.cliente.clientNumber),a=[],r=[],i=c.listSummaryContracts.listContracts,u=0;u<i.length;u++)for(var l=0;l<c.listContracts.length;l++)i[u].contractNumber===c.listContracts[l].contractNumber&&(a.push({contract:c.listContracts[l].contractNumber,source:"Casa"===c.listContracts[l].companyName?"CB":"B"}),l=c.listContracts.length);if(c.listPositionContracts)for(var d in c.listPositionContracts){var m=c.listPositionContracts[d].rows[0];r.push({contractNumber:m.contractNumber,issuer:m.issuer,position:m.position,price:m.lastPrice,valuation:m.valuation})}else r=0;var p={language:"SPA",contracts:window.btoa(JSON.stringify(a)),clientId:e,totalCash:c.listSummaryContracts.totalCash,totalFunds:c.listSummaryContracts.totalFounds,totalMoney:c.listSummaryContracts.totalCasa,totalCapitals:c.listSummaryContracts.totalMC,name:t.user.name,mail:t.user.mail,createEnvironment:!0,createForecast:!0};c.positionContract?(p.products=window.btoa(JSON.stringify(r)),n.getDetailedCustomerTrackingReport(p).then(function(e){if(/access/i.test(navigator.userAgent)){var t=btoa(s(new Uint8Array(e.data))),n=window.open("Propuesta","_blank","width=1000px,height=905px,resizable=0");n.document.open(),n.document.write('<html><head></head><body><iframe width="100%" height="100%" src="data:application/pdf;base64,'+t+'"></iframe></body></html>'),n.document.close()}else{var o=new Blob([e.data],{type:"application/pdf"}),a=URL.createObjectURL(o);window.open(a,"_blank","Reporte")}}).catch(function(e){o.error("Lo sentimos ocurrio un error. "+e)})):n.getCustomerTrackingReport(p).then(function(e){if(/access/i.test(navigator.userAgent)){var t=btoa(s(new Uint8Array(e.data))),n=window.open("Propuesta","_blank","width=1000px,height=905px,resizable=0");n.document.open(),n.document.write('<html><head></head><body><iframe width="100%" height="100%" src="data:application/pdf;base64,'+t+'"></iframe></body></html>'),n.document.close()}else{var o=new Blob([e.data],{type:"application/pdf"}),a=URL.createObjectURL(o);window.open(a,"_blank","Reporte")}}).catch(function(e){o.error("Lo sentimos ocurrio un error. "+e)})},function(){r()}()}e.$inject=["$q","userConfig","proposalSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("tracingClientCtrl",e)}(),function(){"use strict";function e(e,t){function n(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}var o=this;o.resetForm=function(){o.form={},o.scontract=!1},o.validateForm=function(e){var n=!1;void 0===o.form.tir&&"CB"===o.form.scontract.origen?n="Los datos del periodo para calculo de TIR-1 son incorrectos o incompletos, favor de revisarlos":o.form.tir&&o.form.other_calculus&&void 0===o.form.tir2&&"CB"===o.form.scontract.origen?n="Los datos del periodo para calculo de TIR-2 son incorrectos o incompletos, favor de revisarlos":"CB"===o.form.scontract.origen&&o.form.tir&&o.form.tir.startDate._d.getDate()===o.form.tir.endDate._d.getDate()&&o.form.tir.startDate._d.getMonth()===o.form.tir.endDate._d.getMonth()&&o.form.tir.startDate._d.getFullYear()===o.form.tir.endDate._d.getFullYear()?n="Los datos del periodo para calculo de TIR-1 no pueden ser iguales, favor de revisarlos":"CB"===o.form.scontract.origen&&o.form.other_calculus&&o.form.tir2&&o.form.tir2.startDate._d.getDate()===o.form.tir2.endDate._d.getDate()&&o.form.tir2.startDate._d.getMonth()===o.form.tir2.endDate._d.getMonth()&&o.form.tir2.startDate._d.getFullYear()===o.form.tir2.endDate._d.getFullYear()?n="Los datos del periodo para calculo de TIR-2 no pueden ser iguales, favor de revisarlos":e.ext.$valid||(n="El número de extension es obligatorio, favor de revisarlo."),n?t.error(n):o.submitForm()},o.submitForm=function(){e.doTracing(o.form).then(function(e){try{if(/access/i.test(navigator.userAgent)){var o=btoa(n(new Uint8Array(e.data))),a=window.open("Propuesta","_blank","width=1000px,height=905px,resizable=0");a.document.open(),a.document.write('<html><head></head><body><iframe width="100%" height="100%" src="data:application/pdf;base64,'+o+'"></iframe></body></html>'),a.document.close()}else{var r=new Blob([e.data],{type:"application/pdf"}),i=URL.createObjectURL(r);window.open(i,"_blank","Reporte")}}catch(e){t.error(e)}},function(){t.error("Error al generar la propuesta<br/>Intente más tarde.")})}}e.$inject=["proposalsTracingSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("tracingCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){t.getOpportunityById(u).then(function(e){c.detailOpportunity=e})}function s(){t.getDetailProspect(idProspect,c.detailProspect.idStage).then(function(e){angular.isArray(e.scheduledActivities)&&e.scheduledActivities.forEach(function(t){t.closeDate=e.closeDate,t.prospectDetail={nombreProspecto:e.name,mailProspect:e.mail}}),c.prospectDetail=e})}var c=this;c.isOpenProgramadas=!0,c.isOpenVencidas=!0;var u=o.id;e.$on("updateDetailProspect",function(){s()}),c.addProspect=function(){n.addActivity("NUEVA ACTIVIDAD",c.prospectDetail).result.then(function(){r.done("La actividad se guardo de manera exitosa."),s()}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},c.modify=function(){n.addOpportunity("DATOS PERSONALES",u).result.then(function(){i()},function(){})},c.updateStage=function(e){var n={language:"SPA",idOpportunity:u,idEmployee:a.user.employeeID,idNextStage:e};8===e&&0==c.detailOpportunity.contacted?r.error("Para cambiar de etapa, el cliente debe ser contactado"):c.detailOpportunity.asrStage.idStage+1!=e?r.error("Te falta seleccionar la Etapa PROSPECTO"):r.warning("¿Estás seguro de cambiar de etapa al prospecto?").result.then(function(){t.nextStage(n).then(function(){r.done("El cambio de etapa se realizó de manera correcta."),i()})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e&&void 0!==e)throw e})},function(){i()}()}e.$inject=["$scope","prospectSrv","prospectModalsSrv","$stateParams","userConfig","CommonModalsSrv"],angular.module("actinver.controllers").controller("prospectsDetailCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i){function s(){a.id&&(p=a.id,m.sectionForAdmin=!0),m.dateOptions={minMode:"month"},m.reportType="mes"}function c(e){var t,n=e;m.stagesCat=[],R.forEach(function(e){t="stage"+e.idStage,m.stagesCat[t]=R.filter(function(t){return t.idStage===e.idStage},n)},m.stages),m.typeStage="stage7",u()}function u(){var e=angular.copy(m.typeStage),t={page:1,count:10};m.configTable=new n(t,{paginationMaxBlocks:4,paginationMinBlocks:2,dataset:m.stagesCat[e]})}function l(){m.loadingStage=!0,o.getListByEmployee(p).then(function(e){c(e),m.stagesTable=e,m.loadingStage=!1}).catch(function(){m.loadingStage=!1})}function d(){o.getStages().then(function(e){m.stages=e,l()})}var m=this,p=r.user.employeeID;m.addOpportunity=function(){t.addOpportunity().result.then(function(){i.done("La oportunidad se ha guardado de manera exitosa."),d()})},m.filterStage=function(){var e=m.fieldSearch;m.configTable.filter({$:e})},m.changeStage=function(e){angular.isObject(e)?m.typeStage="stage"+e.idStage:m.typeStage=e,u()},m.changeDate=function(e){m.selectedReport=e},m.getReport=function(){m.loadingReports=!0,o.getProsReports(m.reportDate,m.reportType,p).then(function(e){m.prospectsReport=e,m.selectedReport=e.calendar[0],m.loadingReports=!1})},m.downloadPDF=function(){o.downloadPDF()},m.contactedClient=function(e){i.warning("¿Confirma que se ha contactado a "+e.nameOpportunity).result.then(function(){o.updateContacted(e.idOpportunity).then(function(e){l()})}).catch(function(e){if("cancel"!==e&&"escape key press"!==e&&"backdrop click"!==e)throw e})},function(){s(),d()}()}e.$inject=["binnacleInfo","prospectModalsSrv","NgTableParams","prospectSrv","$stateParams","userConfig","CommonModalsSrv"],angular.module("actinver.controllers").controller("prospectsProfileCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s,c,u){function l(){i.getReportOpportunity(p,m.date).then(function(e){m.listReport=e.result}).catch(function(){})}function d(){m.date=new Date,m.openedCalendar=!1,m.dateOptions={minMode:"month"}}var m=this,p=c.user.employeeID;m.name=c.user.name,m.filterTable={},m.activeFilters=!1,m.datepicker_opts_Fecha_Alta={parentEl:"idDateEnd",singleDatePicker:!0,minDate:moment(),locale:{format:"DD/MM/YYYY"}},m.getDetailReport=function(e,t){var n=1==t?"REPORTE ESPECIAL DEL USUARIO: "+e.name:"REPORTE ESPECIAL DEL CF: "+e.financialCenter;return u.open({templateUrl:"/scripts/modals/views/prospects/report-detail.html",controller:"reportDetailCtrl",controllerAs:"reportDetail",resolve:{adviserInfo:function(){return{adviserID:e.idEmployee,idCF:e.idFC,name:n,type:t}},dateInfo:function(){return{date:m.date}}}}).result.finally(angular.noop).then(angular.noop,angular.noop)},m.report=function(){var e=r.tableToExcel("#idTablaResultadosReport","Reporte General"),t=document.createElement("a");t.download="Reporte General.xls",t.href=e,t.click()},m.getInfoTabs=function(e){l()},m.activfilters=function(){m.activeFilters?m.activeFilters=!1:m.activeFilters=!0,o.search=void 0},function(){d(),l()}()}e.$inject=["binnacleInfo","prospectModalsSrv","$filter","$scope","NgTableParams","exportTableToExcel","prospectSrv","$state","userConfig","$uibModal"],angular.module("actinver.controllers").controller("reportOppCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){var i=this,s=r.user.employeeID;i.typeUserF=function(){var e=i.user.type?1:0,t=i.user.type2?1:0;i.loadingTeamGraph=!0,o.getPrincipalgraphics(e,t,s).then(function(e){i.details1=o.generateDataChart(e.money),i.details2=o.generateDataChart(e.funds),i.details3=o.generateDataChart(e.credit,!0),i.details4=o.generateDataChart(e.seguros,!0),i.noResults=e.money||e.fuds||e.credit||e.seguros,i.totalProspects=i.details3.chart.percentage+i.details4.chart.percentage,i.remainingProspects=i.details3.remaining+i.details4.remaining,i.customersContacted=e.customersContacted,i.loadingTeamGraph=!1,i.viewDetail=!1})},i.detailStage=function(e){i.spinnerDetail=!0,o.getTableProspects(e).then(function(e){var t={count:5},o={dataset:e,paginationMaxBlocks:4,paginationMinBlocks:2};i.configTable=new n(t,o),i.spinnerDetail=!1,i.viewDetail=!0})},i.setUser=function(e){i.adviserProspect=e,a.go("prospects.team.idTeam",{id:40})},i.applySearch=function(){var e=i.fieldSearch;i.configTable.filter({$:e})},i.addProspect=function(){t.add()},i.downloadPDF=function(){o.downloadPDF()}}e.$inject=["binnacleInfo","prospectModalsSrv","NgTableParams","prospectSrv","$state","userConfig"],angular.module("actinver.controllers").controller("prospectsTeamCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){c.profile=n.model}function s(){r.getStages().then(function(e){c.stages=e.map(function(e){return e.text=e.description,e})})}var c=this;if(!n.model)return t.go("prospects.myProfile"),"";c.reactivate=function(){var n=c.varsActivity?c.varsActivity.activity:null;e.reactivate(c.profile,n).then(function(){a.done("Se a reactivado correctamente el perfil").result.then(function(){t.go("prospects.myProfile")})})},function(){i(),s()}()}e.$inject=["reactivateSrv","$state","$stateParams","$scope","CommonModalsSrv","prospectSrv"],angular.module("actinver.controllers").controller("prospectsReactivateCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getProfile=function(o){return t(function(t){n({method:"POST",url:e.genericPost,data:o}).then(function(e){e.data.status&&t(e.data.result)})})},o.prototype.reactivate=function(o,a){return t(function(t){n({method:"POST",url:e.genericPost,data:{prospect:o,activity:a}}).then(function(e){e.data.status&&t(e.data.result)})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("reactivateSrv",e)}(),function(){"use strict";function e(e,t){var n=this;n.changeOptionSelectedDropdowm=function(e){n.quote={type:"fisica"},n.quote.optionsSelectedDropdowm=e,n.payment=0},n.getPayment=function(){e.getSimPayment(n.quote).then(function(e){n.payment=e.payment})},n.quotation=function(){e.quotation(n.quote).then(function(e){n.quotationDetail=e,n.showNewQuotation=!0})},n.back=function(){n.showNewQuotation=!1},n.print=function(){t.downloadPDF()},function(){n.payment=0,n.quote={optionsSelectedDropdowm:null,type:"fisica"},n.optionsDropdowm=[{id:1,text:"Crédito Valor"},{id:2,text:"Crédito Prendario Tasa Variable"}]}()}e.$inject=["creditSrv","prospectSrv"],angular.module("actinver.controllers").controller("creditCtrl",e)}(),function(){"use strict";function e(e,t,n,o){function a(){}return a.prototype.quotation=function(a){return t(function(t,r){n({method:"POST",url:e.getCreditDetail,params:{language:"SPA"},data:a}).then(function(e){1===e.data.status?t(e.data.result):(o(e.data.messages),r())})})},a.prototype.getSimPayment=function(a){return t(function(t,r){n({method:"POST",url:e.getSimPayment,params:{language:"SPA"},data:a||{}}).then(function(e){1===e.data.status?t(e.data.result):(o(e.data.messages),r())})})},new a}e.$inject=["URLS","$q","$http","ErrorMessagesSrv"],angular.module("actinver.services").service("creditSrv",e)}(),function(){"use strict";function e(e,t,n,o){function a(){c=t.model,u=document.getElementById("chartjs-tooltip2")}function r(){var t=e.sendModel(c);i(t),e.SimulatorRest("smt01",t.send).then(function(t){l.amounts=e.calculate(c.virtualAmount,t),l.smt01=t.issuers,l.chartLine=e.setupDataLine(t.simulator),l.chartDonut=e.setDonutChart(l.smt01,u,c)})}function i(t){e.SimulatorRest("smt02",t.send).then(function(e){l.smt02=e})}function s(){o.complete()}var c,u,l=this;if(!t.model)return n.go("simulators.performance"),"";!function(){a(),r()}(),l.viewDetail=function(){l.viewMore=!0,l.newCharts=[];var t=[];t.push(e.getType("debt",c.send.issuers,l.smt01,"DEUDA")),t.push(e.getType("rent",c.send.issuers,l.smt01,"RENTA VARIABLE")),t.push(e.getType("din",c.send.issuers,l.smt01,"DINÁMICOS")),t.push(e.getType("MERCADO DE CAPITALES",c.send.issuers,l.smt01,"MERCADO DE CAPITALES")),l.newCharts=e.getGraps(t,u,c)},l.downloadPDF=function(){o.start(),setTimeout(s,5e3)}}e.$inject=["PerformanceSrv","$stateParams","$state","cfpLoadingBar"],angular.module("actinver.controllers").controller("detailPerformCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){c.date={startDate:null,endDate:null},c.categories={},c.totalValueMarket=0,c.allMarkets=[],c.selectedTab="funds",c.selectedSubTab="debt",c.amount=1e6,c.slider={value:0,options:{floor:1,ceil:5,step:2,showSelectionBar:!0,translate:function(e,t,n){switch(n){case"model":return e+" años ";default:return""}}}},c.optionsTab1=[{id:3,text:"DE DEUDA",code:"debt"},{id:2,text:"DE RENTA VARIABLE",code:"rent"},{id:1,text:"DINÁMICOS",code:"din"}],c.optionsTab2=[{id:4,text:"IPC",code:"ipc"},{id:5,text:"MAS BURSÁTILES",code:"masbursatil"},{id:6,text:"MENOS BURSÁTILES",code:"menosbursatil"},{id:7,text:"SIC",code:"sic"},{id:8,text:"TRACKS",code:"tracks"},{id:9,text:"TRACKS DEUDA",code:"tracksdeuda"}]}function i(){c.loading=!0,t.all([e.GetStations(3),e.GetStations(2),e.GetStations(1)]).then(function(t){if("string"!=typeof t[0]&&"string"!=typeof t[1]&&"string"!=typeof t[2]){var n=["debt","rent","din"];t.map(function(t,o){t.issuer.map(function(t){e.getClasification(t),t.type=n[o],c.allMarkets.push(t)}),c.categories[n[o]]=t.issuer}),c.resultTable=c.categories.debt,s()}else a("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk")})}function s(){e.GetStationsMarket().then(function(e){c.categories.capitals=e.marketDataTuple,e.marketDataTuple.map(function(e){c.allMarkets.push(e)}),c.selectTabTable("funds"),c.loading=!1})}var c=this;c.goState=function(){var e=o("filter")(c.allMarkets,{selected:!0}),t=e.map(function(e){return"funds"===c.selectedTab?{issuer:e.issuerName,serie:e.serie,virtualAmount:e.value/100*c.amount,percent:e.value,type:e.type}:{issuer:e.issuerName,serie:e.serie,virtualAmount:e.value/100*c.amount,percent:e.value,type:"MERCADO DE CAPITALES"}}),a=new Date,r=new Date;r.setFullYear(r.getFullYear()-c.slider.value);var i={send:{beginDate:o("date")(r,"ddMMyy"),endDate:o("date")(a,"ddMMyy"),issuers:t},virtualAmount:c.amount};n.go("simulators.details",{model:i})},c.selectTabTable=function(e,t){t?(c.selectedSubTab=t,c.resultTable=c.categories[c.selectedSubTab.code]):(c.selectedTab=e,"funds"===e?(c.selectedSubTab=c.optionsTab1[0],c.resultTable=c.categories[c.selectedSubTab.code]):(c.selectedSubTab=c.optionsTab2[0],c.selectTabTableMarket(c.selectedSubTab)))},c.selectTabTableMarket=function(t){if(t){c.selectedSubTab=t;var n=0,o=0;switch(t.code){case"ipc":n=2,o=2;break;case"masbursatil":n=2,o=3;break;case"menosbursatil":n=2,o=4;break;case"sic":n=5,o=5;break;case"tracks":n=3,o=5;break;case"tracksdeuda":n=4,o=5}e.GetStationsMarketCAP(n,o).then(function(e){if(void 0===c.categories[t.code]){var n=[],o={};angular.forEach(e,function(e){o=e.issuer,o.averagePrice=e.averagePrice,o.closingPrice=e.closingPrice,o.lastPrice=e.lastPrice,o.selected=!1,o.type=t.code,n.push(o),c.allMarkets.push(o)}),c.categories[t.code]=n}c.resultTable=c.categories[t.code]})}},c.updateTotal=function(){c.totalValueMarket=0,c.allMarkets.map(function(e){e.selected&&(c.totalValueMarket+=parseInt(e.value)||0)})},function(){r(),i()}()}e.$inject=["PerformanceSrv","$q","$state","$filter","ErrorMessagesSrv"],angular.module("actinver.controllers").controller("performanceCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r){function i(){}function s(e,t){return t.filter(function(t){return t.issuer===e})[0].percent}i.prototype.GetStations=function(o){return t(function(t,a){n({method:"GET",url:e.getInvestmentIssuersQuery+"55/0/0/0/"+o+"/0",params:{language:"SPA"}}).then(function(e){
1===e.data.outCommonHeader.result.result?t(e.data.outInvestmentIssuersQuery):2===e.data.outCommonHeader.result.result&&t("response.data.outCommonHeader.result.messages[0].responseMessage")}).catch(function(e){r("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),a({error:e.data})})})},i.prototype.GetStationsMarket=function(){return t(function(t,o){n({method:"GET",url:e.clientIssuersMarketInfoQuery+"0/1/1/0/0/0/",params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outClientIssuersMarketInfoQuery):o(e.data.outCommonHeader)})})},i.prototype.GetStationsMarketCAP=function(o,a){return t(function(t,i){n({method:"GET",url:e.clientIssuersMarketInfoQueryV1+"55/"+o+"/"+a+"/0/0/1",params:{language:"SPA"}}).then(function(e){1===e.data.outCommonHeader.result.result?t(e.data.outClientIssuersMarketInfoQuery.marketDataTuple):2===e.data.outCommonHeader.result.result&&t(e.data.outCommonHeader.result.messages[0].responseMessage)}).catch(function(e){r("Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"),i({error:e.data})})})},i.prototype.SimulatorRest=function(e,a){return t(function(t,r){function i(){var o={beginDate:a.beginDate,endDate:a.endDate,issuers:JSON.stringify(a.issuers),language:"SPA"};n({method:"POST",url:"https://bursanet.actinver.com/ficha-valor-restful/SimulatorRest/"+e,data:$.param(o)}).then(function(e){1===e.data.status?t(e.data.result):r(e.data.messages)})}function s(e){r(e)}o.csrfValidate().then(i).catch(s)})},i.prototype.getClasification=function(e){switch(e.familyFundClassification){case 1:e.clasificacion="Alternativos";break;case 2:e.clasificacion="Relativo a Indices de Mercado";break;case 3:e.clasificacion="Paises / Economías";break;case 4:e.clasificacion="México Estilos de Inversión";break;case 5:e.clasificacion="Pesos";break;case 6:e.clasificacion="Dólares";break;case 7:e.clasificacion="Activos Locales";break;case 8:e.clasificacion="Activos Globales";break;default:e.clasificacion=""}},i.prototype.calculate=function(e,t){var n=t.simulator.length-1,o=t.simulator[n].investmentFinal;return{start:e,end:o,pesos:o-e,services:e>0?100*(o-e)/e:0}},i.prototype.setupDataLine=function(e){return{chart:[{historical:{contractNumber:"Valuación",historicalInfo:e.map(function(e){var t=new Date(e.datePrice);return{amount:e.investmentFinal,paymentPeriod:a("date")(t,"yyyyMMdd")}})}}]}},i.prototype.sendModel=function(e){var t=e.send.issuers.map(function(e){return{issuer:e.issuer,serie:e.serie,virtualAmount:e.virtualAmount}});return{send:{beginDate:e.send.beginDate,endDate:e.send.endDate,issuers:t}}},i.prototype.setDonutChart=function(e,t,n){var o,r=[];return e.map(function(e){o=e.elements.length-1,e.finalAmount=e.elements[o],r.push(e.finalAmount.virtualValue)}),{chart:{labels:e,data:r,cutoutPercentage:60,colors:["#517cbd","#f5f047","#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac","#b77322","#16d620","#b91383","#f4359e","#9c5935","#a9c413","#2a778d","#668d1c","#bea413","#0c5922","#743411"],tooltips:{custom:function(e){var n=this._chart.canvas.offsetTop,o=this._chart.canvas.offsetLeft;return 0===e.opacity?void(t.style.display="none"):(e.dataPoints&&(t.style.display="block",t.style.left=o+e.caretX+"px",t.style.top=n+e.caretY+"px"),t)},callbacks:{label:function(e,o){var r=o.labels[e.index],i=s(r.issuer,n.send.issuers),c="";c+='<div class="row margin-0 title">',c+='<div class="col-xs-6 padding-left-10 padding-right-0">'+r.issuer+" "+r.serie+" <br/> <em>Renta variable</em></div>",c+='<div class="col-xs-6 percentage">'+i+"% </div>",c+="</div>",c+='<div class="row margin-0 description">',c+='<div class="col-xs-6">',c+="<label>Monto asignado: </label>"+a("currency")(r.virtualAmount),c+="</div>",c+='<div class="col-xs-6 ">',c+="<label>Importe final:</label>"+a("currency")(r.finalAmount.virtualValue),c+="</div>",c+="</div>",c+='<div class="row margin-0 description">',c+='<div class="col-xs-6">',c+="<label>$ Plusvalía en pesos:</label>"+a("currency")(r.finalAmount.virtualValue-r.virtualAmount),c+="</div>",c+='<div class="col-xs-6">',c+="<label>% Plusvalía por servicio:</label>"+a("currency")(r.virtualAmount>0?100*(r.finalAmount.virtualValue-r.virtualAmount)/r.virtualAmount:0,"")+"%",c+="</div>",c+="</div>",t.innerHTML=c}}}}}},i.prototype.getType=function(e,t,n,o){var a=[],r=[],i=0,s=0,c=0;return t.filter(function(t){t.type===e&&n.filter(function(e){e.issuer===t.issuer&&(r.push(e),i+=parseInt(t.virtualAmount),s+=parseInt(e.finalAmount.virtualValue),c+=parseInt(t.percent))})}),a.push(r),a.push(i),a.push(s),a.push(c),a.push(o),0===c?[]:a},i.prototype.getGraps=function(e,t,n){var o=[];return e.filter(function(e){if(0!==e.length){var a={chart:c.setDonutChart(e[0],t,n),name:e[4],investmentFinal:e[2],investment:e[1]};a.chart.chart.tooltips={},a.chart.chart.percentage=e[3]+"%",o.push(a)}}),o};var c=new i;return new i}e.$inject=["URLS","$q","$http","csrfSrv","$filter","ErrorMessagesSrv"],angular.module("actinver.services").service("PerformanceSrv",e)}(),function(){"use strict";function e(e,t){var n=this;n.beneficiarios=t.beneficiaryList.beneficiary,n.attorneyList=t.attorneyList.attorney,n.personAuthorizedList=t.personAuthorizedList.personAuthorized,n.cotitulares=t.coownerList.coowner,n.titular=t.holder,n.investmentProfile=t.investmentProfile.description,n.phoneNumberList=t.holder.phonesList.phone,n.emailList=t.holder.emailList.email,n.adviserName=t.adviser.description,n.financialCenter=t.branch.description,n.discretionaryContractFlag=t.discretionaryContractFlag,n.eligibleClientFlag=t.eligibleClientFlag,n.ownPositionFlag=t.ownPositionFlag,n.contractNumber=t.contractNumber,n.close=function(){e.dismiss()},n.done=function(){e.close()}}e.$inject=["$uibModalInstance","data"],angular.module("actinver.controllers").controller("detailContractCtrl",e)}(),function(){"use strict";function e(e){var t=this,n={all:{val1:1,val2:5,text:"TODAS"},ipc:{val1:2,val2:2,text:"IPC"},bmv:{val1:3,val2:5,text:"BMV"},sic:{val1:4,val2:5,text:"SIC"},trackInt:{val1:5,val2:5,text:"TRACKINT"},trackNac:{val1:6,val2:5,text:"TRACKNAC"},plusBursatiles:{val1:7,val2:3,text:"10MAS"},minusBursatiles:{val1:8,val2:4,text:"10MENOS"}};t.selected=function(e){t.categorySelected=n[e],t.tabSelect=e},e.$on("updateCapitalsTab",function(){switch(e.activeTab){case 0:t.updateFunds();break;case 1:t.updateOrders();break;case 2:t.stopLoss();break;case 3:t.trailingStop();break;case 4:t.clean()}}),t.categorySelected=n.ipc}e.$inject=["$scope"],angular.module("actinver.controllers").controller("capitalsCtrl",e)}(),function(){"use strict";function e(e){var t=this,n={ipc:{val1:2,val2:2,text:"IPC"},bmv:{val1:3,val2:5,text:"BMV"},sic:{val1:4,val2:5,text:"SIC"},trackInt:{val1:5,val2:5,text:"TRACKINT"},trackDeuda:{val1:6,val2:5,text:"TRACKNAC"},plusBursatiles:{val1:7,val2:3,text:"10MAS"},minusBursatiles:{val1:8,val2:4,text:"10MENOS"},all:{val1:1,val2:5,text:"TODAS"}};t.selected=function(e){t.categorySelected=n[e],t.tabSelect=e},e.$on("updateCapitalsTab",function(){switch(e.activeTab){case 0:t.updateFunds();break;case 1:t.updateOrders()}}),t.categorySelected=n.ipc}e.$inject=["$scope"],angular.module("actinver.controllers").controller("capitalsLuminaCtrl",e)}(),function(){"use strict";function e(e,t){var n=this;e.investment.contract||t.go("investment"),e.$on("updateTab",function(){switch(e.activeTab){case 0:n.updateFunds();break;case 1:n.updateOrders();break;case 2:n.clean()}}),n.selected=function(e){n.tabSelect=e}}e.$inject=["$scope","$state"],angular.module("actinver.controllers").controller("fundsCtrl",e)}(),function(){"use strict";function e(e){var t=this;e.$on("updateTab",function(){switch(e.activeTab){case 0:t.updateFunds();break;case 1:t.updateOrders();break;case 2:t.clean()}}),t.selected=function(e){t.tabSelect=e}}e.$inject=["$scope"],angular.module("actinver.controllers").controller("fundsBankCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){return[{id:1,text:"PDF"},{id:2,text:"XML"},{id:3,text:"PDF/XML"}]}function i(){var e=JSON.parse(localStorage.getItem("contractSelected")).bankingArea,a={contractNumber:p.contract,bankingArea:e},r=[];return t.getContractInfoDetail(a).then(function(e){0===e.holder.emailList.email.length?n.error("No tiene Correos Asignados"):angular.forEach(e.holder.emailList.email,function(e,t){r.push({id:t,text:e.toLowerCase()})})}).catch(function(e){var t=e.data.outCommonHeader.result.messages;n.error(o.createError(t))}),r}function s(e){var t=[];return a.getStatementFiscales(p.contract,e).then(function(n){0!==n.resultSet&&angular.forEach(n.resultSet,function(n){t.push({id:n.period,text:3===e?c(n.period):Number(n.period),contractNumber:n.contractNumber,typeAccountStatement:n.typeAccountStatement,fileNameExtension:n.fileNameExtension})})}).catch(function(e){n.error(o.createError(e.data.outCommonHeader.result.messages))}),t}function c(e){return e.substring(0,2)+"/"+e.substring(2,6)}function u(e){e="999"===JSON.parse(localStorage.getItem("contractSelected")).bankingArea?1:2;var t=[];return a.getStatementFiscalesPormenorizadas(p.contract,e).then(function(e){0!==e.resultSet&&angular.forEach(e.resultSet,function(e){t.push({id:e.period,text:Number(e.period)-1,contractNumber:e.contractNumber,typeAccountStatement:e.typeAccountStatement?e.typeAccountStatement:9,fileNameExtension:e.fileNameExtension,documentTypeID:e.documentTypeID})})}).catch(function(e){var t=e.data.outCommonHeader.result.messages;n.error(o.createError(t))}),t}function l(){p.ListConstanciasFiscales=[],p.ListConstanciasPormenorizadas=[];var e=void 0!==p.cmd?p.cmd:null;if(null!==e){var t=void 0!==e.dataEmailConstancias?e.dataEmailConstancias:null,n=void 0!==e.dataListConstanciasFiscales?e.dataListConstanciasFiscales:null,o=void 0!==e.dataListConstanciasPormenorizadas?e.dataListConstanciasPormenorizadas:null,a=void 0!==e.dataListFormats?e.dataListFormats:null;null!==t&&(p.cmd.dataEmailConstancias.type=[]),null!==n&&(p.cmd.dataListConstanciasFiscales.type=[]),null!==o&&(p.cmd.dataListConstanciasPormenorizadas.type=[]),null!==a&&(p.cmd.dataListFormats.type=[])}}function d(){var e=JSON.parse(localStorage.getItem("contractSelected")).bankingArea,t=[];t.push(p.cmd.dataEmailConstancias.type.text);var o={contract:p.contract,businessType:"999"===e?1:2,documentKeyValue:1,month:3===p.cmd.dataListConstanciasFiscales.type.typeAccountStatement?p.cmd.dataListConstanciasFiscales.type.text.substring(0,2):0,year:3===p.cmd.dataListConstanciasFiscales.type.typeAccountStatement?p.cmd.dataListConstanciasFiscales.type.text.substring(3,7):p.cmd.dataListConstanciasFiscales.type.text+1,typeAccountStatement:p.cmd.dataListConstanciasFiscales.type.typeAccountStatement,documentTypeID:p.cmd.dataListFormats.type.id,email:t};a.sendEmailNotificationStatementFiscalNew(o).then(function(e){e.status&&n.done(e.message)}).catch(function(e){n.error(e.message)})}function m(e,t){switch(l(),t.id){case 4:p.ListFormats=r(t.id),p.ListConstanciasFiscales=s(t.id);break;case 9:p.ListFormats=r(t.id),p.ListConstanciasFiscales=u(t.id);break;case 3:p.ListFormats=r(t.id),p.ListConstanciasFiscales=s(t.id)}}var p=this;p.ListConstancias=function(){return[{id:4,text:"Constancia Fiscal"},{id:9,text:"Constancia Fiscal Pormenorizada"},{id:3,text:"Estados de Cuenta"}]}(),p.ListConstanciasFiscales=[],p.ListConstanciasPormenorizadas=[],p.EmailConstancias=[],p.contract=0,p.sendMail=d,p.onChangeStatementFiscal=m,function(){var e=JSON.parse(localStorage.getItem("contractSelected"));p.contract=e.contractNumber,p.EmailConstancias=i()}(),e.validate=function(){var e=void 0!==p.cmd.dataStatementFiscal?p.cmd.dataStatementFiscal.type:null,t=void 0!==p.cmd.dataEmailConstancias?p.cmd.dataEmailConstancias.type:null,o=void 0!==p.cmd.dataListConstanciasFiscales?p.cmd.dataListConstanciasFiscales.type:null,a=void 0!==p.cmd.dataListConstanciasPormenorizadas?p.cmd.dataListConstanciasPormenorizadas.type:null,r=void 0!==p.cmd.dataListFormats?p.cmd.dataListFormats.type:null;return null===e?(n.error("Seleccione un tipo de Constancia"),!1):4===e.id?null!==t&&null!==o&&null!==r:9===e.id&&(null!==t&&null!==a&&null!==r)}}e.$inject=["$scope","accountSrv","CommonModalsSrv","ErrorMessage","statementFiscalSrv"],angular.module("actinver.controllers").controller("statementFiscalCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getStatementFiscales=function(o,a){return e(function(e,r){t({method:"GET",url:n.getStatementFiscal+o+"/"+a,params:{language:"SPA"}}).then(function(t){1===t.data.outCommonHeader.result.result?e(t.data.outAccountStatementAvailabilityQuery):r(t.data.outCommonHeader.result)})})},o.prototype.getStatementFiscalesPormenorizadas=function(o,a){return e(function(e,r){t({method:"GET",url:n.getStatementFiscalPormenorizadas+o+"/"+a,params:{language:"SPA"}}).then(function(t){1===t.data.outCommonHeader.result.result?e(t.data.outFiscalCertificateAvailableQuery):r(t.data.outCommonHeader.result)})})},o.prototype.sendEmailNotificationStatementFiscal=function(o,a,r,i,s,c,u){return e(function(e,l){t({method:"GET",url:n.sendEmailNotificationStatementFiscalQuery+o+"/"+a+"/"+r+"/"+i+"/"+s+"/"+c,params:u}).then(function(t){1===t.data.outCommonHeader.result.result?e(t.data.outCommonHeader):l(t.data.outCommonHeader.result)})})},o.prototype.sendEmailNotificationStatementFiscalNew=function(o){return e(function(e,a){t({method:"GET",url:n.sendEmailNotificationStatementFiscalQuery+o.contract+"/"+o.businessType+"/"+o.documentKeyValue+"/"+o.month+"/"+o.year+"/"+o.typeAccountStatement+"/"+o.documentTypeID,params:{language:"SPA",emailTo:o.email}}).then(function(t){1===t.data.outCommonHeader.result.result?e({status:!0,message:"Se envió el correo correctamente"}):a({status:!1,message:t.data.outCommonHeader.result.messages[0].responseMessage})})})},new o}e.$inject=["$q","$http","URLS"],angular.module("actinver.services").service("statementFiscalSrv",e)}(),function(){"use strict";function e(e,t){var n=this;e.$on("updateItems",function(){switch(e.activeTab){case 0:n.updateInstruments();break;case 1:n.updateOrders();break;case 2:n.fhClean()}}),n.selected=function(e){n.tabSelect=e,1===n.tabSelect?(n.type="directo",t.bands=null):n.type="reporto"}}e.$inject=["$scope","$rootScope"],angular.module("actinver.controllers").controller("moneyCtrl",e)}(),function(){"use strict";function e(){var e=this;e.bandsDirect=[],e.selected=function(t){e.tabSelect=t,1===e.tabSelect?e.type="directo":2===e.tabSelect?e.type="reporto":3===e.tabSelect&&(e.type="subastas")}}angular.module("actinver.controllers").controller("moneyBankCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a){function r(){o.service("financialCenters").then(function(e){u.financialCenters=e.map(function(e){return e.text=e.financialCenter,e})}),o.service("userGroups").then(function(e){u.users=e.map(function(e){return e.text=e.userCode,e})})}function i(){var e={count:5},o={dataset:t.financialCenters,paginationMaxBlocks:4,paginationMinBlocks:2};u.configTable=new n(e,o)}function s(){var e={count:5},o={dataset:t.users,paginationMaxBlocks:4,paginationMinBlocks:2};u.configTable2=new n(e,o)}function c(){u.group=t}var u=this;u.search=function(e){var t=u[e];"table2"===e?u.configTable2.filter({$:t}):u.configTable.filter({$:t})},u.addUser=function(){var e={idTargetGroup:t.idTargetGroup,idEmployee:u.userSelected.idEmployee,language:"SPA"};o.service("saveUser","POST",e).then(function(){u.disabledModal=!0,a.done("El Usuario se agregó de manera exitosa.").result.finally(function(){u.disabledModal=!1}),t.users.push(angular.copy(u.userSelected)),s(),u.userSelected=null})},u.deleteUser=function(e){var n={idTargetGroup:t.idTargetGroup,idEmployee:e.idEmployee,language:"SPA"};o.service("deleteUser","POST",n).then(function(){u.disabledModal=!0,a.done("El Usuario se elimino de manera exitosa.").result.finally(function(){u.disabledModal=!1})})},u.addFinancial=function(){var e={idTargetGroup:t.idTargetGroup,keyCenter:u.financialCenterSelected.keyCenter,language:"SPA"};o.service("saveCenter","POST",e).then(function(){u.disabledModal=!0,a.done("El Centro Financiero se agregó de manera exitosa.").result.finally(function(){u.disabledModal=!1}),t.financialCenters.push(angular.copy(u.financialCenterSelected)),i(),u.financialCenterSelected=null})},u.deleteFinancial=function(e){var n={idTargetGroup:t.idTargetGroup,keyCenter:e.keyCenter,language:"SPA"};o.service("deleteCenter","POST",n).then(function(){u.disabledModal=!0,a.done("El Centro Financiero se elimino de manera exitosa.").result.finally(function(){u.disabledModal=!1})})},u.close=function(){e.dismiss()},u.done=function(){e.close(u.group),e.close(u.employee)},function(){r(),c(),s(),i()}()}e.$inject=["$uibModalInstance","group","NgTableParams","GroupSrv","CommonModalsSrv"],angular.module("actinver.controllers").controller("admonGroupModalCtrl",e)}(),function(){"use strict";function e(e,t,n,o,a,r,i,s){var c=this;c.modal=!1,c.listRegister=[],c.getLista=function(){console.log("========= DENTRO DE LA FUNCION GET LISTA ======="),c.modal=!0,i.getListaReportes().then(function(e){console.log("========== DATA ========="+e),e.success?(c.listRegister=e.lista,console.log("*******************"+listRegister)):(c.listRegister=[],s(e.message),cosole.log("******************ERROR")),c.modal=!1}).catch(function(e){c.modal=!1,s(e.message)})},c.exportData=function(){var e=a.tableToExcel("#idTablaResultados","Mis Reportes"),t=document.createElement("a");t.download=r.getNameFile()+".xls",t.href=e,t.click()},function(){c.getLista()}()}e.$inject=["$scope","URLS","$http","$timeout","exportTableToExcel","randomNamesSrv","misreportesSrv","ErrorMessagesSrv"],angular.module("actinver.controllers").controller("misreportesCtrl",e)}(),function(){"use strict";function e(e,t,n){function o(){}return o.prototype.getListaReportes=function(){return console.log("========= GetLisReportes ========="),t(function(t,o){n({method:"Get",url:e.getInsuranceMaritalStatusQuery,params:{language:"SPA",insuranceTypeID:"100"}}).then(function(e){console.log(e)}).catch(function(){o({success:!1,lista:[],msg:"Se encontró un error favor de intentarlo más tarde, comuníquese con su help desk"})})})},new o}e.$inject=["URLS","$q","$http"],angular.module("actinver.services").service("misreportesSrv",e)}();